LavaPack.loadBundle([[10,{"../controllers/account-order":197},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.AccountOrderControllerInit=void 0;var r=e("../controllers/account-order");n.AccountOrderControllerInit=({controllerMessenger:e,persistedState:t})=>({controller:new r.AccountOrderController({messenger:e,state:t.AccountOrderController})})}}},{package:"$root$",file:"app/scripts/controller-init/account-order-controller-init.ts"}],[100,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getMetaMetricsDataDeletionControllerMessenger=function(e){return e.getRestricted({name:"MetaMetricsDataDeletionController",allowedActions:["MetaMetricsController:getState"],allowedEvents:[]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/metametrics-data-deletion-controller-messenger.ts"}],[101,{"./multichain-assets-controller-messenger":102,"./multichain-assets-rates-controller-messenger":103,"./multichain-balances-controller-messenger":104,"./multichain-network-controller-messenger":105,"./multichain-transactions-controller-messenger":106},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"getMultichainAssetsControllerMessenger",{enumerable:!0,get:function(){return r.getMultichainAssetsControllerMessenger}}),Object.defineProperty(n,"getMultichainAssetsRatesControllerMessenger",{enumerable:!0,get:function(){return s.getMultichainAssetsRatesControllerMessenger}}),Object.defineProperty(n,"getMultichainBalancesControllerMessenger",{enumerable:!0,get:function(){return i.getMultichainBalancesControllerMessenger}}),Object.defineProperty(n,"getMultichainNetworkControllerMessenger",{enumerable:!0,get:function(){return a.getMultichainNetworkControllerMessenger}}),Object.defineProperty(n,"getMultichainTransactionsControllerMessenger",{enumerable:!0,get:function(){return o.getMultichainTransactionsControllerMessenger}});var r=e("./multichain-assets-controller-messenger"),s=e("./multichain-assets-rates-controller-messenger"),i=e("./multichain-balances-controller-messenger"),o=e("./multichain-transactions-controller-messenger"),a=e("./multichain-network-controller-messenger")}}},{package:"$root$",file:"app/scripts/controller-init/messengers/multichain/index.ts"}],[102,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getMultichainAssetsControllerMessenger=function(e){return e.getRestricted({name:"MultichainAssetsController",allowedEvents:["AccountsController:accountAdded","AccountsController:accountRemoved","AccountsController:accountAssetListUpdated"],allowedActions:["PermissionController:getPermissions","SnapController:handleRequest","SnapController:getAll","AccountsController:listMultichainAccounts"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/multichain/multichain-assets-controller-messenger.ts"}],[103,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getMultichainAssetsRatesControllerMessenger=function(e){return e.getRestricted({name:"MultichainAssetsRatesController",allowedEvents:["AccountsController:accountAdded","KeyringController:lock","KeyringController:unlock","CurrencyRateController:stateChange","MultichainAssetsController:accountAssetListUpdated"],allowedActions:["AccountsController:listMultichainAccounts","SnapController:handleRequest","CurrencyRateController:getState","MultichainAssetsController:getState","AccountsController:getSelectedMultichainAccount"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/multichain/multichain-assets-rates-controller-messenger.ts"}],[104,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getMultichainBalancesControllerMessenger=function(e){return e.getRestricted({name:"MultichainBalancesController",allowedEvents:["AccountsController:accountAdded","AccountsController:accountRemoved","AccountsController:accountBalancesUpdated","MultichainAssetsController:accountAssetListUpdated"],allowedActions:["AccountsController:listMultichainAccounts","SnapController:handleRequest","MultichainAssetsController:getState","KeyringController:getState"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/multichain/multichain-balances-controller-messenger.ts"}],[105,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getMultichainNetworkControllerMessenger=function(e){return e.getRestricted({name:"MultichainNetworkController",allowedActions:["NetworkController:setActiveNetwork","NetworkController:getState","NetworkController:removeNetwork","NetworkController:findNetworkClientIdByChainId","NetworkController:getSelectedChainId","AccountsController:listMultichainAccounts"],allowedEvents:["AccountsController:selectedAccountChange"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/multichain/multichain-network-controller-messenger.ts"}],[106,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getMultichainTransactionsControllerMessenger=function(e){return e.getRestricted({name:"MultichainTransactionsController",allowedEvents:["AccountsController:accountAdded","AccountsController:accountRemoved","AccountsController:accountTransactionsUpdated"],allowedActions:["AccountsController:listMultichainAccounts","SnapController:handleRequest","KeyringController:getState"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/multichain/multichain-transactions-controller-messenger.ts"}],[107,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getNameControllerInitMessenger=function(e){return e.getRestricted({name:"NameControllerInit",allowedActions:["PreferencesController:getState"],allowedEvents:[]})},n.getNameControllerMessenger=function(e){return e.getRestricted({name:"NameController",allowedActions:[],allowedEvents:[]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/name-controller-messenger.ts"}],[108,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getNetworkControllerInitMessenger=function(e){return e.getRestricted({name:"NetworkControllerInit",allowedActions:["MetaMetricsController:getMetaMetricsId","MetaMetricsController:trackEvent"],allowedEvents:["NetworkController:rpcEndpointUnavailable","NetworkController:rpcEndpointDegraded","RemoteFeatureFlagController:stateChange"]})},n.getNetworkControllerMessenger=function(e){return e.getRestricted({name:"NetworkController",allowedActions:["ErrorReportingService:captureException"],allowedEvents:[]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/network-controller-messenger.ts"}],[109,{"./notification-services-controller-messenger":110,"./notification-services-push-controller-messenger":111},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"getNotificationServicesControllerMessenger",{enumerable:!0,get:function(){return r.getNotificationServicesControllerMessenger}}),Object.defineProperty(n,"getNotificationServicesPushControllerInitMessenger",{enumerable:!0,get:function(){return s.getNotificationServicesPushControllerInitMessenger}}),Object.defineProperty(n,"getNotificationServicesPushControllerMessenger",{enumerable:!0,get:function(){return s.getNotificationServicesPushControllerMessenger}});var r=e("./notification-services-controller-messenger"),s=e("./notification-services-push-controller-messenger")}}},{package:"$root$",file:"app/scripts/controller-init/messengers/notifications/index.ts"}],[11,{"../../../shared/constants/network":5800,"../../../shared/modules/selectors/networks":5918,"../controllers/account-tracker-controller":198,"@metamask/utils":2908},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.AccountTrackerControllerInit=void 0;var r,s=e("@metamask/utils"),i=e("../../../shared/modules/selectors/networks"),o=e("../../../shared/constants/network"),a=(r=e("../controllers/account-tracker-controller"))&&r.__esModule?r:{default:r};n.AccountTrackerControllerInit=({controllerMessenger:e,initMessenger:t})=>{const{provider:n,blockTracker:r}=t.call("NetworkController:getSelectedNetworkClient")??{};(0,s.assert)(n,"Provider is required to initialize AccountTrackerController."),(0,s.assert)(r,"Block tracker is required to initialize AccountTrackerController.");const c=new a.default({state:{accounts:{}},messenger:e,provider:n,blockTracker:r,getNetworkIdentifier:e=>{const n=t.call("NetworkController:getState"),r=e??(0,i.getProviderConfig)({metamask:n});return r.type===o.NETWORK_TYPES.RPC&&r.rpcUrl?r.rpcUrl:r.type},accountsApiChainIds:()=>{var e;const n=t.call("RemoteFeatureFlagController:getState"),r=null==n||null===(e=n.remoteFeatureFlags)||void 0===e?void 0:e.assetsAccountApiBalances;return Array.isArray(r)?r:[]}});return t.subscribe("NetworkController:networkDidChange",()=>{c.updateAccounts()}),{persistedStateKey:null,memStateKey:null,controller:c}}}}},{package:"$root$",file:"app/scripts/controller-init/account-tracker-controller-init.ts"}],[110,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getNotificationServicesControllerMessenger=function(e){return e.getRestricted({name:"NotificationServicesController",allowedActions:["KeyringController:getState","AuthenticationController:getBearerToken","AuthenticationController:isSignedIn","AuthenticationController:performSignIn","NotificationServicesPushController:enablePushNotifications","NotificationServicesPushController:disablePushNotifications","NotificationServicesPushController:subscribeToPushNotifications"],allowedEvents:["KeyringController:stateChange","KeyringController:lock","KeyringController:unlock","NotificationServicesPushController:onNewNotifications","NotificationServicesPushController:stateChange"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/notifications/notification-services-controller-messenger.ts"}],[111,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getNotificationServicesPushControllerInitMessenger=function(e){return e.getRestricted({name:"NotificationServicesPushControllerInit",allowedActions:["MetaMetricsController:trackEvent"],allowedEvents:["NotificationServicesPushController:onNewNotifications","NotificationServicesPushController:pushNotificationClicked"]})},n.getNotificationServicesPushControllerMessenger=function(e){return e.getRestricted({name:"NotificationServicesPushController",allowedActions:["AuthenticationController:getBearerToken"],allowedEvents:[]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/notifications/notification-services-push-controller-messenger.ts"}],[112,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getOnboardingControllerMessenger=function(e){return e.getRestricted({name:"OnboardingController",allowedActions:[],allowedEvents:[]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/onboarding-controller-messenger.ts"}],[113,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getPermissionControllerInitMessenger=function(e){return e.getRestricted({name:"PermissionControllerInit",allowedActions:["AppStateController:getUnlockPromise","AccountsController:listAccounts","CurrencyRateController:getState","KeyringController:getKeyringsByType","KeyringController:withKeyring","MultichainRouter:isSupportedScope","MultichainRouter:getSupportedAccounts","NetworkController:findNetworkClientIdByChainId","PhishingController:maybeUpdateState","PhishingController:testOrigin","PreferencesController:getState","RateLimitController:call","SnapController:clearSnapState","SnapController:get","SnapController:getSnapState","SnapController:handleRequest","SnapController:updateSnapState","SnapInterfaceController:createInterface","SnapInterfaceController:getInterface"],allowedEvents:[]})},n.getPermissionControllerMessenger=function(e){return e.getRestricted({name:"PermissionController",allowedActions:["ApprovalController:addRequest","ApprovalController:hasRequest","ApprovalController:acceptRequest","ApprovalController:rejectRequest","SnapController:getPermitted","SnapController:install","SubjectMetadataController:getSubjectMetadata"],allowedEvents:[]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/permission-controller-messenger.ts"}],[114,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getPermissionLogControllerMessenger=function(e){return e.getRestricted({name:"PermissionLogController",allowedActions:[],allowedEvents:[]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/permission-log-controller-messenger.ts"}],[115,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getPhishingControllerMessenger=function(e){return e.getRestricted({name:"PhishingController",allowedActions:[],allowedEvents:["TransactionController:stateChange"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/phishing-controller-messenger.ts"}],[116,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getPPOMControllerInitMessenger=function(e){return e.getRestricted({name:"PPOMControllerInit",allowedEvents:["PreferencesController:stateChange"],allowedActions:["NetworkController:getNetworkClientById","NetworkController:getSelectedNetworkClient","NetworkController:getState"]})},n.getPPOMControllerMessenger=function(e){return e.getRestricted({name:"PPOMController",allowedEvents:["NetworkController:stateChange","NetworkController:networkDidChange"],allowedActions:["NetworkController:getNetworkClientById"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/ppom-controller-messenger.ts"}],[1162,{"@metamask/base-controller":1268,"@metamask/controller-utils":1349},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,s,i=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.AddressBookController=n.getDefaultAddressBookControllerState=n.controllerName=n.AddressType=void 0;const o=e("@metamask/base-controller"),a=e("@metamask/controller-utils");var c;!function(e){e.externallyOwnedAccounts="EXTERNALLY_OWNED_ACCOUNTS",e.contractAccounts="CONTRACT_ACCOUNTS",e.nonAccounts="NON_ACCOUNTS"}(c||(n.AddressType=c={})),n.controllerName="AddressBookController";const l={addressBook:{persist:!0,anonymous:!1}};n.getDefaultAddressBookControllerState=()=>({addressBook:{}});class u extends o.BaseController{constructor({messenger:e,state:t}){const o={...(0,n.getDefaultAddressBookControllerState)(),...t};super({messenger:e,metadata:l,name:n.controllerName,state:o}),r.add(this),i(this,r,"m",s).call(this)}list(){const{addressBook:e}=this.state;return Object.keys(e).reduce((t,n)=>{const r=n;return[...t,...Object.values(e[r])]},[])}clear(){this.update(e=>{e.addressBook={}})}delete(e,t){if(t=(0,a.toChecksumHexAddress)(t),!([e,t].every(e=>(0,a.isSafeDynamicKey)(e))&&(0,a.isValidHexAddress)(t)&&this.state.addressBook[e]&&this.state.addressBook[e][t]))return!1;const n={...this.state.addressBook[e][t]};return this.update(n=>{const r=n.addressBook[e];r?.[t]&&(delete r[t],0===Object.keys(r).length&&delete n.addressBook[e])}),"*"!==String(e)&&this.messagingSystem.publish("AddressBookController:contactDeleted",n),!0}set(e,t,n=(0,a.toHex)(1),r="",s){if(e=(0,a.toChecksumHexAddress)(e),!(0,a.isValidHexAddress)(e))return!1;const i={address:e,chainId:n,isEns:!1,memo:r,name:t,addressType:s,lastUpdatedAt:Date.now()},o=(0,a.normalizeEnsName)(t);return o&&(i.name=o,i.isEns=!0),this.update(t=>{t.addressBook={...this.state.addressBook,[n]:{...this.state.addressBook[n],[e]:i}}}),"*"!==String(n)&&this.messagingSystem.publish("AddressBookController:contactUpdated",i),!0}}n.AddressBookController=u,r=new WeakSet,s=function(){this.messagingSystem.registerActionHandler(`${n.controllerName}:list`,this.list.bind(this)),this.messagingSystem.registerActionHandler(`${n.controllerName}:set`,this.set.bind(this)),this.messagingSystem.registerActionHandler(`${n.controllerName}:delete`,this.delete.bind(this))},n.default=u}}},{package:"@metamask/address-book-controller",file:"node_modules/@metamask/address-book-controller/dist/AddressBookController.cjs"}],[1163,{"./AddressBookController.cjs":1162},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.AddressBookController=n.getDefaultAddressBookControllerState=void 0;var r=e("./AddressBookController.cjs");Object.defineProperty(n,"getDefaultAddressBookControllerState",{enumerable:!0,get:function(){return r.getDefaultAddressBookControllerState}}),Object.defineProperty(n,"AddressBookController",{enumerable:!0,get:function(){return r.AddressBookController}})}}},{package:"@metamask/address-book-controller",file:"node_modules/@metamask/address-book-controller/dist/index.cjs"}],[1164,{"@metamask/base-controller":1268},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,s,i=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.AnnouncementController=void 0;const o=e("@metamask/base-controller"),a={announcements:{}},c={announcements:{persist:!0,anonymous:!0}};class l extends o.BaseController{constructor({messenger:e,state:t,allAnnouncements:n}){const o={...a,...t};super({messenger:e,metadata:c,name:"AnnouncementController",state:o}),r.add(this),i(this,r,"m",s).call(this,n)}resetViewed(){this.update(({announcements:e})=>{for(const t of Object.values(e))t.isShown=!1})}updateViewed(e){this.update(({announcements:t})=>{for(const n of Object.keys(e).map(Number))t[n].isShown=e[n]})}}n.AnnouncementController=l,r=new WeakSet,s=function(e){this.update(t=>{Object.values(e).forEach(e=>{t.announcements[e.id]=t.announcements[e.id]??{...e,isShown:!1}})})}}}},{package:"@metamask/announcement-controller",file:"node_modules/@metamask/announcement-controller/dist/AnnouncementController.cjs"}],[1165,{"./AnnouncementController.cjs":1164},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.AnnouncementController=void 0;var r=e("./AnnouncementController.cjs");Object.defineProperty(n,"AnnouncementController",{enumerable:!0,get:function(){return r.AnnouncementController}})}}},{package:"@metamask/announcement-controller",file:"node_modules/@metamask/announcement-controller/dist/index.cjs"}],[117,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getPreferencesControllerMessenger=function(e){return e.getRestricted({name:"PreferencesController",allowedActions:["AccountsController:setSelectedAccount","AccountsController:getSelectedAccount","AccountsController:getAccountByAddress","AccountsController:setAccountName","NetworkController:getState"],allowedEvents:["AccountsController:stateChange"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/preferences-controller-messenger.ts"}],[118,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getRatesControllerMessenger=function(e){return e.getRestricted({name:"RatesController",allowedActions:[],allowedEvents:[]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/rates-controller-messenger.ts"}],[119,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getRemoteFeatureFlagControllerInitMessenger=function(e){return e.getRestricted({name:"RemoteFeatureFlagControllerInit",allowedActions:["MetaMetricsController:getMetaMetricsId","PreferencesController:getState"],allowedEvents:["PreferencesController:stateChange"]})},n.getRemoteFeatureFlagControllerMessenger=function(e){return e.getRestricted({name:"RemoteFeatureFlagController",allowedActions:[],allowedEvents:[]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/remote-feature-flag-controller-messenger.ts"}],[12,{"@metamask/accounts-controller":1160},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.AccountsControllerInit=void 0;var r=e("@metamask/accounts-controller");n.AccountsControllerInit=({controllerMessenger:e,persistedState:t})=>({controller:new r.AccountsController({messenger:e,state:t.AccountsController})})}}},{package:"$root$",file:"app/scripts/controller-init/accounts-controller-init.ts"}],[120,{"./oauth-service-messenger":121,"./seedless-onboarding-controller-messenger":122},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"getOAuthServiceMessenger",{enumerable:!0,get:function(){return r.getOAuthServiceMessenger}}),Object.defineProperty(n,"getSeedlessOnboardingControllerInitMessenger",{enumerable:!0,get:function(){return s.getSeedlessOnboardingControllerInitMessenger}}),Object.defineProperty(n,"getSeedlessOnboardingControllerMessenger",{enumerable:!0,get:function(){return s.getSeedlessOnboardingControllerMessenger}});var r=e("./oauth-service-messenger"),s=e("./seedless-onboarding-controller-messenger")}}},{package:"$root$",file:"app/scripts/controller-init/messengers/seedless-onboarding/index.ts"}],[121,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getOAuthServiceMessenger=function(e){return e.getRestricted({name:"OAuthService",allowedActions:["SeedlessOnboardingController:getState"],allowedEvents:[]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/seedless-onboarding/oauth-service-messenger.ts"}],[122,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getSeedlessOnboardingControllerInitMessenger=function(e){return e.getRestricted({name:"SeedlessOnboardingControllerInit",allowedEvents:[],allowedActions:["OAuthService:getNewRefreshToken","OAuthService:revokeRefreshToken","OAuthService:renewRefreshToken"]})},n.getSeedlessOnboardingControllerMessenger=function(e){return e.getRestricted({name:"SeedlessOnboardingController",allowedActions:[],allowedEvents:[]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/seedless-onboarding/seedless-onboarding-controller-messenger.ts"}],[123,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getSelectedNetworkControllerMessenger=function(e){return e.getRestricted({name:"SelectedNetworkController",allowedActions:["NetworkController:getNetworkClientById","NetworkController:getState","NetworkController:getSelectedNetworkClient","PermissionController:hasPermissions","PermissionController:getSubjectNames"],allowedEvents:["NetworkController:stateChange","PermissionController:stateChange"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/selected-network-controller-messenger.ts"}],[124,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getShieldControllerInitMessenger=function(e){return e.getRestricted({name:"ShieldControllerInit",allowedEvents:[],allowedActions:["AuthenticationController:getBearerToken"]})},n.getShieldControllerMessenger=function(e){return e.getRestricted({name:"ShieldController",allowedActions:[],allowedEvents:["SignatureController:stateChange","TransactionController:stateChange"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/shield/shield-controller-messenger.ts"}],[125,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getSignatureControllerInitMessenger=function(e){return e.getRestricted({name:"SignatureControllerInit",allowedActions:["MetaMetricsController:trackEvent","PreferencesController:getState"],allowedEvents:[]})},n.getSignatureControllerMessenger=function(e){return e.getRestricted({name:"SignatureController",allowedActions:["AccountsController:getState","ApprovalController:addRequest","KeyringController:signMessage","KeyringController:signPersonalMessage","KeyringController:signTypedMessage","LoggingController:add","NetworkController:getNetworkClientById","GatorPermissionsController:decodePermissionFromPermissionContextForOrigin"],allowedEvents:[]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/signature-controller-messenger.ts"}],[126,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getSmartTransactionsControllerInitMessenger=function(e){return e.getRestricted({name:"SmartTransactionsControllerInit",allowedActions:["MetaMetricsController:trackEvent"],allowedEvents:[]})},n.getSmartTransactionsControllerMessenger=function(e){return e.getRestricted({name:"SmartTransactionsController",allowedActions:["NetworkController:getNetworkClientById","NetworkController:getState","TransactionController:getNonceLock","TransactionController:confirmExternalTransaction","TransactionController:getTransactions","TransactionController:updateTransaction"],allowedEvents:["NetworkController:stateChange"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/smart-transactions-controller-messenger.ts"}],[127,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getCronjobControllerMessenger=function(e){return e.getRestricted({name:"CronjobController",allowedEvents:["SnapController:snapInstalled","SnapController:snapUpdated","SnapController:snapUninstalled","SnapController:snapEnabled","SnapController:snapDisabled"],allowedActions:["PermissionController:getPermissions","SnapController:handleRequest"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/snaps/cronjob-controller-messenger.ts"}],[128,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getExecutionServiceMessenger=function(e){return e.getRestricted({name:"ExecutionService",allowedEvents:[],allowedActions:[]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/snaps/execution-service-messenger.ts"}],[129,{"./cronjob-controller-messenger":127,"./execution-service-messenger":128,"./multichain-router-messenger":130,"./rate-limit-controller-messenger":131,"./snap-controller-messenger":132,"./snap-insights-controller-messenger":133,"./snap-interface-controller-messenger":134,"./snaps-name-provider-messenger":135,"./snaps-registry-messenger":136,"./websocket-service-messenger":137},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"getCronjobControllerMessenger",{enumerable:!0,get:function(){return r.getCronjobControllerMessenger}}),Object.defineProperty(n,"getExecutionServiceMessenger",{enumerable:!0,get:function(){return s.getExecutionServiceMessenger}}),Object.defineProperty(n,"getMultichainRouterMessenger",{enumerable:!0,get:function(){return i.getMultichainRouterMessenger}}),Object.defineProperty(n,"getRateLimitControllerInitMessenger",{enumerable:!0,get:function(){return o.getRateLimitControllerInitMessenger}}),Object.defineProperty(n,"getRateLimitControllerMessenger",{enumerable:!0,get:function(){return o.getRateLimitControllerMessenger}}),Object.defineProperty(n,"getSnapControllerInitMessenger",{enumerable:!0,get:function(){return a.getSnapControllerInitMessenger}}),Object.defineProperty(n,"getSnapControllerMessenger",{enumerable:!0,get:function(){return a.getSnapControllerMessenger}}),Object.defineProperty(n,"getSnapInsightsControllerMessenger",{enumerable:!0,get:function(){return c.getSnapInsightsControllerMessenger}}),Object.defineProperty(n,"getSnapInterfaceControllerMessenger",{enumerable:!0,get:function(){return l.getSnapInterfaceControllerMessenger}}),Object.defineProperty(n,"getSnapsNameProviderMessenger",{enumerable:!0,get:function(){return u.getSnapsNameProviderMessenger}}),Object.defineProperty(n,"getSnapsRegistryMessenger",{enumerable:!0,get:function(){return d.getSnapsRegistryMessenger}}),Object.defineProperty(n,"getWebSocketServiceMessenger",{enumerable:!0,get:function(){return h.getWebSocketServiceMessenger}});var r=e("./cronjob-controller-messenger"),s=e("./execution-service-messenger"),i=e("./multichain-router-messenger"),o=e("./rate-limit-controller-messenger"),a=e("./snap-controller-messenger"),c=e("./snap-insights-controller-messenger"),l=e("./snap-interface-controller-messenger"),u=e("./snaps-name-provider-messenger"),d=e("./snaps-registry-messenger"),h=e("./websocket-service-messenger")}}},{package:"$root$",file:"app/scripts/controller-init/messengers/snaps/index.ts"}],[13,{"../../../../shared/constants/metametrics":5796,"../../../../shared/lib/trace":5888,"@metamask/account-tree-controller":1153},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.AccountTreeControllerInit=void 0;var r=e("@metamask/account-tree-controller"),s=e("../../../../shared/lib/trace"),i=e("../../../../shared/constants/metametrics");n.AccountTreeControllerInit=({controllerMessenger:e,persistedState:t,initMessenger:n})=>({controller:new r.AccountTreeController({messenger:e,state:t.AccountTreeController,config:{trace:s.trace,backupAndSync:{onBackupAndSyncEvent:e=>{n.call("MetaMetricsController:trackEvent",{category:i.MetaMetricsEventCategory.BackupAndSync,event:i.MetaMetricsEventName.ProfileActivityUpdated,properties:{event:e}})}},accountOrderCallbacks:{isHiddenAccount:e=>{const t=n.call("AccountsController:getAccount",e);if(!t)return!1;return n.call("AccountOrderController:getState").hiddenAccountList.includes(t.address)},isPinnedAccount:e=>{const t=n.call("AccountsController:getAccount",e);if(!t)return!1;return n.call("AccountOrderController:getState").pinnedAccountList.includes(t.address)}}}})})}}},{package:"$root$",file:"app/scripts/controller-init/accounts/account-tree-controller-init.ts"}],[130,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getMultichainRouterMessenger=function(e){return e.getRestricted({name:"MultichainRouter",allowedActions:["SnapController:getAll","SnapController:handleRequest","PermissionController:getPermissions","AccountsController:listMultichainAccounts"],allowedEvents:[]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/snaps/multichain-router-messenger.ts"}],[131,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getRateLimitControllerInitMessenger=function(e){return e.getRestricted({name:"RateLimitController",allowedActions:["SubjectMetadataController:getState","NotificationServicesController:updateMetamaskNotificationsList"],allowedEvents:[]})},n.getRateLimitControllerMessenger=function(e){return e.getRestricted({name:"RateLimitController",allowedEvents:[],allowedActions:[]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/snaps/rate-limit-controller-messenger.ts"}],[132,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getSnapControllerInitMessenger=function(e){return e.getRestricted({name:"SnapControllerInit",allowedActions:["KeyringController:getKeyringsByType","PreferencesController:getState","MetaMetricsController:trackEvent","SnapController:setClientActive"],allowedEvents:["KeyringController:lock","KeyringController:unlock"]})},n.getSnapControllerMessenger=function(e){return e.getRestricted({name:"SnapController",allowedEvents:["ExecutionService:unhandledError","ExecutionService:outboundRequest","ExecutionService:outboundResponse","KeyringController:lock"],allowedActions:["PermissionController:getEndowments","PermissionController:getPermissions","PermissionController:hasPermission","PermissionController:hasPermissions","PermissionController:requestPermissions","PermissionController:revokeAllPermissions","PermissionController:revokePermissions","PermissionController:revokePermissionForAllSubjects","PermissionController:getSubjectNames","PermissionController:updateCaveat","ApprovalController:addRequest","ApprovalController:updateRequestState","PermissionController:grantPermissions","SubjectMetadataController:getSubjectMetadata","SubjectMetadataController:addSubjectMetadata","ExecutionService:executeSnap","ExecutionService:terminateSnap","ExecutionService:terminateAllSnaps","ExecutionService:handleRpcRequest","NetworkController:getNetworkClientById","SelectedNetworkController:getNetworkClientIdForDomain","SnapsRegistry:get","SnapsRegistry:getMetadata","SnapsRegistry:update","SnapsRegistry:resolveVersion","SnapInterfaceController:createInterface","SnapInterfaceController:getInterface"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/snaps/snap-controller-messenger.ts"}],[133,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getSnapInsightsControllerMessenger=function(e){return e.getRestricted({name:"SnapInsightsController",allowedActions:["SnapController:handleRequest","SnapController:getAll","PermissionController:getPermissions","SnapInterfaceController:deleteInterface"],allowedEvents:["TransactionController:unapprovedTransactionAdded","TransactionController:transactionStatusUpdated","SignatureController:stateChange"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/snaps/snap-insights-controller-messenger.ts"}],[134,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getSnapInterfaceControllerMessenger=function(e){return e.getRestricted({name:"SnapInterfaceController",allowedActions:["PhishingController:maybeUpdateState","PhishingController:testOrigin","ApprovalController:hasRequest","ApprovalController:acceptRequest","SnapController:get","MultichainAssetsController:getState","AccountsController:getSelectedMultichainAccount","AccountsController:getAccountByAddress","AccountsController:listMultichainAccounts"],allowedEvents:["NotificationServicesController:notificationsListUpdated"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/snaps/snap-interface-controller-messenger.ts"}],[135,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getSnapsNameProviderMessenger=function(e){return e.getRestricted({name:"SnapsNameProvider",allowedActions:["SnapController:getAll","SnapController:get","SnapController:handleRequest","PermissionController:getState"],allowedEvents:[]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/snaps/snaps-name-provider-messenger.ts"}],[1354,{"./BackendWebSocketService.cjs":1355,"./logger.cjs":1357},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,s,i,o,a,c,l,u,d,h,p,m,g,f=this&&this.__classPrivateFieldSet||function(e,t,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n},y=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.AccountActivityService=n.ACCOUNT_ACTIVITY_SERVICE_ALLOWED_EVENTS=n.ACCOUNT_ACTIVITY_SERVICE_ALLOWED_ACTIONS=void 0;const w=e("./BackendWebSocketService.cjs"),v=e("./logger.cjs"),b="AccountActivityService",k=(0,v.createModuleLogger)(v.projectLogger,b),C=["subscribe","unsubscribe"];n.ACCOUNT_ACTIVITY_SERVICE_ALLOWED_ACTIONS=["AccountsController:getSelectedAccount","BackendWebSocketService:connect","BackendWebSocketService:forceReconnection","BackendWebSocketService:subscribe","BackendWebSocketService:getConnectionInfo","BackendWebSocketService:channelHasSubscription","BackendWebSocketService:getSubscriptionsByChannel","BackendWebSocketService:findSubscriptionsByChannelPrefix","BackendWebSocketService:addChannelCallback","BackendWebSocketService:removeChannelCallback"],n.ACCOUNT_ACTIVITY_SERVICE_ALLOWED_EVENTS=["AccountsController:selectedAccountChange","BackendWebSocketService:connectionStateChanged"];n.AccountActivityService=class{constructor(e){r.add(this),this.name=b,s.set(this,void 0),i.set(this,void 0),o.set(this,void 0),a.set(this,new Set),f(this,s,e.messenger,"f"),f(this,i,{subscriptionNamespace:e.subscriptionNamespace??"account-activity.v1"},"f"),f(this,o,e.traceFn??((e,t)=>t?.()),"f"),y(this,s,"f").registerMethodActionHandlers(this,C),y(this,s,"f").subscribe("AccountsController:selectedAccountChange",async e=>await y(this,r,"m",l).call(this,e)),y(this,s,"f").subscribe("BackendWebSocketService:connectionStateChanged",e=>y(this,r,"m",d).call(this,e)),y(this,s,"f").call("BackendWebSocketService:addChannelCallback",{channelName:`system-notifications.v1.${y(this,i,"f").subscriptionNamespace}`,callback:e=>y(this,r,"m",u).call(this,e)})}async subscribe(e){try{await y(this,s,"f").call("BackendWebSocketService:connect");const t=`${y(this,i,"f").subscriptionNamespace}.${e.address}`;if(y(this,s,"f").call("BackendWebSocketService:channelHasSubscription",t))return;await y(this,s,"f").call("BackendWebSocketService:subscribe",{channels:[t],channelType:y(this,i,"f").subscriptionNamespace,callback:e=>{y(this,r,"m",c).call(this,e.data)}})}catch(e){k("Subscription failed, forcing reconnection",{error:e}),await y(this,r,"m",g).call(this)}}async unsubscribe(e){const{address:t}=e;try{const e=`${y(this,i,"f").subscriptionNamespace}.${t}`,n=y(this,s,"f").call("BackendWebSocketService:getSubscriptionsByChannel",e);if(0===n.length)return;for(const e of n)await e.unsubscribe()}catch(e){k("Unsubscription failed, forcing reconnection",{error:e}),await y(this,r,"m",g).call(this)}}destroy(){y(this,s,"f").call("BackendWebSocketService:removeChannelCallback",`system-notifications.v1.${y(this,i,"f").subscriptionNamespace}`)}},s=new WeakMap,i=new WeakMap,o=new WeakMap,a=new WeakMap,r=new WeakSet,c=function(e){const{address:t,tx:n,updates:r}=e,a=1e3*n.timestamp,c=Date.now()-a;k("Handling account activity update",{address:t,updateCount:r.length,elapsedMs:c}),y(this,o,"f").call(this,{name:`${b} Transaction Message`,data:{chain:n.chain,status:n.status,elapsed_ms:c},tags:{service:b,notification_type:y(this,i,"f").subscriptionNamespace}},()=>{y(this,s,"f").publish("AccountActivityService:transactionUpdated",n),y(this,s,"f").publish("AccountActivityService:balanceUpdated",{address:t,chain:n.chain,updates:r})})},l=async function(e){if(e?.address)try{const t=y(this,r,"m",m).call(this,e);await y(this,r,"m",p).call(this),await this.subscribe({address:t})}catch(e){k("Account change failed",{error:e})}},u=function(e){const t=e.data,{timestamp:n}=e;if(!t.chainIds||!Array.isArray(t.chainIds)||!t.status)throw new Error("Invalid system notification data: missing chainIds or status");if("up"===t.status)for(const e of t.chainIds)y(this,a,"f").add(e);else for(const e of t.chainIds)y(this,a,"f").delete(e);y(this,s,"f").publish("AccountActivityService:statusChanged",{chainIds:t.chainIds,status:t.status,timestamp:n})},d=async function(e){const{state:t}=e;if(t===w.WebSocketState.CONNECTED)await y(this,r,"m",h).call(this);else if(t===w.WebSocketState.DISCONNECTED||t===w.WebSocketState.ERROR){const e=Array.from(y(this,a,"f"));e.length>0&&(y(this,s,"f").publish("AccountActivityService:statusChanged",{chainIds:e,status:"down",timestamp:Date.now()}),k("WebSocket error/disconnection - Published tracked chains as down",{count:e.length,chains:e}),y(this,a,"f").clear())}},h=async function(){const e=y(this,s,"f").call("AccountsController:getSelectedAccount");if(!e||!e.address)return;const t=y(this,r,"m",m).call(this,e);await this.subscribe({address:t})},p=async function(){const e=y(this,s,"f").call("BackendWebSocketService:findSubscriptionsByChannelPrefix",y(this,i,"f").subscriptionNamespace);for(const t of e)await t.unsubscribe()},m=function(e){return e.scopes.some(e=>e.startsWith("eip155:"))?`eip155:0:${e.address}`:e.scopes.some(e=>e.startsWith("solana:"))?`solana:0:${e.address}`:e.address},g=async function(){k("Forcing WebSocket reconnection to clean up subscription state"),await y(this,s,"f").call("BackendWebSocketService:forceReconnection")}}}},{package:"@metamask/core-backend",file:"node_modules/@metamask/core-backend/dist/AccountActivityService.cjs"}],[1355,{"./logger.cjs":1357,"@metamask/controller-utils":1349,"@metamask/utils":2908,uuid:5732},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,s,i,o,a,c,l,u,d,h,p,m,g,f,y,w,v,b,k,C,S,M,A,T,E,I,_,P,j,N,O,B,R,x,D,L,F,U=this&&this.__classPrivateFieldSet||function(e,t,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n},$=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.BackendWebSocketService=n.WebSocketEventType=n.WebSocketState=n.getCloseReason=void 0;const K=e("@metamask/controller-utils"),W=e("@metamask/utils"),G=e("uuid"),H=e("./logger.cjs"),q="BackendWebSocketService",V=(0,H.createModuleLogger)(H.projectLogger,q),z=["connect","disconnect","forceReconnection","sendMessage","sendRequest","subscribe","getConnectionInfo","getSubscriptionsByChannel","channelHasSubscription","findSubscriptionsByChannelPrefix","addChannelCallback","removeChannelCallback","getChannelCallbacks"];function Y(e){switch(e){case 1e3:return"Normal Closure";case 1001:return"Going Away";case 1002:return"Protocol Error";case 1003:return"Unsupported Data";case 1004:return"Reserved";case 1005:return"No Status Received";case 1006:return"Abnormal Closure";case 1007:return"Invalid frame payload data";case 1008:return"Policy Violation";case 1009:return"Message Too Big";case 1010:return"Mandatory Extension";case 1011:return"Internal Server Error";case 1012:return"Service Restart";case 1013:return"Try Again Later";case 1014:return"Bad Gateway";case 1015:return"TLS Handshake";default:return e>=3e3&&e<=3999?"Library/Framework Error":e>=4e3&&e<=4999?"Application Error":"Unknown"}}var J,Q;n.getCloseReason=Y,function(e){e.CONNECTING="connecting",e.CONNECTED="connected",e.DISCONNECTING="disconnecting",e.DISCONNECTED="disconnected",e.ERROR="error"}(J||(n.WebSocketState=J={})),function(e){e.CONNECTED="connected",e.DISCONNECTED="disconnected",e.MESSAGE="message",e.ERROR="error",e.RECONNECTING="reconnecting",e.RECONNECTED="reconnected"}(Q||(n.WebSocketEventType=Q={}));n.BackendWebSocketService=class{constructor(e){r.add(this),this.name=q,s.set(this,void 0),i.set(this,void 0),o.set(this,void 0),a.set(this,void 0),c.set(this,void 0),l.set(this,J.DISCONNECTED),u.set(this,0),d.set(this,null),h.set(this,null),p.set(this,null),m.set(this,null),g.set(this,new Map),f.set(this,0),y.set(this,!1),w.set(this,new Map),v.set(this,new Map),b.set(this,void 0),U(this,s,e.messenger,"f"),U(this,o,e.isEnabled,"f"),U(this,a,e.traceFn??((e,t)=>t?.()),"f"),U(this,i,{url:e.url,timeout:e.timeout??1e4,reconnectDelay:e.reconnectDelay??500,maxReconnectDelay:e.maxReconnectDelay??5e3,requestTimeout:e.requestTimeout??3e4},"f"),$(this,r,"m",R).call(this),$(this,r,"m",k).call(this),$(this,s,"f").registerMethodActionHandlers(this,z)}async connect(){if(U(this,y,!1,"f"),$(this,o,"f")&&!$(this,o,"f").call(this))return $(this,r,"m",x).call(this),void U(this,u,0,"f");if($(this,l,"f")!==J.CONNECTED)if($(this,m,"f"))await $(this,m,"f");else if(!$(this,d,"f")){U(this,m,(async()=>{let e;try{const t=await $(this,s,"f").call("AuthenticationController:getBearerToken");if(!t)throw new Error("Authentication required: user not signed in");e=t}catch(e){throw V("Failed to check authentication requirements",{error:e}),e}$(this,r,"m",F).call(this,J.CONNECTING);try{await $(this,r,"m",S).call(this,e)}catch(e){const t=(0,W.getErrorMessage)(e);throw V("Connection attempt failed",{errorMessage:t,error:e}),$(this,r,"m",F).call(this,J.ERROR),e}})(),"f");try{await $(this,m,"f")}catch{$(this,r,"m",B).call(this)}finally{U(this,m,null,"f")}}}disconnect(){$(this,l,"f")!==J.DISCONNECTED&&$(this,l,"f")!==J.DISCONNECTING&&(U(this,y,!0,"f"),$(this,r,"m",F).call(this,J.DISCONNECTING),$(this,r,"m",x).call(this),$(this,r,"m",D).call(this,new Error("WebSocket disconnected")),U(this,m,null,"f"),U(this,u,0,"f"),$(this,c,"f")&&$(this,c,"f").close(1e3,"Normal closure"),V("WebSocket manually disconnected"))}async forceReconnection(){$(this,d,"f")?V("Reconnect already scheduled, skipping force reconnection"):(V("Forcing WebSocket reconnection to clean up subscription state"),this.disconnect(),$(this,r,"m",B).call(this))}sendMessage(e){if($(this,l,"f")!==J.CONNECTED||!$(this,c,"f"))throw new Error(`Cannot send message: WebSocket is ${$(this,l,"f")}`);try{$(this,c,"f").send(JSON.stringify(e))}catch(e){const t=(0,W.getErrorMessage)(e);throw $(this,r,"m",O).call(this,new Error(t)),new Error(t)}}async sendRequest(e){if($(this,l,"f")!==J.CONNECTED)throw new Error(`Cannot send request: WebSocket is ${$(this,l,"f")}`);const t=e.data?.requestId??(0,G.v4)(),n={event:e.event,data:{...e.data,requestId:t}};return new Promise((e,r)=>{const s=setTimeout(()=>{$(this,g,"f").delete(t),V("Request timeout - triggering reconnection",{timeout:$(this,i,"f").requestTimeout}),$(this,l,"f")===J.CONNECTED&&$(this,c,"f")&&$(this,c,"f").close(3e3,"Request timeout - forcing reconnect"),r(new Error(`Request timeout after ${$(this,i,"f").requestTimeout}ms`))},$(this,i,"f").requestTimeout);$(this,g,"f").set(t,{resolve:e,reject:r,timeout:s});try{this.sendMessage(n)}catch(e){$(this,g,"f").delete(t),clearTimeout(s),r(e instanceof Error?e:new Error(String(e)))}})}getConnectionInfo(){return{state:$(this,l,"f"),url:$(this,i,"f").url,timeout:$(this,i,"f").timeout,reconnectDelay:$(this,i,"f").reconnectDelay,maxReconnectDelay:$(this,i,"f").maxReconnectDelay,requestTimeout:$(this,i,"f").requestTimeout,reconnectAttempts:$(this,u,"f"),connectedAt:$(this,f,"f")}}getSubscriptionsByChannel(e){const t=[];for(const[n,r]of $(this,w,"f"))r.channels.includes(e)&&t.push({subscriptionId:n,channels:r.channels,channelType:r.channelType,unsubscribe:r.unsubscribe});return t}channelHasSubscription(e){for(const t of $(this,w,"f").values())if(t.channels.includes(e))return!0;return!1}findSubscriptionsByChannelPrefix(e){const t=[];for(const[n,r]of $(this,w,"f")){r.channels.some(t=>t.startsWith(e))&&t.push({subscriptionId:n,channels:r.channels,channelType:r.channelType,unsubscribe:r.unsubscribe})}return t}addChannelCallback(e){const t={channelName:e.channelName,callback:e.callback};$(this,v,"f").has(e.channelName)||$(this,v,"f").set(e.channelName,t)}removeChannelCallback(e){return $(this,v,"f").delete(e)}getChannelCallbacks(){return Array.from($(this,v,"f").values())}destroy(){$(this,r,"m",x).call(this),$(this,r,"m",L).call(this),U(this,m,null,"f"),$(this,r,"m",D).call(this,new Error("Service cleanup")),$(this,c,"f")&&$(this,c,"f").readyState===WebSocket.OPEN&&$(this,c,"f").close(1e3,"Service cleanup"),$(this,r,"m",F).call(this,J.DISCONNECTED)}async subscribe(e){const{channels:t,channelType:n,callback:r,requestId:s}=e;if($(this,l,"f")!==J.CONNECTED)throw new Error(`Cannot create subscription(s) ${t.join(", ")}: WebSocket is ${$(this,l,"f")}`);const i=await this.sendRequest({event:"subscribe",data:{channels:t,requestId:s}});if(!i?.subscriptionId)throw new Error("Invalid subscription response: missing subscription ID");const{subscriptionId:o}=i,a=async e=>{await this.sendRequest({event:"unsubscribe",data:{subscription:o,channels:t,requestId:e}}),$(this,w,"f").delete(o)},c={subscriptionId:o,channels:[...t],channelType:n,unsubscribe:a};return $(this,w,"f").set(o,{subscriptionId:o,channels:[...t],channelType:n,callback:r,unsubscribe:a}),c}},s=new WeakMap,i=new WeakMap,o=new WeakMap,a=new WeakMap,c=new WeakMap,l=new WeakMap,u=new WeakMap,d=new WeakMap,h=new WeakMap,p=new WeakMap,m=new WeakMap,g=new WeakMap,f=new WeakMap,y=new WeakMap,w=new WeakMap,v=new WeakMap,b=new WeakMap,r=new WeakSet,k=function(){$(this,s,"f").subscribe("AuthenticationController:stateChange",e=>{e.isSignedIn?this.connect():this.disconnect()},e=>({isSignedIn:e.isSignedIn})),$(this,s,"f").subscribe("KeyringController:unlock",()=>{this.connect()}),$(this,s,"f").subscribe("KeyringController:lock",()=>{this.disconnect()})},C=function(e){const t=$(this,i,"f").url,n=new URL(t);return n.searchParams.set("token",e),n.toString()},S=async function(e){const t=$(this,r,"m",C).call(this,e),n=Date.now();return new Promise((e,s)=>{const o=new WebSocket(t);U(this,h,setTimeout(()=>{V("WebSocket connection timeout - forcing close",{timeout:$(this,i,"f").timeout}),o.close(),s(new Error(`Failed to connect to WebSocket: Connection timeout after ${$(this,i,"f").timeout}ms`))},$(this,i,"f").timeout),"f"),o.onopen=()=>{$(this,h,"f")&&(clearTimeout($(this,h,"f")),U(this,h,null,"f"));const t=Date.now()-n;$(this,a,"f").call(this,{name:`${q} Connection`,data:{reconnectAttempt:$(this,u,"f"),latency_ms:t},tags:{service:q}},()=>{U(this,c,o,"f"),$(this,r,"m",F).call(this,J.CONNECTED),U(this,f,Date.now(),"f"),U(this,p,setTimeout(()=>{U(this,p,null,"f"),U(this,u,0,"f"),$(this,r,"m",R).call(this),V("Connection stable - reset reconnect attempts and backoff")},1e4),"f"),e()})},o.onerror=e=>{V("WebSocket onerror event triggered",{event:e}),$(this,h,"f")&&(clearTimeout($(this,h,"f")),U(this,h,null,"f"));const n=new Error(`WebSocket connection error to ${t}`);s(n)},o.onclose=e=>{V("WebSocket onclose event triggered",{code:e.code,reason:e.reason,wasClean:e.wasClean}),$(this,l,"f")===J.CONNECTING?($(this,h,"f")&&(clearTimeout($(this,h,"f")),U(this,h,null,"f")),s(new Error(`WebSocket connection closed during connection: ${e.code} ${e.reason}`))):$(this,r,"m",N).call(this,e)},o.onmessage=e=>{try{const t=$(this,r,"m",j).call(this,e.data);$(this,r,"m",M).call(this,t)}catch{}}})},M=function(e){if($(this,r,"m",A).call(this,e))$(this,r,"m",I).call(this,e);else{if($(this,r,"m",T).call(this,e)){const t=e;if($(this,r,"m",P).call(this,t))return}if($(this,r,"m",E).call(this,e)){const t=e;$(this,r,"m",_).call(this,t)}}},A=function(e){return"data"in e&&e.data&&"object"==typeof e.data&&"requestId"in e.data},T=function(e){return"subscriptionId"in e&&!$(this,r,"m",A).call(this,e)},E=function(e){return"channel"in e},I=function(e){const{requestId:t}=e.data,n=$(this,g,"f").get(t);n&&($(this,g,"f").delete(t),clearTimeout(n.timeout),e.data.failed&&e.data.failed.length>0?n.reject(new Error(`Request failed: ${e.data.failed.join(", ")}`)):n.resolve(e.data))},_=function(e){if(0===$(this,v,"f").size)return;const t=Date.now()-e.timestamp;$(this,a,"f").call(this,{name:`${q} Channel Message`,data:{latency_ms:t,event:e.event},tags:{service:q}},()=>{$(this,v,"f").get(e.channel)?.callback(e)})},P=function(e){const{subscriptionId:t,timestamp:n,channel:r}=e;if(null!==t&&t!==undefined){const s=$(this,w,"f").get(t);if(!s)return!1;const i=Date.now()-n;return $(this,a,"f").call(this,{name:`${q} Notification`,data:{channel:r,latency_ms:i,subscriptionId:t},tags:{service:q,notification_type:s.channelType}},()=>{s.callback?.(e)}),!0}return!1},j=function(e){return JSON.parse(e)},N=function(e){const t=Date.now()-$(this,f,"f");$(this,h,"f")&&(clearTimeout($(this,h,"f")),U(this,h,null,"f")),$(this,p,"f")&&(clearTimeout($(this,p,"f")),U(this,p,null,"f")),U(this,f,0,"f"),U(this,m,null,"f"),$(this,r,"m",D).call(this,new Error("WebSocket connection closed")),$(this,r,"m",L).call(this),$(this,r,"m",F).call(this,J.DISCONNECTED),$(this,y,"f")||($(this,a,"f").call(this,{name:`${q} Disconnect`,data:{code:e.code,reason:e.reason||Y(e.code),connectionDuration_ms:t},tags:{service:q,disconnect_type:"unexpected"}},()=>{}),$(this,r,"m",B).call(this))},O=function(e){},B=function(){if($(this,d,"f"))return;U(this,u,$(this,u,"f")+1,"f");const e=$(this,b,"f").duration;U(this,b,$(this,b,"f").next({attempt:$(this,u,"f")}),"f"),V("Scheduling reconnect",{attempt:$(this,u,"f"),delay_ms:e}),U(this,d,setTimeout(()=>{if(U(this,d,null,"f"),$(this,o,"f")&&!$(this,o,"f").call(this))return U(this,u,0,"f"),void $(this,r,"m",R).call(this);this.connect()},e),"f")},R=function(){U(this,b,new K.ExponentialBackoff({initialDelay:$(this,i,"f").reconnectDelay,maxDelay:$(this,i,"f").maxReconnectDelay}).next(),"f")},x=function(){$(this,d,"f")&&(clearTimeout($(this,d,"f")),U(this,d,null,"f")),$(this,h,"f")&&(clearTimeout($(this,h,"f")),U(this,h,null,"f")),$(this,p,"f")&&(clearTimeout($(this,p,"f")),U(this,p,null,"f"))},D=function(e){for(const[,t]of $(this,g,"f"))clearTimeout(t.timeout),t.reject(e);$(this,g,"f").clear()},L=function(){$(this,w,"f").clear()},F=function(e){const t=$(this,l,"f");U(this,l,e,"f"),t!==e&&$(this,s,"f").publish("BackendWebSocketService:connectionStateChanged",this.getConnectionInfo())}}}},{package:"@metamask/core-backend",file:"node_modules/@metamask/core-backend/dist/BackendWebSocketService.cjs"}],[1356,{"./AccountActivityService.cjs":1354,"./BackendWebSocketService.cjs":1355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.AccountActivityService=n.ACCOUNT_ACTIVITY_SERVICE_ALLOWED_EVENTS=n.ACCOUNT_ACTIVITY_SERVICE_ALLOWED_ACTIONS=n.BackendWebSocketService=void 0;var r=e("./BackendWebSocketService.cjs");Object.defineProperty(n,"BackendWebSocketService",{enumerable:!0,get:function(){return r.BackendWebSocketService}});var s=e("./AccountActivityService.cjs");Object.defineProperty(n,"ACCOUNT_ACTIVITY_SERVICE_ALLOWED_ACTIONS",{enumerable:!0,get:function(){return s.ACCOUNT_ACTIVITY_SERVICE_ALLOWED_ACTIONS}}),Object.defineProperty(n,"ACCOUNT_ACTIVITY_SERVICE_ALLOWED_EVENTS",{enumerable:!0,get:function(){return s.ACCOUNT_ACTIVITY_SERVICE_ALLOWED_EVENTS}});var i=e("./AccountActivityService.cjs");Object.defineProperty(n,"AccountActivityService",{enumerable:!0,get:function(){return i.AccountActivityService}})}}},{package:"@metamask/core-backend",file:"node_modules/@metamask/core-backend/dist/index.cjs"}],[1357,{"@metamask/utils":2908},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createModuleLogger=n.projectLogger=void 0;const r=e("@metamask/utils");Object.defineProperty(n,"createModuleLogger",{enumerable:!0,get:function(){return r.createModuleLogger}}),n.projectLogger=(0,r.createProjectLogger)("core-backend")}}},{package:"@metamask/core-backend",file:"node_modules/@metamask/core-backend/dist/logger.cjs"}],[1358,{"./constants.cjs":1359,"./utils.cjs":1361,"@metamask/base-controller":1268,"@metamask/keyring-controller":2070,"@metamask/utils":2908},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,s,i=this&&this.__classPrivateFieldSet||function(e,t,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n},o=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.DelegationController=n.controllerName=void 0;const a=e("@metamask/base-controller"),c=e("@metamask/keyring-controller"),l=e("@metamask/utils"),u=e("./constants.cjs"),d=e("./utils.cjs");n.controllerName="DelegationController";const h={delegations:{persist:!0,anonymous:!1}};class p extends a.BaseController{constructor({messenger:e,state:t,hashDelegation:o,getDelegationEnvironment:a}){super({messenger:e,metadata:h,name:n.controllerName,state:{delegations:{},...t}}),r.set(this,void 0),s.set(this,void 0),i(this,r,o,"f"),i(this,s,a,"f")}async signDelegation(e){const{delegation:t,chainId:n}=e,{DelegationManager:r}=o(this,s,"f").call(this,n),i=(0,d.createTypedMessageParams)({chainId:(0,l.hexToNumber)(n),from:t.delegator,delegation:{...t,signature:"0x"},verifyingContract:r});return await this.messagingSystem.call("KeyringController:signTypedMessage",i,c.SignTypedDataVersion.V4)}store(e){const{entry:t}=e,n=o(this,r,"f").call(this,t.delegation);if(!(0,d.isHexEqual)(t.delegation.authority,u.ROOT_AUTHORITY)&&!this.state.delegations[t.delegation.authority])throw new Error("Invalid authority");this.update(e=>{e.delegations[n]=t})}list(e){const t=this.messagingSystem.call("AccountsController:getSelectedAccount").address;let n=Object.values(this.state.delegations);e?.from&&(n=n.filter(t=>(0,d.isHexEqual)(t.delegation.delegator,e.from))),(!e?.from||e?.from&&!(0,d.isHexEqual)(e.from,t))&&(n=n.filter(e=>(0,d.isHexEqual)(e.delegation.delegate,t)));const r=e?.chainId;r&&(n=n.filter(e=>(0,d.isHexEqual)(e.chainId,r)));const s=e?.tags;return s&&s.length>0&&(n=n.filter(e=>s.every(t=>e.tags.includes(t)))),n}retrieve(e){return this.state.delegations[e]??null}chain(e){const t=[],n=this.retrieve(e);if(!n)return null;t.push(n);for(let e=n.delegation.authority;e!==u.ROOT_AUTHORITY;){const n=this.retrieve(e);if(!n)throw new Error("Invalid delegation chain");t.push(n),e=n.delegation.authority}return t}delete(e){if(!this.retrieve(e))return 0;const t=Object.entries(this.state.delegations),n=[e],r=[];for(;n.length>0;){const e=n.pop();t.filter(([t,n])=>n.delegation.authority===e).forEach(([e])=>{n.push(e)}),r.push(e)}return this.update(e=>{r.forEach(t=>{delete e.delegations[t]})}),r.length}}n.DelegationController=p,r=new WeakMap,s=new WeakMap}}},{package:"@metamask/delegation-controller",file:"node_modules/@metamask/delegation-controller/dist/DelegationController.cjs"}],[1359,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SIGNABLE_DELEGATION_TYPED_DATA=n.ROOT_AUTHORITY=void 0,n.ROOT_AUTHORITY="0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff";n.SIGNABLE_DELEGATION_TYPED_DATA={EIP712Domain:[{name:"name",type:"string"},{name:"version",type:"string"},{name:"chainId",type:"uint256"},{name:"verifyingContract",type:"address"}],Caveat:[{name:"enforcer",type:"address"},{name:"terms",type:"bytes"}],Delegation:[{name:"delegate",type:"address"},{name:"delegator",type:"address"},{name:"authority",type:"bytes32"},{name:"caveats",type:"Caveat[]"},{name:"salt",type:"uint256"}]}}}},{package:"@metamask/delegation-controller",file:"node_modules/@metamask/delegation-controller/dist/constants.cjs"}],[136,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getSnapsRegistryMessenger=function(e){return e.getRestricted({name:"SnapsRegistry",allowedEvents:[],allowedActions:[]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/snaps/snaps-registry-messenger.ts"}],[1360,{"./DelegationController.cjs":1358},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.DelegationController=void 0;var r=e("./DelegationController.cjs");Object.defineProperty(n,"DelegationController",{enumerable:!0,get:function(){return r.DelegationController}})}}},{package:"@metamask/delegation-controller",file:"node_modules/@metamask/delegation-controller/dist/index.cjs"}],[1361,{"./constants.cjs":1359,"@metamask/utils":2908},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createTypedMessageParams=n.toDelegationStruct=n.isHexEqual=void 0;const r=e("@metamask/utils"),s=e("./constants.cjs");n.isHexEqual=function(e,t){return e.toLowerCase()===t.toLowerCase()};n.toDelegationStruct=e=>{const t=e.caveats.map(e=>({enforcer:(0,r.getChecksumAddress)(e.enforcer),terms:e.terms,args:e.args})),n="0x"===e.salt?0n:BigInt(e.salt);return{delegate:(0,r.getChecksumAddress)(e.delegate),delegator:(0,r.getChecksumAddress)(e.delegator),authority:e.authority,caveats:t,salt:n,signature:e.signature}},n.createTypedMessageParams=function(e){const{chainId:t,from:r,delegation:i,verifyingContract:o}=e;return{data:{types:s.SIGNABLE_DELEGATION_TYPED_DATA,primaryType:"Delegation",domain:{chainId:t,name:"DelegationManager",version:"1",verifyingContract:o},message:(0,n.toDelegationStruct)(i)},from:r}}}}},{package:"@metamask/delegation-controller",file:"node_modules/@metamask/delegation-controller/dist/utils.cjs"}],[1363,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r={DelegationManager:"0xdb9B1e94B5b69Df7e401DDbedE43491141047dB3",EntryPoint:"0x0000000071727De22E5E9d8BAf0edAc6f37da032",SimpleFactory:"0x69Aa2f9fe1572F1B640E1bbc512f5c3a734fc77c",MultiSigDeleGatorImpl:"0x56a9EdB16a0105eb5a4C54f4C062e2868844f3A7",HybridDeleGatorImpl:"0x48dBe696A4D990079e039489bA2053B36E8FFEC4",EIP7702StatelessDeleGatorImpl:"0x63c0c19a282a1B52b07dD5a65b58948A07DAE32B",AllowedCalldataEnforcer:"0xc2b0d624c1c4319760C96503BA27C347F3260f55",AllowedMethodsEnforcer:"0x2c21fD0Cb9DC8445CB3fb0DC5E7Bb0Aca01842B5",AllowedTargetsEnforcer:"0x7F20f61b1f09b08D970938F6fa563634d65c4EeB",BlockNumberEnforcer:"0x5d9818dF0AE3f66e9c3D0c5029DAF99d1823ca6c",DeployedEnforcer:"0x24ff2AA430D53a8CD6788018E902E098083dcCd2",ERC20BalanceChangeEnforcer:"0xcdF6aB796408598Cea671d79506d7D48E97a5437",ERC20TransferAmountEnforcer:"0xf100b0819427117EcF76Ed94B358B1A5b5C6D2Fc",ERC20PeriodTransferEnforcer:"0x474e3Ae7E169e940607cC624Da8A15Eb120139aB",ERC20StreamingEnforcer:"0x56c97aE02f233B29fa03502Ecc0457266d9be00e",ERC721BalanceChangeEnforcer:"0x8aFdf96eDBbe7e1eD3f5Cd89C7E084841e12A09e",ERC721TransferEnforcer:"0x3790e6B7233f779b09DA74C72b6e94813925b9aF",ERC1155BalanceChangeEnforcer:"0x63c322732695cAFbbD488Fc6937A0A7B66fC001A",ExactCalldataBatchEnforcer:"0x982FD5C86BBF425d7d1451f974192d4525113DfD",ExactCalldataEnforcer:"0x99F2e9bF15ce5eC84685604836F71aB835DBBdED",ExactExecutionBatchEnforcer:"0x1e141e455d08721Dd5BCDA1BaA6Ea5633Afd5017",ExactExecutionEnforcer:"0x146713078D39eCC1F5338309c28405ccf85Abfbb",IdEnforcer:"0xC8B5D93463c893401094cc70e66A206fb5987997",LimitedCallsEnforcer:"0x04658B29F6b82ed55274221a06Fc97D318E25416",NativeBalanceChangeEnforcer:"0xbD7B277507723490Cd50b12EaaFe87C616be6880",ArgsEqualityCheckEnforcer:"0x44B8C6ae3C304213c3e298495e12497Ed3E56E41",NativeTokenPaymentEnforcer:"0x4803a326ddED6dDBc60e659e5ed12d85c7582811",NativeTokenTransferAmountEnforcer:"0xF71af580b9c3078fbc2BBF16FbB8EEd82b330320",NativeTokenStreamingEnforcer:"0xD10b97905a320b13a0608f7E9cC506b56747df19",NativeTokenPeriodTransferEnforcer:"0x9BC0FAf4Aca5AE429F4c06aEEaC517520CB16BD9",NonceEnforcer:"0xDE4f2FAC4B3D87A1d9953Ca5FC09FCa7F366254f",OwnershipTransferEnforcer:"0x7EEf9734E7092032B5C56310Eb9BbD1f4A524681",RedeemerEnforcer:"0xE144b0b2618071B4E56f746313528a669c7E65c5",SpecificActionERC20TransferBatchEnforcer:"0x00e0251aaA263dfE3B3541B758A82D1CBA1c3B6D",TimestampEnforcer:"0x1046bb45C8d673d4ea75321280DB34899413c069",ValueLteEnforcer:"0x92Bf12322527cAA612fd31a0e810472BBB106A8F",MultiTokenPeriodEnforcer:"0xFB2f1a9BD76d3701B730E5d69C3219D42D80eBb7"},s={DelegationManager:"0x56D56e07e3d6Ee5a24e30203A37a0a460f42D7A3",EntryPoint:"0x0000000071727De22E5E9d8BAf0edAc6f37da032",SimpleFactory:"0x6ff518884f21168c30c58CB21184D6AdBC18Ad90",MultiSigDeleGatorImpl:"0xd1f421EDbA5e3FA9efe3874827114b20C5BEC40C",HybridDeleGatorImpl:"0x941f3a016F8726d5643Ce62452d0D78492D42b42",AllowedCalldataEnforcer:"0xff71d60f3208469cBCE0859717B5198042DCB3F3",AllowedMethodsEnforcer:"0xe32C2561792e8446Abe73B9f557B881C13906186",AllowedTargetsEnforcer:"0x06aaE4c67EEA95277c46Bf79b1583d4a01772D22",BlockNumberEnforcer:"0x8E470D2Ae278457b42d2405E0B8Cd4BE21Ed9045",DeployedEnforcer:"0xf9088f013dBD9ebb7Cebd66fEB48253c6Ac5a820",ERC20BalanceGteEnforcer:"0xB7B6f32ec6343261D814e55Ed8C5925d91Cab861",ERC20TransferAmountEnforcer:"0x9A069b18032B31429A363AeCFb1B6A0564b44471",IdEnforcer:"0x91015c3b9D9523966eD2399885e5Df7A567f916c",LimitedCallsEnforcer:"0xe694bFfffEA3E85923b1210b37e6a0175e910863",NonceEnforcer:"0xE83BCFD8bBE672A96747e831050a91cf44F4F87A",TimestampEnforcer:"0x550FdD13eEBC1f22ea2a2480024BacBF0Ad7e5CE",ValueLteEnforcer:"0xBE32a6DB7471F63BB168C088c57Db01AfAe87967",NativeTokenTransferAmountEnforcer:"0x5eD3833d7B957A8DB8A461c3AF2d668Ec25382E0",NativeBalanceGteEnforcer:"0x376a98860E210DdEda3689fb39565592c563cB0A",ArgsEqualityCheckEnforcer:"0x7378dE585998d3E18Ce147867C335C25B3dB8Ee5",NativeTokenPaymentEnforcer:"0x87Fe18EbF99e42fcE8A03a25F1d20E119407f8e7",RedeemerEnforcer:"0x926672b130D1EF60A9d6b11D2048d121b30f40C1"},i={DelegationManager:"0xbe4138886cb096bdc1b930f2f0ca7892aa234d78",EntryPoint:"0x0000000071727De22E5E9d8BAf0edAc6f37da032",SimpleFactory:"0x6ff518884f21168c30c58CB21184D6AdBC18Ad90",MultiSigDeleGatorImpl:"0x11f555af5844d85bfcf5d61d2a22866527eb585a",HybridDeleGatorImpl:"0xd6edd1256deccb2b06bdecef92dc16bcf26e531b",AllowedCalldataEnforcer:"0x48db3835a873d64a4af2c09f014052407c003bd7",AllowedMethodsEnforcer:"0xfd731951bf1c52afccee3e6f14ab656475b76dd4",AllowedTargetsEnforcer:"0xbc8673c0afa52d86d991c06881e55b2966920564",BlockNumberEnforcer:"0xc15faffa0d879b9263c15a46ce31eacfa2e0e8ae",DeployedEnforcer:"0x5accb9559b56a6c1e3f90e342c85c42d93720d43",ERC20BalanceGteEnforcer:"0xb5d6b1ec6d868a3bae5b7f48178eaa2686a7a087",ERC20TransferAmountEnforcer:"0x92ac423b9c111962179a6242e1adb58d02c103be",IdEnforcer:"0x34152d9f3f8f74338d50703e780389e829b4abac",LimitedCallsEnforcer:"0x4b3adad4a328bee8ba17b86074d92fe7372180cd",NonceEnforcer:"0x2f32ff3fc3086d7f63f16fe8d0065390d460b40d",TimestampEnforcer:"0x78e05f779490c24bf3bfa135b4112e7003b321cd",ValueLteEnforcer:"0xfc20ede0a1132e839fbda9d7ed3904ff3c89540f"},o={mainnet:1,polygon:137,bsc:56,optimism:10,arbitrum:42161,linea:59144,base:8453,gnosis:100,sepolia:11155111,lineaSepolia:59141,baseSepolia:84532,megaEthTestnet:6342,chiado:10200,lineaGoerli:59140},a={"1.0.0":{[o.optimism]:i,[o.polygon]:i,[o.base]:i,[o.arbitrum]:i,[o.linea]:i,[o.sepolia]:{...i,HybridDeleGatorImpl:"0x5989F5D13DF8fc818EdA65e417AED90459fD67F7"},[o.lineaSepolia]:{...i,HybridDeleGatorImpl:"0x5989F5D13DF8fc818EdA65e417AED90459fD67F7"}},"1.1.0":{[o.arbitrum]:s,[o.base]:s,[o.linea]:s,[o.optimism]:s,[o.polygon]:s,[o.sepolia]:s,[o.lineaSepolia]:s,[o.baseSepolia]:{...s,SimpleFactory:"0xE8eA1DE8D6AfE400B7C8C1A81B7C29B7876b4d02"}},"1.3.0":{[o.mainnet]:r,[o.polygon]:r,[o.bsc]:r,[o.optimism]:r,[o.arbitrum]:r,[o.linea]:r,[o.base]:r,[o.gnosis]:r,[o.sepolia]:r,[o.lineaSepolia]:r,[o.baseSepolia]:r,[o.megaEthTestnet]:r,[o.chiado]:r}};n.CHAIN_ID=o,n.DELEGATOR_CONTRACTS=a}}},{package:"@metamask/delegation-deployments",file:"node_modules/@metamask/delegation-deployments/dist/index.js"}],[137,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getWebSocketServiceMessenger=function(e){return e.getRestricted({name:"WebSocketService",allowedActions:["SnapController:handleRequest"],allowedEvents:["SnapController:snapUpdated","SnapController:snapUninstalled","SnapController:snapInstalled"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/snaps/websocket-service-messenger.ts"}],[138,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getSubjectMetadataControllerMessenger=function(e){return e.getRestricted({name:"SubjectMetadataController",allowedActions:["PermissionController:hasPermissions"],allowedEvents:[]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/subject-metadata-controller-messenger.ts"}],[139,{"./subscription-controller-messenger":140,"./subscription-service-messenger":141},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"getSubscriptionControllerInitMessenger",{enumerable:!0,get:function(){return r.getSubscriptionControllerInitMessenger}}),Object.defineProperty(n,"getSubscriptionControllerMessenger",{enumerable:!0,get:function(){return r.getSubscriptionControllerMessenger}}),Object.defineProperty(n,"getSubscriptionServiceMessenger",{enumerable:!0,get:function(){return s.getSubscriptionServiceMessenger}});var r=e("./subscription-controller-messenger"),s=e("./subscription-service-messenger")}}},{package:"$root$",file:"app/scripts/controller-init/messengers/subscription/index.ts"}],[14,{"../../lib/snap-keyring/snap-keyring":302},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SnapKeyringBuilderInit=void 0;var r=e("../../lib/snap-keyring/snap-keyring");n.SnapKeyringBuilderInit=({controllerMessenger:e,initMessenger:t,removeAccount:n})=>({persistedStateKey:null,memStateKey:null,controller:(0,r.snapKeyringBuilder)(e,{persistKeyringHelper:async()=>{await t.call("KeyringController:persistAllKeyrings"),await t.call("AccountsController:updateAccounts")},removeAccountHelper:async e=>{await n(e)},trackEvent:t.call.bind(t,"MetaMetricsController:trackEvent")})})}}},{package:"$root$",file:"app/scripts/controller-init/accounts/snap-keyring-builder-init.ts"}],[140,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getSubscriptionControllerInitMessenger=function(e){return e.getRestricted({name:"SubscriptionControllerInit",allowedEvents:[],allowedActions:["AuthenticationController:getBearerToken"]})},n.getSubscriptionControllerMessenger=function(e){return e.getRestricted({name:"SubscriptionController",allowedEvents:["AuthenticationController:stateChange"],allowedActions:["AuthenticationController:getBearerToken","AuthenticationController:performSignOut"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/subscription/subscription-controller-messenger.ts"}],[141,{"../../../services/subscription/types":559},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getSubscriptionServiceMessenger=function(e){return e.getRestricted({name:r.SERVICE_NAME,allowedActions:["SubscriptionController:getPricing","SubscriptionController:getSubscriptions","SubscriptionController:startShieldSubscriptionWithCard","SubscriptionController:updatePaymentMethod","SubscriptionController:getCryptoApproveTransactionParams","SubscriptionController:getBillingPortalUrl","AuthenticationController:getBearerToken"],allowedEvents:[]})};var r=e("../../../services/subscription/types")}}},{package:"$root$",file:"app/scripts/controller-init/messengers/subscription/subscription-service-messenger.ts"}],[142,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getSwapsControllerInitMessenger=function(e){return e.getRestricted({name:"SwapsControllerInit",allowedActions:["MetaMetricsController:trackEvent","NetworkController:getState"],allowedEvents:[]})},n.getSwapsControllerMessenger=function(e){return e.getRestricted({name:"SwapsController",allowedActions:["NetworkController:getNetworkClientById","NetworkController:getState","TokenRatesController:getState"],allowedEvents:[]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/swaps-controller-messenger.ts"}],[143,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getTokenBalancesControllerInitMessenger=function(e){return e.getRestricted({name:"TokenBalancesControllerInit",allowedActions:["PreferencesController:getState","RemoteFeatureFlagController:getState"],allowedEvents:[]})},n.getTokenBalancesControllerMessenger=function(e){return e.getRestricted({name:"TokenBalancesController",allowedActions:["NetworkController:getState","NetworkController:getNetworkClientById","TokensController:getState","PreferencesController:getState","AccountsController:getSelectedAccount","AccountsController:listAccounts","AccountTrackerController:getState","AccountTrackerController:updateNativeBalances","AccountTrackerController:updateStakedBalances","TokenDetectionController:addDetectedTokensViaWs"],allowedEvents:["PreferencesController:stateChange","TokensController:stateChange","NetworkController:stateChange","KeyringController:accountRemoved","AccountActivityService:statusChanged","AccountActivityService:balanceUpdated"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/token-balances-controller-messenger.ts"}],[144,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getTokenDetectionControllerInitMessenger=function(e){return e.getRestricted({name:"TokenDetectionControllerInit",allowedActions:["AssetsContractController:getBalancesInSingleCall","MetaMetricsController:trackEvent","PreferencesController:getState"],allowedEvents:[]})},n.getTokenDetectionControllerMessenger=function(e){return e.getRestricted({name:"TokenDetectionController",allowedActions:["AccountsController:getAccount","AccountsController:getSelectedAccount","KeyringController:getState","NetworkController:getNetworkClientById","NetworkController:getNetworkConfigurationByNetworkClientId","NetworkController:getState","PreferencesController:getState","TokenListController:getState","TokensController:getState","TokensController:addDetectedTokens","TokensController:addTokens","NetworkController:findNetworkClientIdByChainId"],allowedEvents:["AccountsController:selectedEvmAccountChange","KeyringController:lock","KeyringController:unlock","NetworkController:networkDidChange","PreferencesController:stateChange","TokenListController:stateChange","TransactionController:transactionConfirmed"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/token-detection-controller-messenger.ts"}],[145,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getTokenListControllerInitMessenger=function(e){return e.getRestricted({name:"TokenListControllerInit",allowedActions:["NetworkController:getNetworkClientById","NetworkController:getState","PreferencesController:getState"],allowedEvents:["PreferencesController:stateChange"]})},n.getTokenListControllerMessenger=function(e){return e.getRestricted({name:"TokenListController",allowedActions:["NetworkController:getNetworkClientById"],allowedEvents:["NetworkController:stateChange"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/token-list-controller-messenger.ts"}],[146,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getTokensControllerInitMessenger=function(e){return e.getRestricted({name:"TokensControllerInit",allowedActions:["NetworkController:getNetworkClientById","NetworkController:getSelectedNetworkClient","NetworkController:getState"],allowedEvents:[]})},n.getTokensControllerMessenger=function(e){return e.getRestricted({name:"TokensController",allowedActions:["AccountsController:getAccount","AccountsController:getSelectedAccount","AccountsController:listAccounts","ApprovalController:addRequest","NetworkController:getNetworkClientById"],allowedEvents:["AccountsController:selectedEvmAccountChange","KeyringController:accountRemoved","NetworkController:networkDidChange","NetworkController:stateChange","PreferencesController:stateChange","TokenListController:stateChange"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/tokens-controller-messenger.ts"}],[147,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getTransactionControllerInitMessenger=function(e){return e.getRestricted({name:"TransactionControllerInit",allowedEvents:["SmartTransactionsController:smartTransaction","TransactionController:transactionApproved","TransactionController:transactionConfirmed","TransactionController:transactionDropped","TransactionController:transactionFailed","TransactionController:transactionNewSwapApproval","TransactionController:transactionNewSwap","TransactionController:transactionRejected","TransactionController:transactionSubmitted","TransactionController:postTransactionBalanceUpdated","TransactionController:unapprovedTransactionAdded"],allowedActions:["ApprovalController:acceptRequest","ApprovalController:addRequest","ApprovalController:endFlow","ApprovalController:startFlow","ApprovalController:updateRequestState","AppStateController:getState","AuthenticationController:getBearerToken","DelegationController:signDelegation","InstitutionalSnapController:beforeCheckPendingTransactionHook","InstitutionalSnapController:publishHook","KeyringController:signEip7702Authorization","KeyringController:signTypedMessage","NetworkController:getEIP1559Compatibility","RemoteFeatureFlagController:getState","SwapsController:setApproveTxId","SwapsController:setTradeTxId","TransactionController:estimateGas","TransactionController:getState","SubscriptionController:getSubscriptionByProduct"]})},n.getTransactionControllerMessenger=function(e){return e.getRestricted({name:"TransactionController",allowedActions:["AccountsController:getSelectedAccount","AccountsController:getState","ApprovalController:addRequest","KeyringController:signEip7702Authorization","NetworkController:findNetworkClientIdByChainId","NetworkController:getNetworkClientById","RemoteFeatureFlagController:getState"],allowedEvents:["NetworkController:stateChange"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/transaction-controller-messenger.ts"}],[148,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getUserOperationControllerMessenger=function(e){return e.getRestricted({name:"UserOperationController",allowedActions:["ApprovalController:addRequest","NetworkController:getNetworkClientById","KeyringController:prepareUserOperation","KeyringController:patchUserOperation","KeyringController:signUserOperation"],allowedEvents:[]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/user-operation-controller-messenger.ts"}],[149,{"../../../shared/lib/sentry":5881,"../controllers/metametrics-controller":205,"../lib/segment":295},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MetaMetricsControllerInit=void 0;var r,s=(r=e("../controllers/metametrics-controller"))&&r.__esModule?r:{default:r},i=e("../lib/segment"),o=e("../../../shared/lib/sentry");n.MetaMetricsControllerInit=({controllerMessenger:e,extension:t,persistedState:n})=>({controller:new s.default({state:n.MetaMetricsController,messenger:e,version:"13.7.0",environment:"production",segment:i.segment,extension:t,captureException:o.captureException})})}}},{package:"$root$",file:"app/scripts/controller-init/metametrics-controller-init.ts"}],[15,{"../controllers/alert-controller":199},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.AlertControllerInit=void 0;var r=e("../controllers/alert-controller");n.AlertControllerInit=({controllerMessenger:e,persistedState:t})=>({controller:new r.AlertController({state:t.AlertController,messenger:e})})}}},{package:"$root$",file:"app/scripts/controller-init/alert-controller-init.ts"}],[150,{"../controllers/metametrics-data-deletion/metametrics-data-deletion":206,"../services/data-deletion-service":548},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MetaMetricsDataDeletionControllerInit=void 0;var r=e("../controllers/metametrics-data-deletion/metametrics-data-deletion"),s=e("../services/data-deletion-service");n.MetaMetricsDataDeletionControllerInit=({controllerMessenger:e,persistedState:t})=>{const n=new s.DataDeletionService;return{controller:new r.MetaMetricsDataDeletionController({messenger:e,state:t.MetaMetricsDataDeletionController,dataDeletionService:n})}}}}},{package:"$root$",file:"app/scripts/controller-init/metametrics-data-deletion-controller-init.ts"}],[151,{"./multichain-account-service-init":152,"./multichain-assets-controller-init":153,"./multichain-balances-controller-init":154,"./multichain-network-controller-init":155,"./multichain-rates-assets-controller-init":157,"./multichain-transactions-controller-init":158},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"MultichainAccountServiceInit",{enumerable:!0,get:function(){return r.MultichainAccountServiceInit}}),Object.defineProperty(n,"MultichainAssetsControllerInit",{enumerable:!0,get:function(){return s.MultichainAssetsControllerInit}}),Object.defineProperty(n,"MultichainAssetsRatesControllerInit",{enumerable:!0,get:function(){return c.MultichainAssetsRatesControllerInit}}),Object.defineProperty(n,"MultichainBalancesControllerInit",{enumerable:!0,get:function(){return i.MultichainBalancesControllerInit}}),Object.defineProperty(n,"MultichainNetworkControllerInit",{enumerable:!0,get:function(){return a.MultichainNetworkControllerInit}}),Object.defineProperty(n,"MultichainTransactionsControllerInit",{enumerable:!0,get:function(){return o.MultichainTransactionsControllerInit}});var r=e("./multichain-account-service-init"),s=e("./multichain-assets-controller-init"),i=e("./multichain-balances-controller-init"),o=e("./multichain-transactions-controller-init"),a=e("./multichain-network-controller-init"),c=e("./multichain-rates-assets-controller-init")}}},{package:"$root$",file:"app/scripts/controller-init/multichain/index.ts"}],[152,{"../../../../shared/lib/multichain-accounts/remote-feature-flag":5873,"../../../../shared/lib/multichain-feature-flags":5874,"../../lib/util":332,"@metamask/multichain-account-service":2134},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MultichainAccountServiceInit=void 0;var r=e("@metamask/multichain-account-service"),s=e("../../lib/util"),i=e("../../../../shared/lib/multichain-accounts/remote-feature-flag"),o=e("../../../../shared/lib/multichain-feature-flags");n.MultichainAccountServiceInit=({controllerMessenger:e,initMessenger:t})=>{var n;const a=new r.AccountProviderWrapper(e,new r.BtcAccountProvider(e)),c=new r.MultichainAccountService({messenger:e,providers:[a]}),l=t.call("PreferencesController:getState");t.subscribe("PreferencesController:stateChange",(0,s.previousValueComparator)((e,n)=>{const{useExternalServices:r}=e,{useExternalServices:s}=n;if(r!==s){const{remoteFeatureFlags:e}=t.call("RemoteFeatureFlagController:getState"),n=null==e?void 0:e.enableMultichainAccountsState2;(0,i.isMultichainAccountsFeatureEnabled)(n,i.FEATURE_VERSION_2)&&c.setBasicFunctionality(s).catch(e=>{console.error("Failed to set basic functionality on MultichainAccountService:",e)})}return!0},l));const u=t.call("RemoteFeatureFlagController:getState"),d=(0,o.isMultichainFeatureEnabled)(null==u||null===(n=u.remoteFeatureFlags)||void 0===n?void 0:n.bitcoinAccounts);return a.setEnabled(d),e.subscribe("RemoteFeatureFlagController:stateChange",(0,s.previousValueComparator)((e,t)=>{var n,r;const s=(0,o.isMultichainFeatureEnabled)(null==e||null===(n=e.remoteFeatureFlags)||void 0===n?void 0:n.bitcoinAccounts),i=(0,o.isMultichainFeatureEnabled)(null==t||null===(r=t.remoteFeatureFlags)||void 0===r?void 0:r.bitcoinAccounts);return s!==i&&(a.setEnabled(i),i&&c.alignWallets().catch(e=>{console.error("Failed to align wallets after enabling Bitcoin provider:",e)})),!0},u)),{memStateKey:null,persistedStateKey:null,controller:c}}}}},{package:"$root$",file:"app/scripts/controller-init/multichain/multichain-account-service-init.ts"}],[153,{"@metamask/assets-controllers":1203},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MultichainAssetsControllerInit=void 0;var r=e("@metamask/assets-controllers");n.MultichainAssetsControllerInit=({controllerMessenger:e,persistedState:t})=>({controller:new r.MultichainAssetsController({messenger:e,state:t.MultichainAssetsController})})}}},{package:"$root$",file:"app/scripts/controller-init/multichain/multichain-assets-controller-init.ts"}],[154,{"@metamask/assets-controllers":1203},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MultichainBalancesControllerInit=void 0;var r=e("@metamask/assets-controllers");n.MultichainBalancesControllerInit=({controllerMessenger:e,persistedState:t})=>({controller:new r.MultichainBalancesController({messenger:e,state:t.MultichainBalancesController})})}}},{package:"$root$",file:"app/scripts/controller-init/multichain/multichain-balances-controller-init.ts"}],[155,{"./multichain-network-service-init":156,"@metamask/multichain-network-controller":2161},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MultichainNetworkControllerInit=void 0;var r=e("@metamask/multichain-network-controller"),s=e("./multichain-network-service-init");n.MultichainNetworkControllerInit=({controllerMessenger:e,persistedState:t})=>{const n=(0,s.MultichainNetworkServiceInit)();return{controller:new r.MultichainNetworkController({messenger:e,state:t.MultichainNetworkController,networkService:n})}}}}},{package:"$root$",file:"app/scripts/controller-init/multichain/multichain-network-controller-init.ts"}],[156,{"@metamask/multichain-network-controller":2161},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MultichainNetworkServiceInit=void 0;var r=e("@metamask/multichain-network-controller");n.MultichainNetworkServiceInit=()=>new r.MultichainNetworkService({fetch:window.fetch.bind(window)})}}},{package:"$root$",file:"app/scripts/controller-init/multichain/multichain-network-service-init.ts"}],[157,{"@metamask/assets-controllers":1203},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MultichainAssetsRatesControllerInit=void 0;var r=e("@metamask/assets-controllers");n.MultichainAssetsRatesControllerInit=({controllerMessenger:e,persistedState:t})=>({controller:new r.MultichainAssetsRatesController({messenger:e,state:t.MultichainAssetsRatesController,interval:18e4})})}}},{package:"$root$",file:"app/scripts/controller-init/multichain/multichain-rates-assets-controller-init.ts"}],[158,{"@metamask/multichain-transactions-controller":2166},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MultichainTransactionsControllerInit=void 0;var r=e("@metamask/multichain-transactions-controller");n.MultichainTransactionsControllerInit=({controllerMessenger:e,persistedState:t})=>({controller:new r.MultichainTransactionsController({messenger:e,state:t.MultichainTransactionsController})})}}},{package:"$root$",file:"app/scripts/controller-init/multichain/multichain-transactions-controller-init.ts"}],[159,{"../../../shared/constants/network":5800,"../../../shared/constants/time":5817,"../../../shared/lib/network-utils":5878,"../../../shared/lib/sentry":5881,"../lib/network-controller/messenger-action-handlers":263,"@metamask/controller-utils":1349,"@metamask/network-controller":2234,"@metamask/utils":2908},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.NetworkControllerInit=n.ADDITIONAL_DEFAULT_NETWORKS=void 0;var r=e("@metamask/network-controller"),s=e("@metamask/controller-utils"),i=e("@metamask/utils"),o=e("../../../shared/constants/time"),a=e("../../../shared/lib/network-utils"),c=e("../lib/network-controller/messenger-action-handlers"),l=e("../../../shared/constants/network"),u=e("../../../shared/lib/sentry");const d=n.ADDITIONAL_DEFAULT_NETWORKS=[s.ChainId["megaeth-testnet"],s.ChainId["monad-testnet"]];n.NetworkControllerInit=({controllerMessenger:e,infuraProjectId:t,initMessenger:n,persistedState:h})=>{const p=function(e){let t=e;if(!t){t=(0,r.getDefaultNetworkControllerState)(d);const e=t.networkConfigurationsByChainId??{};let n;Object.values(e).forEach(e=>{const t=e.rpcEndpoints[0].networkClientId;(0,i.hasProperty)(s.BlockExplorerUrl,t)&&(e.blockExplorerUrls=[s.BlockExplorerUrl[t]]),e.defaultBlockExplorerUrlIndex=0}),e[l.CHAIN_IDS.MAINNET].rpcEndpoints[0].failoverUrls=(0,l.getFailoverUrlsForInfuraNetwork)("ethereum-mainnet"),e[l.CHAIN_IDS.LINEA_MAINNET].rpcEndpoints[0].failoverUrls=(0,l.getFailoverUrlsForInfuraNetwork)("linea-mainnet"),e[l.CHAIN_IDS.BASE].rpcEndpoints[0].failoverUrls=(0,l.getFailoverUrlsForInfuraNetwork)("base-mainnet"),e[l.CHAIN_IDS.MAINNET].name="Ethereum",e[l.CHAIN_IDS.LINEA_MAINNET].name="Linea",e[l.CHAIN_IDS.BASE].name="Base",n=e[l.CHAIN_IDS.MAINNET],t.selectedNetworkClientId=n.rpcEndpoints[n.defaultRpcEndpointIndex].networkClientId}return t.networkConfigurationsByChainId&&!Object.values(t.networkConfigurationsByChainId).flatMap(e=>e.rpcEndpoints.map(e=>e.networkClientId)).includes(t.selectedNetworkClientId)&&((0,u.captureException)(new Error(`NetworkController state is invalid: \`selectedNetworkClientId\` '${t.selectedNetworkClientId}' does not refer to an RPC endpoint within a network configuration`)),t.selectedNetworkClientId=t.networkConfigurationsByChainId[l.CHAIN_IDS.MAINNET].rpcEndpoints[0].networkClientId),t}(h.NetworkController),m=new r.NetworkController({messenger:e,state:p,infuraProjectId:t,getBlockTrackerOptions:()=>({pollingInterval:20*o.SECOND,retryTimeout:20*o.SECOND}),getRpcServiceOptions:e=>{const t={fetch:globalThis.fetch.bind(globalThis),btoa:globalThis.btoa.bind(globalThis)};return(0,a.getIsQuicknodeEndpointUrl)(e)?{...t,policyOptions:{maxRetries:4,maxConsecutiveFailures:70}}:{...t,policyOptions:{maxRetries:4,maxConsecutiveFailures:35}}},additionalDefaultNetworks:d});return n.subscribe("NetworkController:rpcEndpointUnavailable",async({chainId:e,endpointUrl:r,error:s})=>{(0,c.onRpcEndpointUnavailable)({chainId:e,endpointUrl:r,error:s,infuraProjectId:t,trackEvent:n.call.bind(n,"MetaMetricsController:trackEvent"),metaMetricsId:n.call("MetaMetricsController:getMetaMetricsId")})}),n.subscribe("NetworkController:rpcEndpointDegraded",async({chainId:e,endpointUrl:r,error:s})=>{(0,c.onRpcEndpointDegraded)({chainId:e,endpointUrl:r,error:s,infuraProjectId:t,trackEvent:n.call.bind(n,"MetaMetricsController:trackEvent"),metaMetricsId:n.call("MetaMetricsController:getMetaMetricsId")})}),n.subscribe("RemoteFeatureFlagController:stateChange",e=>{e?(console.log("Enabling RPC failover."),m.enableRpcFailover()):(console.log("Disabling RPC failover."),m.disableRpcFailover())},e=>e.remoteFeatureFlags.walletFrameworkRpcFailoverEnabled),m.initializeProvider({lookupNetwork:!1}),{controller:m}}}}},{package:"$root$",file:"app/scripts/controller-init/network-controller-init.ts"}],[16,{"../../../shared/notifications":5926,"@metamask/announcement-controller":1165},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.AnnouncementControllerInit=void 0;var r=e("@metamask/announcement-controller"),s=e("../../../shared/notifications");n.AnnouncementControllerInit=({controllerMessenger:e,persistedState:t})=>({controller:new r.AnnouncementController({messenger:e,allAnnouncements:s.UI_NOTIFICATIONS,state:t.AnnouncementController})})}}},{package:"$root$",file:"app/scripts/controller-init/announcement-controller-init.ts"}],[160,{"../../../../package.json":5776,"@metamask/notification-services-controller/notification-services":2255},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.NotificationServicesControllerInit=void 0;var r,s=e("@metamask/notification-services-controller/notification-services");const i=((r=e("../../../../package.json"))&&r.__esModule?r:{default:r}).default.version;n.NotificationServicesControllerInit=({controllerMessenger:e,persistedState:t})=>({controller:new s.Controller({messenger:e,state:t.NotificationServicesController,env:{featureAnnouncements:{platform:"extension",spaceId:"jdkgyfmyd9sw",accessToken:"mAYNB_k65snv4AXW4o8ksZN8BwWDQF9702HKV7yBDZI",platformVersion:i}}})})}}},{package:"$root$",file:"app/scripts/controller-init/notifications/notification-services-controller-init.ts"}],[161,{"../../../../shared/constants/metametrics":5796,"../../../../shared/modules/mv3.utils":5909,"../../controllers/push-notifications":219,"@metamask/notification-services-controller/push-services":2274,"@metamask/notification-services-controller/push-services/web":2282,"@metamask/utils":2908},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getNormalisedLocale=n.NotificationServicesPushControllerInit=void 0;var r=e("@metamask/notification-services-controller/push-services"),s=e("@metamask/notification-services-controller/push-services/web"),i=e("@metamask/utils"),o=e("../../../../shared/modules/mv3.utils"),a=e("../../controllers/push-notifications"),c=e("../../../../shared/constants/metametrics");const l=e=>e.replace("_","-");n.getNormalisedLocale=l;n.NotificationServicesPushControllerInit=({controllerMessenger:e,initMessenger:t,persistedState:n,getController:u})=>{const d=new r.Controller({messenger:e,state:{...r.defaultState,...n.NotificationServicesPushController},env:{apiKey:"AIzaSyAA6MJdRkQ00zNh_moTLwxCSxcg3vznbBM",authDomain:"notifications-faf39.firebaseapp.com",storageBucket:"notifications-faf39.appspot.com",projectId:"notifications-faf39",messagingSenderId:"824598429541",appId:"1:824598429541:web:3016d3c90f1f19a6beab8c",measurementId:"G-1FGDTTCWX5",vapidKey:"BBbjhCfHvwIqRsUrBvpfx0viLJIzWHp-beyw8-I124jeZlhNGDOegS_0_I029fFb2stzRuaNkCdTAf9F3I2m3wc"},config:{isPushFeatureEnabled:o.isManifestV3&&!0,platform:"extension",pushService:{createRegToken:s.createRegToken,deleteRegToken:s.deleteRegToken,subscribeToPushNotifications:(0,s.createSubscribeToPushNotifications)({messenger:e,onReceivedHandler:a.onPushNotificationReceived,onClickHandler:a.onPushNotificationClicked})},getLocale:()=>l(u("PreferencesController").state.currentLocale)}});return t.subscribe("NotificationServicesPushController:onNewNotifications",e=>{const n=(0,i.hasProperty)(e,"chain_id")?e.chain_id:null;t.call("MetaMetricsController:trackEvent",{category:c.MetaMetricsEventCategory.PushNotifications,event:c.MetaMetricsEventName.PushNotificationReceived,properties:{notification_id:e.id,notification_type:e.type,chain_id:n}})}),t.subscribe("NotificationServicesPushController:pushNotificationClicked",e=>{const n=(0,i.hasProperty)(e,"chain_id")?e.chain_id:null;t.call("MetaMetricsController:trackEvent",{category:c.MetaMetricsEventCategory.PushNotifications,event:c.MetaMetricsEventName.PushNotificationClicked,properties:{notification_id:e.id,notification_type:e.type,chain_id:n}})}),{controller:d}}}}},{package:"$root$",file:"app/scripts/controller-init/notifications/notification-services-push-controller-init.ts"}],[162,{"../controllers/onboarding":208},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.OnboardingControllerInit=void 0;var r,s=(r=e("../controllers/onboarding"))&&r.__esModule?r:{default:r};n.OnboardingControllerInit=({controllerMessenger:e,persistedState:t})=>({controller:new s.default({state:t.OnboardingController,messenger:e})})}}},{package:"$root$",file:"app/scripts/controller-init/onboarding-controller-init.ts"}],[163,{"../controllers/permissions":212,"../controllers/permissions/snaps/specifications":214,"@metamask/permission-controller":2334},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.PermissionControllerInit=void 0;var r=e("@metamask/permission-controller"),s=e("../controllers/permissions"),i=e("../controllers/permissions/snaps/specifications");n.PermissionControllerInit=({controllerMessenger:e,persistedState:t,initMessenger:n,getController:o})=>{const a=o("ApprovalController"),c=o("KeyringController");return{controller:new r.PermissionController({state:t.PermissionController,messenger:e,caveatSpecifications:(0,s.getCaveatSpecifications)({listAccounts:n.call.bind(n,"AccountsController:listAccounts"),findNetworkClientIdByChainId:n.call.bind(n,"NetworkController:findNetworkClientIdByChainId"),isNonEvmScopeSupported:n.call.bind(n,"MultichainRouter:isSupportedScope"),getNonEvmAccountAddresses:n.call.bind(n,"MultichainRouter:getSupportedAccounts")}),permissionSpecifications:{...(0,s.getPermissionSpecifications)(),...(0,i.getSnapPermissionSpecifications)(n,{addAndShowApprovalRequest:a.addAndShowApprovalRequest.bind(a),addNewKeyring:c.addNewKeyring.bind(c)})},unrestrictedMethods:s.unrestrictedMethods})}}}}},{package:"$root$",file:"app/scripts/controller-init/permission-controller-init.ts"}],[164,{"../../../shared/constants/permissions":5804,"@metamask/permission-log-controller":2343},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.PermissionLogControllerInit=void 0;var r=e("@metamask/permission-log-controller"),s=e("../../../shared/constants/permissions");n.PermissionLogControllerInit=({controllerMessenger:e,persistedState:t})=>({controller:new r.PermissionLogController({messenger:e,state:t.PermissionLogController,restrictedMethods:new Set(Object.keys(s.RestrictedMethods))})})}}},{package:"$root$",file:"app/scripts/controller-init/permission-log-controller-init.ts"}],[165,{"@metamask/phishing-controller":2348,"@metamask/utils":2908},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.PhishingControllerInit=void 0;var r=e("@metamask/phishing-controller");e("@metamask/utils");n.PhishingControllerInit=({controllerMessenger:e,persistedState:t})=>({controller:new r.PhishingController({messenger:e,state:t.PhishingController,hotlistRefreshInterval:undefined,stalelistRefreshInterval:undefined})})}}},{package:"$root$",file:"app/scripts/controller-init/phishing-controller-init.ts"}],[166,{"../controllers/preferences-controller":216},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.PreferencesControllerInit=void 0;var r=e("../controllers/preferences-controller");n.PreferencesControllerInit=({controllerMessenger:e,persistedState:t,initLangCode:n})=>({controller:new r.PreferencesController({state:{currentLocale:n??"",...t.PreferencesController},messenger:e})})}}},{package:"$root$",file:"app/scripts/controller-init/preferences-controller-init.ts"}],[167,{"@metamask/assets-controllers":1203},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.RatesControllerInit=void 0;var r=e("@metamask/assets-controllers");n.RatesControllerInit=({controllerMessenger:e,persistedState:t})=>({memStateKey:"MultichainRatesController",persistedStateKey:"MultichainRatesController",controller:new r.RatesController({state:t.MultichainRatesController,messenger:e,includeUsdRate:!0})})}}},{package:"$root$",file:"app/scripts/controller-init/rates-controller-init.ts"}],[168,{"../../../development/build/constants":562,"../lib/util":332,"@metamask/remote-feature-flag-controller":2478,"@metamask/utils":2908},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.RemoteFeatureFlagControllerInit=void 0,n.getConfigForRemoteFeatureFlagRequest=l;var r=e("@metamask/utils"),s=e("@metamask/remote-feature-flag-controller"),i=e("../../../development/build/constants"),o=e("../lib/util");const a={flask:s.DistributionType.Flask,main:s.DistributionType.Main,beta:s.DistributionType.Beta,experimental:s.DistributionType.Main},c={[i.ENVIRONMENT.DEVELOPMENT]:s.EnvironmentType.Development,[i.ENVIRONMENT.RELEASE_CANDIDATE]:s.EnvironmentType.ReleaseCandidate,[i.ENVIRONMENT.PRODUCTION]:s.EnvironmentType.Production};function l(){(0,r.assert)("main","METAMASK_BUILD_TYPE is not defined"),(0,r.assert)("production","METAMASK_ENVIRONMENT is not defined");const e="main",t=a[e]||s.DistributionType.Main;let n=c.production||s.EnvironmentType.Development;return{distribution:t,environment:n}}n.RemoteFeatureFlagControllerInit=({controllerMessenger:e,initMessenger:t})=>{const n=t.call("PreferencesController:getState"),{distribution:r,environment:i}=l(),a=new s.RemoteFeatureFlagController({messenger:e,fetchInterval:9e5,disabled:!n.useExternalServices,getMetaMetricsId:()=>t.call("MetaMetricsController:getMetaMetricsId"),clientConfigApiService:new s.ClientConfigApiService({fetch:globalThis.fetch.bind(globalThis),config:{client:s.ClientType.Extension,distribution:r,environment:i}})});return t.subscribe("PreferencesController:stateChange",(0,o.previousValueComparator)((e,t)=>{const{useExternalServices:n}=e,{useExternalServices:r}=t;return r&&!n?(a.enable(),a.updateRemoteFeatureFlags().catch(e=>{console.error("Failed to update remote feature flags:",e)})):!r&&n&&a.disable(),!0},n)),{controller:a}}}}},{package:"$root$",file:"app/scripts/controller-init/remote-feature-flag-controller-init.ts"}],[169,{"./oauth-service-init":170,"./seedless-onboarding-controller-init":171},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"OAuthServiceInit",{enumerable:!0,get:function(){return r.OAuthServiceInit}}),Object.defineProperty(n,"SeedlessOnboardingControllerInit",{enumerable:!0,get:function(){return s.SeedlessOnboardingControllerInit}});var r=e("./oauth-service-init"),s=e("./seedless-onboarding-controller-init")}}},{package:"$root$",file:"app/scripts/controller-init/seedless-onboarding/index.ts"}],[17,{"../controllers/app-metadata":200},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.AppMetadataControllerInit=void 0;var r,s=(r=e("../controllers/app-metadata"))&&r.__esModule?r:{default:r};n.AppMetadataControllerInit=({controllerMessenger:e,persistedState:t,currentMigrationVersion:n})=>({controller:new s.default({state:t.AppMetadataController,messenger:e,currentAppVersion:"13.7.0",currentMigrationVersion:n})})}}},{package:"$root$",file:"app/scripts/controller-init/app-metadata-controller-init.ts"}],[170,{"../../services/oauth/oauth-service":554,"../../services/oauth/web-authenticator-factory":557},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.OAuthServiceInit=void 0;var r,s=(r=e("../../services/oauth/oauth-service"))&&r.__esModule?r:{default:r},i=e("../../services/oauth/web-authenticator-factory");n.OAuthServiceInit=e=>{const{controllerMessenger:t,getController:n}=e,r=n("MetaMetricsController");return{controller:new s.default({messenger:t,env:{googleClientId:"795351133007-6d0s31utj13knv440fgjo2ur93241gb6.apps.googleusercontent.com",appleClientId:"io.metamask.appleloginclient.prod"},webAuthenticator:(0,i.webAuthenticatorFactory)(),bufferedTrace:r.bufferedTrace.bind(r),bufferedEndTrace:r.bufferedEndTrace.bind(r)}),memStateKey:null,persistedStateKey:null}}}}},{package:"$root$",file:"app/scripts/controller-init/seedless-onboarding/oauth-service-init.ts"}],[171,{"../../lib/encryptor-factory":251,"../../services/oauth/config":551,"@metamask/seedless-onboarding-controller":2505},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SeedlessOnboardingControllerInit=void 0;var r=e("@metamask/seedless-onboarding-controller"),s=e("../../lib/encryptor-factory"),i=e("../../services/oauth/config");n.SeedlessOnboardingControllerInit=e=>{const{initMessenger:t,controllerMessenger:n,persistedState:o}=e,a=(0,s.encryptorFactory)(6e5),c=(0,i.isDevOrTestBuild)()?r.Web3AuthNetwork.Devnet:r.Web3AuthNetwork.Mainnet;return{controller:new r.SeedlessOnboardingController({messenger:n,state:o.SeedlessOnboardingController,network:c,passwordOutdatedCacheTTL:15e3,refreshJWTToken:(...e)=>t.call("OAuthService:getNewRefreshToken",...e),revokeRefreshToken:(...e)=>t.call("OAuthService:revokeRefreshToken",...e),renewRefreshToken:(...e)=>t.call("OAuthService:renewRefreshToken",...e),encryptor:{decrypt:(e,t)=>a.decrypt(e,t),decryptWithDetail:(e,t)=>a.decryptWithDetail(e,t),decryptWithKey(e,t){let n;return n="string"==typeof t?JSON.parse(t):t,a.decryptWithKey(e,n)},encrypt:(e,t)=>a.encrypt(e,t),encryptWithDetail:(e,t)=>a.encryptWithDetail(e,t),importKey:e=>a.importKey(e)}})}}}}},{package:"$root$",file:"app/scripts/controller-init/seedless-onboarding/seedless-onboarding-controller-init.ts"}],[172,{"../lib/WeakRefObjectMap":232,"@metamask/selected-network-controller":2510},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SelectedNetworkControllerInit=void 0;var r=e("@metamask/selected-network-controller"),s=e("../lib/WeakRefObjectMap");n.SelectedNetworkControllerInit=({controllerMessenger:e,persistedState:t})=>({controller:new r.SelectedNetworkController({state:t.SelectedNetworkController,messenger:e,domainProxyMap:new s.WeakRefObjectMap})})}}},{package:"$root$",file:"app/scripts/controller-init/selected-network-controller-init.ts"}],[173,{"../../lib/ppom/ppom-util":273,"@metamask/keyring-controller":2070,"@metamask/shield-controller":2514},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ShieldControllerInit=void 0;var r=e("@metamask/shield-controller"),s=e("@metamask/keyring-controller"),i=e("../../lib/ppom/ppom-util");const o=e=>{const t=(0,r.parseSignatureRequestMethod)(e),n=e.version===s.SignTypedDataVersion.V3||e.version===s.SignTypedDataVersion.V4,o=n?[e.messageParams.from,e.messageParams.data]:[e.messageParams.data,e.messageParams.from],a={id:e.id,jsonrpc:"2.0",method:t,params:o},c=(0,i.normalizeSignatureRequest)(a);if(null!=c&&c.params&&n){const t=c.params;e.messageParams.data=t[1]}return e};n.ShieldControllerInit=e=>{const{controllerMessenger:t,initMessenger:n,persistedState:s}=e;return{controller:new r.ShieldController({messenger:t,state:s.ShieldController,normalizeSignatureRequest:o,backend:new r.ShieldRemoteBackend({getAccessToken:()=>n.call("AuthenticationController:getBearerToken"),fetch:(e,t)=>fetch(e,t),baseUrl:"https://ruleset-engine.dev-api.cx.metamask.io"})})}}}}},{package:"$root$",file:"app/scripts/controller-init/shield/shield-controller-init.ts"}],[1737,{"@metamask/keyring-controller":2070},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.GetCallsStatusCode=n.EIP7682ErrorCode=n.EIP5792ErrorCode=n.SupportedCapabilities=n.MessageType=n.KEYRING_TYPES_SUPPORTING_7702=n.VERSION=void 0;const r=e("@metamask/keyring-controller");var s,i,o,a,c;n.VERSION="2.0.0",n.KEYRING_TYPES_SUPPORTING_7702=[r.KeyringTypes.hd,r.KeyringTypes.simple],function(e){e.SendTransaction="eth_sendTransaction"}(s||(n.MessageType=s={})),function(e){e.AuxiliaryFunds="auxiliaryFunds"}(i||(n.SupportedCapabilities=i={})),function(e){e[e.UnsupportedNonOptionalCapability=5700]="UnsupportedNonOptionalCapability",e[e.UnsupportedChainId=5710]="UnsupportedChainId",e[e.UnknownBundleId=5730]="UnknownBundleId",e[e.RejectedUpgrade=5750]="RejectedUpgrade"}(o||(n.EIP5792ErrorCode=o={})),function(e){e[e.UnsupportedAsset=5771]="UnsupportedAsset",e[e.UnsupportedChain=5772]="UnsupportedChain",e[e.MalformedRequiredAssets=5773]="MalformedRequiredAssets"}(a||(n.EIP7682ErrorCode=a={})),function(e){e[e.PENDING=100]="PENDING",e[e.CONFIRMED=200]="CONFIRMED",e[e.FAILED_OFFCHAIN=400]="FAILED_OFFCHAIN",e[e.REVERTED=500]="REVERTED",e[e.REVERTED_PARTIAL=600]="REVERTED_PARTIAL"}(c||(n.GetCallsStatusCode=c={}))}}},{package:"@metamask/eip-5792-middleware",file:"node_modules/@metamask/eip-5792-middleware/dist/constants.cjs"}],[1738,{"../constants.cjs":1737,"@metamask/rpc-errors":2485,"@metamask/transaction-controller":2862},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getCallsStatus=void 0;const r=e("@metamask/rpc-errors"),s=e("@metamask/transaction-controller"),i=e("../constants.cjs");n.getCallsStatus=function(e,t){const n=e.call("TransactionController:getState").transactions.filter(e=>e.batchId===t);if(!n?.length)throw new r.JsonRpcError(i.EIP5792ErrorCode.UnknownBundleId,"No matching bundle found");const o=n[0],{chainId:a,txReceipt:c}=o,l=function(e){const{hash:t,status:n}=e;if(n===s.TransactionStatus.confirmed)return i.GetCallsStatusCode.CONFIRMED;if(n===s.TransactionStatus.failed)return t?i.GetCallsStatusCode.REVERTED:i.GetCallsStatusCode.FAILED_OFFCHAIN;if(n===s.TransactionStatus.dropped)return i.GetCallsStatusCode.REVERTED;return i.GetCallsStatusCode.PENDING}(o),u=c,d=u?.logs??[],h=u&&[{blockHash:u.blockHash,blockNumber:u.blockNumber,gasUsed:u.gasUsed,logs:d.map(e=>({address:e.address,data:e.data,topics:e.topics})),status:u.status,transactionHash:u.transactionHash}];return{version:i.VERSION,id:t,chainId:a,atomic:!0,status:l,receipts:h}}}}},{package:"@metamask/eip-5792-middleware",file:"node_modules/@metamask/eip-5792-middleware/dist/hooks/getCallsStatus.cjs"}],[1739,{"../constants.cjs":1737,"../utils.cjs":1746},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getCapabilities=void 0;const r=e("../constants.cjs"),s=e("../utils.cjs");n.getCapabilities=async function(e,t,n,i){const{getDismissSmartAccountSuggestionEnabled:o,getIsSmartTransaction:a,isAtomicBatchSupported:c,isRelaySupported:l,getSendBundleSupportedChains:u,isAuxiliaryFundsSupported:d}=e;let h=i?.map(e=>e.toLowerCase());if(!h?.length){const e=t.call("NetworkController:getState").networkConfigurationsByChainId;h=Object.keys(e)}const p=await c({address:n,chainIds:h}),m=await async function(e,t,n,r,s,i){const o=i.call("PreferencesController:getState").useTransactionSimulations,a=await Promise.all(t.map(({chainId:e})=>e).map(e=>r(e))),c=await s(e),l=t.map((e,t)=>({...e,relaySupportedForChain:a[t]}));return e.reduce((e,t)=>{const r=l.find(({chainId:e})=>e===t)??{},{isSupported:s=!1,relaySupportedForChain:i}=r,a=n(t),u=c[t]??!1;return o&&(a&&u||s&&i)&&(e[t]={alternateGasFees:{supported:!0}}),e},{})}(h,p,a,l,u,t);return h.reduce((e,i)=>{const a=p.find(({chainId:e})=>e===i)??{},{delegationAddress:c,isSupported:l,upgradeContractAddress:u}=a,h=o();let m=!1;try{const e=(0,s.getAccountKeyringType)(n,t);m=r.KEYRING_TYPES_SUPPORTING_7702.includes(e)}catch{}if(!l&&!(!h&&u&&!c&&m))return e;const g=l?"supported":"ready",f=i;return e[f]===undefined&&(e[f]={}),e[f].atomic={status:g},m&&d(i)&&(e[f].auxiliaryFunds={supported:!0}),e},m)}}}},{package:"@metamask/eip-5792-middleware",file:"node_modules/@metamask/eip-5792-middleware/dist/hooks/getCapabilities.cjs"}],[174,{"../../../../shared/constants/smartTransactions":5810,"../../../../shared/modules/selectors":5916,"@metamask/smart-transactions-controller":2527},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SmartTransactionsControllerInit=void 0;var r=e("@metamask/smart-transactions-controller"),s=e("../../../../shared/constants/smartTransactions"),i=e("../../../../shared/modules/selectors");n.SmartTransactionsControllerInit=e=>{const{controllerMessenger:t,initMessenger:n,persistedState:o,getUIState:a,getAccountType:c,getDeviceModel:l,getHardwareTypeForMetric:u,trace:d}=e;return{controller:new r.SmartTransactionsController({supportedChainIds:(0,s.getAllowedSmartTransactionsChainIds)(),clientId:r.ClientId.Extension,trackMetaMetricsEvent:n.call.bind(n,"MetaMetricsController:trackEvent"),state:o.SmartTransactionsController,messenger:t,getFeatureFlags:()=>{const e={metamask:a()};return(0,i.getFeatureFlagsByChainId)(e)},getMetaMetricsProps:async()=>{var e;const t=a(),{internalAccounts:n}=t,r=null==n?void 0:n.selectedAccount,s=r?null==n||null===(e=n.accounts)||void 0===e?void 0:e[r]:null,i=(null==s?void 0:s.address)??"";if(!i)return{accountHardwareType:undefined,accountType:undefined,deviceModel:undefined};return{accountHardwareType:await u(i),accountType:await c(i),deviceModel:await l(i)}},trace:d})}}}}},{package:"$root$",file:"app/scripts/controller-init/smart-transactions/smart-transactions-controller-init.ts"}],[1740,{"../constants.cjs":1737,"../utils.cjs":1746,"@metamask/rpc-errors":2485,"@metamask/transaction-controller":2862,"@metamask/utils":2908,lodash:4816,uuid:5732},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.processSendCalls=void 0;const r=e("@metamask/rpc-errors"),s=e("@metamask/transaction-controller"),i=e("@metamask/utils"),o=e("lodash"),a=e("uuid"),c=e("../constants.cjs"),l=e("../utils.cjs");function u(e){const{version:t}=e;if(t!==c.VERSION)throw r.rpcErrors.invalidInput(`Version not supported: Got ${t}, expected ${c.VERSION}`)}function d(e,t){const{chainId:n}=e;if(n&&n.toLowerCase()!==t.toLowerCase())throw r.rpcErrors.invalidParams(`Chain ID must match the dApp selected network: Got ${n}, expected ${t}`)}function h(e,t,n){const{calls:s,capabilities:i,chainId:o}=e,a=[...Object.keys(i??{}).filter(e=>e!==c.SupportedCapabilities.AuxiliaryFunds.toString()&&!0!==i?.[e].optional),...s.flatMap(e=>Object.keys(e.capabilities??{}).filter(t=>t!==c.SupportedCapabilities.AuxiliaryFunds.toString()&&!0!==e.capabilities?.[t].optional))];if(a?.length)throw new r.JsonRpcError(c.EIP5792ErrorCode.UnsupportedNonOptionalCapability,`Unsupported non-optional capabilities: ${a.join(", ")}`);i?.auxiliaryFunds&&function({auxiliaryFunds:e,chainId:t,keyringType:n,isAuxiliaryFundsSupported:s}){if(e.optional)return;const i=c.KEYRING_TYPES_SUPPORTING_7702.includes(n);if(!i)throw new r.JsonRpcError(c.EIP5792ErrorCode.UnsupportedNonOptionalCapability,`Unsupported non-optional capability: ${c.SupportedCapabilities.AuxiliaryFunds}`);if(!s(t))throw new r.JsonRpcError(c.EIP7682ErrorCode.UnsupportedChain,`The wallet no longer supports auxiliary funds on the requested chain: ${t}`);if(!e?.requiredAssets)return;for(const t of e.requiredAssets)if("erc20"!==t.standard)throw new r.JsonRpcError(c.EIP7682ErrorCode.UnsupportedAsset,`The requested asset ${t.address} is not available through the wallets auxiliary fund system: unsupported token standard ${t.standard}`)}({auxiliaryFunds:i.auxiliaryFunds,chainId:o,keyringType:t,isAuxiliaryFundsSupported:n})}function p(e){if(e.capabilities?.auxiliaryFunds?.requiredAssets){const{requiredAssets:t}=e.capabilities.auxiliaryFunds,n=(0,o.groupBy)(t,e=>`${e.address.toLowerCase()}-${e.standard}`),r=Object.values(n).map(e=>{if(1===e.length)return e[0];const t=e.reduce((e,t)=>e+BigInt(t.amount),0n);return{...e[0],amount:(0,i.add0x)(t.toString(16))}});e.capabilities.auxiliaryFunds.requiredAssets=r}}n.processSendCalls=async function(e,t,n,o){const{addTransactionBatch:m,addTransaction:g,getDismissSmartAccountSuggestionEnabled:f,isAtomicBatchSupported:y,validateSecurity:w,isAuxiliaryFundsSupported:v}=e,{calls:b,from:k}=n,{networkClientId:C,origin:S}=o,M=b.map(e=>({params:e})),{chainId:A}=t.call("NetworkController:getNetworkClientById",C).configuration,T=k??t.call("AccountsController:getSelectedAccount").address,E=(0,a.v4)(),I=w.bind(null,E);let _;return _=1===Object.keys(M).length?await async function({addTransaction:e,chainId:t,from:n,messenger:r,networkClientId:o,origin:m,securityAlertId:g,sendCalls:f,transactions:y,validateSecurity:w,isAuxiliaryFundsSupported:v}){const b=(0,l.getAccountKeyringType)(n,r);!function(e,t,n,r){u(e),h(e,n,r),d(e,t)}(f,t,b,v);const k={from:n,...y[0].params,type:s.TransactionEnvelopeType.feeMarket},C={method:c.MessageType.SendTransaction,params:[k],origin:m};w(C,t),p(f);const S=function(){const e=(0,a.v4)(),t=new Uint8Array((0,a.parse)(e));return(0,i.bytesToHex)(t)}();return await e(k,{networkClientId:o,origin:m,securityAlertResponse:{securityAlertId:g},batchId:S}),S}({addTransaction:g,chainId:A,from:T,messenger:t,networkClientId:C,origin:S,securityAlertId:E,sendCalls:n,transactions:M,validateSecurity:I,isAuxiliaryFundsSupported:v}):await async function({addTransactionBatch:e,isAtomicBatchSupported:t,chainId:n,from:s,getDismissSmartAccountSuggestionEnabled:i,networkClientId:o,messenger:a,origin:m,sendCalls:g,securityAlertId:f,transactions:y,validateSecurity:w,isAuxiliaryFundsSupported:v}){const b=await t({address:s,chainIds:[n]}),k=b?.[0],C=(0,l.getAccountKeyringType)(s,a),S=i();(function(e,t,n,s,i,o){u(e),function(e,t,n){if(d(e,t),!n)throw new r.JsonRpcError(c.EIP5792ErrorCode.UnsupportedChainId,`EIP-7702 not supported on chain: ${t}`)}(e,t,s),h(e,i,o),function(e,t,n){if(t?.delegationAddress)return;if(e)throw new r.JsonRpcError(c.EIP5792ErrorCode.RejectedUpgrade,"EIP-7702 upgrade disabled by the user");if(!c.KEYRING_TYPES_SUPPORTING_7702.includes(n))throw new r.JsonRpcError(c.EIP5792ErrorCode.RejectedUpgrade,"EIP-7702 upgrade not supported on account")}(n,s,i)})(g,n,S,k,C,v),p(g);const M=await e({from:s,networkClientId:o,origin:m,securityAlertId:f,transactions:y,validateSecurity:w});return M.batchId}({addTransactionBatch:m,isAtomicBatchSupported:y,chainId:A,from:T,getDismissSmartAccountSuggestionEnabled:f,messenger:t,networkClientId:C,origin:S,sendCalls:n,securityAlertId:E,transactions:M,validateSecurity:I,isAuxiliaryFundsSupported:v}),{id:_}}}}},{package:"@metamask/eip-5792-middleware",file:"node_modules/@metamask/eip-5792-middleware/dist/hooks/processSendCalls.cjs"}],[1741,{"./hooks/getCallsStatus.cjs":1738,"./hooks/getCapabilities.cjs":1739,"./hooks/processSendCalls.cjs":1740,"./methods/wallet_getCallsStatus.cjs":1742,"./methods/wallet_getCapabilities.cjs":1743,"./methods/wallet_sendCalls.cjs":1744},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.walletGetCapabilities=n.walletGetCallsStatus=n.walletSendCalls=n.getCapabilities=n.getCallsStatus=n.processSendCalls=void 0;var r=e("./hooks/processSendCalls.cjs");Object.defineProperty(n,"processSendCalls",{enumerable:!0,get:function(){return r.processSendCalls}});var s=e("./hooks/getCallsStatus.cjs");Object.defineProperty(n,"getCallsStatus",{enumerable:!0,get:function(){return s.getCallsStatus}});var i=e("./hooks/getCapabilities.cjs");Object.defineProperty(n,"getCapabilities",{enumerable:!0,get:function(){return i.getCapabilities}});var o=e("./methods/wallet_sendCalls.cjs");Object.defineProperty(n,"walletSendCalls",{enumerable:!0,get:function(){return o.walletSendCalls}});var a=e("./methods/wallet_getCallsStatus.cjs");Object.defineProperty(n,"walletGetCallsStatus",{enumerable:!0,get:function(){return a.walletGetCallsStatus}});var c=e("./methods/wallet_getCapabilities.cjs");Object.defineProperty(n,"walletGetCapabilities",{enumerable:!0,get:function(){return c.walletGetCapabilities}})}}},{package:"@metamask/eip-5792-middleware",file:"node_modules/@metamask/eip-5792-middleware/dist/index.cjs"}],[1742,{"../types.cjs":1745,"../utils.cjs":1746,"@metamask/rpc-errors":2485},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.walletGetCallsStatus=void 0;const r=e("@metamask/rpc-errors"),s=e("../types.cjs"),i=e("../utils.cjs");n.walletGetCallsStatus=async function(e,t,{getCallsStatus:n}){if(!n)throw r.rpcErrors.methodNotSupported();(0,i.validateParams)(e.params,s.GetCallsStatusStruct);const o=e.params[0];t.result=await n(o,e)}}}},{package:"@metamask/eip-5792-middleware",file:"node_modules/@metamask/eip-5792-middleware/dist/methods/wallet_getCallsStatus.cjs"}],[1743,{"../types.cjs":1745,"../utils.cjs":1746,"@metamask/rpc-errors":2485},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.walletGetCapabilities=void 0;const r=e("@metamask/rpc-errors"),s=e("../types.cjs"),i=e("../utils.cjs");n.walletGetCapabilities=async function(e,t,{getAccounts:n,getCapabilities:o}){if(!o)throw r.rpcErrors.methodNotSupported();(0,i.validateParams)(e.params,s.GetCapabilitiesStruct);const a=e.params[0],c=e.params[1];await(0,i.validateAndNormalizeKeyholder)(a,e,{getAccounts:n});const l=await o(a,c,e);t.result=l}}}},{package:"@metamask/eip-5792-middleware",file:"node_modules/@metamask/eip-5792-middleware/dist/methods/wallet_getCapabilities.cjs"}],[1744,{"../types.cjs":1745,"../utils.cjs":1746,"@metamask/rpc-errors":2485},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.walletSendCalls=void 0;const r=e("@metamask/rpc-errors"),s=e("../types.cjs"),i=e("../utils.cjs");n.walletSendCalls=async function(e,t,{getAccounts:n,processSendCalls:o}){if(!o)throw r.rpcErrors.methodNotSupported();(0,i.validateParams)(e.params,s.SendCallsStruct);const a=e.params[0],c=a.from?await(0,i.validateAndNormalizeKeyholder)(a.from,e,{getAccounts:n}):undefined,l={...a,from:c};t.result=await o(l,e)}}}},{package:"@metamask/eip-5792-middleware",file:"node_modules/@metamask/eip-5792-middleware/dist/methods/wallet_sendCalls.cjs"}],[1745,{"@metamask/superstruct":2813,"@metamask/utils":2908},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SendCallsStruct=n.CapabilitiesStruct=n.GetCapabilitiesStruct=n.GetCallsStatusStruct=void 0;const r=e("@metamask/superstruct"),s=e("@metamask/utils");n.GetCallsStatusStruct=(0,r.tuple)([s.StrictHexStruct]),n.GetCapabilitiesStruct=(0,r.tuple)([s.HexChecksumAddressStruct,(0,r.optional)((0,r.array)(s.StrictHexStruct))]);const i=(0,r.type)({address:(0,r.nonempty)(s.HexChecksumAddressStruct),amount:(0,r.nonempty)(s.StrictHexStruct),standard:(0,r.nonempty)((0,r.string)())});n.CapabilitiesStruct=(0,r.record)((0,r.string)(),(0,r.type)({optional:(0,r.optional)((0,r.boolean)()),requiredAssets:(0,r.optional)((0,r.array)(i))})),n.SendCallsStruct=(0,r.tuple)([(0,r.object)({version:(0,r.nonempty)((0,r.string)()),id:(0,r.optional)(s.StrictHexStruct),from:(0,r.optional)(s.HexChecksumAddressStruct),chainId:s.StrictHexStruct,atomicRequired:(0,r.boolean)(),calls:(0,r.array)((0,r.object)({to:(0,r.optional)(s.HexChecksumAddressStruct),data:(0,r.optional)(s.StrictHexStruct),value:(0,r.optional)(s.StrictHexStruct),capabilities:(0,r.optional)(n.CapabilitiesStruct)})),capabilities:(0,r.optional)(n.CapabilitiesStruct)})])}}},{package:"@metamask/eip-5792-middleware",file:"node_modules/@metamask/eip-5792-middleware/dist/types.cjs"}],[1746,{"./constants.cjs":1737,"@metamask/rpc-errors":2485,"@metamask/superstruct":2813},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.resemblesAddress=n.validateParams=n.validateAndNormalizeKeyholder=n.getAccountKeyringType=void 0;const r=e("@metamask/rpc-errors"),s=e("@metamask/superstruct"),i=e("./constants.cjs");function o(e){return 42===e.length}n.getAccountKeyringType=function(e,t){const{accounts:n}=t.call("AccountsController:getState").internalAccounts,s=Object.values(n).find(t=>t.address.toLowerCase()===e.toLowerCase()),o=s?.metadata?.keyring?.type;if(!o)throw new r.JsonRpcError(i.EIP5792ErrorCode.RejectedUpgrade,"EIP-7702 upgrade not supported as account type is unknown");return o},n.validateAndNormalizeKeyholder=async function(e,t,{getAccounts:n}){if("string"==typeof e&&e.length>0&&o(e)){const s=(await n(t)).map(e=>e.toLowerCase()),i=e.toLowerCase();if(s.includes(i))return i;throw r.providerErrors.unauthorized()}throw r.rpcErrors.invalidParams({message:"Invalid parameters: must provide an Ethereum address."})},n.validateParams=function(e,t){const[n]=(0,s.validate)(e,t);if(n)throw r.rpcErrors.invalidParams(function(e,t){return`${t}\n\n${e.failures().map(e=>`${e.path.join(" > ")}${e.path.length?" - ":""}${e.message}`).join("\n")}`}(n,"Invalid params"))},n.resemblesAddress=o}}},{package:"@metamask/eip-5792-middleware",file:"node_modules/@metamask/eip-5792-middleware/dist/utils.cjs"}],[1747,{"@ethersproject/providers":735,"@metamask/base-controller":1268,"@metamask/controller-utils":1349,"@metamask/utils":2908,"punycode/punycode.js":5135},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,s,i,o,a,c=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},l=this&&this.__classPrivateFieldSet||function(e,t,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n};Object.defineProperty(n,"__esModule",{value:!0}),n.EnsController=n.DEFAULT_ENS_NETWORK_MAP=void 0;const u=e("@ethersproject/providers"),d=e("@metamask/base-controller"),h=e("@metamask/controller-utils"),p=e("@metamask/utils"),m=e("punycode/punycode.js"),g=(0,p.createProjectLogger)("ens-controller");n.DEFAULT_ENS_NETWORK_MAP={1:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",3:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",4:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",5:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",17e3:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",11155111:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"};const f={ensEntries:{persist:!0,anonymous:!1},ensResolutionsByAddress:{persist:!0,anonymous:!1}},y={ensEntries:{},ensResolutionsByAddress:{}};class w extends d.BaseController{constructor({registriesByChainId:e=n.DEFAULT_ENS_NETWORK_MAP,messenger:t,state:a={},onNetworkDidChange:l}){super({name:"EnsController",metadata:f,messenger:t,state:{...y,ensEntries:Object.fromEntries(Object.entries(e).map(([e,t])=>[(0,h.toHex)(e),{".":{address:t,chainId:(0,h.toHex)(e),ensName:"."}}])),...a}}),r.add(this),s.set(this,null),c(this,r,"m",i).call(this,e),l&&l(({selectedNetworkClientId:t})=>{this.resetState(),c(this,r,"m",o).call(this,t,e)})}resetState(){this.update(e=>{e.ensResolutionsByAddress={}})}clear(){this.update(e=>{e.ensEntries={}})}delete(e,t){const n=(0,h.normalizeEnsName)(t);return!!((0,h.isSafeDynamicKey)(e)&&n&&this.state.ensEntries[e]&&this.state.ensEntries[e][n])&&(this.update(t=>{delete t.ensEntries[e][n],0===Object.keys(t.ensEntries[e]).length&&delete t.ensEntries[e]}),!0)}get(e,t){const n=(0,h.normalizeEnsName)(t);return n&&this.state.ensEntries[e]&&this.state.ensEntries[e][n]||null}set(e,t,n){if(!Number.isInteger(Number.parseInt(e,10))||!t||"string"!=typeof t||n&&!(0,h.isValidHexAddress)(n))throw new Error(`Invalid ENS entry: { chainId:${e}, ensName:${t}, address:${n}}`);const r=(0,h.normalizeEnsName)(t);if(!r)throw new Error(`Invalid ENS name: ${t}`);const s=n?(0,h.toChecksumHexAddress)(n):null,i=this.state.ensEntries[e];return(!i?.[r]||i[r].address!==s)&&(this.update(t=>{t.ensEntries={...this.state.ensEntries,[e]:{...this.state.ensEntries[e],[r]:{address:s,chainId:e,ensName:r}}}}),!0)}async reverseResolveAddress(e){if(!c(this,s,"f"))return undefined;const t=(0,h.toChecksumHexAddress)(e);if(this.state.ensResolutionsByAddress[t])return this.state.ensResolutionsByAddress[t];let n,r;try{n=await c(this,s,"f").lookupAddress(t)}catch(e){return g(e),undefined}if(!n)return undefined;try{r=await c(this,s,"f").resolveName(n)}catch(e){return g(e),undefined}return r?"0x0000000000000000000000000000000000000000"===r||"0x"===r||(0,h.toChecksumHexAddress)(r)!==t?undefined:(this.update(e=>{e.ensResolutionsByAddress[t]=(0,m.toASCII)(n)}),n):undefined}}n.EnsController=w,s=new WeakMap,r=new WeakSet,i=function(e){const{selectedNetworkClientId:t}=this.messagingSystem.call("NetworkController:getState");c(this,r,"m",o).call(this,t,e)},o=function(e,t){const{configuration:{chainId:n},provider:i}=this.messagingSystem.call("NetworkController:getNetworkClientById",e);t&&t[parseInt(n,16)]&&c(this,r,"m",a).call(this,n)?l(this,s,new u.Web3Provider(i,{chainId:(0,h.convertHexToDecimal)(n),name:h.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP[n],ensAddress:t[parseInt(n,16)]}),"f"):l(this,s,null,"f")},a=function(e){return Boolean(this.state.ensEntries[e])},n.default=w}}},{package:"@metamask/ens-controller",file:"node_modules/@metamask/ens-controller/dist/EnsController.cjs"}],[1748,{"./EnsController.cjs":1747},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){r===undefined&&(r=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,s)}:function(e,t,n,r){r===undefined&&(r=n),e[r]=t[n]}),s=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),s(e("./EnsController.cjs"),n)}}},{package:"@metamask/ens-controller",file:"node_modules/@metamask/ens-controller/dist/index.cjs"}],[1749,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,s,i=this&&this.__classPrivateFieldSet||function(e,t,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n},o=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.ErrorReportingService=void 0;n.ErrorReportingService=class{constructor({messenger:e,captureException:t}){this.name="ErrorReportingService",this.state=null,r.set(this,void 0),s.set(this,void 0),i(this,s,e,"f"),i(this,r,t,"f"),o(this,s,"f").registerActionHandler("ErrorReportingService:captureException",o(this,r,"f").bind(this))}captureException(e){o(this,r,"f").call(this,e)}},r=new WeakMap,s=new WeakMap}}},{package:"@metamask/error-reporting-service",file:"node_modules/@metamask/error-reporting-service/dist/error-reporting-service.cjs"}],[175,{"@metamask/snaps-controllers":2536},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.CronjobControllerInit=void 0;var r=e("@metamask/snaps-controllers");n.CronjobControllerInit=({controllerMessenger:e,persistedState:t,getCronjobControllerStorageManager:n})=>({controller:new r.CronjobController({state:t.CronjobController,messenger:e,stateManager:n()}),persistedStateKey:null})}}},{package:"$root$",file:"app/scripts/controller-init/snaps/cronjob-controller-init.ts"}],[1750,{"./error-reporting-service.cjs":1749},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ErrorReportingService=void 0;var r=e("./error-reporting-service.cjs");Object.defineProperty(n,"ErrorReportingService",{enumerable:!0,get:function(){return r.ErrorReportingService}})}}},{package:"@metamask/error-reporting-service",file:"node_modules/@metamask/error-reporting-service/dist/index.cjs"}],[1756,{"./base-filter":1757},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){const r=e("./base-filter");t.exports=class extends r{constructor(){super(),this.allResults=[]}async update(){throw new Error("BaseFilterWithHistory - no update method specified")}addResults(e){this.allResults=this.allResults.concat(e),super.addResults(e)}addInitialResults(e){this.allResults=this.allResults.concat(e),super.addInitialResults(e)}getAllResults(){return this.allResults}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/base-filter-history.js"}],[1757,{"@metamask/safe-event-emitter":2487},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){const r=e("@metamask/safe-event-emitter").default;t.exports=class extends r{constructor(){super(),this.updates=[]}async initialize(){}async update(){throw new Error("BaseFilter - no update method specified")}addResults(e){this.updates=this.updates.concat(e),e.forEach(e=>this.emit("update",e))}addInitialResults(e){}getChangesAndClear(){const e=this.updates;return this.updates=[],e}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/base-filter.js"}],[1758,{"./base-filter":1757,"./getBlocksForRange":1759,"./hexUtils":1760},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){const r=e("./base-filter"),s=e("./getBlocksForRange"),{incrementHexInt:i}=e("./hexUtils");t.exports=class extends r{constructor({provider:e,params:t}){super(),this.type="block",this.provider=e}async update({oldBlock:e,newBlock:t}){const n=t,r=i(e),o=(await s({provider:this.provider,fromBlock:r,toBlock:n})).map(e=>e.hash);this.addResults(o)}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/block-filter.js"}],[1759,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){function r(e){return e===undefined||null===e?e:Number.parseInt(e,16)}function s(e){if(e===undefined||null===e)return e;return"0x"+e.toString(16)}t.exports=async function({provider:e,fromBlock:t,toBlock:n}){t||(t=n);const i=r(t),o=r(n),a=Array(o-i+1).fill().map((e,t)=>i+t).map(s);let c=await Promise.all(a.map(t=>async function(e,t,n){for(let r=0;r<3;r++)try{return e.request({id:1,jsonrpc:"2.0",method:t,params:n})}catch(e){console.error(`provider.request failed: ${e.stack||e.message||e}`)}return null}(e,"eth_getBlockByNumber",[t,!1])));return c=c.filter(e=>null!==e),c}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/getBlocksForRange.js"}],[176,{"../../../../shared/modules/mv3.utils":5909,"@metamask/permission-controller":2334,"@metamask/snaps-controllers":2536,"@metamask/utils":2908},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ExecutionServiceInit=void 0;var r=e("@metamask/snaps-controllers"),s=e("@metamask/utils"),i=e("@metamask/permission-controller"),o=e("../../../../shared/modules/mv3.utils");n.ExecutionServiceInit=({controllerMessenger:e,offscreenPromise:t,setupUntrustedCommunicationEip1193:n})=>{function a(e,t){n({connectionStream:t,sender:{snapId:e},subjectType:i.SubjectType.Snap})}if(o.isManifestV3&&"undefined"!=typeof chrome&&void 0!==chrome.offscreen)return{memStateKey:null,persistedStateKey:null,controller:new r.OffscreenExecutionService({messenger:e,setupSnapProvider:a,offscreenPromise:t,pingTimeout:5e3})};const c="https://execution.metamask.io/iframe/10.2.2/index.html";return(0,s.assert)(c,"Missing iframe URL."),{memStateKey:null,persistedStateKey:null,controller:new r.IframeExecutionService({messenger:e,iframeUrl:new URL(c),setupSnapProvider:a,pingTimeout:5e3})}}}}},{package:"$root$",file:"app/scripts/controller-init/snaps/execution-service-init.ts"}],[1760,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){function r(e){return e.sort((e,t)=>"latest"===e||"earliest"===t?1:"latest"===t||"earliest"===e?-1:s(e)-s(t))}function s(e){return e===undefined||null===e?e:Number.parseInt(e,16)}function i(e){if(e===undefined||null===e)return e;let t=e.toString(16);return t.length%2&&(t="0"+t),"0x"+t}function o(){return Math.floor(16*Math.random()).toString(16)}t.exports={minBlockRef:function(...e){return r(e)[0]},maxBlockRef:function(...e){const t=r(e);return t[t.length-1]},sortBlockRefs:r,bnToHex:function(e){return"0x"+e.toString(16)},blockRefIsNumber:function(e){return e&&!["earliest","latest","pending"].includes(e)},hexToInt:s,incrementHexInt:function(e){if(e===undefined||null===e)return e;return i(s(e)+1)},intToHex:i,unsafeRandomBytes:function(e){let t="0x";for(let n=0;n<e;n++)t+=o(),t+=o();return t}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/hexUtils.js"}],[1761,{"./block-filter.js":1758,"./hexUtils":1760,"./log-filter.js":1762,"./tx-filter.js":1764,"@metamask/json-rpc-engine":1994,"async-mutex":3883},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){const r=e("async-mutex").Mutex,{createAsyncMiddleware:s,createScaffoldMiddleware:i}=e("@metamask/json-rpc-engine"),o=e("./log-filter.js"),a=e("./block-filter.js"),c=e("./tx-filter.js"),{intToHex:l,hexToInt:u}=e("./hexUtils");function d(e){return h(async(...t)=>{const n=await e(...t);return l(n.id)})}function h(e){return s(async(t,n)=>{const r=await e.apply(null,t.params);n.result=r})}function p(e,t){const n=[];for(let t in e)n.push(e[t]);return n}t.exports=function({blockTracker:e,provider:t}){let n=0,s={};const m=new r,g=function({mutex:e}){return t=>async(n,r,s,i)=>{(await e.acquire())(),t(n,r,s,i)}}({mutex:m}),f=i({eth_newFilter:g(d(w)),eth_newBlockFilter:g(d(v)),eth_newPendingTransactionFilter:g(d(b)),eth_uninstallFilter:g(h(S)),eth_getFilterChanges:g(h(k)),eth_getFilterLogs:g(h(C))}),y=async({oldBlock:e,newBlock:t})=>{if(0===s.length)return;const n=await m.acquire();try{await Promise.all(p(s).map(async n=>{try{await n.update({oldBlock:e,newBlock:t})}catch(e){console.error(e)}}))}catch(e){console.error(e)}n()};return f.newLogFilter=w,f.newBlockFilter=v,f.newPendingTransactionFilter=b,f.uninstallFilter=S,f.getFilterChanges=k,f.getFilterLogs=C,f.destroy=()=>{!async function(){const e=p(s).length;s={},A({prevFilterCount:e,newFilterCount:0})}()},f;async function w(e){const n=new o({provider:t,params:e});await M(n);return n}async function v(){const e=new a({provider:t});await M(e);return e}async function b(){const e=new c({provider:t});await M(e);return e}async function k(e){const t=u(e),n=s[t];if(!n)throw new Error(`No filter for index "${t}"`);return n.getChangesAndClear()}async function C(e){const t=u(e),n=s[t];if(!n)throw new Error(`No filter for index "${t}"`);let r=[];return"log"===n.type&&(r=n.getAllResults()),r}async function S(e){const t=u(e),n=s[t],r=Boolean(n);return r&&await async function(e){const t=p(s).length;delete s[e];const n=p(s).length;A({prevFilterCount:t,newFilterCount:n})}(t),r}async function M(t){const r=p(s).length,i=await e.getLatestBlock();await t.initialize({currentBlock:i}),n++,s[n]=t,t.id=n,t.idHex=l(n);return A({prevFilterCount:r,newFilterCount:p(s).length}),n}function A({prevFilterCount:t,newFilterCount:n}){0===t&&n>0?e.on("sync",y):t>0&&0===n&&e.removeListener("sync",y)}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/index.js"}],[1762,{"./base-filter-history":1756,"./hexUtils":1760,"@metamask/eth-query":1882,pify:5062},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){const r=e("@metamask/eth-query"),s=e("pify"),i=e("./base-filter-history"),{bnToHex:o,hexToInt:a,incrementHexInt:c,minBlockRef:l,blockRefIsNumber:u}=e("./hexUtils");t.exports=class extends i{constructor({provider:e,params:t}){super(),this.type="log",this.ethQuery=new r(e),this.params=Object.assign({fromBlock:"latest",toBlock:"latest",address:undefined,topics:[]},t),this.params.address&&(Array.isArray(this.params.address)||(this.params.address=[this.params.address]),this.params.address=this.params.address.map(e=>e.toLowerCase()))}async initialize({currentBlock:e}){let t=this.params.fromBlock;["latest","pending"].includes(t)&&(t=e),"earliest"===t&&(t="0x0"),this.params.fromBlock=t;const n=l(this.params.toBlock,e),r=Object.assign({},this.params,{toBlock:n}),s=await this._fetchLogs(r);this.addInitialResults(s)}async update({oldBlock:e,newBlock:t}){const n=t;let r;r=e?c(e):t;const s=Object.assign({},this.params,{fromBlock:r,toBlock:n}),i=(await this._fetchLogs(s)).filter(e=>this.matchLog(e));this.addResults(i)}async _fetchLogs(e){return await s(t=>this.ethQuery.getLogs(e,t))()}matchLog(e){if(a(this.params.fromBlock)>=a(e.blockNumber))return!1;if(u(this.params.toBlock)&&a(this.params.toBlock)<=a(e.blockNumber))return!1;const t=e.address&&e.address.toLowerCase();if(this.params.address&&t&&!this.params.address.includes(t))return!1;return this.params.topics.every((t,n)=>{let r=e.topics[n];if(!r)return!1;r=r.toLowerCase();let s=Array.isArray(t)?t:[t];if(s.includes(null))return!0;s=s.map(e=>e.toLowerCase());return s.includes(r)})}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/log-filter.js"}],[1763,{"./getBlocksForRange.js":1759,"./hexUtils.js":1760,"./index.js":1761,"@metamask/json-rpc-engine":1994,"@metamask/safe-event-emitter":2487},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){const r=e("@metamask/safe-event-emitter").default,{createAsyncMiddleware:s,createScaffoldMiddleware:i}=e("@metamask/json-rpc-engine"),o=e("./index.js"),{unsafeRandomBytes:a,incrementHexInt:c}=e("./hexUtils.js"),l=e("./getBlocksForRange.js");function u(e){return null===e||e===undefined?null:{hash:e.hash,parentHash:e.parentHash,sha3Uncles:e.sha3Uncles,miner:e.miner,stateRoot:e.stateRoot,transactionsRoot:e.transactionsRoot,receiptsRoot:e.receiptsRoot,logsBloom:e.logsBloom,difficulty:e.difficulty,number:e.number,gasLimit:e.gasLimit,gasUsed:e.gasUsed,nonce:e.nonce,mixHash:e.mixHash,timestamp:e.timestamp,extraData:e.extraData}}t.exports=function({blockTracker:e,provider:t}){const n={},d=o({blockTracker:e,provider:t});let h=!1;const p=new r,m=i({eth_subscribe:s(async function(r,s){if(h)throw new Error("SubscriptionManager - attempting to use after destroying");const i=r.params[0],o=a(16);let p;switch(i){case"newHeads":p=m({subId:o});break;case"logs":const e=r.params[1];p=f({subId:o,filter:await d.newLogFilter(e)});break;default:throw new Error(`SubscriptionManager - unsupported subscription type "${i}"`)}return n[o]=p,void(s.result=o);function m({subId:n}){const r={type:i,destroy:async()=>{e.removeListener("sync",r.update)},update:async({oldBlock:e,newBlock:r})=>{const s=r,i=c(e);(await l({provider:t,fromBlock:i,toBlock:s})).map(u).filter(e=>null!==e).forEach(e=>{g(n,e)})}};return e.on("sync",r.update),r}function f({subId:e,filter:t}){t.on("update",t=>g(e,t));return{type:i,destroy:async()=>await d.uninstallFilter(t.idHex)}}}),eth_unsubscribe:s(async function(e,t){if(h)throw new Error("SubscriptionManager - attempting to use after destroying");const r=e.params[0],s=n[r];if(!s)return void(t.result=!1);delete n[r],await s.destroy(),t.result=!0})});return m.destroy=function(){p.removeAllListeners();for(const e in n)n[e].destroy(),delete n[e];h=!0},{events:p,middleware:m};function g(e,t){p.emit("notification",{jsonrpc:"2.0",method:"eth_subscription",params:{subscription:e,result:t}})}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/subscriptionManager.js"}],[1764,{"./base-filter":1757,"./getBlocksForRange":1759,"./hexUtils":1760},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){const r=e("./base-filter"),s=e("./getBlocksForRange"),{incrementHexInt:i}=e("./hexUtils");t.exports=class extends r{constructor({provider:e}){super(),this.type="tx",this.provider=e}async update({oldBlock:e}){const t=e,n=i(e),r=await s({provider:this.provider,fromBlock:n,toBlock:t}),o=[];for(const e of r)o.push(...e.transactions);this.addResults(o)}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/tx-filter.js"}],[177,{"./cronjob-controller-init":175,"./execution-service-init":176,"./multichain-router-init":178,"./rate-limit-controller-init":179,"./snap-controller-init":180,"./snap-insights-controller-init":181,"./snap-interface-controller-init":182,"./snaps-name-provider-init":183,"./snaps-registry-init":184,"./websocket-service-init":185},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"CronjobControllerInit",{enumerable:!0,get:function(){return r.CronjobControllerInit}}),Object.defineProperty(n,"ExecutionServiceInit",{enumerable:!0,get:function(){return s.ExecutionServiceInit}}),Object.defineProperty(n,"MultichainRouterInit",{enumerable:!0,get:function(){return i.MultichainRouterInit}}),Object.defineProperty(n,"RateLimitControllerInit",{enumerable:!0,get:function(){return o.RateLimitControllerInit}}),Object.defineProperty(n,"SnapControllerInit",{enumerable:!0,get:function(){return a.SnapControllerInit}}),Object.defineProperty(n,"SnapInsightsControllerInit",{enumerable:!0,get:function(){return c.SnapInsightsControllerInit}}),Object.defineProperty(n,"SnapInterfaceControllerInit",{enumerable:!0,get:function(){return l.SnapInterfaceControllerInit}}),Object.defineProperty(n,"SnapsNameProviderInit",{enumerable:!0,get:function(){return u.SnapsNameProviderInit}}),Object.defineProperty(n,"SnapsRegistryInit",{enumerable:!0,get:function(){return d.SnapsRegistryInit}}),Object.defineProperty(n,"WebSocketServiceInit",{enumerable:!0,get:function(){return h.WebSocketServiceInit}});var r=e("./cronjob-controller-init"),s=e("./execution-service-init"),i=e("./multichain-router-init"),o=e("./rate-limit-controller-init"),a=e("./snap-controller-init"),c=e("./snap-insights-controller-init"),l=e("./snap-interface-controller-init"),u=e("./snaps-name-provider-init"),d=e("./snaps-registry-init"),h=e("./websocket-service-init")}}},{package:"$root$",file:"app/scripts/controller-init/snaps/index.ts"}],[178,{"../../../../shared/constants/keyring":5792,"@metamask/snaps-controllers":2536},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MultichainRouterInit=void 0;var r=e("@metamask/snaps-controllers"),s=e("../../../../shared/constants/keyring");n.MultichainRouterInit=({controllerMessenger:e,getController:t})=>{const n=t("KeyringController");return{memStateKey:null,persistedStateKey:null,controller:new r.MultichainRouter({messenger:e,withSnapKeyring:async e=>e({keyring:await(async()=>{let[e]=n.getKeyringsByType(s.KeyringType.snap);return e||(await n.addNewKeyring(s.KeyringType.snap),[e]=n.getKeyringsByType(s.KeyringType.snap)),e})()})})}}}}},{package:"$root$",file:"app/scripts/controller-init/snaps/multichain-router-init.ts"}],[179,{"@metamask/notification-services-controller/notification-services":2255,"@metamask/rate-limit-controller":2475,loglevel:4824},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.RateLimitControllerInit=void 0;var r,s=e("@metamask/rate-limit-controller"),i=(r=e("loglevel"))&&r.__esModule?r:{default:r},o=e("@metamask/notification-services-controller/notification-services");n.RateLimitControllerInit=({controllerMessenger:e,initMessenger:t,persistedState:n,showNotification:r})=>({controller:new s.RateLimitController({state:n.RateLimitController,messenger:e,implementations:{showNativeNotification:{method:(e,n)=>{const s=t.call("SubjectMetadataController:getState").subjectMetadata[e];return r((null==s?void 0:s.name)??e,n).catch(e=>{i.default.error("Failed to create notification",e)}),null},rateLimitCount:2,rateLimitTimeout:3e5},showInAppNotification:{method:(e,n)=>{const{message:r,title:s,footerLink:i,interfaceId:a}=n,c={title:s,...i?{footerLink:i}:{},interfaceId:a},l={data:{message:r,origin:e,...a?{detailedView:c}:{}},type:o.TRIGGER_TYPES.SNAP,readDate:null};return t.call("NotificationServicesController:updateMetamaskNotificationsList",l),null},rateLimitCount:5,rateLimitTimeout:6e4}}}),memStateKey:null,persistedStateKey:null})}}},{package:"$root$",file:"app/scripts/controller-init/snaps/rate-limit-controller-init.ts"}],[1793,{"./ledger-hw-app.cjs":1795,"./ledger-iframe-bridge.cjs":1796,"./ledger-keyring.cjs":1797,"./ledger-mobile-bridge.cjs":1798,"./ledger-transport-middleware.cjs":1799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){r===undefined&&(r=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,s)}:function(e,t,n,r){r===undefined&&(r=n),e[r]=t[n]}),s=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),s(e("./ledger-keyring.cjs"),n),s(e("./ledger-iframe-bridge.cjs"),n),s(e("./ledger-mobile-bridge.cjs"),n),s(e("./ledger-transport-middleware.cjs"),n),s(e("./ledger-hw-app.cjs"),n)}}},{package:"@metamask/eth-ledger-bridge-keyring",file:"node_modules/@metamask/eth-ledger-bridge-keyring/dist/index.cjs"}],[1794,{"./type.cjs":1800,"@ledgerhq/hw-transport":923},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.handleLedgerTransportError=function(e,t){if(e instanceof r.TransportStatusError){const t=e;throw new s.LedgerStatusError(t.statusCode,function(e){switch(e.statusCode){case 27013:return"Ledger: User rejected the transaction";case 27264:return"Ledger: Blind signing must be enabled";case 21781:return"Ledger: Device is locked. Unlock it to continue";case 25871:return"Ledger: Ethereum app closed. Open it to unlock";default:return e.message}}(t))}throw e instanceof Error?e:new Error(t)};const r=e("@ledgerhq/hw-transport"),s=e("./type.cjs")}}},{package:"@metamask/eth-ledger-bridge-keyring",file:"node_modules/@metamask/eth-ledger-bridge-keyring/dist/ledger-error-handler.cjs"}],[1795,{"@ledgerhq/hw-app-eth":908,buffer:4061},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.MetaMaskLedgerHwAppEth=void 0;const s=r(e("@ledgerhq/hw-app-eth")),i=e("buffer");class o extends s.default{constructor(){super(...arguments),this.mainAppName="BOLOS",this.ethAppName="Ethereum",this.transportEncoding="ascii"}async openEthApp(){await this.transport.send(224,216,0,0,i.Buffer.from(this.ethAppName,this.transportEncoding))}async closeApps(){await this.transport.send(176,167,0,0)}async getAppNameAndVersion(){const e=await this.transport.send(176,1,0,0);if(1!==e[0])throw new Error("Incorrect format return from getAppNameAndVersion.");let t=1;const n=e[t]??0;t+=1;const r=e.slice(t,t+=n).toString(this.transportEncoding),s=e[t]??0;t+=1;return{appName:r,version:e.slice(t,t+=s).toString(this.transportEncoding)}}}n.MetaMaskLedgerHwAppEth=o}}},{package:"@metamask/eth-ledger-bridge-keyring",file:"node_modules/@metamask/eth-ledger-bridge-keyring/dist/ledger-hw-app.cjs"}],[1796,{"@metamask/utils":2908},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,s,i,o,a,c,l,u,d,h=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},p=this&&this.__classPrivateFieldSet||function(e,t,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n};Object.defineProperty(n,"__esModule",{value:!0}),n.LedgerIframeBridge=n.IFrameMessageAction=void 0;const m=e("@metamask/utils");var g;!function(e){e.LedgerIsIframeReady="ledger-is-iframe-ready",e.LedgerConnectionChange="ledger-connection-change",e.LedgerUnlock="ledger-unlock",e.LedgerMakeApp="ledger-make-app",e.LedgerUpdateTransport="ledger-update-transport",e.LedgerSignTransaction="ledger-sign-transaction",e.LedgerSignPersonalMessage="ledger-sign-personal-message",e.LedgerSignTypedData="ledger-sign-typed-data"}(g||(n.IFrameMessageAction=g={}));n.LedgerIframeBridge=class{constructor(e={bridgeUrl:"https://metamask.github.io/eth-ledger-bridge-keyring"}){r.add(this),this.iframeLoaded=!1,s.set(this,void 0),this.isDeviceConnected=!1,this.currentMessageId=0,i.set(this,new Map),h(this,r,"m",d).call(this,e),p(this,s,{bridgeUrl:e?.bridgeUrl},"f")}async init(){await h(this,r,"m",a).call(this,h(this,s,"f").bridgeUrl),this.eventListener=h(this,r,"m",l).bind(this,h(this,s,"f").bridgeUrl),window.addEventListener("message",this.eventListener)}async destroy(){this.eventListener&&window.removeEventListener("message",this.eventListener)}async getOptions(){return h(this,s,"f")}async setOptions(e){h(this,r,"m",d).call(this,e),h(this,s,"f")?.bridgeUrl!==e.bridgeUrl&&(h(this,s,"f").bridgeUrl=e.bridgeUrl,await this.destroy(),await this.init())}async attemptMakeApp(){const e=await h(this,r,"m",u).call(this,{action:g.LedgerMakeApp},{timeout:8e3});if("success"in e&&e.success)return!0;throw"error"in e?e.error:new Error("Unknown error occurred")}async updateTransportMethod(e){if(!this.iframeLoaded)throw new Error("The iframe is not loaded yet");const t=await h(this,r,"m",u).call(this,{action:g.LedgerUpdateTransport,params:{transportType:e}},{timeout:8e3});if("success"in t&&t.success)return!0;throw new Error("Ledger transport could not be updated")}async getPublicKey(e){return h(this,r,"m",o).call(this,g.LedgerUnlock,e)}async deviceSignTransaction(e){return h(this,r,"m",o).call(this,g.LedgerSignTransaction,e)}async deviceSignMessage(e){return h(this,r,"m",o).call(this,g.LedgerSignPersonalMessage,e)}async deviceSignTypedData(e){return h(this,r,"m",o).call(this,g.LedgerSignTypedData,e)}},s=new WeakMap,i=new WeakMap,r=new WeakSet,o=async function(...[e,t]){const n=await h(this,r,"m",u).call(this,{action:e,params:t});if("payload"in n&&n.payload){if("success"in n&&n.success)return n.payload;if("error"in n.payload)throw n.payload.error}throw new Error("Unknown error occurred")},a=async function(e){return new Promise(t=>{this.iframe=document.createElement("iframe"),this.iframe.src=e,this.iframe.allow="hid 'src'",this.iframe.onload=async()=>{this.iframeLoaded=!0,t()},document.head.appendChild(this.iframe)})},c=function(e){const t=e.split("/");return t.splice(-1,1),t.join("/")},l=function(e,t){const{origin:n,data:s}=t;if(n===h(this,r,"m",c).call(this,e)&&s){const e=h(this,i,"f").get(s.messageId);e?(e.resolve(s),h(this,i,"f").delete(s.messageId)):s.action===g.LedgerConnectionChange&&(this.isDeviceConnected=s.payload.connected)}},u=async function(e,{timeout:t}={}){this.currentMessageId+=1;const n={...e,messageId:this.currentMessageId,target:"LEDGER-IFRAME"},r=(0,m.createDeferredPromise)();if(h(this,i,"f").set(this.currentMessageId,r),!this.iframeLoaded||!this.iframe?.contentWindow)throw new Error("The iframe is not loaded yet");return t&&setTimeout(()=>{h(this,i,"f").has(n.messageId)&&(h(this,i,"f").delete(n.messageId),r.reject(new Error("Ledger iframe message timeout")))},t),this.iframe.contentWindow.postMessage(n,"*"),r.promise},d=function(e){if("string"!=typeof e.bridgeUrl||0===e.bridgeUrl.length)throw new Error("bridgeURL is not a valid URL")}}}},{package:"@metamask/eth-ledger-bridge-keyring",file:"node_modules/@metamask/eth-ledger-bridge-keyring/dist/ledger-iframe-bridge.cjs"}],[1797,{"./ledger-error-handler.cjs":1794,"@ethereumjs/rlp":621,"@ethereumjs/tx":634,"@ethereumjs/util":648,"@metamask/eth-sig-util":1884,"@metamask/utils":2908,buffer:4061,hdkey:4574},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,s,i,o,a,c,l,u,d,h,p,m,g,f,y=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},w=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.LedgerKeyring=void 0;const v=e("@ethereumjs/rlp"),b=e("@ethereumjs/tx"),k=e("@ethereumjs/util"),C=e("@metamask/eth-sig-util"),S=e("@metamask/utils"),M=e("buffer"),A=w(e("hdkey")),T=e("./ledger-error-handler.cjs"),E="m",I=`${E}/44'/60'/0'`,_="Ledger Hardware";var P;!function(e){e.Ropsten="https://api-ropsten.etherscan.io",e.Kovan="https://api-kovan.etherscan.io",e.Rinkeby="https://api-rinkeby.etherscan.io",e.Mainnet="https://api.etherscan.io"}(P||(P={}));class j{constructor({bridge:e}){if(r.add(this),this.deviceId="",this.type=_,this.page=0,this.perPage=5,this.unlockedAccount=0,this.accounts=[],this.accountDetails={},this.hdk=new A.default,this.hdPath=I,this.paths={},this.network=P.Mainnet,this.implementFullBIP44=!1,!e)throw new Error("Bridge is a required dependency for the keyring");this.bridge=e}async init(){return this.bridge.init()}async destroy(){return this.bridge.destroy()}async serialize(){return{hdPath:this.hdPath,accounts:this.accounts.slice(),deviceId:this.deviceId,accountDetails:this.accountDetails,implementFullBIP44:!1}}async deserialize(e){this.hdPath=e.hdPath??I,this.accounts=e.accounts??[],this.deviceId=e.deviceId??"",this.accountDetails=e.accountDetails??{},e.accountDetails||y(this,r,"m",s).call(this,e),this.implementFullBIP44=e.implementFullBIP44??!1;const t=new Set(Object.keys(this.accountDetails));return this.accounts=this.accounts.filter(e=>t.has(y(this,r,"m",f).call(this,e))),Promise.resolve()}setDeviceId(e){this.deviceId=e}getDeviceId(){return this.deviceId}isUnlocked(){return Boolean(this.hdk.publicKey)}isConnected(){return this.bridge.isDeviceConnected}setAccountToUnlock(e){this.unlockedAccount=e}setHdPath(e){this.hdPath!==e&&(this.hdk=new A.default),this.hdPath=e}async unlock(e,t=!0){if(this.isUnlocked()&&!e)return y(this,r,"m",f).call(this,(0,S.bytesToHex)((0,k.publicToAddress)(this.hdk.publicKey,!0)));const n=e?y(this,r,"m",p).call(this,e):this.hdPath;let s;try{s=await this.bridge.getPublicKey({hdPath:n})}catch(e){(0,T.handleLedgerTransportError)(e,"Ledger: Unknown error while unlocking account")}return t&&s.chainCode&&(this.hdk.publicKey=M.Buffer.from(s.publicKey,"hex"),this.hdk.chainCode=M.Buffer.from(s.chainCode,"hex")),(0,S.add0x)(s.address)}async addAccounts(e){return new Promise((t,n)=>{this.unlock().then(async n=>{const s=this.unlockedAccount,i=s+e,o=[];for(let e=s;e<i;e++){const t=y(this,r,"m",d).call(this,e);let n;n=y(this,r,"m",h).call(this)?await this.unlock(t):y(this,r,"m",l).call(this,E,e),this.accountDetails[y(this,r,"m",f).call(this,n)]={bip44:y(this,r,"m",h).call(this),hdPath:t},this.accounts.includes(n)||(this.accounts=[...this.accounts,n],o.push(n)),this.page=0}t(o)}).catch(n)})}getName(){return _}async getFirstPage(){return this.page=0,y(this,r,"m",o).call(this,1)}async getNextPage(){return y(this,r,"m",o).call(this,1)}async getPreviousPage(){return y(this,r,"m",o).call(this,-1)}async getAccounts(){return Promise.resolve(this.accounts.slice())}removeAccount(e){const t=this.accounts.filter(t=>t.toLowerCase()!==e.toLowerCase());if(t.length===this.accounts.length)throw new Error(`Address ${e} not found in this keyring`);this.accounts=t,delete this.accountDetails[y(this,r,"m",f).call(this,e)]}async attemptMakeApp(){return this.bridge.attemptMakeApp()}async updateTransportMethod(e){return this.bridge.updateTransportMethod(e)}async signTransaction(e,t){let n;if(function(e){return"getChainId"in e&&"function"==typeof e.getChainId}(t))return t.v=t.getChainId(),t.r="0x00",t.s="0x00",n=t.serialize().toString("hex"),y(this,r,"m",i).call(this,e,n,e=>(t.v=M.Buffer.from(e.v,"hex"),t.r=M.Buffer.from(e.r,"hex"),t.s=M.Buffer.from(e.s,"hex"),t));const s=t.getMessageToSign();return n=Array.isArray(s)?M.Buffer.from(v.RLP.encode(s)).toString("hex"):(0,S.bytesToHex)(s),y(this,r,"m",i).call(this,e,n,e=>{const n=t.toJSON();return n.type=t.type,n.v=(0,S.add0x)(e.v),n.r=(0,S.add0x)(e.r),n.s=(0,S.add0x)(e.s),b.TransactionFactory.fromTxData(n,{common:t.common,freeze:Object.isFrozen(t)})})}async signMessage(e,t){return this.signPersonalMessage(e,t)}async signPersonalMessage(e,t){const n=await this.unlockAccountByAddress(e);if(!n)throw new Error("Ledger: Unknown error while signing message");let s;try{s=await this.bridge.deviceSignMessage({hdPath:n,message:(0,S.remove0x)(t)})}catch(e){(0,T.handleLedgerTransportError)(e,"Ledger: Unknown error while signing message")}let i=parseInt(String(s.v),10).toString(16);i.length<2&&(i=`0${i}`);const o=`0x${s.r}${s.s}${i}`,a=(0,C.recoverPersonalSignature)({data:t,signature:o});if(y(this,r,"m",f).call(this,a)!==y(this,r,"m",f).call(this,e))throw new Error("Ledger: The signature doesnt match the right address");return o}async unlockAccountByAddress(e){const t=y(this,r,"m",f).call(this,e),n=this.accountDetails[t];if(!n)throw new Error(`Ledger: Account for address '${t}' not found`);const{hdPath:s}=n;if((await this.unlock(s,!1)).toLowerCase()!==e.toLowerCase())throw new Error(`Ledger: Account ${e} does not belong to the connected device`);return s}async signTypedData(e,t,n){const{version:s}=n??{};if(!("V4"===s))throw new Error("Ledger: Only version 4 of typed data signing is supported");const{domain:i,types:o,primaryType:a,message:c}=C.TypedDataUtils.sanitizeData(t),l=await this.unlockAccountByAddress(e);if(!l)throw new Error("Ledger: Unknown error while signing message");let u;try{u=await this.bridge.deviceSignTypedData({hdPath:l,message:{domain:{name:i.name,chainId:i.chainId,version:i.version,verifyingContract:i.verifyingContract,salt:i.salt instanceof ArrayBuffer?M.Buffer.from(i.salt).toString("hex"):i.salt},types:o,primaryType:a.toString(),message:c}})}catch(e){(0,T.handleLedgerTransportError)(e,"Ledger: Unknown error while signing message")}let d=parseInt(String(u.v),10).toString(16);d.length<2&&(d=`0${d}`);const h=`0x${u.r}${u.s}${d}`,p=(0,C.recoverTypedSignature)({data:t,signature:h,version:C.SignTypedDataVersion.V4});if(y(this,r,"m",f).call(this,p)!==y(this,r,"m",f).call(this,e))throw new Error("Ledger: The signature doesnt match the right address");return h}forgetDevice(){this.deviceId="",this.accounts=[],this.page=0,this.unlockedAccount=0,this.paths={},this.accountDetails={},this.hdk=new A.default}}n.LedgerKeyring=j,r=new WeakSet,s=function(e){if(y(this,r,"m",h).call(this)&&e.accountIndexes)for(const[t,n]of Object.entries(e.accountIndexes))this.accountDetails[t]={bip44:!0,hdPath:y(this,r,"m",d).call(this,n)};const t=new Set(Object.keys(this.accountDetails));y(this,r,"m",h).call(this)||this.accounts.forEach(e=>{const n=y(this,r,"m",f).call(this,e);t.has(n)||(this.accountDetails[n]={bip44:!1,hdPath:y(this,r,"m",u).call(this,e)})})},i=async function(e,t,n){const r=await this.unlockAccountByAddress(e);if(!r)throw new Error("Ledger: hdPath is empty while signing transaction");let s;try{s=await this.bridge.deviceSignTransaction({tx:(0,S.remove0x)(t),hdPath:r})}catch(e){(0,T.handleLedgerTransportError)(e,"Ledger: Unknown error while signing transaction")}const i=n(s);if(i.verifySignature())return i;throw new Error("Ledger: The transaction signature is not valid")},o=async function(e){this.page+=e,this.page<=0&&(this.page=1);const t=(this.page-1)*this.perPage,n=t+this.perPage;let s;return await this.unlock(),s=y(this,r,"m",h).call(this)?await y(this,r,"m",a).call(this,t,n):y(this,r,"m",c).call(this,t,n),s},a=async function(e,t){const n=[];for(let s=e;s<t;s++){const e=y(this,r,"m",d).call(this,s),t=await this.unlock(e),i=!this.implementFullBIP44||await y(this,r,"m",m).call(this,t);if(n.push({address:t,balance:null,index:s}),!i)break}return n},c=function(e,t){const n=[];for(let s=e;s<t;s++){const e=y(this,r,"m",l).call(this,E,s);n.push({address:e,balance:null,index:s}),this.paths[y(this,r,"m",f).call(this,e)]=s}return n},l=function(e,t){const n=this.hdk.derive(`${e}/${t}`),s=(0,S.bytesToHex)((0,k.publicToAddress)(n.publicKey,!0));return y(this,r,"m",f).call(this,s)},u=function(e){const t=y(this,r,"m",f).call(this,e);let n=this.paths[t];if(void 0===n)for(let e=0;e<1e3;e++)if(t===y(this,r,"m",l).call(this,E,e)){n=e;break}if(void 0===n)throw new Error("Unknown address");return y(this,r,"m",d).call(this,n)},d=function(e){return y(this,r,"m",h).call(this)?`m/44'/60'/${e}'/0/0`:`${this.hdPath}/${e}`},h=function(){return"m/44'/60'/0'/0/0"===this.hdPath},p=function(e){return e.toString().replace("m/","")},m=async function(e){const t=y(this,r,"m",g).call(this),n=await window.fetch(`${t}/api?module=account&action=txlist&address=${e}&tag=latest&page=1&offset=1`),s=await n.json();return"0"!==s.status&&s.result.length>0},g=function(){return this.network},f=function(e){return(0,S.getChecksumAddress)((0,S.add0x)(e))},j.type=_}}},{package:"@metamask/eth-ledger-bridge-keyring",file:"node_modules/@metamask/eth-ledger-bridge-keyring/dist/ledger-keyring.cjs"}],[1798,{"./ledger-hw-app.cjs":1795},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,s,i,o,a,c=this&&this.__classPrivateFieldSet||function(e,t,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n},l=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.LedgerMobileBridge=void 0;e("./ledger-hw-app.cjs");n.LedgerMobileBridge=class{constructor(e,t={}){r.add(this),s.set(this,void 0),i.set(this,void 0),this.isDeviceConnected=!1,c(this,i,t,"f"),c(this,s,e,"f")}async init(){return Promise.resolve()}async destroy(){try{await l(this,r,"m",o).call(this).dispose()}catch(e){console.error(e)}this.isDeviceConnected=!1}async deviceSignMessage({hdPath:e,message:t}){return l(this,r,"m",a).call(this).signPersonalMessage(e,t)}async deviceSignTypedData({hdPath:e,message:t}){return l(this,r,"m",a).call(this).signEIP712Message(e,t)}async deviceSignTransaction({tx:e,hdPath:t}){return l(this,r,"m",a).call(this).clearSignTransaction(t,e,{externalPlugins:!0,erc20:!0,nft:!0})}async getPublicKey({hdPath:e}){return await l(this,r,"m",a).call(this).getAddress(e,!1,!0)}async getOptions(){return l(this,i,"f")}async setOptions(e){c(this,i,e,"f")}async updateTransportMethod(e){if(!e.deviceModel)throw new Error("Property `deviceModel` is not defined in `transport`.");if(!e.deviceModel.id)throw new Error("Property `deviceModel.id` is not defined in `transport`.");return l(this,r,"m",o).call(this).setTransport(e),this.isDeviceConnected=!0,Promise.resolve(!0)}async attemptMakeApp(){throw new Error("Method not supported.")}async openEthApp(){await l(this,r,"m",a).call(this).openEthApp()}async closeApps(){await l(this,r,"m",a).call(this).closeApps()}async getAppNameAndVersion(){return l(this,r,"m",a).call(this).getAppNameAndVersion()}},s=new WeakMap,i=new WeakMap,r=new WeakSet,o=function(){if(l(this,s,"f"))return l(this,s,"f");throw new Error("Instance `transportMiddleware` is not initialized.")},a=function(){return l(this,r,"m",o).call(this).getEthApp()}}}},{package:"@metamask/eth-ledger-bridge-keyring",file:"node_modules/@metamask/eth-ledger-bridge-keyring/dist/ledger-mobile-bridge.cjs"}],[1799,{"./ledger-hw-app.cjs":1795},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,s=this&&this.__classPrivateFieldSet||function(e,t,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n},i=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.LedgerTransportMiddleware=void 0;const o=e("./ledger-hw-app.cjs");n.LedgerTransportMiddleware=class{constructor(){this.mainAppName="BOLOS",this.ethAppName="Ethereum",this.transportEncoding="ascii",r.set(this,void 0)}async dispose(){const e=this.getTransport();await e.close()}setTransport(e){s(this,r,e,"f")}getTransport(){if(!i(this,r,"f"))throw new Error("Instance `transport` is not initialized.");return i(this,r,"f")}getEthApp(){return new o.MetaMaskLedgerHwAppEth(this.getTransport())}},r=new WeakMap}}},{package:"@metamask/eth-ledger-bridge-keyring",file:"node_modules/@metamask/eth-ledger-bridge-keyring/dist/ledger-transport-middleware.cjs"}],[18,{"../controllers/app-state-controller":201},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.AppStateControllerInit=void 0;var r=e("../controllers/app-state-controller");n.AppStateControllerInit=({controllerMessenger:e,persistedState:t,setLocked:n,extension:s})=>({controller:new r.AppStateController({messenger:e,state:t.AppStateController,onInactiveTimeout:()=>n(),extension:s})})}}},{package:"$root$",file:"app/scripts/controller-init/app-state-controller-init.ts"}],[180,{"../../../../shared/constants/keyring":5792,"../../../../shared/constants/snaps/permissions":5811,"../../lib/encryptor-factory":251,"../../lib/util":332,"@metamask/snaps-controllers":2536,"@metamask/utils":2908},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SnapControllerInit=void 0;var r=e("@metamask/snaps-controllers"),s=e("@metamask/utils"),i=e("../../../../shared/constants/snaps/permissions"),o=e("../../lib/encryptor-factory"),a=e("../../../../shared/constants/keyring"),c=e("../../lib/util");n.SnapControllerInit=({initMessenger:e,controllerMessenger:t,persistedState:n,removeAllConnections:l,preinstalledSnaps:u})=>{const d=(0,c.getBooleanFlag)(!1),h=(0,c.getBooleanFlag)(!0),p=(0,c.getBooleanFlag)(!0);const m=new r.SnapController({dynamicPermissions:["endowment:caip25"],environmentEndowmentPermissions:Object.values(i.EndowmentPermissions),excludedPermissions:{...i.ExcludedSnapPermissions,...i.ExcludedSnapEndowments},closeAllConnections:l,state:n.SnapController,messenger:t,featureFlags:{allowLocalSnaps:d,requireAllowlist:h,rejectInvalidPlatformVersion:p},encryptor:(0,o.encryptorFactory)(6e5),getMnemonicSeed:async function(){const t=e.call("KeyringController:getKeyringsByType",a.KeyringType.hdKeyTree);if(!(t[0]&&(0,s.hasProperty)(t[0],"seed")&&t[0].seed instanceof Uint8Array))throw new Error("Primary keyring mnemonic unavailable.");return t[0].seed},preinstalledSnaps:u,getFeatureFlags:function(){return{disableSnaps:!1===e.call("PreferencesController:getState").useExternalServices}},trackEvent:e.call.bind(e,"MetaMetricsController:trackEvent")});return e.subscribe("KeyringController:lock",()=>{e.call("SnapController:setClientActive",!1)}),e.subscribe("KeyringController:unlock",()=>{e.call("SnapController:setClientActive",!0)}),{controller:m}}}}},{package:"$root$",file:"app/scripts/controller-init/snaps/snap-controller-init.ts"}],[1800,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.LedgerStatusError=void 0;class r extends Error{constructor(e,t){super(t),this.statusCode=e}}n.LedgerStatusError=r}}},{package:"@metamask/eth-ledger-bridge-keyring",file:"node_modules/@metamask/eth-ledger-bridge-keyring/dist/type.cjs"}],[181,{"@metamask/snaps-controllers":2536},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SnapInsightsControllerInit=void 0;var r=e("@metamask/snaps-controllers");n.SnapInsightsControllerInit=({controllerMessenger:e,persistedState:t})=>({controller:new r.SnapInsightsController({state:t.SnapInsightsController,messenger:e})})}}},{package:"$root$",file:"app/scripts/controller-init/snaps/snap-insights-controller-init.ts"}],[182,{"@metamask/snaps-controllers":2536},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SnapInterfaceControllerInit=void 0;var r=e("@metamask/snaps-controllers");n.SnapInterfaceControllerInit=({controllerMessenger:e,persistedState:t})=>({controller:new r.SnapInterfaceController({state:t.SnapInterfaceController,messenger:e})})}}},{package:"$root$",file:"app/scripts/controller-init/snaps/snap-interface-controller-init.ts"}],[183,{"../../lib/SnapsNameProvider":231},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SnapsNameProviderInit=void 0;var r=e("../../lib/SnapsNameProvider");n.SnapsNameProviderInit=({controllerMessenger:e})=>({persistedStateKey:null,memStateKey:null,controller:new r.SnapsNameProvider({messenger:e})})}}},{package:"$root$",file:"app/scripts/controller-init/snaps/snaps-name-provider-init.ts"}],[184,{"../../lib/util":332,"@metamask/snaps-controllers":2536},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SnapsRegistryInit=void 0;var r=e("@metamask/snaps-controllers"),s=e("../../lib/util");n.SnapsRegistryInit=({controllerMessenger:e,persistedState:t})=>{const n=(0,s.getBooleanFlag)(!0);return{controller:new r.JsonSnapsRegistry({state:t.SnapsRegistry,messenger:e,refetchOnAllowlistMiss:n})}}}}},{package:"$root$",file:"app/scripts/controller-init/snaps/snaps-registry-init.ts"}],[185,{"@metamask/snaps-controllers":2536},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.WebSocketServiceInit=void 0;var r=e("@metamask/snaps-controllers");n.WebSocketServiceInit=({controllerMessenger:e})=>({memStateKey:null,persistedStateKey:null,controller:new r.WebSocketService({messenger:e})})}}},{package:"$root$",file:"app/scripts/controller-init/snaps/websocket-service-init.ts"}],[186,{"@metamask/permission-controller":2334},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SubjectMetadataControllerInit=void 0;var r=e("@metamask/permission-controller");n.SubjectMetadataControllerInit=({controllerMessenger:e,persistedState:t})=>({controller:new r.SubjectMetadataController({state:t.SubjectMetadataController,messenger:e,subjectCacheLimit:100})})}}},{package:"$root$",file:"app/scripts/controller-init/subject-metadata-controller-init.ts"}],[187,{"./subscription-controller-init":188,"./subscription-service-init":189},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"SubscriptionControllerInit",{enumerable:!0,get:function(){return r.SubscriptionControllerInit}}),Object.defineProperty(n,"SubscriptionServiceInit",{enumerable:!0,get:function(){return s.SubscriptionServiceInit}});var r=e("./subscription-controller-init"),s=e("./subscription-service-init")}}},{package:"$root$",file:"app/scripts/controller-init/subscription/index.ts"}],[188,{"../../../../development/build/constants":562,"@metamask/subscription-controller":2810},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SubscriptionControllerInit=void 0;var r=e("@metamask/subscription-controller"),s=e("../../../../development/build/constants");n.SubscriptionControllerInit=e=>{const{initMessenger:t,controllerMessenger:n,persistedState:i}=e,o=new r.SubscriptionService({env:"production"===s.ENVIRONMENT.DEVELOPMENT||"production"===s.ENVIRONMENT.TESTING?r.Env.DEV:r.Env.PRD,auth:{getAccessToken:()=>t.call("AuthenticationController:getBearerToken")}});return{controller:new r.SubscriptionController({messenger:n,state:i.SubscriptionController,subscriptionService:o})}}}}},{package:"$root$",file:"app/scripts/controller-init/subscription/subscription-controller-init.ts"}],[189,{"../../services/oauth/web-authenticator-factory":557,"../../services/subscription/subscription-service":558},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SubscriptionServiceInit=void 0;var r=e("../../services/subscription/subscription-service"),s=e("../../services/oauth/web-authenticator-factory");n.SubscriptionServiceInit=e=>{const{controllerMessenger:t,platform:n}=e;return{controller:new r.SubscriptionService({messenger:t,platform:n,webAuthenticator:(0,s.webAuthenticatorFactory)()}),memStateKey:null,persistedStateKey:null}}}}},{package:"$root$",file:"app/scripts/controller-init/subscription/subscription-service-init.ts"}],[19,{"../init-utils":51,"@metamask/assets-controllers":1203},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.AssetsContractControllerInit=void 0;var r=e("@metamask/assets-controllers"),s=e("../init-utils");n.AssetsContractControllerInit=({controllerMessenger:e,initMessenger:t})=>({controller:new r.AssetsContractController({messenger:e,chainId:(0,s.getGlobalChainId)(t)}),memStateKey:null})}}},{package:"$root$",file:"app/scripts/controller-init/assets/assets-contract-controller-init.ts"}],[190,{"../controllers/swaps":220},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SwapsControllerInit=void 0;var r,s=(r=e("../controllers/swaps"))&&r.__esModule?r:{default:r};n.SwapsControllerInit=({controllerMessenger:e,initMessenger:t,persistedState:n,getController:r})=>{const i=r("GasFeeController"),o=r("TransactionController");return{controller:new s.default({messenger:e,getBufferedGasLimit:async(e,n)=>{const r=t.call("NetworkController:getState"),{gas:s,simulationFails:i}=await o.estimateGasBuffered(e.txParams,n,r.selectedNetworkClientId);return{gasLimit:s,simulationFails:i}},getEIP1559GasFeeEstimates:(...e)=>i.fetchGasFeeEstimates(...e),getLayer1GasFee:(...e)=>o.getLayer1GasFee(...e),trackMetaMetricsEvent:t.call.bind(t,"MetaMetricsController:trackEvent")},n.SwapsController)}}}}},{package:"$root$",file:"app/scripts/controller-init/swaps-controller-init.ts"}],[191,{"@metamask/assets-controllers":1203},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.TokenBalancesControllerInit=void 0;var r=e("@metamask/assets-controllers");n.TokenBalancesControllerInit=({controllerMessenger:e,initMessenger:t,persistedState:n})=>{const{useMultiAccountBalanceChecker:s}=t.call("PreferencesController:getState");return{controller:new r.TokenBalancesController({messenger:e,state:n.TokenBalancesController,queryMultipleAccounts:s,interval:3e4,allowExternalServices:()=>t.call("PreferencesController:getState").useExternalServices,accountsApiChainIds:()=>{var e;const n=t.call("RemoteFeatureFlagController:getState"),r=null==n||null===(e=n.remoteFeatureFlags)||void 0===e?void 0:e.assetsAccountApiBalances;return Array.isArray(r)?r:[]}})}}}}},{package:"$root$",file:"app/scripts/controller-init/token-balances-controller-init.ts"}],[192,{"@metamask/assets-controllers":1203},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.TokenDetectionControllerInit=void 0;var r=e("@metamask/assets-controllers");n.TokenDetectionControllerInit=({controllerMessenger:e,initMessenger:t})=>({memStateKey:null,persistedStateKey:null,controller:new r.TokenDetectionController({messenger:e,getBalancesInSingleCall:(...e)=>t.call("AssetsContractController:getBalancesInSingleCall",...e),trackMetaMetricsEvent:(...e)=>t.call("MetaMetricsController:trackEvent",...e),useAccountsAPI:!0,platform:"extension",useTokenDetection:()=>t.call("PreferencesController:getState").useTokenDetection,useExternalServices:()=>t.call("PreferencesController:getState").useExternalServices})})}}},{package:"$root$",file:"app/scripts/controller-init/token-detection-controller-init.ts"}],[193,{"../lib/util":332,"./init-utils":51,"@metamask/assets-controllers":1203},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.TokenListControllerInit=void 0;var r=e("@metamask/assets-controllers"),s=e("../lib/util"),i=e("./init-utils");n.TokenListControllerInit=({controllerMessenger:e,initMessenger:t,persistedState:n})=>{const o=t.call("PreferencesController:getState"),a=e=>{const{useTokenDetection:t,useTransactionSimulations:n,preferences:r}=e??{},{petnamesEnabled:s}=r??{};return t||s||n},c=new r.TokenListController({messenger:e,state:n.TokenListController,preventPollingOnNetworkRestart:!a(o),chainId:(0,i.getGlobalChainId)(t)});return t.subscribe("PreferencesController:stateChange",(0,s.previousValueComparator)((e,t)=>(((e,t)=>{const n=a(t),r=a(e);n!==r&&c.updatePreventPollingOnNetworkRestart(!r)})(t,e),!0),o)),{controller:c}}}}},{package:"$root$",file:"app/scripts/controller-init/token-list-controller-init.ts"}],[194,{"./init-utils":51,"@metamask/assets-controllers":1203,"@metamask/utils":2908},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.TokensControllerInit=void 0;var r=e("@metamask/assets-controllers"),s=e("@metamask/utils"),i=e("./init-utils");n.TokensControllerInit=({controllerMessenger:e,initMessenger:t,persistedState:n})=>{const{provider:o}=t.call("NetworkController:getSelectedNetworkClient")??{};(0,s.assert)(o,"Provider is required to initialize TokensController.");return{controller:new r.TokensController({messenger:e,state:n.TokensController,provider:o,chainId:(0,i.getGlobalChainId)(t)})}}}}},{package:"$root$",file:"app/scripts/controller-init/tokens-controller-init.ts"}],[1947,{"./onekey-keyring.cjs":1948,"./trezor-connect-bridge.cjs":1949,"./trezor-keyring.cjs":1950},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){r===undefined&&(r=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,s)}:function(e,t,n,r){r===undefined&&(r=n),e[r]=t[n]}),s=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),s(e("./trezor-keyring.cjs"),n),s(e("./onekey-keyring.cjs"),n),s(e("./trezor-connect-bridge.cjs"),n)}}},{package:"@metamask/eth-trezor-keyring",file:"node_modules/@metamask/eth-trezor-keyring/dist/index.cjs"}],[1948,{"./trezor-keyring.cjs":1950},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.OneKeyKeyring=void 0;const r=e("./trezor-keyring.cjs"),s="OneKey Hardware";class i extends r.TrezorKeyring{constructor(){super(...arguments),this.type=s}}n.OneKeyKeyring=i,i.type=s}}},{package:"@metamask/eth-trezor-keyring",file:"node_modules/@metamask/eth-trezor-keyring/dist/onekey-keyring.cjs"}],[1949,{"@trezor/connect-web":3219},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){r===undefined&&(r=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,s)}:function(e,t,n,r){r===undefined&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return s(t,e),t};Object.defineProperty(n,"__esModule",{value:!0}),n.TrezorConnectBridge=void 0;const o=i(e("@trezor/connect-web"));n.TrezorConnectBridge=class{constructor(){this.trezorConnectInitiated=!1}async init(e){o.default.on(o.DEVICE_EVENT,e=>{var t;e.type===o.DEVICE.CONNECT&&(this.model=null===(t=e.payload.features)||void 0===t?void 0:t.model)}),this.trezorConnectInitiated||(await o.default.init(e),this.trezorConnectInitiated=!0)}async dispose(){return o.default.dispose(),Promise.resolve()}getPublicKey(e){return o.default.getPublicKey(e)}ethereumSignTransaction(e){return o.default.ethereumSignTransaction(e)}ethereumSignMessage(e){return o.default.ethereumSignMessage(e)}ethereumSignTypedData(e){return o.default.ethereumSignTypedData(e)}}}}},{package:"@metamask/eth-trezor-keyring",file:"node_modules/@metamask/eth-trezor-keyring/dist/trezor-connect-bridge.cjs"}],[195,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){}}},{package:"$root$",file:"app/scripts/controller-init/types.ts"}],[1950,{"@ethereumjs/tx":634,"@ethereumjs/util":648,"@metamask/eth-sig-util":1884,"@metamask/utils":2908,"@trezor/connect-plugin-ethereum":3210,buffer:4061,hdkey:4574},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){var r,s,i,o,a,c,l=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.TrezorKeyring=n.TREZOR_CONNECT_MANIFEST=void 0;const d=e("@ethereumjs/tx"),h=e("@ethereumjs/util"),p=e("@metamask/eth-sig-util"),m=e("@metamask/utils"),g=e("@trezor/connect-plugin-ethereum"),f=u(e("hdkey")),y="m/44'/60'/0'/0",w="m/44'/1'/0'/0",v="m/44'/60'/0'",b={[y]:!0,[v]:!0,[w]:!0},k="Trezor Hardware",C=1e3;async function S(e){return new Promise(t=>setTimeout(t,e))}function M(e){return"function"==typeof e.getChainId}n.TREZOR_CONNECT_MANIFEST={appName:"MetaMask",email:"support@metamask.io",appUrl:"https://metamask.io"};class A{constructor({bridge:e}){if(r.add(this),this.type=k,this.accounts=[],this.hdk=new f.default,this.hdPath=y,this.page=0,this.perPage=5,this.unlockedAccount=0,this.paths={},!e)throw new Error("Bridge is a required dependency for the keyring");this.bridge=e}getModel(){return this.bridge.model}async init(){return this.bridge.init({manifest:n.TREZOR_CONNECT_MANIFEST,lazyLoad:!0})}async destroy(){return this.bridge.dispose()}async serialize(){return Promise.resolve({hdPath:this.hdPath,accounts:this.accounts.slice(),page:this.page,paths:this.paths,perPage:this.perPage,unlockedAccount:this.unlockedAccount})}async deserialize(e){var t,n,r,s;return this.hdPath=null!==(t=e.hdPath)&&void 0!==t?t:y,this.accounts=null!==(n=e.accounts)&&void 0!==n?n:[],this.page=null!==(r=e.page)&&void 0!==r?r:0,this.perPage=null!==(s=e.perPage)&&void 0!==s?s:5,Promise.resolve()}isUnlocked(){var e;return Boolean(null===(e=this.hdk)||void 0===e?void 0:e.publicKey)}async unlock(){return this.isUnlocked()?Promise.resolve("already unlocked"):new Promise((e,n)=>{this.bridge.getPublicKey({path:this.hdPath,coin:"ETH"}).then(r=>{var s;r.success?(this.hdk.publicKey=t.from(r.payload.publicKey,"hex"),this.hdk.chainCode=t.from(r.payload.chainCode,"hex"),e("just unlocked")):n(new Error((null===(s=r.payload)||void 0===s?void 0:s.error)||"Unknown error"))}).catch(e=>{n(new Error((null==e?void 0:e.toString())||"Unknown error"))})})}setAccountToUnlock(e){this.unlockedAccount=parseInt(String(e),10)}async addAccounts(e){return new Promise((t,n)=>{this.unlock().then(n=>{const s=this.unlockedAccount,i=s+e,o=[];for(let e=s;e<i;e++){const t=l(this,r,"m",a).call(this,"m",e);this.accounts.includes(t)||(this.accounts=[...this.accounts,t],o.push(t)),this.page=0}t(o)}).catch(e=>{n(e)})})}async getFirstPage(){return this.page=0,l(this,r,"m",s).call(this,1)}async getNextPage(){return l(this,r,"m",s).call(this,1)}async getPreviousPage(){return l(this,r,"m",s).call(this,-1)}async getAccounts(){return Promise.resolve(this.accounts.slice())}removeAccount(e){if(!this.accounts.map(e=>e.toLowerCase()).includes(e.toLowerCase()))throw new Error(`Address ${e} not found in this keyring`);this.accounts=this.accounts.filter(t=>t.toLowerCase()!==e.toLowerCase())}async signTransaction(e,n){return M(n)?l(this,r,"m",i).call(this,e,n.getChainId(),n,e=>(n.v=t.from(e.v,"hex"),n.r=t.from(e.r,"hex"),n.s=t.from(e.s,"hex"),n)):l(this,r,"m",i).call(this,e,Number(n.common.chainId()),n,e=>{const t=n.toJSON();return t.type=n.type,t.v=(0,m.add0x)(e.v),t.r=(0,m.add0x)(e.r),t.s=(0,m.add0x)(e.s),d.TransactionFactory.fromTxData(t,{common:n.common,freeze:Object.isFrozen(n)})})}async signMessage(e,t){return this.signPersonalMessage(e,t)}async signPersonalMessage(e,t){return new Promise((n,s)=>{this.unlock().then(i=>{setTimeout(()=>{this.bridge.ethereumSignMessage({path:l(this,r,"m",c).call(this,e),message:(0,m.remove0x)(t),hex:!0}).then(t=>{var r;if(t.success){t.payload.address!==(0,m.getChecksumAddress)(e)&&s(new Error("signature doesnt match the right address"));const r=`0x${t.payload.signature}`;n(r)}else s(new Error((null===(r=t.payload)||void 0===r?void 0:r.error)||"Unknown error"))}).catch(e=>{s(new Error((null==e?void 0:e.toString())||"Unknown error"))})},"just unlocked"===i?C:0)}).catch(e=>{s(new Error((null==e?void 0:e.toString())||"Unknown error"))})})}async signTypedData(e,t,n){var s,i;const{version:o}=null!=n?n:{version:p.SignTypedDataVersion.V4},a=(0,g.transformTypedData)(t,o===p.SignTypedDataVersion.V4),{types:u,message:d={},domain:h={},primaryType:f,domain_separator_hash:y,message_hash:w}=a,v=await this.unlock();await S("just unlocked"===v?C:0);const b=await this.bridge.ethereumSignTypedData({path:l(this,r,"m",c).call(this,e),data:{types:Object.assign(Object.assign({},u),{EIP712Domain:null!==(s=u.EIP712Domain)&&void 0!==s?s:[]}),message:d,domain:h,primaryType:f},metamask_v4_compat:!0,domain_separator_hash:y,message_hash:null!=w?w:""});if(b.success){if((0,m.getChecksumAddress)(e)!==b.payload.address)throw new Error("signature doesnt match the right address");return b.payload.signature}throw new Error((null===(i=b.payload)||void 0===i?void 0:i.error)||"Unknown error")}forgetDevice(){this.accounts=[],this.hdk=new f.default,this.page=0,this.unlockedAccount=0,this.paths={}}setHdPath(e){if(!b[e])throw new Error(`The setHdPath method does not support setting HD Path to ${e}`);this.hdPath!==e&&(this.hdk=new f.default,this.accounts=[],this.page=0,this.perPage=5,this.unlockedAccount=0,this.paths={}),this.hdPath=e}}n.TrezorKeyring=A,r=new WeakSet,s=async function(e){return this.page+=e,this.page<=0&&(this.page=1),new Promise((e,t)=>{this.unlock().then(t=>{const n=(this.page-1)*this.perPage,s=n+this.perPage,i=[];for(let e=n;e<s;e++){const t=l(this,r,"m",a).call(this,"m",e);i.push({address:t,balance:null,index:e}),this.paths[(0,m.getChecksumAddress)(t)]=e}e(i)}).catch(e=>{t(e)})})},i=async function(e,n,s,i){var a,u,d,h;let p;p=M(s)?{to:l(this,r,"m",o).call(this,s.to),value:l(this,r,"m",o).call(this,s.value),data:l(this,r,"m",o).call(this,s.data),chainId:n,nonce:l(this,r,"m",o).call(this,s.nonce),gasLimit:l(this,r,"m",o).call(this,s.gasLimit),gasPrice:l(this,r,"m",o).call(this,s.gasPrice)}:Object.assign(Object.assign({},s.toJSON()),{chainId:n,to:l(this,r,"m",o).call(this,t.from(null!==(u=null===(a=s.to)||void 0===a?void 0:a.bytes)&&void 0!==u?u:[]))});try{const t=await this.unlock();await S("just unlocked"===t?C:0);const n=await this.bridge.ethereumSignTransaction({path:l(this,r,"m",c).call(this,e),transaction:p});if(n.success){const t=i(n.payload),r=(0,m.getChecksumAddress)((0,m.add0x)(t.getSenderAddress().toString("hex")));if(r!==(0,m.getChecksumAddress)(e))throw new Error("signature doesn't match the right address");return t}throw new Error((null===(d=n.payload)||void 0===d?void 0:d.error)||"Unknown error")}catch(e){throw new Error(null!==(h=null==e?void 0:e.toString())&&void 0!==h?h:"Unknown error")}},o=function(e){return(0,m.bytesToHex)(e)},a=function(e,t){const n=this.hdk.derive(`${e}/${t}`),r=(0,m.bytesToHex)((0,h.publicToAddress)(n.publicKey,!0));return(0,h.toChecksumAddress)(r)},c=function(e){const t=(0,m.getChecksumAddress)(e);let n=this.paths[t];if(void 0===n)for(let e=0;e<1e3;e++)if(t===l(this,r,"m",a).call(this,"m",e)){n=e;break}if(void 0===n)throw new Error("Unknown address");return`${this.hdPath}/${n}`},A.type=k}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/eth-trezor-keyring",file:"node_modules/@metamask/eth-trezor-keyring/dist/trezor-keyring.cjs"}],[196,{"./messengers":96,"./types":195,"@metamask/utils":2908},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.initControllers=function({baseControllerMessenger:e,existingControllers:t=[],initFunctions:n,initRequest:r}){i("Initializing controllers",Object.keys(n).length);const o=t.reduce((e,t)=>(e[t.name]=t,e),{}),a={},c={};let l={};const u=e=>function(e,t){const n=e[t];if(!n)throw new Error(`Controller requested before it was initialized: ${t}`);return n}(o,e);for(const[t,d]of Object.entries(n)){const n=t,h=d,p=s.CONTROLLER_MESSENGERS[n],m=null==p?void 0:p.getMessenger,g=null==p?void 0:p.getInitMessenger,f={...r,controllerMessenger:null==m?void 0:m(e),getController:u,initMessenger:null==g?void 0:g(e)},y=h({...f,controllerMessenger:f.controllerMessenger}),{controller:w,persistedStateKey:v,memStateKey:b}=y,k=y.api??{},C=null===v?undefined:v??n,S=null===b?undefined:b??n;o[n]=w,l={...l,...k},C&&(a[C]=w),S&&(c[S]=w),i("Initialized controller",n,{api:Object.keys(k),persistedStateKey:C,memStateKey:S})}return{controllerApi:l,controllerMemState:c,controllerPersistedState:a,controllersByName:o}};var r=e("@metamask/utils"),s=(e("./types"),e("./messengers"));const i=(0,r.createProjectLogger)("controller-init")}}},{package:"$root$",file:"app/scripts/controller-init/utils.ts"}],[197,{"@metamask/base-controller":1268},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.AccountOrderController=void 0;var r=e("@metamask/base-controller");const s={pinnedAccountList:[],hiddenAccountList:[]},i={pinnedAccountList:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},hiddenAccountList:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0}};class o extends r.BaseController{constructor({messenger:e,state:t}){super({messenger:e,metadata:i,name:"AccountOrderController",state:{...s,...t}})}updateAccountsList(e){this.update(t=>(t.pinnedAccountList=e,t))}updateHiddenAccountsList(e){this.update(t=>(t.hiddenAccountList=e,t))}}n.AccountOrderController=o}}},{package:"$root$",file:"app/scripts/controllers/account-order.ts"}],[198,{"../../../shared/constants/accounts":5777,"../../../shared/constants/network":5800,"../constants/contracts":5,"../lib/batch-utils":235,"../lib/util":332,"@ethersproject/contracts":697,"@ethersproject/providers":735,"@metamask/base-controller":1268,"@metamask/controller-utils":1349,"@metamask/utils":2908,lodash:4816,loglevel:4824,"single-call-balance-checker-abi":5622,uuid:5732},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getDefaultAccountTrackerControllerState=n.default=void 0;var r=e("uuid"),s=y(e("loglevel")),i=e("@ethersproject/providers"),o=e("@ethersproject/contracts"),a=y(e("single-call-balance-checker-abi")),c=e("lodash"),l=e("@metamask/utils"),u=e("@metamask/base-controller"),d=e("@metamask/controller-utils"),h=e("../../../shared/constants/network"),p=e("../constants/contracts"),m=e("../../../shared/constants/accounts"),g=e("../lib/util"),f=e("../lib/batch-utils");function y(e){return e&&e.__esModule?e:{default:e}}function w(e,t,n){v(e,t),t.set(e,n)}function v(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function b(e,t){return e.get(C(e,t))}function k(e,t,n){return e.set(C(e,t),n),n}function C(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const S="AccountTrackerController",M={accounts:{includeInStateLogs:!1,persist:!0,anonymous:!1,usedInUi:!0},currentBlockGasLimit:{includeInStateLogs:!1,persist:!0,anonymous:!0,usedInUi:!0},accountsByChainId:{includeInStateLogs:!1,persist:!0,anonymous:!1,usedInUi:!0},currentBlockGasLimitByChainId:{includeInStateLogs:!1,persist:!0,anonymous:!0,usedInUi:!0}},A=()=>({accounts:{},currentBlockGasLimit:"",accountsByChainId:{},currentBlockGasLimitByChainId:{}});n.getDefaultAccountTrackerControllerState=A;var T=new WeakMap,E=new WeakMap,I=new WeakMap,_=new WeakMap,P=new WeakMap,j=new WeakMap,N=new WeakMap,O=new WeakMap,B=new WeakSet,R=new WeakMap;class x extends u.BaseController{constructor(e){var t,n;super({name:S,metadata:M,state:{accounts:{},currentBlockGasLimit:"",accountsByChainId:{},currentBlockGasLimitByChainId:{},...e.state},messenger:e.messenger}),v(t=this,n=B),n.add(t),w(this,T,new Map),w(this,E,{}),w(this,I,void 0),w(this,_,void 0),w(this,P,{}),w(this,j,void 0),w(this,N,void 0),w(this,O,void 0),w(this,R,async e=>{await C(B,this,K).call(this,undefined,e)}),k(I,this,e.provider),k(_,this,e.blockTracker),k(j,this,e.getNetworkIdentifier),k(O,this,e.accountsApiChainIds??(()=>[])),this.messagingSystem.subscribe("KeyringController:accountRemoved",e=>this.removeAccounts([e]));const r=this.messagingSystem.call("OnboardingController:getState");this.messagingSystem.subscribe("OnboardingController:stateChange",(0,g.previousValueComparator)((e,t)=>{const{completedOnboarding:n}=e,{completedOnboarding:r}=t;return!n&&r&&this.updateAccountsAllActiveNetworks(),!0},r)),k(N,this,this.messagingSystem.call("AccountsController:getSelectedAccount")),this.messagingSystem.subscribe("AccountsController:selectedEvmAccountChange",e=>{const{useMultiAccountBalanceChecker:t}=this.messagingSystem.call("PreferencesController:getState");b(N,this).id===e.id||t||(k(N,this,e),this.updateAccountsAllActiveNetworks())}),this._registerMessageHandlers()}resetState(){const{accounts:e,accountsByChainId:t,currentBlockGasLimit:n,currentBlockGasLimitByChainId:r}={accounts:{},currentBlockGasLimit:"",accountsByChainId:{},currentBlockGasLimitByChainId:{}};this.update(s=>{s.accounts=e,s.accountsByChainId=t,s.currentBlockGasLimit=n,s.currentBlockGasLimitByChainId=r})}start(){k(P,this,{[C(B,this,D).call(this)]:b(_,this).getCurrentBlock()}),b(_,this).once("latest",e=>{b(P,this)[C(B,this,D).call(this)]=e}),b(_,this).removeListener("latest",b(R,this)),b(_,this).addListener("latest",b(R,this)),this.updateAccounts()}stop(){b(_,this).removeListener("latest",b(R,this))}startPollingByNetworkClientId(e){const t=(0,r.v4)(),n=b(T,this).get(e);if(n)n.add(t);else{const n=new Set;n.add(t),b(T,this).set(e,n),C(B,this,F).call(this,e)}return t}stopAllPolling(){this.stop(),b(T,this).forEach((e,t)=>{e.forEach(e=>{this.stopPollingByPollingToken(e)})})}stopPollingByPollingToken(e){if(!e)throw new Error("pollingToken required");b(T,this).forEach((t,n)=>{t.has(e)&&(t.delete(e),0===t.size&&(b(T,this).delete(n),C(B,this,U).call(this,n)))})}syncWithAddresses(e){const{accounts:t}=this.state,n=Object.keys(t),r=[];e.forEach(e=>{n.includes(e)||r.push(e)});const s=[];n.forEach(t=>{e.includes(t)||s.push(t)}),this.addAccounts(r),this.removeAccounts(s)}addAccounts(e){const{accounts:t,accountsByChainId:n}=this.state,r=(0,c.cloneDeep)(t),s=(0,c.cloneDeep)(n);e.forEach(e=>{r[e]={}}),Object.keys(s).forEach(t=>{e.forEach(e=>{s[t][e]={}})}),this.update(e=>{e.accounts=r,e.accountsByChainId=s}),b(P,this)[C(B,this,D).call(this)]&&this.updateAccounts(),b(T,this).forEach((e,t)=>{const{chainId:n}=C(B,this,L).call(this,t);b(P,this)[n]&&this.updateAccounts(t)})}removeAccounts(e){const{accounts:t,accountsByChainId:n}=this.state,r=(0,c.cloneDeep)(t),s=(0,c.cloneDeep)(n);e.forEach(e=>{delete r[e]}),Object.keys(s).forEach(t=>{e.forEach(e=>{delete s[t][e]})}),this.update(e=>{e.accounts=r,e.accountsByChainId=s})}clearAccounts(){this.update(e=>{e.accounts={},e.accountsByChainId={[C(B,this,D).call(this)]:{}}})}async updateAccountsAllActiveNetworks(){const{completedOnboarding:e}=this.messagingSystem.call("OnboardingController:getState");if(!e)return;const{useMultiAccountBalanceChecker:t}=this.messagingSystem.call("PreferencesController:getState");let n=[];if(t){const{accounts:e}=this.state;n=Object.keys(e)}else{n=[this.messagingSystem.call("AccountsController:getSelectedAccount").address]}const{useExternalServices:r}=this.messagingSystem.call("PreferencesController:getState");if(b(O,this).call(this).length>0&&r&&t)try{if(await C(B,this,z).call(this,n))return void s.default.debug("Successfully updated all accounts via multiaccount API v4")}catch(e){s.default.warn("Multiaccount API failed, falling back to individual requests:",e)}await this.updateAccounts(),await Promise.all(Array.from(b(T,this)).map(([e])=>this.updateAccounts(e)))}async updateAccounts(e){const{completedOnboarding:t}=this.messagingSystem.call("OnboardingController:getState");if(!t)return;const{chainId:n,provider:r,identifier:i}=C(B,this,L).call(this,e),{useMultiAccountBalanceChecker:o,useExternalServices:a}=this.messagingSystem.call("PreferencesController:getState");let c=[];if(o){const{accounts:e}=this.state;c=Object.keys(e)}else{c=[this.messagingSystem.call("AccountsController:getSelectedAccount").address]}let l=!1;if(b(O,this).call(this).includes(n)&&a&&o)try{if(l=await C(B,this,V).call(this,c,n),l)return void s.default.debug(`Successfully updated balances via multiaccount API v4 for chain ${n}`)}catch(e){s.default.warn("Account API failed, falling back to RPC/balance checker:",e)}i!==h.LOCALHOST_RPC_URL&&"http://127.0.0.1:8545"!==i&&n in p.SINGLE_CALL_BALANCES_ADDRESSES?await C(B,this,G).call(this,c,p.SINGLE_CALL_BALANCES_ADDRESSES[n],r,n):await Promise.all(c.map(e=>C(B,this,W).call(this,e,r,n)))}async updateAccountByAddress({address:e,networkClientId:t}={}){const{completedOnboarding:n}=this.messagingSystem.call("OnboardingController:getState");if(!n)return;const r=e||this.messagingSystem.call("AccountsController:getSelectedAccount").address;if(!r)return;const{chainId:s,provider:i}=C(B,this,L).call(this,t);await C(B,this,W).call(this,r,i,s)}updateNativeBalances(e){this.update(t=>{e.forEach(({address:e,chainId:n,balance:r})=>{const s=e.toLowerCase();t.accountsByChainId[n]||(t.accountsByChainId[n]={}),t.accountsByChainId[n][s]||(t.accountsByChainId[n][s]={address:s,balance:"0x0"}),r&&(t.accountsByChainId[n][s].balance=(0,d.toHex)(r))})})}updateStakedBalances(e){this.update(t=>{e.forEach(({address:e,chainId:n,stakedBalance:r})=>{t.accountsByChainId[n]||(t.accountsByChainId[n]={}),t.accountsByChainId[n][e]||(t.accountsByChainId[n][e]={address:e,balance:"0x0"}),r&&(t.accountsByChainId[n][e].stakedBalance=(0,d.toHex)(r))})})}_registerMessageHandlers(){this.messagingSystem.registerActionHandler(`${S}:updateNativeBalances`,this.updateNativeBalances.bind(this)),this.messagingSystem.registerActionHandler(`${S}:updateStakedBalances`,this.updateStakedBalances.bind(this))}}function D(){const{selectedNetworkClientId:e}=this.messagingSystem.call("NetworkController:getState"),{configuration:{chainId:t}}=this.messagingSystem.call("NetworkController:getNetworkClientById",e);return t}function L(e){if(e){const{configuration:t,provider:n,blockTracker:r}=this.messagingSystem.call("NetworkController:getNetworkClientById",e);return{chainId:t.chainId,provider:n,blockTracker:r,identifier:b(j,this).call(this,t)}}return{chainId:C(B,this,D).call(this),provider:b(I,this),blockTracker:b(_,this),identifier:b(j,this).call(this)}}function F(e){if(b(E,this)[e])return;const{blockTracker:t}=C(B,this,L).call(this,e),n=t=>C(B,this,K).call(this,e,t);t.addListener("latest",n),b(E,this)[e]=n,this.updateAccounts(e)}function U(e){if(!b(E,this)[e])return;const{blockTracker:t}=C(B,this,L).call(this,e);t.removeListener("latest",b(E,this)[e]),delete b(E,this)[e]}function $(e){const{accounts:t,accountsByChainId:n}=this.state;if(n[e])return(0,c.cloneDeep)(n[e]);const r={};return Object.keys(t).forEach(e=>{r[e]={}}),r}async function K(e,t){const{chainId:n,provider:r}=C(B,this,L).call(this,e);b(P,this)[n]=t;const i=await r.request({method:"eth_getBlockByNumber",params:[t,!1]});if(!i)return;const o=i.gasLimit;this.update(e=>{n===C(B,this,D).call(this)&&(e.currentBlockGasLimit=o),e.currentBlockGasLimitByChainId[n]=o});try{await this.updateAccounts(e)}catch(e){s.default.error(e)}}async function W(e,t,n){const{useMultiAccountBalanceChecker:r}=this.messagingSystem.call("PreferencesController:getState");let s="0x0";try{s=await t.request({method:"eth_getBalance",params:[e,"latest"]})}catch(e){if(e&&"object"==typeof e&&(0,l.hasProperty)(e,"data")&&e.data&&(0,l.hasProperty)(e.data,"request")&&e.data.request&&(0,l.hasProperty)(e.data.request,"method")&&"eth_getBalance"!==e.data.request.method)throw e}const i={address:e,balance:s},o=C(B,this,$).call(this,n);if(!o[e])return;let a=o;r||(a={},Object.keys(o).forEach(t=>{e!==t&&(a[t]={address:t,balance:null})})),a[e]=i,this.update(e=>{n===C(B,this,D).call(this)&&(e.accounts=a),e.accountsByChainId[n]=a})}async function G(e,t,n,r){const c=await new o.Contract(t,a.default,new i.Web3Provider(n)),l=["0x0000000000000000000000000000000000000000"];try{const t=await c.balances(e,l),n=C(B,this,$).call(this,r),s={};Object.keys(n).forEach(t=>{e.includes(t)||(s[t]={address:t,balance:null})}),e.forEach((e,n)=>{const r=t[n]?t[n].toHexString():"0x0";s[e]={address:e,balance:r}}),this.update(e=>{r===C(B,this,D).call(this)&&(e.accounts=s),e.accountsByChainId[r]=s})}catch(t){s.default.warn("MetaMask - Account Tracker single call balance fetch failed",t),Promise.allSettled(e.map(e=>C(B,this,W).call(this,e,n,r)))}}async function H(e,t){try{const{useExternalServices:n}=this.messagingSystem.call("PreferencesController:getState");if(!n)return null;const r=t.filter(e=>b(O,this).call(this).includes(e)).map(e=>e);if(0===r.length)return null;return await(0,f.fetchAccountBalancesInBatches)({addresses:e,supportedChainIds:r,accountApiBaseUrl:m.ACCOUNTS_PROD_API_BASE_URL,batchSize:50,logger:{warn:e=>s.default.warn(e),debug:e=>s.default.debug(e)}})}catch(e){return s.default.warn("Failed to fetch balances from account API:",e),null}}async function q(e,t){try{const n=await C(B,this,H).call(this,e,[t]);return!(null==n||!n.balances)&&(this.update(r=>{const s=C(B,this,$).call(this,t),i={};Object.keys(s).forEach(t=>{e.includes(t)||(i[t]={address:t,balance:null})}),e.forEach(e=>{const r=(0,l.toCaipAccountId)("eip155",t,e);let o=null;for(const e in n.balances)if(Object.prototype.hasOwnProperty.call(n.balances,e)){const t=n.balances[e];if(t.accountAddress===r&&"native"===t.type&&"0x0000000000000000000000000000000000000000"===t.address){o=t;break}}if(o){const t=BigInt(Math.floor(parseFloat(o.balance)*Math.pow(10,o.decimals)));i[e]={address:e,balance:`0x${t.toString(16)}`}}else{const t=s[e];i[e]=t||{address:e,balance:null}}}),t===C(B,this,D).call(this)&&(r.accounts=i),r.accountsByChainId[t]=i}),!0)}catch(e){return s.default.warn("Failed to update accounts via multiaccount API:",e),!1}}async function V(e,t){return C(B,this,q).call(this,e,t)}async function z(e){try{const t=new Set;t.add(C(B,this,D).call(this)),b(T,this).forEach((e,n)=>{const{chainId:r}=C(B,this,L).call(this,n);t.add(r)});const n=Array.from(t);let r=!0;for(const t of n){await C(B,this,q).call(this,e,t)||(r=!1)}return r}catch(e){return s.default.warn("Failed to update accounts for all chains via multiaccount API:",e),!1}}n.default=x}}},{package:"$root$",file:"app/scripts/controllers/account-tracker-controller.ts"}],[199,{"../../../shared/constants/alerts":5779,"@metamask/base-controller":1268},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getDefaultAlertControllerState=n.AlertController=void 0;var r=e("@metamask/base-controller"),s=e("../../../shared/constants/alerts");function i(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function o(e,t,n){return e.set(a(e,t),n),n}function a(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const c=()=>({alertEnabledness:s.TOGGLEABLE_ALERT_TYPES.reduce((e,t)=>(e[t]=!0,e),{}),unconnectedAccountAlertShownOrigins:{},web3ShimUsageOrigins:{}});n.getDefaultAlertControllerState=c;const l={alertEnabledness:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},unconnectedAccountAlertShownOrigins:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!0},web3ShimUsageOrigins:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!0}};var u=new WeakMap,d=new WeakSet;class h extends r.BaseController{constructor(e){var t,n;super({messenger:e.messenger,metadata:l,name:"AlertController",state:{...c(),...e.state}}),i(t=this,n=d),n.add(t),function(e,t,n){i(e,t),t.set(e,n)}(this,u,void 0),o(u,this,this.messagingSystem.call("AccountsController:getSelectedAccount").address),this.messagingSystem.subscribe("AccountsController:selectedAccountChange",e=>{this.state.unconnectedAccountAlertShownOrigins&&function(e,t){return e.get(a(e,t))}(u,this)!==e.address&&(o(u,this,e.address),this.update(e=>{e.unconnectedAccountAlertShownOrigins={}}))})}setAlertEnabledness(e,t){this.update(n=>{n.alertEnabledness[e]=t})}setUnconnectedAccountAlertShown(e){this.update(t=>{t.unconnectedAccountAlertShownOrigins[e]=!0})}getWeb3ShimUsageState(e){var t;return null===(t=this.state.web3ShimUsageOrigins)||void 0===t?void 0:t[e]}setWeb3ShimUsageRecorded(e){a(d,this,p).call(this,e,s.Web3ShimUsageAlertStates.recorded)}setWeb3ShimUsageAlertDismissed(e){a(d,this,p).call(this,e,s.Web3ShimUsageAlertStates.dismissed)}}function p(e,t){this.update(n=>{n.web3ShimUsageOrigins&&(n.web3ShimUsageOrigins[e]=t)})}n.AlertController=h}}},{package:"$root$",file:"app/scripts/controllers/alert-controller.ts"}],[20,{"./assets-contract-controller-init":19,"./network-order-controller-init":22,"./nft-controller-init":23,"./nft-detection-controller-init":24,"./token-rates-controller-init":25},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"AssetsContractControllerInit",{enumerable:!0,get:function(){return o.AssetsContractControllerInit}}),Object.defineProperty(n,"NetworkOrderControllerInit",{enumerable:!0,get:function(){return a.NetworkOrderControllerInit}}),Object.defineProperty(n,"NftControllerInit",{enumerable:!0,get:function(){return s.NftControllerInit}}),Object.defineProperty(n,"NftDetectionControllerInit",{enumerable:!0,get:function(){return i.NftDetectionControllerInit}}),Object.defineProperty(n,"TokenRatesControllerInit",{enumerable:!0,get:function(){return r.TokenRatesControllerInit}});var r=e("./token-rates-controller-init"),s=e("./nft-controller-init"),i=e("./nft-detection-controller-init"),o=e("./assets-contract-controller-init"),a=e("./network-order-controller-init")}}},{package:"$root$",file:"app/scripts/controller-init/assets/index.ts"}],[200,{"@metamask/base-controller":1268},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getDefaultAppMetadataControllerState=n.default=void 0;var r=e("@metamask/base-controller");function s(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function i(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const o=()=>({currentAppVersion:"",previousAppVersion:"",previousMigrationVersion:0,currentMigrationVersion:0});n.getDefaultAppMetadataControllerState=o;const a={currentAppVersion:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!1},previousAppVersion:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!1},previousMigrationVersion:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!1},currentMigrationVersion:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!1}};var c=new WeakSet;class l extends r.BaseController{constructor({state:e={},messenger:t,currentAppVersion:n="",currentMigrationVersion:r=0}){super({name:"AppMetadataController",metadata:a,state:{currentAppVersion:"",previousAppVersion:"",previousMigrationVersion:0,currentMigrationVersion:0,...e},messenger:t}),s(this,c),i(c,this,u).call(this,n),i(c,this,d).call(this,r)}}function u(e){const t=this.state.currentAppVersion;e!==t&&this.update(n=>{n.currentAppVersion=e,n.previousAppVersion=t})}function d(e){const t=this.state.currentMigrationVersion;e!==t&&this.update(n=>{n.previousMigrationVersion=t,n.currentMigrationVersion=e})}n.default=l}}},{package:"$root$",file:"app/scripts/controllers/app-metadata.ts"}],[201,{"../../../shared/constants/alarms":5778,"../../../shared/constants/app":5781,"../../../shared/constants/preferences":5805,"../../../shared/constants/time":5817,"../../../shared/modules/mv3.utils":5909,"../../../ui/helpers/utils/build-types":7049,"@metamask/base-controller":1268,"@metamask/controller-utils":1349,"@metamask/utils":2908,loglevel:4824,uuid:5732},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.AppStateController=void 0;var r,s=e("uuid"),i=(r=e("loglevel"))&&r.__esModule?r:{default:r},o=e("@metamask/controller-utils"),a=e("@metamask/base-controller"),c=e("@metamask/utils"),l=e("../../../shared/constants/time"),u=e("../../../shared/constants/alarms"),d=e("../../../shared/modules/mv3.utils"),h=e("../../../ui/helpers/utils/build-types"),p=e("../../../shared/constants/app"),m=e("../../../shared/constants/preferences");function g(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t,n){y(e,t),t.set(e,n)}function y(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function w(e,t){return e.get(b(e,t))}function v(e,t,n){return e.set(b(e,t),n),n}function b(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const k={activeQrCodeScanRequest:{includeInStateLogs:!1,persist:!1,anonymous:!0,usedInUi:!0},addressSecurityAlertResponses:{includeInStateLogs:!0,persist:!1,anonymous:!0,usedInUi:!0},browserEnvironment:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},connectedStatusPopoverHasBeenShown:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},currentExtensionPopupId:{includeInStateLogs:!0,persist:!1,anonymous:!0,usedInUi:!0},currentPopupId:{includeInStateLogs:!0,persist:!1,anonymous:!0,usedInUi:!0},defaultHomeActiveTabName:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},enableEnforcedSimulations:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},enableEnforcedSimulationsForTransactions:{includeInStateLogs:!0,persist:!1,anonymous:!0,usedInUi:!0},enforcedSimulationsSlippage:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},enforcedSimulationsSlippageForTransactions:{includeInStateLogs:!0,persist:!1,anonymous:!0,usedInUi:!0},fullScreenGasPollTokens:{includeInStateLogs:!0,persist:!1,anonymous:!0,usedInUi:!0},hadAdvancedGasFeesSetPriorToMigration92_3:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!1},isRampCardClosed:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},isUpdateAvailable:{includeInStateLogs:!0,persist:!1,anonymous:!0,usedInUi:!0},lastInteractedConfirmationInfo:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},lastUpdatedAt:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},lastViewedUserSurvey:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},networkConnectionBanner:{includeInStateLogs:!1,persist:!1,anonymous:!1,usedInUi:!0},newPrivacyPolicyToastClickedOrClosed:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},newPrivacyPolicyToastShownDate:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},nftsDetectionNoticeDismissed:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!1},nftsDropdownState:{includeInStateLogs:!0,persist:!1,anonymous:!0,usedInUi:!0},notificationGasPollTokens:{includeInStateLogs:!0,persist:!1,anonymous:!0,usedInUi:!0},onboardingDate:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},outdatedBrowserWarningLastShown:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},popupGasPollTokens:{includeInStateLogs:!0,persist:!1,anonymous:!0,usedInUi:!0},productTour:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},recoveryPhraseReminderHasBeenShown:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},recoveryPhraseReminderLastShown:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},showAccountBanner:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},showBetaHeader:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},showDownloadMobileAppSlide:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},showNetworkBanner:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},showPermissionsTour:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},showTestnetMessageInDropdown:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!1},signatureSecurityAlertResponses:{includeInStateLogs:!0,persist:!1,anonymous:!0,usedInUi:!0},slides:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},snapsInstallPrivacyWarningShown:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},surveyLinkLastClickedOrClosed:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},shieldEndingToastLastClickedOrClosed:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},shieldPausedToastLastClickedOrClosed:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},termsOfUseLastAgreed:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},throttledOrigins:{includeInStateLogs:!0,persist:!1,anonymous:!0,usedInUi:!0},timeoutMinutes:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!1},trezorModel:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!1},updateModalLastDismissedAt:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},hasShownMultichainAccountsIntroModal:{persist:!0,anonymous:!0,usedInUi:!0,includeInStateLogs:!0},showShieldEntryModalOnce:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0}};var C=new WeakMap,S=new WeakMap,M=new WeakMap,A=new WeakMap,T=new WeakMap,E=new WeakSet;class I extends a.BaseController{constructor({state:e={},messenger:t,onInactiveTimeout:n,extension:r}){super({name:"AppStateController",metadata:k,state:{activeQrCodeScanRequest:null,browserEnvironment:{},connectedStatusPopoverHasBeenShown:!0,defaultHomeActiveTabName:null,enableEnforcedSimulations:!0,enableEnforcedSimulationsForTransactions:{},enforcedSimulationsSlippage:10,enforcedSimulationsSlippageForTransactions:{},fullScreenGasPollTokens:[],hadAdvancedGasFeesSetPriorToMigration92_3:!1,isRampCardClosed:!1,isUpdateAvailable:!1,lastUpdatedAt:null,lastViewedUserSurvey:null,newPrivacyPolicyToastClickedOrClosed:null,newPrivacyPolicyToastShownDate:null,nftsDetectionNoticeDismissed:!1,notificationGasPollTokens:[],onboardingDate:null,outdatedBrowserWarningLastShown:null,popupGasPollTokens:[],productTour:"accountIcon",recoveryPhraseReminderHasBeenShown:!1,recoveryPhraseReminderLastShown:(new Date).getTime(),showAccountBanner:!0,showBetaHeader:(0,h.isBeta)(),showDownloadMobileAppSlide:!0,showNetworkBanner:!0,showPermissionsTour:!0,showTestnetMessageInDropdown:!0,slides:[],surveyLinkLastClickedOrClosed:null,shieldEndingToastLastClickedOrClosed:null,shieldPausedToastLastClickedOrClosed:null,throttledOrigins:{},timeoutMinutes:m.DEFAULT_AUTO_LOCK_TIME_LIMIT,trezorModel:null,updateModalLastDismissedAt:null,hasShownMultichainAccountsIntroModal:!1,showShieldEntryModalOnce:null,addressSecurityAlertResponses:{},currentExtensionPopupId:0,nftsDropdownState:{},signatureSecurityAlertResponses:{},networkConnectionBanner:{status:"unknown"},...e,addressSecurityAlertResponses:{},currentExtensionPopupId:0,nftsDropdownState:{},signatureSecurityAlertResponses:{},networkConnectionBanner:{status:"unknown"}},messenger:t}),function(e,t){y(e,t),t.add(e)}(this,E),f(this,C,void 0),f(this,S,void 0),f(this,M,void 0),g(this,"waitingForUnlock",void 0),f(this,A,void 0),f(this,T,null),g(this,"getAddressSecurityAlertResponse",e=>{const t=this.state.addressSecurityAlertResponses[e.toLowerCase()];if(!t)return undefined;const n=Date.now(),r=15*l.MINUTE;if(n-t.timestamp>r)return this.update(t=>{delete t.addressSecurityAlertResponses[e.toLowerCase()]}),undefined;const{timestamp:s,...i}=t;return i}),g(this,"addAddressSecurityAlertResponse",(e,t)=>{this.update(n=>{n.addressSecurityAlertResponses[e.toLowerCase()]={...t,timestamp:Date.now()}})}),v(C,this,r),v(S,this,n||(()=>undefined)),v(M,this,null),this.waitingForUnlock=[],t.subscribe("KeyringController:unlock",b(E,this,P).bind(this)),t.subscribe("PreferencesController:stateChange",({preferences:e})=>{const t=this.state;"number"==typeof(null==e?void 0:e.autoLockTimeLimit)&&t.timeoutMinutes!==e.autoLockTimeLimit&&b(E,this,j).call(this,e.autoLockTimeLimit)});const{preferences:s}=t.call("PreferencesController:getState");"number"==typeof s.autoLockTimeLimit&&b(E,this,j).call(this,s.autoLockTimeLimit),this.messagingSystem.registerActionHandler("AppStateController:getUnlockPromise",this.getUnlockPromise.bind(this)),this.messagingSystem.registerActionHandler("AppStateController:requestQrCodeScan",b(E,this,D).bind(this)),v(A,this,null)}getUnlockPromise(e){return new Promise(t=>{const{isUnlocked:n}=this.messagingSystem.call("KeyringController:getState");n?t():b(E,this,_).call(this,t,e)})}setDefaultHomeActiveTabName(e){this.update(t=>{t.defaultHomeActiveTabName=e})}setConnectedStatusPopoverHasBeenShown(){this.update(e=>{e.connectedStatusPopoverHasBeenShown=!0})}setRecoveryPhraseReminderHasBeenShown(){this.update(e=>{e.recoveryPhraseReminderHasBeenShown=!0})}setSurveyLinkLastClickedOrClosed(e){this.update(t=>{t.surveyLinkLastClickedOrClosed=e})}setOnboardingDate(){this.update(e=>{e.onboardingDate=Date.now()})}setLastViewedUserSurvey(e){this.update(t=>{t.lastViewedUserSurvey=e})}setRampCardClosed(){this.update(e=>{e.isRampCardClosed=!0})}setNewPrivacyPolicyToastClickedOrClosed(){this.update(e=>{e.newPrivacyPolicyToastClickedOrClosed=!0})}setNewPrivacyPolicyToastShownDate(e){this.update(t=>{t.newPrivacyPolicyToastShownDate=e})}setShieldPausedToastLastClickedOrClosed(e){this.update(t=>{t.shieldPausedToastLastClickedOrClosed=e})}setShieldEndingToastLastClickedOrClosed(e){this.update(t=>{t.shieldEndingToastLastClickedOrClosed=e})}updateSlides(e){this.update(t=>{const n=t.slides||[],r=e.map(e=>{const t=n.find(t=>t.id===e.id);return t?{...t,...e}:e});t.slides=[...r]})}removeSlide(e){this.update(t=>{const n=t.slides||[];t.slides=n.map(t=>t.id===e?{...t,dismissed:!0}:t),e===p.DOWNLOAD_MOBILE_APP_SLIDE_ID&&(t.showDownloadMobileAppSlide=!1)})}setRecoveryPhraseReminderLastShown(e){this.update(t=>{t.recoveryPhraseReminderLastShown=e})}setTermsOfUseLastAgreed(e){this.update(t=>{t.termsOfUseLastAgreed=e})}setSnapsInstallPrivacyWarningShownStatus(e){this.update(t=>{t.snapsInstallPrivacyWarningShown=e})}setOutdatedBrowserWarningLastShown(e){this.update(t=>{t.outdatedBrowserWarningLastShown=e})}setLastActiveTime(){b(E,this,N).call(this)}setIsUpdateAvailable(e){this.update(t=>{t.isUpdateAvailable=e})}setUpdateModalLastDismissedAt(e){this.update(t=>{t.updateModalLastDismissedAt=e})}setLastUpdatedAt(e){this.update(t=>{t.lastUpdatedAt=e})}setBrowserEnvironment(e,t){this.update(n=>{n.browserEnvironment={os:e,browser:t}})}addPollingToken(e,t){t.toString()!==p.POLLING_TOKEN_ENVIRONMENT_TYPES[p.ENVIRONMENT_TYPE_BACKGROUND]&&b(E,this,B).call(this,t)&&b(E,this,O).call(this,e,t)}removePollingToken(e,t){if(t.toString()!==p.POLLING_TOKEN_ENVIRONMENT_TYPES[p.ENVIRONMENT_TYPE_BACKGROUND]){const n=this.state[t];b(E,this,B).call(this,t)&&this.update(r=>{r[t]=n.filter(t=>t!==e)})}}clearPollingTokens(){this.update(e=>{e.popupGasPollTokens=[],e.notificationGasPollTokens=[],e.fullScreenGasPollTokens=[]})}setShowTestnetMessageInDropdown(e){this.update(t=>{t.showTestnetMessageInDropdown=e})}setShowBetaHeader(e){this.update(t=>{t.showBetaHeader=e})}setShowPermissionsTour(e){this.update(t=>{t.showPermissionsTour=e})}setHasShownMultichainAccountsIntroModal(e){this.update(t=>{t.hasShownMultichainAccountsIntroModal=e})}setProductTour(e){this.update(t=>{t.productTour=e})}setShowNetworkBanner(e){this.update(t=>{t.showNetworkBanner=e})}updateNetworkConnectionBanner(e){this.update(t=>{t.networkConnectionBanner=e})}setShowAccountBanner(e){this.update(t=>{t.showAccountBanner=e})}setCurrentExtensionPopupId(e){this.update(t=>{t.currentExtensionPopupId=e})}setTrezorModel(e){this.update(t=>{t.trezorModel=e})}updateNftDropDownState(e){this.update(t=>{t.nftsDropdownState=e})}getSignatureSecurityAlertResponse(e){return this.state.signatureSecurityAlertResponses[e]}addSignatureSecurityAlertResponse(e){e.securityAlertId&&this.update(t=>{t.signatureSecurityAlertResponses[String(e.securityAlertId)]=e})}setCurrentPopupId(e){this.update(t=>{t.currentPopupId=e})}getLastInteractedConfirmationInfo(){return this.state.lastInteractedConfirmationInfo}setLastInteractedConfirmationInfo(e){this.update(t=>{t.lastInteractedConfirmationInfo=e})}getCurrentPopupId(){return this.state.currentPopupId}getThrottledOriginState(e){return this.state.throttledOrigins[e]}updateThrottledOriginState(e,t){this.update(n=>{n.throttledOrigins[e]=t})}completeQrCodeScan(e){if(!w(T,this))throw new Error("No QR code scan is in progress.");this.update(e=>{e.activeQrCodeScanRequest=null}),w(T,this).resolve(e),v(T,this,null)}cancelQrCodeScan(e){if(!w(T,this))throw new Error("No QR code scan is in progress.");this.update(e=>{e.activeQrCodeScanRequest=null}),w(T,this).reject(e||new Error("Scan cancelled")),v(T,this,null)}setEnableEnforcedSimulations(e){this.update(t=>{t.enableEnforcedSimulations=e})}setEnableEnforcedSimulationsForTransaction(e,t){this.update(n=>{n.enableEnforcedSimulationsForTransactions[e]=t})}setEnforcedSimulationsSlippage(e){this.update(t=>{t.enforcedSimulationsSlippage=e})}setEnforcedSimulationsSlippageForTransaction(e,t){this.update(n=>{n.enforcedSimulationsSlippageForTransactions[e]=t})}setShowShieldEntryModalOnce(e){this.update(t=>{t.showShieldEntryModalOnce=e})}}function _(e,t){this.waitingForUnlock.push({resolve:e}),this.messagingSystem.publish("AppStateController:unlockChange"),t&&b(E,this,R).call(this)}function P(){if(this.waitingForUnlock.length>0){for(;this.waitingForUnlock.length>0;){var e;null===(e=this.waitingForUnlock.shift())||void 0===e||e.resolve()}this.messagingSystem.publish("AppStateController:unlockChange")}b(E,this,x).call(this)}function j(e){this.update(t=>{t.timeoutMinutes=e}),b(E,this,N).call(this)}function N(){const{timeoutMinutes:e}=this.state;if(w(M,this)?clearTimeout(w(M,this)):d.isManifestV3&&w(C,this).alarms.clear(u.AUTO_LOCK_TIMEOUT_ALARM),!e)return;const t=Number(e);d.isManifestV3?(w(C,this).alarms.create(u.AUTO_LOCK_TIMEOUT_ALARM,{delayInMinutes:t,periodInMinutes:t}),w(C,this).alarms.onAlarm.addListener(e=>{e.name===u.AUTO_LOCK_TIMEOUT_ALARM&&(w(S,this).call(this),w(C,this).alarms.clear(u.AUTO_LOCK_TIMEOUT_ALARM))})):v(M,this,setTimeout(()=>w(S,this).call(this),t*l.MINUTE))}function O(e,t){this.update(n=>{n[t].push(e)})}function B(e){return["popupGasPollTokens","notificationGasPollTokens","fullScreenGasPollTokens"].includes(e)}function R(){w(A,this)||(v(A,this,(0,s.v4)()),this.messagingSystem.call("ApprovalController:addRequest",{id:w(A,this),origin:p.ORIGIN_METAMASK,type:o.ApprovalType.Unlock},!0).catch(()=>{v(A,this,null)}))}function x(){if(w(A,this)){try{this.messagingSystem.call("ApprovalController:acceptRequest",w(A,this))}catch(e){i.default.error("Failed to unlock approval request",e)}v(A,this,null)}}function D(e){if(w(T,this))return w(T,this).promise;const t=(0,c.createDeferredPromise)();return v(T,this,t),this.update(t=>{t.activeQrCodeScanRequest=e}),t.promise}n.AppStateController=I}}},{package:"$root$",file:"app/scripts/controllers/app-state-controller.ts"}],[202,{"../../../shared/constants/metametrics":5796,"../../../shared/modules/hexstring-utils":5906,"@metamask/base-controller":1268,"@metamask/controller-utils":1349,"@metamask/utils":2908,buffer:4061,loglevel:4824},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){Object.defineProperty(n,"__esModule",{value:!0}),n.isEIP1024EncryptedMessage=n.getDefaultState=n.default=void 0;var r,s=(r=e("loglevel"))&&r.__esModule?r:{default:r},i=e("@metamask/base-controller"),o=e("@metamask/controller-utils"),a=e("@metamask/utils"),c=e("../../../shared/constants/metametrics"),l=e("../../../shared/modules/hexstring-utils");function u(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const d={unapprovedDecryptMsgs:{includeInStateLogs:!0,persist:!1,anonymous:!1,usedInUi:!0},unapprovedDecryptMsgCount:{includeInStateLogs:!0,persist:!1,anonymous:!1,usedInUi:!0}},h=e=>!!((0,a.isObject)(e.data)&&(0,a.hasProperty)(e.data,"version")&&(0,a.hasProperty)(e.data,"nonce")&&(0,a.hasProperty)(e.data,"ephemPublicKey")&&(0,a.hasProperty)(e.data,"ciphertext"));n.isEIP1024EncryptedMessage=h;const p=()=>({unapprovedDecryptMsgs:{},unapprovedDecryptMsgCount:0});n.getDefaultState=p;class m extends i.BaseController{constructor({getState:e,metricsEvent:t,messenger:n,manager:r}){super({metadata:d,messenger:n,name:"DecryptMessageController",state:{unapprovedDecryptMsgs:{},unapprovedDecryptMsgCount:0}}),u(this,"_getState",void 0),u(this,"_metricsEvent",void 0),u(this,"_decryptMessageManager",void 0),this._getState=e,this._metricsEvent=t,this._decryptMessageManager=r,n.subscribe("DecryptMessageManager:unapprovedMessage",this._requestApproval.bind(this)),this._subscribeToMessageState(n,(e,t,n)=>{e.unapprovedDecryptMsgs=t,e.unapprovedDecryptMsgCount=n})}get unapprovedDecryptMsgCount(){return this._decryptMessageManager.getUnapprovedMessagesCount()}resetState(){this.update(()=>({unapprovedDecryptMsgs:{},unapprovedDecryptMsgCount:0}))}clearUnapproved(){this._decryptMessageManager.clearUnapprovedMessages()}async newRequestDecryptMessage(e,t){return this._decryptMessageManager.addUnapprovedMessageAsync(e,t)}async decryptMessage(e){const t=e.metamaskId;try{const n=await this._decryptMessageManager.approveMessage(e);if(n.data=this._parseMessageData(n.data),!h(n))throw new Error("Invalid encrypted data.");const r=await this.messagingSystem.call("KeyringController:decryptMessage",n);this._decryptMessageManager.setMessageStatusAndResult(t,r,"decrypted"),this._acceptApproval(t)}catch(e){throw s.default.info("MetaMaskController - eth_decrypt failed.",e),this._cancelAbstractMessage(this._decryptMessageManager,t),e}return this._getState()}async decryptMessageInline(e){const t=e.metamaskId;if(e.data=this._parseMessageData(e.data),!h(e))throw new Error("Invalid encrypted data.");const n=await this.messagingSystem.call("KeyringController:decryptMessage",e);return this._decryptMessageManager.setResult(t,n),this._getState()}cancelDecryptMessage(e){return this._decryptMessageManager.rejectMessage(e),this._rejectApproval(e),this._getState()}rejectUnapproved(e){Object.keys(this._decryptMessageManager.getUnapprovedMessages()).forEach(t=>{this._cancelAbstractMessage(this._decryptMessageManager,t,e)})}_acceptApproval(e){this.messagingSystem.call("ApprovalController:acceptRequest",e)}_cancelAbstractMessage(e,t,n){return n&&this._metricsEvent({event:n,category:c.MetaMetricsEventCategory.Messages,properties:{action:"Decrypt Message Request"}}),e.rejectMessage(t),this._rejectApproval(t),this._getState()}_subscribeToMessageState(e,t){e.subscribe("DecryptMessageManager:stateChange",e=>{const n=this._migrateMessages(e.unapprovedMessages);this.update(r=>{t(r,n,e.unapprovedMessagesCount)})})}_migrateMessages(e){const t={};for(const n of Object.keys(e)){const r=e[n],s=this._migrateMessage(r);t[n]=s}return t}_migrateMessage(e){const{messageParams:t,...n}=e;return{...n,rawSig:e.rawSig,msgParams:t,origin:t.origin}}_requestApproval(e){const t=e.metamaskId,n=e.origin||o.ORIGIN_METAMASK;try{this.messagingSystem.call("ApprovalController:addRequest",{id:t,origin:n,type:o.ApprovalType.EthDecrypt},!0)}catch(e){s.default.info("Error adding request to approval controller",e)}}_parseMessageData(e){const n=(0,l.stripHexPrefix)(e),r=t.from(n,"hex");return JSON.parse(r.toString("utf8"))}_rejectApproval(e){try{this.messagingSystem.call("ApprovalController:rejectRequest",e,"Cancel")}catch(e){s.default.info("Error rejecting request to approval controller",e)}}}n.default=m}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"$root$",file:"app/scripts/controllers/decrypt-message.ts"}],[203,{"../../../shared/constants/app":5781,"../../../shared/constants/keyring":5792,"../../../shared/constants/metametrics":5796,"@metamask/base-controller":1268,loglevel:4824},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,s=(r=e("loglevel"))&&r.__esModule?r:{default:r},i=e("@metamask/base-controller"),o=e("../../../shared/constants/metametrics"),a=e("../../../shared/constants/keyring"),c=e("../../../shared/constants/app");function l(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const u={unapprovedEncryptionPublicKeyMsgs:{includeInStateLogs:!0,persist:!1,anonymous:!1,usedInUi:!0},unapprovedEncryptionPublicKeyMsgCount:{includeInStateLogs:!0,persist:!1,anonymous:!1,usedInUi:!0}};class d extends i.BaseController{constructor({messenger:e,manager:t,getEncryptionPublicKey:n,getAccountKeyringType:r,getState:s,metricsEvent:i}){super({name:"EncryptionPublicKeyController",metadata:u,messenger:e,state:{unapprovedEncryptionPublicKeyMsgs:{},unapprovedEncryptionPublicKeyMsgCount:0}}),l(this,"_getEncryptionPublicKey",void 0),l(this,"_getAccountKeyringType",void 0),l(this,"_getState",void 0),l(this,"_encryptionPublicKeyManager",void 0),l(this,"_metricsEvent",void 0),this._getEncryptionPublicKey=n,this._getAccountKeyringType=r,this._getState=s,this._metricsEvent=i,this._encryptionPublicKeyManager=t,this.messagingSystem.subscribe("EncryptionPublicKeyManager:unapprovedMessage",this._requestApproval.bind(this)),this._subscribeToMessageState(e,(e,t,n)=>{e.unapprovedEncryptionPublicKeyMsgs=t,e.unapprovedEncryptionPublicKeyMsgCount=n})}get unapprovedMsgCount(){return this._encryptionPublicKeyManager.getUnapprovedMessagesCount()}resetState(){this.update(()=>({unapprovedEncryptionPublicKeyMsgs:{},unapprovedEncryptionPublicKeyMsgCount:0}))}async newRequestEncryptionPublicKey(e,t){switch(await this._getAccountKeyringType(e)){case a.KeyringType.ledger:return new Promise((e,t)=>{t(new Error("Ledger does not support eth_getEncryptionPublicKey."))});case a.KeyringType.trezor:return new Promise((e,t)=>{t(new Error("Trezor does not support eth_getEncryptionPublicKey."))});case a.KeyringType.lattice:return new Promise((e,t)=>{t(new Error("Lattice does not support eth_getEncryptionPublicKey."))});case a.KeyringType.qr:return Promise.reject(new Error("QR hardware does not support eth_getEncryptionPublicKey."));default:return this._encryptionPublicKeyManager.addUnapprovedMessageAsync({from:e},t)}}async encryptionPublicKey(e){s.default.info("MetaMaskController - encryptionPublicKey");const t=e.metamaskId;try{const n=await this._encryptionPublicKeyManager.approveMessage(e),r=await this._getEncryptionPublicKey(n.from);return this._encryptionPublicKeyManager.setMessageStatusAndResult(t,r,"received"),this._acceptApproval(t),this._getState()}catch(e){throw s.default.info("MetaMaskController - eth_getEncryptionPublicKey failed.",e),this._cancelAbstractMessage(this._encryptionPublicKeyManager,t),e}}cancelEncryptionPublicKey(e){return this._cancelAbstractMessage(this._encryptionPublicKeyManager,e)}rejectUnapproved(e){Object.keys(this._encryptionPublicKeyManager.getUnapprovedMessages()).forEach(t=>{this._cancelAbstractMessage(this._encryptionPublicKeyManager,t,e)})}clearUnapproved(){this._encryptionPublicKeyManager.clearUnapprovedMessages()}_cancelAbstractMessage(e,t,n){return n&&this._metricsEvent({event:n,category:o.MetaMetricsEventCategory.Messages,properties:{action:"Encryption public key Request"}}),e.rejectMessage(t),this._rejectApproval(t),this._getState()}_subscribeToMessageState(e,t){e.subscribe("EncryptionPublicKeyManager:stateChange",e=>{const n=this._migrateMessages(e.unapprovedMessages);this.update(r=>{t(r,n,e.unapprovedMessagesCount)})})}_migrateMessages(e){const t={};for(const n of Object.keys(e)){const r=e[n],s=this._migrateMessage(r);t[n]=s}return t}_migrateMessage(e){const{messageParams:t,...n}=e;return{...n,rawSig:e.rawSig,msgParams:t.from,origin:t.origin}}_requestApproval(e){const t=e.metamaskId,n=e.origin||c.ORIGIN_METAMASK;this.messagingSystem.call("ApprovalController:addRequest",{id:t,origin:n,type:"eth_getEncryptionPublicKey"},!0).catch(()=>{})}_acceptApproval(e){this.messagingSystem.call("ApprovalController:acceptRequest",e)}_rejectApproval(e){this.messagingSystem.call("ApprovalController:rejectRequest",e,"Cancel")}}n.default=d}}},{package:"$root$",file:"app/scripts/controllers/encryption-public-key.ts"}],[204,{"../../../../shared/lib/accounts/institutional-wallet-snap":5825,"@metamask/base-controller":1268,"@metamask/controller-utils":1349,"@metamask/snaps-utils":2785,"@metamask/transaction-controller":2862},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.InstitutionalSnapController=void 0;var r=e("@metamask/transaction-controller"),s=e("@metamask/snaps-utils"),i=e("@metamask/base-controller"),o=e("@metamask/controller-utils");function a(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function c(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const l=e("../../../../shared/lib/accounts/institutional-wallet-snap").INSTITUTIONAL_WALLET_SNAP_ID,u="InstitutionalSnapController",d={};var h=new WeakSet;class p extends i.BaseController{constructor({messenger:e}){super({messenger:e,name:u,state:{},metadata:d}),a(this,h),c(h,this,m).call(this)}async deferPublicationHook(e){if(await c(h,this,w).call(this,e)){const t=await c(h,this,f).call(this,e);return await c(h,this,y).call(this,e.id,t),!1}return!0}async beforeCheckPendingTransactionHook(e){return!await c(h,this,w).call(this,e)}}function m(){this.messagingSystem.registerActionHandler(`${u}:publishHook`,this.deferPublicationHook.bind(this)),this.messagingSystem.registerActionHandler(`${u}:beforeCheckPendingTransactionHook`,this.beforeCheckPendingTransactionHook.bind(this))}async function g(e){return await this.messagingSystem.call("SnapController:handleRequest",e)}async function f(e){const t={from:e.txParams.from,to:e.txParams.to,value:e.txParams.value,data:e.txParams.data,chainId:e.chainId},n={snapId:l,origin:o.ORIGIN_METAMASK,handler:s.HandlerType.OnRpcRequest,request:{method:"transactions.getMutableTransactionParameters",params:t}},i=await c(h,this,g).call(this,n);return{hash:i.transaction.transactionHash,nonce:i.transaction.nonce,gasLimit:i.transaction.gasLimit,maxFeePerGas:i.transaction.maxFeePerGas,maxPriorityFeePerGas:i.transaction.maxPriorityFeePerGas,type:i.transaction.type,status:r.TransactionStatus.submitted}}async function y(e,{status:t,hash:n,nonce:r,gasLimit:s,maxFeePerGas:i,maxPriorityFeePerGas:o,type:a}){return await this.messagingSystem.call("TransactionController:updateCustodialTransaction",{transactionId:e,status:t,hash:n,nonce:r,gasLimit:s,maxFeePerGas:i,maxPriorityFeePerGas:o,type:a})}async function w(e){var t;const n=await this.messagingSystem.call("AccountsController:getAccountByAddress",e.txParams.from);return null==n||null===(t=n.options.custodian)||void 0===t?void 0:t.deferPublication}n.InstitutionalSnapController=p}}},{package:"$root$",file:"app/scripts/controllers/institutional-snap/InstitutionalSnapController.ts"}],[205,{"../../../development/build/constants":562,"../../../shared/constants/alarms":5778,"../../../shared/constants/app":5781,"../../../shared/constants/keyring":5792,"../../../shared/constants/metametrics":5796,"../../../shared/constants/time":5817,"../../../shared/constants/transaction":5819,"../../../shared/lib/trace":5888,"../../../shared/modules/mv3.utils":5909,"../lib/util":332,"@metamask/base-controller":1268,"@metamask/name-controller":2222,"@metamask/utils":2908,buffer:4061,"ethereumjs-util":4319,lodash:4816,uuid:5732},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){Object.defineProperty(n,"__esModule",{value:!0}),n.overrideAnonymousEventNames=n.getDefaultMetaMetricsControllerState=n.default=void 0;var r=e("lodash"),s=e("ethereumjs-util"),i=e("uuid"),o=e("@metamask/name-controller"),a=e("@metamask/utils"),c=e("@metamask/base-controller"),l=e("../../../shared/constants/app"),u=e("../../../shared/constants/metametrics"),d=e("../../../shared/constants/time"),h=e("../../../shared/modules/mv3.utils"),p=e("../../../shared/constants/alarms"),m=e("../lib/util"),g=e("../../../shared/constants/transaction"),f=e("../../../shared/lib/trace"),y=e("../../../development/build/constants"),w=e("../../../shared/constants/keyring");function v(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e,t,n){k(e,t),t.set(e,n)}function k(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function C(e,t){return e.get(M(e,t))}function S(e,t,n){return e.set(M(e,t),n),n}function M(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const A=n.overrideAnonymousEventNames={[g.TransactionMetaMetricsEvent.added]:g.AnonymousTransactionMetaMetricsEvent.added,[g.TransactionMetaMetricsEvent.approved]:g.AnonymousTransactionMetaMetricsEvent.approved,[g.TransactionMetaMetricsEvent.finalized]:g.AnonymousTransactionMetaMetricsEvent.finalized,[g.TransactionMetaMetricsEvent.rejected]:g.AnonymousTransactionMetaMetricsEvent.rejected,[g.TransactionMetaMetricsEvent.submitted]:g.AnonymousTransactionMetaMetricsEvent.submitted,[u.MetaMetricsEventName.SignatureRequested]:u.MetaMetricsEventName.SignatureRequestedAnon,[u.MetaMetricsEventName.SignatureApproved]:u.MetaMetricsEventName.SignatureApprovedAnon,[u.MetaMetricsEventName.SignatureRejected]:u.MetaMetricsEventName.SignatureRejectedAnon},T=e=>{setTimeout(()=>{throw e})},E=e=>{const t=[];return e.uniqueIdentifier&&t.push(e.uniqueIdentifier),e.actionId&&t.push(e.actionId),t.length&&e.isDuplicateAnonymizedEvent&&t.push("0x000"),t.length?t.join("-"):(0,m.generateRandomId)()},I={'You must pass either an "anonymousId" or a "userId".':!0},_={metaMetricsId:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},participateInMetaMetrics:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},latestNonAnonymousEventTimestamp:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},fragments:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!0},eventsBeforeMetricsOptIn:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!1},tracesBeforeMetricsOptIn:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!1},traits:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!1},dataCollectionForMarketing:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!0},marketingCampaignCookieId:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!1},segmentApiCalls:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!1}},P=()=>({participateInMetaMetrics:null,metaMetricsId:null,dataCollectionForMarketing:null,marketingCampaignCookieId:null,latestNonAnonymousEventTimestamp:0,eventsBeforeMetricsOptIn:[],tracesBeforeMetricsOptIn:[],traits:{},fragments:{},segmentApiCalls:{}});n.getDefaultMetaMetricsControllerState=P;var j=new WeakMap,N=new WeakMap,O=new WeakMap,B=new WeakMap,R=new WeakSet,x=new WeakMap;class D extends c.BaseController{constructor({state:e={},messenger:t,segment:n,version:s,environment:i,extension:o,captureException:c=T}){var l,u;super({name:"MetaMetricsController",metadata:_,state:{participateInMetaMetrics:null,metaMetricsId:null,dataCollectionForMarketing:null,marketingCampaignCookieId:null,latestNonAnonymousEventTimestamp:0,eventsBeforeMetricsOptIn:[],tracesBeforeMetricsOptIn:[],traits:{},fragments:{},segmentApiCalls:{},...e},messenger:t}),k(l=this,u=R),u.add(l),b(this,j,void 0),v(this,"chainId",void 0),v(this,"locale",void 0),v(this,"previousUserTraits",void 0),v(this,"version",void 0),b(this,N,void 0),b(this,O,void 0),b(this,B,void 0),b(this,x,(0,r.memoize)((e={})=>Object.values(e).reduce((e,t)=>e.concat(...Object.values(t)),[]))),S(j,this,e=>{const t=(0,a.getErrorMessage)(e);I[t]||c(e)}),this.chainId=M(R,this,L).call(this);const g=this.messagingSystem.call("PreferencesController:getState");this.locale=g.currentLocale.replace("_","-"),this.version="production"===i?s:`${s}-${i}`,S(N,this,o),S(O,this,i),this.messagingSystem.registerActionHandler("MetaMetricsController:trackEvent",this.trackEvent.bind(this)),this.messagingSystem.registerActionHandler("MetaMetricsController:getMetaMetricsId",this.getMetaMetricsId.bind(this)),this.messagingSystem.registerActionHandler("MetaMetricsController:createEventFragment",this.createEventFragment.bind(this)),this.messagingSystem.registerActionHandler("MetaMetricsController:getEventFragmentById",this.getEventFragmentById.bind(this)),this.messagingSystem.registerActionHandler("MetaMetricsController:updateEventFragment",this.updateEventFragment.bind(this)),this.messagingSystem.registerActionHandler("MetaMetricsController:deleteEventFragment",this.deleteEventFragment.bind(this)),this.messagingSystem.registerActionHandler("MetaMetricsController:finalizeEventFragment",this.finalizeEventFragment.bind(this));const f=(0,r.omitBy)(e.fragments,"persist");this.messagingSystem.subscribe("PreferencesController:stateChange",({currentLocale:e})=>{this.locale=null==e?void 0:e.replace("_","-")}),this.messagingSystem.subscribe("NetworkController:networkDidChange",({selectedNetworkClientId:e})=>{this.chainId=M(R,this,L).call(this,e)}),S(B,this,n),Object.values(f).forEach(e=>{this.processAbandonedFragment(e)}),h.isManifestV3&&Object.values(e.segmentApiCalls||{}).forEach(({eventType:e,payload:t})=>{try{M(R,this,X).call(this,e,t)}catch(e){C(j,this).call(this,e)}}),h.isManifestV3?(C(N,this).alarms.getAll().then(e=>{(0,m.checkAlarmExists)(e,p.METAMETRICS_FINALIZE_EVENT_FRAGMENT_ALARM)||C(N,this).alarms.create(p.METAMETRICS_FINALIZE_EVENT_FRAGMENT_ALARM,{delayInMinutes:1,periodInMinutes:1})}),C(N,this).alarms.onAlarm.addListener(e=>{e.name===p.METAMETRICS_FINALIZE_EVENT_FRAGMENT_ALARM&&this.finalizeAbandonedFragments()})):setInterval(()=>{this.finalizeAbandonedFragments()},30*d.SECOND)}finalizeAbandonedFragments(){Object.values(this.state.fragments).forEach(e=>{e.timeout&&e.lastUpdated&&Date.now()-e.lastUpdated/1e3>e.timeout&&this.processAbandonedFragment(e)})}generateMetaMetricsId(){return(0,s.bufferToHex)((0,s.keccak)(t.from(String(Date.now())+String(Math.round(Math.random()*Number.MAX_SAFE_INTEGER)))))}createEventFragment(e){if(!e.successEvent)throw new Error(`Must specify success event. Success event was: ${e.event}. Payload keys were: ${Object.keys(e)}. ${"object"==typeof e.properties?`Payload property keys were: ${Object.keys(e.properties)}`:""}`);const{fragments:t}=this.state,n=e.uniqueIdentifier??(0,i.v4)(),s={id:n,...e,lastUpdated:Date.now()},o=e.initialEvent===g.TransactionMetaMetricsEvent.submitted&&t[n]?{...t[n],canDeleteIfAbandoned:!1}:{};return this.update(e=>{e.fragments[n]=(0,r.merge)({},o,s)}),s.initialEvent&&this.trackEvent({event:s.initialEvent,category:s.category,properties:s.properties,sensitiveProperties:s.sensitiveProperties,page:s.page,referrer:s.referrer,revenue:s.revenue,value:s.value,currency:s.currency,environmentType:s.environmentType,actionId:e.actionId,uniqueIdentifier:e.uniqueIdentifier}),s}getEventFragmentById(e){return this.state.fragments[e]}processAbandonedFragment(e){e.canDeleteIfAbandoned?this.deleteEventFragment(e.id):this.finalizeEventFragment(e.id,{abandoned:!0})}updateEventFragment(e,t){const{fragments:n}=this.state,s=n[e];if(!s&&e.includes("transaction-submitted-"))this.update(n=>{n.fragments[e]={canDeleteIfAbandoned:!0,category:u.MetaMetricsEventCategory.Transactions,successEvent:g.TransactionMetaMetricsEvent.finalized,id:e,...t,lastUpdated:Date.now()}});else{if(!s)throw new Error(`Event fragment with id ${e} does not exist.`);this.update(n=>{n.fragments[e]=(0,r.merge)(n.fragments[e],{...t,lastUpdated:Date.now()})})}}deleteEventFragment(e){this.state.fragments[e]&&this.update(t=>{delete t.fragments[e]})}finalizeEventFragment(e,{abandoned:t=!1,page:n,referrer:r}={}){const s=this.state.fragments[e];if(!s)throw new Error(`Funnel with id ${e} does not exist.`);const i=t?s.failureEvent:s.successEvent;this.trackEvent({event:i??"",category:s.category,properties:s.properties,sensitiveProperties:s.sensitiveProperties,page:n??s.page,referrer:s.referrer??r,revenue:s.revenue,value:s.value,currency:s.currency,environmentType:s.environmentType,actionId:s.actionId,uniqueIdentifier:s.uniqueIdentifier?`${s.uniqueIdentifier}-${t?"failure":"success"}`:undefined}),this.update(t=>{delete t.fragments[e]})}identify(e){const{metaMetricsId:t,participateInMetaMetrics:n}=this.state;if(!n||!t||!e)return;if("object"!=typeof e)return void console.warn("MetaMetricsController#identify: userTraits parameter must be an object. Received type: "+typeof e);const r=M(R,this,W).call(this,e);M(R,this,V).call(this,r)}updateExtensionUninstallUrl(e,n){const r={av:this.version};e&&(r.mmi=t.from(n).toString("base64"),r.env=C(O,this));const s=new URLSearchParams(r);C(N,this)&&C(N,this).runtime&&C(N,this).runtime.setUninstallURL(`https://metamask.io/uninstalled?${s}`)}async setParticipateInMetaMetrics(e){const{metaMetricsId:t}=this.state,n=e&&!t?this.generateMetaMetricsId():t;return this.update(t=>{t.participateInMetaMetrics=e,t.metaMetricsId=n}),e?(this.trackEventsAfterMetricsOptIn(),this.clearEventsAfterMetricsOptIn(),this.trackTracesAfterMetricsOptIn(),this.clearTracesAfterMetricsOptIn()):this.state.marketingCampaignCookieId&&this.setMarketingCampaignCookieId(null),C(O,this)!==y.ENVIRONMENT.DEVELOPMENT&&null!==n&&this.updateExtensionUninstallUrl(e,n),n}setDataCollectionForMarketing(e){const{metaMetricsId:t}=this.state;return this.update(t=>{t.dataCollectionForMarketing=e}),!e&&this.state.marketingCampaignCookieId&&this.setMarketingCampaignCookieId(null),t}setMarketingCampaignCookieId(e){this.update(t=>{t.marketingCampaignCookieId=e})}trackPage(e,t){try{if(!1===this.state.participateInMetaMetrics)return;if(null===this.state.participateInMetaMetrics&&(null==t||!t.isOptInPath))return;const{name:n,params:r,environmentType:s,page:i,referrer:o,actionId:a}=e,{metaMetricsId:c}=this.state,l=c?"userId":"anonymousId",d=c??u.METAMETRICS_ANONYMOUS_ID;M(R,this,X).call(this,"page",{messageId:E({actionId:a}),[l]:d,name:n,properties:{params:r,locale:this.locale,chain_id:this.chainId,environment_type:s},context:M(R,this,$).call(this,o,i)})}catch(e){C(j,this).call(this,e)}}trackEvent(e,t){M(R,this,U).call(this,e),M(R,this,F).call(this,e,t).catch(e=>{C(j,this).call(this,e)})}handleMetaMaskStateUpdate(e){const t=this._buildUserTraitsObject(e);t&&this.identify(t)}trackEventsAfterMetricsOptIn(){const{eventsBeforeMetricsOptIn:e}=this.state;e.forEach(e=>{this.trackEvent(e)})}clearEventsAfterMetricsOptIn(){this.update(e=>{e.eventsBeforeMetricsOptIn=[]})}addEventBeforeMetricsOptIn(e){this.update(t=>{t.eventsBeforeMetricsOptIn.push(e)})}trackTracesAfterMetricsOptIn(){const{tracesBeforeMetricsOptIn:e}=this.state;e.forEach(e=>{"start"===e.type?(0,f.trace)(e.request):"end"===e.type&&(0,f.endTrace)(e.request)})}clearTracesAfterMetricsOptIn(){this.update(e=>{e.tracesBeforeMetricsOptIn=[]})}addTraceBeforeMetricsOptIn(e){this.update(t=>{t.tracesBeforeMetricsOptIn.push(e)})}bufferedTrace(e,t){if(this.state.participateInMetaMetrics)return t?(0,f.trace)(e,t):(0,f.trace)(e);let n;if(e.parentContext&&"object"==typeof e.parentContext){const t=e.parentContext;n=null==t?void 0:t._name}return this.addTraceBeforeMetricsOptIn({type:"start",request:{...e,parentContext:undefined,startTime:e.startTime??Date.now()},parentTraceName:n}),undefined}bufferedEndTrace(e){this.state.participateInMetaMetrics?(0,f.endTrace)(e):this.addTraceBeforeMetricsOptIn({type:"end",request:{...e,timestamp:e.timestamp??Date.now()}})}updateTraits(e){this.update(t=>{t.traits={...t.traits,...e}})}getMetaMetricsId(){let{metaMetricsId:e}=this.state;return e||(e=this.generateMetaMetricsId(),this.update(t=>{t.metaMetricsId=e})),e}_buildUserTraitsObject(e){var t,n,s;const{traits:i}=this.state,o={[u.MetaMetricsUserTrait.AddressBookEntries]:(0,r.sum)(Object.values(e.addressBook).map(r.size)),[u.MetaMetricsUserTrait.InstallDateExt]:i[u.MetaMetricsUserTrait.InstallDateExt]||"",[u.MetaMetricsUserTrait.LedgerConnectionType]:e.ledgerTransportType,[u.MetaMetricsUserTrait.NetworksAdded]:Object.values(e.networkConfigurationsByChainId).map(e=>e.chainId),[u.MetaMetricsUserTrait.NetworksWithoutTicker]:Object.values(e.networkConfigurationsByChainId).filter(({nativeCurrency:e})=>!e).map(({chainId:e})=>e),[u.MetaMetricsUserTrait.ChainIdList]:[...Object.keys(e.networkConfigurationsByChainId).map(e=>`eip155:${parseInt(e,16)}`),...Object.keys(e.multichainNetworkConfigurationsByChainId)],[u.MetaMetricsUserTrait.NftAutodetectionEnabled]:e.useNftDetection,[u.MetaMetricsUserTrait.NumberOfAccounts]:Object.values(e.internalAccounts.accounts).length,[u.MetaMetricsUserTrait.NumberOfNftCollections]:M(R,this,G).call(this,e.allNfts),[u.MetaMetricsUserTrait.NumberOfNfts]:C(x,this).call(this,e.allNfts).length,[u.MetaMetricsUserTrait.NumberOfTokens]:M(R,this,H).call(this,e.allTokens),[u.MetaMetricsUserTrait.NumberOfHDEntropies]:M(R,this,q).call(this,e)??(null===(t=this.previousUserTraits)||void 0===t?void 0:t.number_of_hd_entropies),[u.MetaMetricsUserTrait.OpenSeaApiEnabled]:e.openSeaEnabled,[u.MetaMetricsUserTrait.ThreeBoxEnabled]:!1,[u.MetaMetricsUserTrait.Theme]:e.theme||"default",[u.MetaMetricsUserTrait.TokenDetectionEnabled]:e.useTokenDetection,[u.MetaMetricsUserTrait.ShowNativeTokenAsMainBalance]:e.ShowNativeTokenAsMainBalance,[u.MetaMetricsUserTrait.CurrentCurrency]:e.currentCurrency,[u.MetaMetricsUserTrait.SecurityProviders]:e.securityAlertsEnabled?["blockaid"]:[],[u.MetaMetricsUserTrait.PetnameAddressCount]:M(R,this,Z).call(this,e),[u.MetaMetricsUserTrait.IsMetricsOptedIn]:e.participateInMetaMetrics,[u.MetaMetricsUserTrait.HasMarketingConsent]:e.dataCollectionForMarketing,[u.MetaMetricsUserTrait.TokenSortPreference]:(null===(n=e.tokenSortConfig)||void 0===n?void 0:n.key)||"",[u.MetaMetricsUserTrait.PrivacyModeEnabled]:e.preferences.privacyMode,[u.MetaMetricsUserTrait.NetworkFilterPreference]:Object.keys(e.preferences.tokenNetworkFilter||{}),[u.MetaMetricsUserTrait.ProfileId]:null===(s=Object.entries(e.srpSessionData||{}))||void 0===s||null===(s=s[0])||void 0===s||null===(s=s[1])||void 0===s||null===(s=s.profile)||void 0===s?void 0:s.profileId};if(!this.previousUserTraits&&e.participateInMetaMetrics)return this.previousUserTraits=o,o;if(this.previousUserTraits&&!(0,r.isEqual)(this.previousUserTraits,o)){const t=(0,r.pickBy)(o,(e,t)=>{const n=this.previousUserTraits[t];return!(0,r.isEqual)(n,e)});return e.participateInMetaMetrics&&(this.previousUserTraits=o),t}return null}}function L(e){const t=e||this.messagingSystem.call("NetworkController:getState").selectedNetworkClientId,{configuration:{chainId:n}}=this.messagingSystem.call("NetworkController:getNetworkClientById",t);return n}async function F(e,t){if(!(this.state.participateInMetaMetrics||null!=t&&t.isOptIn))return;const n=[];if(e.sensitiveProperties){if(!0===(null==t?void 0:t.excludeMetaMetricsId))throw new Error("sensitiveProperties was specified in an event payload that also set the excludeMetaMetricsId flag");const s=A[`${e.event}`],i={...e,event:s??e.event},o=(0,r.merge)({...i.sensitiveProperties},{...i.properties});n.push(M(R,this,Q).call(this,M(R,this,K).call(this,{...i,properties:o,isDuplicateAnonymizedEvent:!0}),{...t,excludeMetaMetricsId:!0}))}n.push(M(R,this,Q).call(this,M(R,this,K).call(this,e),t)),await Promise.all(n)}function U(e){if(!e.event)throw new Error(`Must specify event. Event was: ${e.event}. Payload keys were: ${Object.keys(e)}. ${"object"==typeof e.properties?`Payload property keys were: ${Object.keys(e.properties)}`:""}`)}function $(e,t=u.METAMETRICS_BACKGROUND_PAGE_OBJECT){return{app:{name:"MetaMask Extension",version:this.version},userAgent:window.navigator.userAgent,page:t,referrer:e,marketingCampaignCookieId:this.state.marketingCampaignCookieId}}function K(e){const{event:t,properties:n,revenue:s,value:i,currency:o,category:a,page:c,referrer:u,environmentType:d=l.ENVIRONMENT_TYPE_BACKGROUND}=e;let h;return h=n&&"chain_id_caip"in n&&"string"==typeof n.chain_id_caip?null:n&&"chain_id"in n&&"string"==typeof n.chain_id?n.chain_id:this.chainId,{event:t,messageId:E(e),properties:{...(0,r.omit)(n,["revenue","locale","currency","value"]),revenue:s,value:i,currency:o,category:a,locale:this.locale,chain_id:h,environment_type:d},context:M(R,this,$).call(this,u,c)}}function W(e){return Object.entries(e).reduce((e,[t,n])=>M(R,this,J).call(this,n)?{...e,[t]:n.toISOString()}:M(R,this,z).call(this,n)?{...e,[t]:n}:(console.warn(`MetaMetricsController: "${t}" value is not a valid trait type`),e),{})}function G(e={}){const t=C(x,this).call(this,e).map(e=>e.address);return new Set(t).size}function H(e){return Object.values(e).reduce((e,t)=>e+(0,r.sum)(Object.values(t).map(r.size)),0)}function q(e){var t;return(null===(t=e.keyrings)||void 0===t?void 0:t.filter(e=>e.type===w.KeyringType.hdKeyTree).length)??0}function V(e){const{metaMetricsId:t}=this.state;if(e&&0!==Object.keys(e).length)try{M(R,this,X).call(this,"identify",{userId:t??undefined,traits:e})}catch(e){C(j,this).call(this,e)}else console.warn("MetaMetricsController#_identify: No userTraits found")}function z(e){const t=typeof e;return"string"===t||"boolean"===t||"number"===t||M(R,this,Y).call(this,e)||M(R,this,J).call(this,e)}function Y(e){return Array.isArray(e)&&(e.every(e=>"string"==typeof e)||e.every(e=>"boolean"==typeof e)||e.every(e=>"number"==typeof e))}function J(e){return"[object Date]"===Object.prototype.toString.call(e)}function Q(e,t){const{isOptIn:n,metaMetricsId:r,matomoEvent:s,flushImmediately:i}=t||{};let o="userId",c=this.state.metaMetricsId,l=(null==t?void 0:t.excludeMetaMetricsId)??!1;const d=Boolean(e.event.match(/^send|^confirm/iu));return!1!==(null==t?void 0:t.excludeMetaMetricsId)&&d&&(l=!0),l||n&&!r?(o="anonymousId",c=u.METAMETRICS_ANONYMOUS_ID):n&&r&&(c=r),e[o]=c??undefined,!0===s&&(e.properties.legacy_event=!0),new Promise((t,n)=>{M(R,this,X).call(this,"track",e,e=>{if(e){const t=(0,a.isErrorWithMessage)(e)?e.message:"",r=(0,a.isErrorWithStack)(e)?e.stack:undefined,s=new Error(t);return r&&(s.stack=r),n(s)}return t()}),i&&C(B,this).flush()})}function X(e,t,n){const{metaMetricsId:r,latestNonAnonymousEventTimestamp:s,participateInMetaMetrics:i}=this.state;if(!i||!r)return;const o=t.messageId||(0,m.generateRandomId)();let a=new Date;if(t.timestamp){const e=new Date(t.timestamp);(0,m.isValidDate)(e)&&(a=e)}const c={...t,messageId:o,timestamp:a};this.update(t=>{t.latestNonAnonymousEventTimestamp=c.anonymousId===u.METAMETRICS_ANONYMOUS_ID?s:a.valueOf(),t.segmentApiCalls[o]={eventType:e,payload:{...c,timestamp:c.timestamp.toString()}}});C(B,this)[e](c,e=>(this.update(e=>{delete e.segmentApiCalls[o]}),null==n?void 0:n(e)))}function Z(e){var t;const n=(null===(t=e.names)||void 0===t?void 0:t[o.NameType.ETHEREUM_ADDRESS])??{};return Object.keys(n).reduce((e,t)=>{const r=n[t];return e+Object.keys(r).reduce((e,t)=>{var n;return e+(Boolean(null===(n=r[t].name)||void 0===n?void 0:n.length)?1:0)},0)},0)}n.default=D}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"$root$",file:"app/scripts/controllers/metametrics-controller.ts"}],[206,{"@metamask/base-controller":1268},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MetaMetricsDataDeletionController=void 0;var r=e("@metamask/base-controller");function s(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function i(e,t){return e.get(o(e,t))}function o(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const a="MetaMetricsDataDeletionController",c={metaMetricsDataDeletionId:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},metaMetricsDataDeletionTimestamp:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},metaMetricsDataDeletionStatus:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0}};var l=new WeakMap,u=new WeakSet;class d extends r.BaseController{constructor({dataDeletionService:e,messenger:t,state:n}){var r,i;super({messenger:t,metadata:c,name:a,state:{metaMetricsDataDeletionId:null,metaMetricsDataDeletionTimestamp:0,...n}}),s(r=this,i=u),i.add(r),function(e,t,n){s(e,t),t.set(e,n)}(this,l,void 0),function(e,t,n){e.set(o(e,t),n)}(l,this,e),o(u,this,h).call(this)}async createMetaMetricsDataDeletionTask(){const{metaMetricsId:e}=this.messagingSystem.call("MetaMetricsController:getState");if(!e)throw new Error("MetaMetrics ID not found");const t=await i(l,this).createDataDeletionRegulationTask(e);this.update(e=>{e.metaMetricsDataDeletionId=t??null,e.metaMetricsDataDeletionTimestamp=Date.now()}),await this.updateDataDeletionTaskStatus()}async updateDataDeletionTaskStatus(){const e=this.state.metaMetricsDataDeletionId;if(!e)throw new Error("Delete Regulation id not found");const t=await i(l,this).fetchDeletionRegulationStatus(e);this.update(e=>{e.metaMetricsDataDeletionStatus=t??undefined})}}function h(){this.messagingSystem.registerActionHandler(`${a}:createMetaMetricsDataDeletionTask`,this.createMetaMetricsDataDeletionTask.bind(this)),this.messagingSystem.registerActionHandler(`${a}:updateDataDeletionTaskStatus`,this.updateDataDeletionTaskStatus.bind(this))}n.MetaMetricsDataDeletionController=d}}},{package:"$root$",file:"app/scripts/controllers/metametrics-data-deletion/metametrics-data-deletion.ts"}],[207,{"../../../shared/constants/network":5800,"@metamask/base-controller":1268,"@metamask/keyring-api":2060,"@metamask/multichain-network-controller":2161},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.NetworkOrderController=void 0;var r=e("@metamask/keyring-api"),s=e("@metamask/base-controller"),i=e("@metamask/multichain-network-controller"),o=e("../../../shared/constants/network");const a={orderedNetworkList:[]},c={orderedNetworkList:{includeInStateLogs:!1,persist:!0,anonymous:!0,usedInUi:!0}};class l extends s.BaseController{constructor({messenger:e,state:t}){super({messenger:e,metadata:c,name:"NetworkOrderController",state:{...a,...t}}),this.messagingSystem.subscribe("NetworkController:stateChange",e=>{this.onNetworkControllerStateChange(e)})}onNetworkControllerStateChange({networkConfigurationsByChainId:e}){this.update(t=>{const n=Object.keys(e).filter(e=>!o.TEST_CHAINS.includes(e)).map(i.toEvmCaipChainId),s=[r.BtcScope.Mainnet,r.SolScope.Mainnet],a=n.filter(e=>!t.orderedNetworkList.some(({networkId:t})=>t===e)).map(e=>({networkId:e}));t.orderedNetworkList=t.orderedNetworkList.filter(({networkId:e})=>n.includes(e)||s.includes(e)).concat(a)})}updateNetworksList(e){this.update(t=>{t.orderedNetworkList=e.map(e=>({networkId:e}))})}}n.NetworkOrderController=l}}},{package:"$root$",file:"app/scripts/controllers/network-order.ts"}],[208,{"../../../shared/constants/onboarding":5803,"../../../shared/modules/environment":5901,"@metamask/base-controller":1268,loglevel:4824},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getDefaultOnboardingControllerState=n.default=void 0;var r,s=e("@metamask/base-controller"),i=(r=e("loglevel"))&&r.__esModule?r:{default:r},o=e("../../../shared/constants/onboarding"),a=e("../../../shared/modules/environment");function c(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const l=()=>({seedPhraseBackedUp:null,firstTimeFlowType:null,completedOnboarding:!1});n.getDefaultOnboardingControllerState=l;const u={onboardingTabs:{}},d={seedPhraseBackedUp:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},firstTimeFlowType:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},completedOnboarding:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},onboardingTabs:{includeInStateLogs:!0,persist:!1,anonymous:!1,usedInUi:!0}};class h extends s.BaseController{constructor({messenger:e,state:t}){super({messenger:e,metadata:d,name:"OnboardingController",state:{seedPhraseBackedUp:null,firstTimeFlowType:null,completedOnboarding:!1,...t,...u}}),c(this,"registerOnboarding",async(e,t)=>{if(this.state.completedOnboarding)return void i.default.debug("Ignoring registerOnboarding; user already onboarded");const{onboardingTabs:n}={...this.state??{}};n&&(n[e]&&n[e]===t||(i.default.debug(`Registering onboarding tab at location '${e}' with tabId '${t}'`),this.update(r=>{r.onboardingTabs={...n,[e]:t}})))})}setSeedPhraseBackedUp(e){this.update(t=>{t.seedPhraseBackedUp=e})}completeOnboarding(){return this.update(e=>{e.completedOnboarding=!0}),!0}setFirstTimeFlowType(e){this.update(t=>{t.firstTimeFlowType=e})}getIsSocialLoginFlow(){if(!(0,a.getIsSeedlessOnboardingFeatureEnabled)())return!1;const{firstTimeFlowType:e}=this.state;return e===o.FirstTimeFlowType.socialCreate||e===o.FirstTimeFlowType.socialImport}}n.default=h}}},{package:"$root$",file:"app/scripts/controllers/onboarding.ts"}],[21,{"../../../../shared/constants/network":5800,"@metamask/keyring-api":2060,"@metamask/network-enablement-controller":2241,"@metamask/utils":2908},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.NetworkEnablementControllerInit=void 0;var r=e("@metamask/network-enablement-controller"),s=e("@metamask/keyring-api"),i=e("@metamask/utils"),o=e("../../../../shared/constants/network");const a=(e,t)=>{const n={[i.KnownCaipNamespace.Eip155]:{}};return Object.keys(e).forEach(e=>{n[i.KnownCaipNamespace.Eip155][e]=t.includes(e)}),n},c=(e,t=[])=>{const n={};return Object.keys(e).forEach(e=>{const r=t.includes(e),{namespace:s}=(0,i.parseCaipChainId)(e);(n[s]??(n[s]={}))[e]=r}),n},l=(e,t)=>{const{networkConfigurationsByChainId:n}=e,{multichainNetworkConfigurationsByChainId:r}=t;const i=[s.SolScope.Mainnet];return i.push(s.BtcScope.Mainnet),{enabledNetworkMap:{...a(n,o.FEATURED_NETWORK_CHAIN_IDS),...c(r,i)}}};n.NetworkEnablementControllerInit=({controllerMessenger:e,initMessenger:t,persistedState:n,getController:o})=>{const a=o("MultichainNetworkController").state,c=o("NetworkController").state,u=new r.NetworkEnablementController({messenger:e,state:{...l(c,a),...n.NetworkEnablementController}});return t.subscribe("AccountsController:selectedAccountChange",e=>{e.type===s.SolAccountType.DataAccount&&u.enableNetworkInNamespace(s.SolScope.Mainnet,i.KnownCaipNamespace.Solana)}),t.subscribe("AccountTreeController:selectedAccountGroupChange",()=>{const e=t.call("AccountTreeController:getAccountsFromSelectedAccountGroup",{scopes:[s.SolScope.Mainnet]}),n=t.call("AccountTreeController:getAccountsFromSelectedAccountGroup",{scopes:[s.BtcScope.Mainnet]}),r=Object.values(u.state.enabledNetworkMap).reduce((e,t)=>({...e,...t}),{});if(1===Object.keys(r).length){const t=Object.keys(r)[0];let i=!1;t===s.SolScope.Mainnet&&0===e.length&&(i=!0),t===s.BtcScope.Mainnet&&0===n.length&&(i=!0),i&&u.enableNetwork("0x1")}}),{controller:u}}}}},{package:"$root$",file:"app/scripts/controller-init/assets/network-enablement-controller-init.ts"}],[2120,{"@metamask/base-controller":1268,events:4361,uuid:5732},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.AbstractMessageManager=void 0;const r=e("@metamask/base-controller"),s=e("events"),i=e("uuid"),o={unapprovedMessages:{includeInStateLogs:!0,persist:!1,anonymous:!1,usedInUi:!0},unapprovedMessagesCount:{includeInStateLogs:!0,persist:!1,anonymous:!1,usedInUi:!0}};class a extends r.BaseController{constructor({additionalFinishStatuses:e,messenger:t,name:n,securityProviderRequest:r,state:i={}}){super({messenger:t,metadata:o,name:n,state:{unapprovedMessages:{},unapprovedMessagesCount:0,...i}}),this.internalEvents=new s.EventEmitter,this.messages=[],this.securityProviderRequest=r,this.additionalFinishStatuses=e??[]}addRequestToMessageParams(e,t){const n={...e};return t&&(n.requestId=t.id,n.origin=t.origin),n}createUnapprovedMessage(e,t,n){return{id:(0,i.v1)(),messageParams:e,securityAlertResponse:n?.securityAlertResponse,status:"unapproved",time:Date.now(),type:t}}saveMessageList(e=!0){this.update(e=>{e.unapprovedMessages=this.getUnapprovedMessages(),e.unapprovedMessagesCount=this.getUnapprovedMessagesCount()}),e&&this.messagingSystem.publish(`${this.name}:updateBadge`)}setMessageStatus(e,t){const n=this.getMessage(e);if(!n)throw new Error(`${this.name}: Message not found for id: ${e}.`);const r={...n,status:t};this.updateMessage(r),this.internalEvents.emit(`${e}:${t}`,r),("rejected"===t||"signed"===t||"errored"===t||this.additionalFinishStatuses.includes(t))&&this.internalEvents.emit(`${e}:finished`,r)}updateMessage(e,t=!0){const n=this.messages.findIndex(t=>e.id===t.id);-1!==n&&(this.messages[n]=e),this.saveMessageList(t)}async securityCheck(e){if(this.securityProviderRequest){const t=await this.securityProviderRequest(e,e.type);return{...e,securityProviderResponse:t}}return e}clearUnapprovedMessages(){this.update(e=>{e.unapprovedMessages={},e.unapprovedMessagesCount=0})}getUnapprovedMessagesCount(){return Object.keys(this.getUnapprovedMessages()).length}getUnapprovedMessages(){return this.messages.filter(e=>"unapproved"===e.status).reduce((e,t)=>(e[t.id]=t,e),{})}async addMessage(e){const t=await this.securityCheck(e);this.messages.push(t),this.saveMessageList()}getMessage(e){return this.messages.find(t=>t.id===e)}getAllMessages(){return this.messages}approveMessage(e){return this.setMessageStatusApproved(e.metamaskId),this.prepMessageForSigning(e)}setMessageStatusApproved(e){this.setMessageStatus(e,"approved")}setMessageStatusInProgress(e){this.setMessageStatus(e,"inProgress")}setMessageStatusSigned(e,t){this.setMessageStatusAndResult(e,t,"signed")}setMessageStatusAndResult(e,t,n){this.setResult(e,t),this.setMessageStatus(e,n)}setResult(e,t){const n=this.getMessage(e);n&&this.updateMessage({...n,rawSig:t},!1)}setMetadata(e,t){const n=this.getMessage(e);if(!n)throw new Error(`${this.name}: Message not found for id: ${e}.`);this.updateMessage({...n,metadata:t},!1)}rejectMessage(e){this.setMessageStatus(e,"rejected")}async waitForFinishStatus(e,t){const{metamaskId:n,...r}=e;return new Promise((e,s)=>{this.internalEvents.once(`${n}:finished`,n=>{switch(n.status){case"signed":return e(n.rawSig);case"rejected":return s(new Error(`MetaMask ${t} Signature: User denied message signature.`));case"errored":return s(new Error(`MetaMask ${t} Signature: ${n.error}`));default:return s(new Error(`MetaMask ${t} Signature: Unknown problem: ${JSON.stringify(r)}`))}})})}}n.AbstractMessageManager=a,n.default=a}}},{package:"@metamask/message-manager",file:"node_modules/@metamask/message-manager/dist/AbstractMessageManager.cjs"}],[2121,{"./AbstractMessageManager.cjs":2120,"./utils.cjs":2125,"@metamask/controller-utils":1349},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.DecryptMessageManager=void 0;const r=e("@metamask/controller-utils"),s=e("./AbstractMessageManager.cjs"),i=e("./utils.cjs"),o="DecryptMessageManager";class a extends s.AbstractMessageManager{constructor({additionalFinishStatuses:e,messenger:t,securityProviderRequest:n,state:r}){super({additionalFinishStatuses:e,messenger:t,name:o,securityProviderRequest:n,state:r})}async addUnapprovedMessageAsync(e,t){(0,i.validateDecryptedMessageData)(e);const n=await this.addUnapprovedMessage(e,t);return new Promise((t,r)=>{this.internalEvents.once(`${n}:finished`,n=>{switch(n.status){case"decrypted":return t(n.rawSig);case"rejected":return r(new Error("MetaMask DecryptMessage: User denied message decryption."));case"errored":return r(new Error("MetaMask DecryptMessage: This message cannot be decrypted."));default:return r(new Error(`MetaMask DecryptMessage: Unknown problem: ${JSON.stringify(e)}`))}})})}async addUnapprovedMessage(e,t){const n=this.addRequestToMessageParams(e,t);e.data=(0,i.normalizeMessageData)(e.data);const s=this.createUnapprovedMessage(n,r.ApprovalType.EthDecrypt,t),a=s.id;return await this.addMessage(s),this.messagingSystem.publish(`${o}:unapprovedMessage`,{...n,metamaskId:a}),a}prepMessageForSigning(e){return delete e.metamaskId,Promise.resolve(e)}}n.DecryptMessageManager=a}}},{package:"@metamask/message-manager",file:"node_modules/@metamask/message-manager/dist/DecryptMessageManager.cjs"}],[2122,{"./AbstractMessageManager.cjs":2120,"./utils.cjs":2125,"@metamask/controller-utils":1349},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.EncryptionPublicKeyManager=void 0;const r=e("@metamask/controller-utils"),s=e("./AbstractMessageManager.cjs"),i=e("./utils.cjs");class o extends s.AbstractMessageManager{constructor({additionalFinishStatuses:e,messenger:t,securityProviderRequest:n,state:r}){super({additionalFinishStatuses:e,messenger:t,name:"EncryptionPublicKeyManager",securityProviderRequest:n,state:r})}async addUnapprovedMessageAsync(e,t){(0,i.validateEncryptionPublicKeyMessageData)(e);const n=await this.addUnapprovedMessage(e,t);return new Promise((t,r)=>{this.internalEvents.once(`${n}:finished`,n=>{switch(n.status){case"received":return t(n.rawSig);case"rejected":return r(new Error("MetaMask EncryptionPublicKey: User denied message EncryptionPublicKey."));default:return r(new Error(`MetaMask EncryptionPublicKey: Unknown problem: ${JSON.stringify(e)}`))}})})}async addUnapprovedMessage(e,t){const n=this.addRequestToMessageParams(e,t),s=this.createUnapprovedMessage(n,r.ApprovalType.EthGetEncryptionPublicKey,t),i=s.id;return await this.addMessage(s),this.messagingSystem.publish(`${this.name}:unapprovedMessage`,{...n,metamaskId:i}),i}prepMessageForSigning(e){return delete e.metamaskId,Promise.resolve({from:e.data})}}n.EncryptionPublicKeyManager=o,n.default=o}}},{package:"@metamask/message-manager",file:"node_modules/@metamask/message-manager/dist/EncryptionPublicKeyManager.cjs"}],[2123,{"./AbstractMessageManager.cjs":2120,"./DecryptMessageManager.cjs":2121,"./EncryptionPublicKeyManager.cjs":2122,"./types.cjs":2124},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){r===undefined&&(r=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,s)}:function(e,t,n,r){r===undefined&&(r=n),e[r]=t[n]}),s=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),s(e("./AbstractMessageManager.cjs"),n),s(e("./EncryptionPublicKeyManager.cjs"),n),s(e("./DecryptMessageManager.cjs"),n),s(e("./types.cjs"),n)}}},{package:"@metamask/message-manager",file:"node_modules/@metamask/message-manager/dist/index.cjs"}],[2124,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0})}}},{package:"@metamask/message-manager",file:"node_modules/@metamask/message-manager/dist/types.cjs"}],[2125,{"@metamask/controller-utils":1349,"@metamask/utils":2908,buffer:4061},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){Object.defineProperty(n,"__esModule",{value:!0}),n.validateDecryptedMessageData=n.validateEncryptionPublicKeyMessageData=n.normalizeMessageData=void 0;const r=e("@metamask/controller-utils"),s=e("@metamask/utils"),i=/^[0-9A-Fa-f]+$/gu;function o(e,t){if(!e||"string"!=typeof e||!(0,r.isValidHexAddress)(e))throw new Error(`Invalid "${t}" address: ${e} must be a valid string.`)}n.normalizeMessageData=function(e){try{const t=(0,s.remove0x)(e);if(t.match(i))return(0,s.add0x)(t)}catch(e){}return(0,s.bytesToHex)(t.from(e,"utf8"))},n.validateEncryptionPublicKeyMessageData=function(e){const{from:t}=e;o(t,"from")},n.validateDecryptedMessageData=function(e){const{from:t}=e;o(t,"from")}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/message-manager",file:"node_modules/@metamask/message-manager/dist/utils.cjs"}],[2131,{"./logger.cjs":2135,"@metamask/account-api":1129},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,s,i,o,a,c,l,u,d,h=this&&this.__classPrivateFieldSet||function(e,t,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n},p=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.MultichainAccountGroup=void 0;const m=e("@metamask/account-api"),g=e("@metamask/account-api"),f=e("./logger.cjs");n.MultichainAccountGroup=class{constructor({groupIndex:e,wallet:t,providers:n,messenger:m}){r.set(this,void 0),s.set(this,void 0),i.set(this,void 0),o.set(this,void 0),a.set(this,void 0),c.set(this,void 0),l.set(this,void 0),u.set(this,void 0),d.set(this,!1),h(this,r,(0,g.toMultichainAccountGroupId)(t.id,e),"f"),h(this,i,e,"f"),h(this,s,t,"f"),h(this,o,n,"f"),h(this,l,m,"f"),h(this,a,new Map,"f"),h(this,c,new Map,"f"),h(this,u,(0,f.createModuleLogger)(f.projectLogger,`[${p(this,r,"f")}]`),"f"),this.sync(),h(this,d,!0,"f")}sync(){p(this,u,"f").call(this,"Synchronizing with account providers..."),p(this,c,"f").clear();for(const e of p(this,o,"f")){const t=[];for(const n of e.getAccounts())n.options.entropy.id===this.wallet.entropySource&&n.options.entropy.groupIndex===this.groupIndex&&t.push(n.id);p(this,a,"f").set(e,t);for(const n of t)p(this,c,"f").set(n,e)}p(this,d,"f")&&p(this,l,"f").publish("MultichainAccountService:multichainAccountGroupUpdated",this),p(this,u,"f").call(this,"Synchronized")}get id(){return p(this,r,"f")}get type(){return m.AccountGroupType.MultichainAccount}get wallet(){return p(this,s,"f")}get groupIndex(){return p(this,i,"f")}hasAccounts(){return p(this,c,"f").size>0}getAccounts(){const e=[];for(const[t,n]of p(this,a,"f").entries())for(const r of n){const n=t.getAccount(r);n&&e.push(n)}return e}getAccount(e){const t=p(this,c,"f").get(e);return t?t.getAccount(e):undefined}get(e){return(0,m.selectOne)(this.getAccounts(),e)}select(e){return(0,m.select)(this.getAccounts(),e)}async alignAccounts(){p(this,u,"f").call(this,"Aligning accounts...");if((await Promise.allSettled(p(this,o,"f").map(async e=>{const t=p(this,a,"f").get(e);if(!t||0===t.length){p(this,u,"f").call(this,`Found missing accounts for account provider "${e.getName()}", creating them now...`);const t=await e.createAccounts({entropySource:this.wallet.entropySource,groupIndex:this.groupIndex});return p(this,u,"f").call(this,`Created ${t.length} accounts`),t}return Promise.resolve()}))).some(e=>"rejected"===e.status)){const e=`Failed to fully align multichain account group for entropy ID: ${this.wallet.entropySource} and group index: ${this.groupIndex}, some accounts might be missing`;p(this,u,"f").call(this,`${f.WARNING_PREFIX} ${e}`),console.warn(e)}p(this,u,"f").call(this,"Aligned")}},r=new WeakMap,s=new WeakMap,i=new WeakMap,o=new WeakMap,a=new WeakMap,c=new WeakMap,l=new WeakMap,u=new WeakMap,d=new WeakMap}}},{package:"@metamask/multichain-account-service",file:"node_modules/@metamask/multichain-account-service/dist/MultichainAccountGroup.cjs"}],[2132,{"./MultichainAccountWallet.cjs":2133,"./logger.cjs":2135,"./providers/AccountProviderWrapper.cjs":2136,"./providers/EvmAccountProvider.cjs":2139,"./providers/SolAccountProvider.cjs":2141,"@metamask/account-api":1129,"@metamask/key-tree":2033,"@metamask/keyring-controller":2070,"@metamask/utils":2908},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,s,i,o,a,c,l,u,d=this&&this.__classPrivateFieldSet||function(e,t,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n},h=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.MultichainAccountService=n.serviceName=void 0;const p=e("@metamask/account-api"),m=e("@metamask/key-tree"),g=e("@metamask/keyring-controller"),f=e("@metamask/utils"),y=e("./logger.cjs"),w=e("./MultichainAccountWallet.cjs"),v=e("./providers/AccountProviderWrapper.cjs"),b=e("./providers/EvmAccountProvider.cjs"),k=e("./providers/SolAccountProvider.cjs");n.serviceName="MultichainAccountService";n.MultichainAccountService=class{constructor({messenger:e,providers:t=[],providerConfigs:u}){r.add(this),s.set(this,void 0),i.set(this,void 0),o.set(this,void 0),a.set(this,void 0),this.name=n.serviceName,d(this,s,e,"f"),d(this,o,new Map,"f"),d(this,a,new Map,"f"),d(this,i,[new b.EvmAccountProvider(h(this,s,"f"),u?.[b.EvmAccountProvider.NAME]),new v.AccountProviderWrapper(h(this,s,"f"),new k.SolAccountProvider(h(this,s,"f"),u?.[k.SolAccountProvider.NAME])),...t],"f"),h(this,s,"f").registerActionHandler("MultichainAccountService:getMultichainAccountGroup",(...e)=>this.getMultichainAccountGroup(...e)),h(this,s,"f").registerActionHandler("MultichainAccountService:getMultichainAccountGroups",(...e)=>this.getMultichainAccountGroups(...e)),h(this,s,"f").registerActionHandler("MultichainAccountService:getMultichainAccountWallet",(...e)=>this.getMultichainAccountWallet(...e)),h(this,s,"f").registerActionHandler("MultichainAccountService:getMultichainAccountWallets",(...e)=>this.getMultichainAccountWallets(...e)),h(this,s,"f").registerActionHandler("MultichainAccountService:createNextMultichainAccountGroup",(...e)=>this.createNextMultichainAccountGroup(...e)),h(this,s,"f").registerActionHandler("MultichainAccountService:createMultichainAccountGroup",(...e)=>this.createMultichainAccountGroup(...e)),h(this,s,"f").registerActionHandler("MultichainAccountService:setBasicFunctionality",(...e)=>this.setBasicFunctionality(...e)),h(this,s,"f").registerActionHandler("MultichainAccountService:alignWallets",(...e)=>this.alignWallets(...e)),h(this,s,"f").registerActionHandler("MultichainAccountService:alignWallet",(...e)=>this.alignWallet(...e)),h(this,s,"f").registerActionHandler("MultichainAccountService:createMultichainAccountWallet",(...e)=>this.createMultichainAccountWallet(...e)),h(this,s,"f").subscribe("AccountsController:accountAdded",e=>h(this,r,"m",c).call(this,e)),h(this,s,"f").subscribe("AccountsController:accountRemoved",e=>h(this,r,"m",l).call(this,e))}init(){(0,y.projectLogger)("Initializing..."),h(this,o,"f").clear(),h(this,a,"f").clear();const{keyrings:e}=h(this,s,"f").call("KeyringController:getState");for(const t of e)if(t.type===g.KeyringTypes.hd){const e=t.metadata.id;(0,y.projectLogger)(`Adding new wallet for entropy: "${e}"`);const n=new w.MultichainAccountWallet({entropySource:e,providers:h(this,i,"f"),messenger:h(this,s,"f")});h(this,o,"f").set(n.id,n);for(const e of n.getMultichainAccountGroups())for(const t of e.getAccounts())h(this,a,"f").set(t.id,{wallet:n,group:e})}(0,y.projectLogger)("Initialized")}getAccountContext(e){return h(this,a,"f").get(e)}getMultichainAccountWallet({entropySource:e}){return h(this,r,"m",u).call(this,e)}getMultichainAccountWallets(){return Array.from(h(this,o,"f").values())}async createMultichainAccountWallet({mnemonic:e}){const t=h(this,s,"f").call("KeyringController:getKeyringsByType",g.KeyringTypes.hd),n=(0,m.mnemonicPhraseToBytes)(e);if(t.some(e=>!!e.mnemonic&&(0,f.areUint8ArraysEqual)(e.mnemonic,n)))throw new Error("This Secret Recovery Phrase has already been imported.");(0,y.projectLogger)("Creating new wallet...");const r=await h(this,s,"f").call("KeyringController:addNewKeyring",g.KeyringTypes.hd,{mnemonic:e}),a=new w.MultichainAccountWallet({providers:h(this,i,"f"),entropySource:r.id,messenger:h(this,s,"f")});return h(this,o,"f").set(a.id,a),(0,y.projectLogger)(`Wallet created: [${a.id}]`),a}getMultichainAccountGroup({entropySource:e,groupIndex:t}){const n=h(this,r,"m",u).call(this,e).getMultichainAccountGroup(t);if(!n)throw new Error(`No multichain account for index: ${t}`);return n}getMultichainAccountGroups({entropySource:e}){return h(this,r,"m",u).call(this,e).getMultichainAccountGroups()}async createNextMultichainAccountGroup({entropySource:e}){return await h(this,r,"m",u).call(this,e).createNextMultichainAccountGroup()}async createMultichainAccountGroup({groupIndex:e,entropySource:t}){return await h(this,r,"m",u).call(this,t).createMultichainAccountGroup(e)}async setBasicFunctionality(e){(0,y.projectLogger)("Turning basic functionality: "+(e?"ON":"OFF"));for(const t of h(this,i,"f"))(0,v.isAccountProviderWrapper)(t)&&((0,y.projectLogger)(`${e?"Enabling":"Disabling"} account provider: "${t.getName()}"`),t.setEnabled(e));e&&await this.alignWallets()}async alignWallets(){(0,y.projectLogger)("Triggering alignment on all wallets...");const e=this.getMultichainAccountWallets();await Promise.all(e.map(e=>e.alignAccounts())),(0,y.projectLogger)("Wallets aligned")}async alignWallet(e){const t=this.getMultichainAccountWallet({entropySource:e});(0,y.projectLogger)(`Triggering alignment for wallet: [${t.id}]`),await t.alignAccounts(),(0,y.projectLogger)(`Wallet [${t.id}] aligned`)}},s=new WeakMap,i=new WeakMap,o=new WeakMap,a=new WeakMap,r=new WeakSet,c=function(e){if(!(0,p.isBip44Account)(e))return;let t=!0,n=h(this,o,"f").get((0,p.toMultichainAccountWalletId)(e.options.entropy.id));n||((0,y.projectLogger)(`Adding new wallet for entropy: "${e.options.entropy.id}" (for account: "${e.id}")`),n=new w.MultichainAccountWallet({entropySource:e.options.entropy.id,providers:h(this,i,"f"),messenger:h(this,s,"f")}),h(this,o,"f").set(n.id,n),t=!1);let r=n.getMultichainAccountGroup(e.options.entropy.groupIndex);r||(t&&n.sync(),r=n.getMultichainAccountGroup(e.options.entropy.groupIndex),t=!1),r&&(t&&r.sync(),h(this,a,"f").set(e.id,{wallet:n,group:r}))},l=function(e){const t=h(this,a,"f").get(e);if(t){const{wallet:n}=t;(0,y.projectLogger)(`Re-synchronize wallet [${n.id}] since account "${e}" got removed`),n.sync()}h(this,a,"f").delete(e)},u=function(e){const t=h(this,o,"f").get((0,p.toMultichainAccountWalletId)(e));if(!t)throw new Error("Unknown wallet, no wallet matching this entropy source");return t}}}},{package:"@metamask/multichain-account-service",file:"node_modules/@metamask/multichain-account-service/dist/MultichainAccountService.cjs"}],[2133,{"./MultichainAccountGroup.cjs":2131,"./logger.cjs":2135,"./providers/index.cjs":2143,"@metamask/account-api":1129,"@metamask/utils":2908,"async-mutex":3883},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,s,i,o,a,c,l,u,d,h,p,m,g=this&&this.__classPrivateFieldSet||function(e,t,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n},f=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.MultichainAccountWallet=void 0;const y=e("@metamask/account-api"),w=e("@metamask/utils"),v=e("async-mutex"),b=e("./logger.cjs"),k=e("./MultichainAccountGroup.cjs"),C=e("./providers/index.cjs");n.MultichainAccountWallet=class{constructor({providers:e,entropySource:t,messenger:n}){r.add(this),s.set(this,new v.Mutex),i.set(this,void 0),o.set(this,void 0),a.set(this,void 0),c.set(this,void 0),l.set(this,void 0),u.set(this,void 0),d.set(this,!1),h.set(this,void 0),g(this,i,(0,y.toMultichainAccountWalletId)(t),"f"),g(this,o,e,"f"),g(this,a,t,"f"),g(this,l,n,"f"),g(this,c,new Map,"f"),g(this,u,(0,b.createModuleLogger)(b.projectLogger,`[${f(this,i,"f")}]`),"f"),g(this,h,"uninitialized","f"),this.sync(),g(this,d,!0,"f"),g(this,h,"ready","f")}sync(){f(this,u,"f").call(this,"Synchronizing with account providers...");for(const e of f(this,o,"f"))for(const t of e.getAccounts()){const{entropy:e}=t.options;if(e.id!==this.entropySource)continue;let n=f(this,c,"f").get(e.groupIndex);n||(n=new k.MultichainAccountGroup({groupIndex:e.groupIndex,wallet:this,providers:f(this,o,"f"),messenger:f(this,l,"f")}),f(this,u,"f").call(this,`Found a new group: [${n.id}]`),f(this,c,"f").set(e.groupIndex,n))}for(const[e,t]of f(this,c,"f").entries())t.sync(),t.hasAccounts()||(f(this,u,"f").call(this,`Deleting group: [${t.id}]`),f(this,c,"f").delete(e));f(this,u,"f").call(this,"Synchronized")}get id(){return f(this,i,"f")}get type(){return y.AccountWalletType.Entropy}get entropySource(){return f(this,a,"f")}get status(){return f(this,h,"f")}getAccountGroup(e){if(e===(0,y.toDefaultAccountGroupId)(this.id))return f(this,c,"f").get(0);if(!(0,y.isMultichainAccountGroupId)(e))return undefined;const t=(0,y.getGroupIndexFromMultichainAccountGroupId)(e);return f(this,c,"f").get(t)}getAccountGroups(){return this.getMultichainAccountGroups()}getMultichainAccountGroup(e){return f(this,c,"f").get(e)}getMultichainAccountGroups(){return Array.from(f(this,c,"f").values())}getNextGroupIndex(){return Math.max(-1,...f(this,c,"f").keys())+1}async createMultichainAccountGroup(e,t={waitForAllProvidersToFinishCreatingAccounts:!1}){return await f(this,r,"m",p).call(this,"in-progress:create-accounts",async()=>{const n=this.getNextGroupIndex();if(e>n)throw new Error(`You cannot use a group index that is higher than the next available one: expected <=${n}, got ${e}`);let r=this.getMultichainAccountGroup(e);if(r)return r.sync(),f(this,u,"f").call(this,`Trying to re-create existing group: [${r.id}] (idempotent)`),r;if(f(this,u,"f").call(this,`Creating new group for index ${e}...`),t?.waitForAllProvidersToFinishCreatingAccounts){const t=await Promise.allSettled(f(this,o,"f").map(t=>t.createAccounts({entropySource:f(this,a,"f"),groupIndex:e})));if(t.some(e=>"rejected"===e.status)){const n=`Unable to create multichain account group for index: ${e}`;let r=`${n}:`;for(const e of t)"rejected"===e.status&&(r+=`\n- ${e.reason}`);throw f(this,u,"f").call(this,`${b.WARNING_PREFIX} ${r}`),console.warn(r),new Error(n)}}else{const[t,...n]=f(this,o,"f");(0,w.assert)(t instanceof C.EvmAccountProvider,"EVM account provider must be first");try{await t.createAccounts({entropySource:f(this,a,"f"),groupIndex:e})}catch(n){const r=`Unable to create multichain account group for index: ${e} with provider "${t.getName()}". Error: ${n.message}`;throw f(this,u,"f").call(this,`${b.ERROR_PREFIX} ${r}:`,n),new Error(r)}n.forEach(t=>{t.createAccounts({entropySource:f(this,a,"f"),groupIndex:e}).catch(n=>{const r=`Could not to create account with provider "${t.getName()}" for multichain account group index: ${e}`;f(this,u,"f").call(this,`${b.WARNING_PREFIX} ${r}:`,n)})})}return r=this.getMultichainAccountGroup(e),r||(r=new k.MultichainAccountGroup({wallet:this,providers:f(this,o,"f"),groupIndex:e,messenger:f(this,l,"f")})),f(this,c,"f").set(e,r),f(this,u,"f").call(this,`New group created: [${r.id}]`),f(this,d,"f")&&f(this,l,"f").publish("MultichainAccountService:multichainAccountGroupCreated",r),r})}async createNextMultichainAccountGroup(){return this.createMultichainAccountGroup(this.getNextGroupIndex(),{waitForAllProvidersToFinishCreatingAccounts:!0})}async alignAccounts(){await f(this,r,"m",p).call(this,"in-progress:alignment",async()=>{await f(this,r,"m",m).call(this)})}async alignAccountsOf(e){await f(this,r,"m",p).call(this,"in-progress:alignment",async()=>{const t=this.getMultichainAccountGroup(e);t&&await t.alignAccounts()})}async discoverAccounts(){return f(this,r,"m",p).call(this,"in-progress:discovery",async()=>{let e=this.getNextGroupIndex();const t=f(this,o,"f").map(t=>({provider:t,stopped:!1,groupIndex:e,accounts:[]}));return await Promise.all(t.map(async t=>{const n=t.provider.getName(),r=(e,t)=>`[${n}] Discovery ${e} for group index: ${t}`;for(;!t.stopped;){const n=Math.max(t.groupIndex,e);(0,b.projectLogger)(r("started",n));let s=[];try{s=await t.provider.discoverAccounts({entropySource:f(this,a,"f"),groupIndex:n})}catch(e){t.stopped=!0,console.error(e),(0,b.projectLogger)(r(`failed (with: "${e.message}")`,n),e);break}if(!s.length){(0,b.projectLogger)(r("stopped (no accounts got discovered)",n)),t.stopped=!0;break}(0,b.projectLogger)(r("**succeeded**",n)),t.accounts=t.accounts.concat(s);const i=n+1;t.groupIndex=i,i>e&&(e=i)}})),this.sync(),await f(this,r,"m",m).call(this),t.flatMap(e=>e.accounts)})}},s=new WeakMap,i=new WeakMap,o=new WeakMap,a=new WeakMap,c=new WeakMap,l=new WeakMap,u=new WeakMap,d=new WeakMap,h=new WeakMap,r=new WeakSet,p=async function(e,t){const n=await f(this,s,"f").acquire();try{return f(this,u,"f").call(this,`Locking wallet with status "${e}"...`),g(this,h,e,"f"),f(this,l,"f").publish("MultichainAccountService:walletStatusChange",this.id,f(this,h,"f")),await t()}finally{g(this,h,"ready","f"),f(this,l,"f").publish("MultichainAccountService:walletStatusChange",this.id,f(this,h,"f")),n(),f(this,u,"f").call(this,`Releasing wallet lock (was "${e}")`)}},m=async function(){const e=this.getMultichainAccountGroups();await Promise.all(e.map(e=>e.alignAccounts()))}}}},{package:"@metamask/multichain-account-service",file:"node_modules/@metamask/multichain-account-service/dist/MultichainAccountWallet.cjs"}],[2134,{"./MultichainAccountGroup.cjs":2131,"./MultichainAccountService.cjs":2132,"./MultichainAccountWallet.cjs":2133,"./providers/index.cjs":2143},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MultichainAccountService=n.MultichainAccountGroup=n.MultichainAccountWallet=n.TrxAccountProvider=n.TRX_ACCOUNT_PROVIDER_NAME=n.BtcAccountProvider=n.BTC_ACCOUNT_PROVIDER_NAME=n.SolAccountProvider=n.SOL_ACCOUNT_PROVIDER_NAME=n.EvmAccountProvider=n.EVM_ACCOUNT_PROVIDER_NAME=n.TimeoutError=n.SnapAccountProvider=n.BaseBip44AccountProvider=n.AccountProviderWrapper=void 0;var r=e("./providers/index.cjs");Object.defineProperty(n,"AccountProviderWrapper",{enumerable:!0,get:function(){return r.AccountProviderWrapper}}),Object.defineProperty(n,"BaseBip44AccountProvider",{enumerable:!0,get:function(){return r.BaseBip44AccountProvider}}),Object.defineProperty(n,"SnapAccountProvider",{enumerable:!0,get:function(){return r.SnapAccountProvider}}),Object.defineProperty(n,"TimeoutError",{enumerable:!0,get:function(){return r.TimeoutError}}),Object.defineProperty(n,"EVM_ACCOUNT_PROVIDER_NAME",{enumerable:!0,get:function(){return r.EVM_ACCOUNT_PROVIDER_NAME}}),Object.defineProperty(n,"EvmAccountProvider",{enumerable:!0,get:function(){return r.EvmAccountProvider}}),Object.defineProperty(n,"SOL_ACCOUNT_PROVIDER_NAME",{enumerable:!0,get:function(){return r.SOL_ACCOUNT_PROVIDER_NAME}}),Object.defineProperty(n,"SolAccountProvider",{enumerable:!0,get:function(){return r.SolAccountProvider}}),Object.defineProperty(n,"BTC_ACCOUNT_PROVIDER_NAME",{enumerable:!0,get:function(){return r.BTC_ACCOUNT_PROVIDER_NAME}}),Object.defineProperty(n,"BtcAccountProvider",{enumerable:!0,get:function(){return r.BtcAccountProvider}}),Object.defineProperty(n,"TRX_ACCOUNT_PROVIDER_NAME",{enumerable:!0,get:function(){return r.TRX_ACCOUNT_PROVIDER_NAME}}),Object.defineProperty(n,"TrxAccountProvider",{enumerable:!0,get:function(){return r.TrxAccountProvider}});var s=e("./MultichainAccountWallet.cjs");Object.defineProperty(n,"MultichainAccountWallet",{enumerable:!0,get:function(){return s.MultichainAccountWallet}});var i=e("./MultichainAccountGroup.cjs");Object.defineProperty(n,"MultichainAccountGroup",{enumerable:!0,get:function(){return i.MultichainAccountGroup}});var o=e("./MultichainAccountService.cjs");Object.defineProperty(n,"MultichainAccountService",{enumerable:!0,get:function(){return o.MultichainAccountService}})}}},{package:"@metamask/multichain-account-service",file:"node_modules/@metamask/multichain-account-service/dist/index.cjs"}],[2135,{"@metamask/utils":2908},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ERROR_PREFIX=n.WARNING_PREFIX=n.createModuleLogger=n.projectLogger=void 0;const r=e("@metamask/utils");Object.defineProperty(n,"createModuleLogger",{enumerable:!0,get:function(){return r.createModuleLogger}}),n.projectLogger=(0,r.createProjectLogger)("multichain-account-service"),n.WARNING_PREFIX="WARNING --",n.ERROR_PREFIX="ERROR --"}}},{package:"@metamask/multichain-account-service",file:"node_modules/@metamask/multichain-account-service/dist/logger.cjs"}],[2136,{"./BaseBip44AccountProvider.cjs":2137},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isAccountProviderWrapper=n.AccountProviderWrapper=void 0;const r=e("./BaseBip44AccountProvider.cjs");class s extends r.BaseBip44AccountProvider{constructor(e,t){super(e),this.isEnabled=!0,this.provider=t}getName(){return this.provider.getName()}setEnabled(e){this.isEnabled=e}getAccounts(){return this.isEnabled?this.provider.getAccounts():[]}getAccount(e){if(!this.isEnabled)throw new Error("Provider is disabled");return this.provider.getAccount(e)}isAccountCompatible(e){return this.provider.isAccountCompatible(e)}async createAccounts(e){return this.isEnabled?this.provider.createAccounts(e):[]}async discoverAccounts(e){return this.isEnabled?this.provider.discoverAccounts(e):[]}}n.AccountProviderWrapper=s,n.isAccountProviderWrapper=function(e){return e instanceof s}}}},{package:"@metamask/multichain-account-service",file:"node_modules/@metamask/multichain-account-service/dist/providers/AccountProviderWrapper.cjs"}],[2137,{"@metamask/account-api":1129},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,s,i=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.BaseBip44AccountProvider=n.assertAreBip44Accounts=n.assertIsBip44Account=void 0;const o=e("@metamask/account-api");function a(e){if(!(0,o.isBip44Account)(e))throw new Error("Created account is not BIP-44 compatible")}n.assertIsBip44Account=a,n.assertAreBip44Accounts=function(e){e.forEach(a)};n.BaseBip44AccountProvider=class{constructor(e){r.add(this),this.messenger=e}getAccounts(){return i(this,r,"m",s).call(this)}getAccount(e){const[t]=i(this,r,"m",s).call(this,t=>t.id===e);if(!t)throw new Error(`Unable to find account: ${e}`);return t}async withKeyring(e,t){return await this.messenger.call("KeyringController:withKeyring",e,({keyring:e,metadata:n})=>t({keyring:e,metadata:n}))}},r=new WeakSet,s=function(e=()=>!0){const t=[];for(const n of this.messenger.call("AccountsController:listMultichainAccounts"))(0,o.isBip44Account)(n)&&this.isAccountCompatible(n)&&e(n)&&t.push(n);return t}}}},{package:"@metamask/multichain-account-service",file:"node_modules/@metamask/multichain-account-service/dist/providers/BaseBip44AccountProvider.cjs"}],[2138,{"./SnapAccountProvider.cjs":2140,"./utils.cjs":2144,"@metamask/account-api":1129,"@metamask/keyring-api":2060,"@metamask/keyring-snap-client":2081,"@metamask/snaps-utils":2785},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,s,i,o,a=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},c=this&&this.__classPrivateFieldSet||function(e,t,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n};Object.defineProperty(n,"__esModule",{value:!0}),n.BtcAccountProvider=n.BTC_ACCOUNT_PROVIDER_NAME=void 0;const l=e("@metamask/account-api"),u=e("@metamask/keyring-api"),d=e("@metamask/keyring-snap-client"),h=e("@metamask/snaps-utils"),p=e("./SnapAccountProvider.cjs"),m=e("./utils.cjs");n.BTC_ACCOUNT_PROVIDER_NAME="Bitcoin";class g extends p.SnapAccountProvider{constructor(e,t={createAccounts:{timeoutMs:3e3},discovery:{timeoutMs:2e3,maxAttempts:3,backOffMs:1e3}}){super(g.BTC_SNAP_ID,e),r.add(this),s.set(this,void 0),i.set(this,void 0),c(this,s,a(this,r,"m",o).call(this,g.BTC_SNAP_ID),"f"),c(this,i,t,"f")}getName(){return g.NAME}isAccountCompatible(e){return e.type===u.BtcAccountType.P2wpkh&&Object.values(u.BtcAccountType).includes(e.type)}async createAccounts({entropySource:e,groupIndex:t}){const n=await this.getRestrictedSnapAccountCreator(),r=await(0,m.withTimeout)(n({entropySource:e,index:t,addressType:u.BtcAccountType.P2wpkh,scope:u.BtcScope.Mainnet}),a(this,i,"f").createAccounts.timeoutMs);return(0,l.assertIsBip44Account)(r),[r]}async discoverAccounts({entropySource:e,groupIndex:t}){const n=await(0,m.withRetry)(()=>(0,m.withTimeout)(a(this,s,"f").discoverAccounts([u.BtcScope.Mainnet],e,t),a(this,i,"f").discovery.timeoutMs),{maxAttempts:a(this,i,"f").discovery.maxAttempts,backOffMs:a(this,i,"f").discovery.backOffMs});if(!Array.isArray(n)||0===n.length)return[];return await this.createAccounts({entropySource:e,groupIndex:t})}}n.BtcAccountProvider=g,s=new WeakMap,i=new WeakMap,r=new WeakSet,o=function(e){return new d.KeyringClient({send:async t=>await this.messenger.call("SnapController:handleRequest",{snapId:e,origin:"metamask",handler:h.HandlerType.OnKeyringRequest,request:t})})},g.NAME=n.BTC_ACCOUNT_PROVIDER_NAME,g.BTC_SNAP_ID="npm:@metamask/bitcoin-wallet-snap"}}},{package:"@metamask/multichain-account-service",file:"node_modules/@metamask/multichain-account-service/dist/providers/BtcAccountProvider.cjs"}],[2139,{"./BaseBip44AccountProvider.cjs":2137,"./utils.cjs":2144,"@ethereumjs/util":648,"@metamask/keyring-api":2060,"@metamask/keyring-controller":2070,"@metamask/utils":2908},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,s,i,o,a,c=this&&this.__classPrivateFieldSet||function(e,t,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n},l=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.EvmAccountProvider=n.EVM_ACCOUNT_PROVIDER_NAME=void 0;const u=e("@ethereumjs/util"),d=e("@metamask/keyring-api"),h=e("@metamask/keyring-controller"),p=e("@metamask/utils"),m=e("./BaseBip44AccountProvider.cjs"),g=e("./utils.cjs");function f(e){if(!e)throw new Error("Internal account does not exist")}n.EVM_ACCOUNT_PROVIDER_NAME="EVM";class y extends m.BaseBip44AccountProvider{constructor(e,t={discovery:{maxAttempts:3,timeoutMs:500,backOffMs:500}}){super(e),r.add(this),s.set(this,void 0),c(this,s,t,"f")}isAccountCompatible(e){return e.type===d.EthAccountType.Eoa&&e.metadata.keyring.type===h.KeyringTypes.hd}getName(){return y.NAME}getEvmProvider(){const e=this.messenger.call("NetworkController:findNetworkClientIdByChainId","0x1"),{provider:t}=this.messenger.call("NetworkController:getNetworkClientById",e);return t}async createAccounts({entropySource:e,groupIndex:t}){const[n]=await l(this,r,"m",i).call(this,{entropySource:e,groupIndex:t,throwOnGap:!0}),s=this.messenger.call("AccountsController:getAccountByAddress",n);f(s);const o=[s];return(0,m.assertAreBip44Accounts)(o),o}async discoverAccounts(e){const t=this.getEvmProvider(),{entropySource:n,groupIndex:s}=e,c=await l(this,r,"m",a).call(this,{entropySource:n,groupIndex:s});if(0===await l(this,r,"m",o).call(this,t,c))return[];const[u]=await l(this,r,"m",i).call(this,{entropySource:n,groupIndex:s});(0,p.assert)(c===u,"Created account does not match address from group index.");const d=this.messenger.call("AccountsController:getAccountByAddress",u);return f(d),(0,m.assertIsBip44Account)(d),[d]}}n.EvmAccountProvider=y,s=new WeakMap,r=new WeakSet,i=async function({entropySource:e,groupIndex:t,throwOnGap:n=!1}){return await this.withKeyring({id:e},async({keyring:e})=>{const r=await e.getAccounts();if(t<r.length)return[r[t],!1];if(n&&t!==r.length)throw new Error("Trying to create too many accounts");const[s]=await e.addAccounts(1);return[s,!0]})},o=async function(e,t){const n=await(0,g.withRetry)(()=>(0,g.withTimeout)(e.request({method:"eth_getTransactionCount",params:[t,"latest"]}),l(this,s,"f").discovery.timeoutMs),{maxAttempts:l(this,s,"f").discovery.maxAttempts,backOffMs:l(this,s,"f").discovery.backOffMs});return parseInt(n,16)},a=async function({entropySource:e,groupIndex:t}){return await this.withKeyring({id:e},async({keyring:e})=>{const n=await e.getAccounts();if(t<n.length)return n[t];(0,p.assert)(e.root,"Expected HD keyring.root to be set");const r=e.root.deriveChild(t);return(0,p.assert)(r.publicKey,"Expected public key to be set"),(0,p.add0x)((0,p.bytesToHex)((0,u.publicToAddress)(r.publicKey,!0)).toLowerCase())})},y.NAME=n.EVM_ACCOUNT_PROVIDER_NAME}}},{package:"@metamask/multichain-account-service",file:"node_modules/@metamask/multichain-account-service/dist/providers/EvmAccountProvider.cjs"}],[214,{"../../../../../shared/constants/keyring":5792,"../../../../../shared/constants/snaps/permissions":5811,"@metamask/keyring-controller":2070,"@metamask/snaps-rpc-methods":2615,"@metamask/utils":2908},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getSnapPermissionSpecifications=function(e,t){return{...(0,r.buildSnapEndowmentSpecifications)(Object.keys(o.ExcludedSnapEndowments)),...(0,r.buildSnapRestrictedMethodSpecifications)(Object.keys(o.ExcludedSnapPermissions),{getPreferences:()=>{const t=e.call("CurrencyRateController:getState").currentCurrency,{currentLocale:n,openSeaEnabled:r,preferences:{privacyMode:s,showTestNetworks:i},securityAlertsEnabled:o,useCurrencyRateCheck:a,useTransactionSimulations:c,useTokenDetection:l,useMultiAccountBalanceChecker:u,useNftDetection:d}=e.call("PreferencesController:getState");return{locale:n,currency:t,hideBalances:s,useSecurityAlerts:o,useExternalPricingData:a,simulateOnChainActions:c,useTokenDetection:l,batchCheckBalances:u,displayNftMedia:r,useNftDetection:d,showTestnets:i}},clearSnapState:e.call.bind(e,"SnapController:clearSnapState"),getMnemonic:async t=>{if(!t){const[t]=e.call("KeyringController:getKeyringsByType",a.KeyringType.hdKeyTree);if(!t.mnemonic)throw new Error("Primary keyring mnemonic unavailable.");return t.mnemonic}try{const{type:n,mnemonic:r}=await e.call("KeyringController:withKeyring",{id:t},async({keyring:e})=>({type:e.type,mnemonic:(0,i.hasProperty)(e,"mnemonic")?e.mnemonic:undefined}));if(n!==s.KeyringTypes.hd||!r)throw new Error(`Entropy source with ID "${t}" not found.`);return r}catch{throw new Error(`Entropy source with ID "${t}" not found.`)}},getMnemonicSeed:async t=>{if(!t){const[t]=e.call("KeyringController:getKeyringsByType",a.KeyringType.hdKeyTree);if(!t.seed)throw new Error("Primary keyring mnemonic unavailable.");return t.seed}try{const{type:n,seed:r}=await e.call("KeyringController:withKeyring",{id:t},async({keyring:e})=>({type:e.type,seed:(0,i.hasProperty)(e,"seed")?e.seed:undefined}));if(n!==s.KeyringTypes.hd||!r)throw new Error(`Entropy source with ID "${t}" not found.`);return r}catch{throw new Error(`Entropy source with ID "${t}" not found.`)}},getUnlockPromise:e.call.bind(e,"AppStateController:getUnlockPromise"),getSnap:e.call.bind(e,"SnapController:get"),handleSnapRpcRequest:e.call.bind(e,"SnapController:handleRequest"),getSnapState:e.call.bind(e,"SnapController:getSnapState"),requestUserApproval:t.addAndShowApprovalRequest,showNativeNotification:(t,n)=>e.call("RateLimitController:call",t,"showNativeNotification",t,n.message),showInAppNotification:(t,n)=>{const{content:r,message:s,title:i,footerLink:o}=n,a={interfaceId:r,message:s,title:i,footerLink:o};return e.call("RateLimitController:call",t,"showInAppNotification",t,a)},updateSnapState:e.call.bind(e,"SnapController:updateSnapState"),maybeUpdatePhishingList:()=>{const{usePhishDetect:t}=e.call("PreferencesController:getState");t&&e.call("PhishingController:maybeUpdateState")},isOnPhishingList:t=>{const{usePhishDetect:n}=e.call("PreferencesController:getState");return!!n&&e.call("PhishingController:testOrigin",t).result},createInterface:e.call.bind(e,"SnapInterfaceController:createInterface"),getInterface:e.call.bind(e,"SnapInterfaceController:getInterface"),getClientCryptography:()=>({}),getSnapKeyring:async()=>{const[n]=e.call("KeyringController:getKeyringsByType",a.KeyringType.snap);return n||(await t.addNewKeyring(a.KeyringType.snap),e.call("KeyringController:getKeyringsByType",a.KeyringType.snap)[0])}})}};var r=e("@metamask/snaps-rpc-methods"),s=e("@metamask/keyring-controller"),i=e("@metamask/utils"),o=e("../../../../../shared/constants/snaps/permissions"),a=e("../../../../../shared/constants/keyring")}}},{package:"$root$",file:"app/scripts/controllers/permissions/snaps/specifications.ts"}],[2140,{"./BaseBip44AccountProvider.cjs":2137,"@metamask/keyring-controller":2070},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isSnapAccountProvider=n.SnapAccountProvider=void 0;const r=e("@metamask/keyring-controller"),s=e("./BaseBip44AccountProvider.cjs");class i extends s.BaseBip44AccountProvider{constructor(e,t){super(t),this.snapId=e}async getRestrictedSnapAccountCreator(){const e=await this.withKeyring({type:r.KeyringTypes.snap},async({keyring:e})=>e.createAccount.bind(e));return t=>e(this.snapId,t,{displayAccountNameSuggestion:!1,displayConfirmation:!1,setSelectedAccount:!1})}}n.SnapAccountProvider=i;n.isSnapAccountProvider=e=>e instanceof i}}},{package:"@metamask/multichain-account-service",file:"node_modules/@metamask/multichain-account-service/dist/providers/SnapAccountProvider.cjs"}],[2141,{"./SnapAccountProvider.cjs":2140,"./utils.cjs":2144,"@metamask/account-api":1129,"@metamask/keyring-api":2060,"@metamask/keyring-controller":2070,"@metamask/keyring-snap-client":2081,"@metamask/snaps-utils":2785},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,s,i,o,a,c=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},l=this&&this.__classPrivateFieldSet||function(e,t,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n};Object.defineProperty(n,"__esModule",{value:!0}),n.SolAccountProvider=n.SOL_ACCOUNT_PROVIDER_NAME=void 0;const u=e("@metamask/account-api"),d=e("@metamask/keyring-api"),h=e("@metamask/keyring-api"),p=e("@metamask/keyring-controller"),m=e("@metamask/keyring-snap-client"),g=e("@metamask/snaps-utils"),f=e("./SnapAccountProvider.cjs"),y=e("./utils.cjs");n.SOL_ACCOUNT_PROVIDER_NAME="Solana";class w extends f.SnapAccountProvider{constructor(e,t={discovery:{timeoutMs:2e3,maxAttempts:3,backOffMs:1e3},createAccounts:{timeoutMs:3e3}}){super(w.SOLANA_SNAP_ID,e),r.add(this),s.set(this,void 0),i.set(this,void 0),l(this,s,c(this,r,"m",o).call(this,w.SOLANA_SNAP_ID),"f"),l(this,i,t,"f")}getName(){return w.NAME}isAccountCompatible(e){return e.type===h.SolAccountType.DataAccount&&e.metadata.keyring.type===p.KeyringTypes.snap}async createAccounts({entropySource:e,groupIndex:t}){const n=`m/44'/501'/${t}'/0'`;return[await c(this,r,"m",a).call(this,{entropySource:e,groupIndex:t,derivationPath:n})]}async discoverAccounts({entropySource:e,groupIndex:t}){const n=await(0,y.withRetry)(()=>(0,y.withTimeout)(c(this,s,"f").discoverAccounts([d.SolScope.Mainnet],e,t),c(this,i,"f").discovery.timeoutMs),{maxAttempts:c(this,i,"f").discovery.maxAttempts,backOffMs:c(this,i,"f").discovery.backOffMs});if(!n.length)return[];return await Promise.all(n.map(n=>c(this,r,"m",a).call(this,{entropySource:e,groupIndex:t,derivationPath:n.derivationPath})))}}n.SolAccountProvider=w,s=new WeakMap,i=new WeakMap,r=new WeakSet,o=function(e){return new m.KeyringClient({send:async t=>await this.messenger.call("SnapController:handleRequest",{snapId:e,origin:"metamask",handler:g.HandlerType.OnKeyringRequest,request:t})})},a=async function({entropySource:e,groupIndex:t,derivationPath:n}){const r=await this.getRestrictedSnapAccountCreator(),s=await(0,y.withTimeout)(r({entropySource:e,derivationPath:n}),c(this,i,"f").createAccounts.timeoutMs);return s.options.entropy={type:h.KeyringAccountEntropyTypeOption.Mnemonic,id:e,groupIndex:t,derivationPath:n},(0,u.assertIsBip44Account)(s),s},w.NAME=n.SOL_ACCOUNT_PROVIDER_NAME,w.SOLANA_SNAP_ID="npm:@metamask/solana-wallet-snap"}}},{package:"@metamask/multichain-account-service",file:"node_modules/@metamask/multichain-account-service/dist/providers/SolAccountProvider.cjs"}],[2142,{"./SnapAccountProvider.cjs":2140,"./utils.cjs":2144,"@metamask/account-api":1129,"@metamask/keyring-api":2060,"@metamask/keyring-controller":2070,"@metamask/keyring-snap-client":2081,"@metamask/snaps-utils":2785},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,s,i,o,a,c=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},l=this&&this.__classPrivateFieldSet||function(e,t,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n};Object.defineProperty(n,"__esModule",{value:!0}),n.TrxAccountProvider=n.TRX_ACCOUNT_PROVIDER_NAME=void 0;const u=e("@metamask/account-api"),d=e("@metamask/keyring-api"),h=e("@metamask/keyring-api"),p=e("@metamask/keyring-controller"),m=e("@metamask/keyring-snap-client"),g=e("@metamask/snaps-utils"),f=e("./SnapAccountProvider.cjs"),y=e("./utils.cjs");n.TRX_ACCOUNT_PROVIDER_NAME="Tron";class w extends f.SnapAccountProvider{constructor(e,t={discovery:{timeoutMs:2e3,maxAttempts:3,backOffMs:1e3},createAccounts:{timeoutMs:3e3}}){super(w.TRX_SNAP_ID,e),r.add(this),s.set(this,void 0),i.set(this,void 0),l(this,s,c(this,r,"m",o).call(this,w.TRX_SNAP_ID),"f"),l(this,i,t,"f")}getName(){return w.NAME}isAccountCompatible(e){return e.type===d.TrxAccountType.Eoa&&e.metadata.keyring.type===p.KeyringTypes.snap}async createAccounts({entropySource:e,groupIndex:t}){const n=`m/44'/195'/0'/${t}'`;return[await c(this,r,"m",a).call(this,{entropySource:e,groupIndex:t,derivationPath:n})]}async discoverAccounts({entropySource:e,groupIndex:t}){const n=await(0,y.withRetry)(()=>(0,y.withTimeout)(c(this,s,"f").discoverAccounts([d.TrxScope.Mainnet],e,t),c(this,i,"f").discovery.timeoutMs),{maxAttempts:c(this,i,"f").discovery.maxAttempts,backOffMs:c(this,i,"f").discovery.backOffMs});if(!n.length)return[];return await Promise.all(n.map(n=>c(this,r,"m",a).call(this,{entropySource:e,groupIndex:t,derivationPath:n.derivationPath})))}}n.TrxAccountProvider=w,s=new WeakMap,i=new WeakMap,r=new WeakSet,o=function(e){return new m.KeyringClient({send:async t=>await this.messenger.call("SnapController:handleRequest",{snapId:e,origin:"metamask",handler:g.HandlerType.OnKeyringRequest,request:t})})},a=async function({entropySource:e,groupIndex:t,derivationPath:n}){const r=await this.getRestrictedSnapAccountCreator(),s=await(0,y.withTimeout)(r({entropySource:e,derivationPath:n}),c(this,i,"f").createAccounts.timeoutMs);return s.options.entropy={type:h.KeyringAccountEntropyTypeOption.Mnemonic,id:e,groupIndex:t,derivationPath:n},(0,u.assertIsBip44Account)(s),s},w.NAME=n.TRX_ACCOUNT_PROVIDER_NAME,w.TRX_SNAP_ID="npm:@metamask/tron-wallet-snap"}}},{package:"@metamask/multichain-account-service",file:"node_modules/@metamask/multichain-account-service/dist/providers/TrxAccountProvider.cjs"}],[2143,{"./AccountProviderWrapper.cjs":2136,"./BaseBip44AccountProvider.cjs":2137,"./BtcAccountProvider.cjs":2138,"./EvmAccountProvider.cjs":2139,"./SnapAccountProvider.cjs":2140,"./SolAccountProvider.cjs":2141,"./TrxAccountProvider.cjs":2142,"./utils.cjs":2144},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){r===undefined&&(r=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,s)}:function(e,t,n,r){r===undefined&&(r=n),e[r]=t[n]}),s=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.TimeoutError=void 0,s(e("./BaseBip44AccountProvider.cjs"),n),s(e("./SnapAccountProvider.cjs"),n),s(e("./AccountProviderWrapper.cjs"),n);var i=e("./utils.cjs");Object.defineProperty(n,"TimeoutError",{enumerable:!0,get:function(){return i.TimeoutError}}),s(e("./SolAccountProvider.cjs"),n),s(e("./EvmAccountProvider.cjs"),n),s(e("./BtcAccountProvider.cjs"),n),s(e("./TrxAccountProvider.cjs"),n)}}},{package:"@metamask/multichain-account-service",file:"node_modules/@metamask/multichain-account-service/dist/providers/index.cjs"}],[2144,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.withTimeout=n.withRetry=n.TimeoutError=void 0;class r extends Error{constructor(e){super(e),this.name="TimeoutError"}}n.TimeoutError=r,n.withRetry=async function(e,{maxAttempts:t=3,backOffMs:n=500}={}){let r,s=n;for(let n=1;n<=t;n++)try{return await e()}catch(e){if(r=e,n>=t)break;const i=s;await new Promise(e=>setTimeout(e,i)),s*=2}throw r},n.withTimeout=async function(e,t=500){let n;try{return await Promise.race([e,new Promise((e,s)=>{n=setTimeout(()=>s(new r("Timed out")),t)})])}finally{n&&clearTimeout(n)}}}}},{package:"@metamask/multichain-account-service",file:"node_modules/@metamask/multichain-account-service/dist/providers/utils.cjs"}],[2145,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r;Object.defineProperty(n,"__esModule",{value:!0}),n.MultichainApiNotifications=void 0,function(e){e.sessionChanged="wallet_sessionChanged",e.walletNotify="wallet_notify"}(r||(n.MultichainApiNotifications=r={}))}}},{package:"@metamask/multichain-api-middleware",file:"node_modules/@metamask/multichain-api-middleware/dist/handlers/types.cjs"}],[2146,{"@metamask/chain-agnostic-permission":1329,"@metamask/controller-utils":1349,"@metamask/permission-controller":2334,"@metamask/rpc-errors":2485,"@metamask/utils":2908},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.walletCreateSession=void 0;const r=e("@metamask/chain-agnostic-permission"),s=e("@metamask/controller-utils"),i=e("@metamask/permission-controller"),o=e("@metamask/rpc-errors"),a=e("@metamask/utils");n.walletCreateSession={methodNames:["wallet_createSession"],implementation:async function(e,t,n,c,l){if(!(0,a.isPlainObject)(e.params))return c((0,i.invalidParams)({data:{request:e}}));const{requiredScopes:u,optionalScopes:d,sessionProperties:h}=e.params;if(h&&0===Object.keys(h).length)return c(new o.JsonRpcError(5302,"Invalid sessionProperties requested"));const p=Object.fromEntries(Object.entries(h??{}).filter(([e])=>(0,r.isKnownSessionPropertyValue)(e)));try{const{normalizedRequiredScopes:e,normalizedOptionalScopes:n}=(0,r.validateAndNormalizeScopes)(u||{},d||{}),i=(0,r.getSupportedScopeObjects)(e,{getNonEvmSupportedMethods:l.getNonEvmSupportedMethods}),h=(0,r.getSupportedScopeObjects)(n,{getNonEvmSupportedMethods:l.getNonEvmSupportedMethods}),m=e=>{try{return l.findNetworkClientIdByChainId(e),!0}catch{return!1}},g=(0,r.isNamespaceInScopesObject)(i,a.KnownCaipNamespace.Solana)||(0,r.isNamespaceInScopesObject)(h,a.KnownCaipNamespace.Solana);let f=!1;if(g){f=0===l.getNonEvmAccountAddresses("solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp").length}const{supportedScopes:y}=(0,r.bucketScopes)(i,{isEvmChainIdSupported:m,isEvmChainIdSupportable:()=>!1,getNonEvmSupportedMethods:l.getNonEvmSupportedMethods,isNonEvmScopeSupported:l.isNonEvmScopeSupported}),{supportedScopes:w}=(0,r.bucketScopes)(h,{isEvmChainIdSupported:m,isEvmChainIdSupportable:()=>!1,getNonEvmSupportedMethods:l.getNonEvmSupportedMethods,isNonEvmScopeSupported:l.isNonEvmScopeSupported}),v=(0,r.getCaipAccountIdsFromScopesObjects)([y,w]),b=(0,r.getAllScopesFromScopesObjects)([y,w]),k=l.listAccounts().map(e=>e.address),C=v.filter(e=>{const{address:t,chain:{namespace:n},chainId:r}=(0,a.parseCaipAccountId)(e);return n===a.KnownCaipNamespace.Eip155.toString()?k.some(e=>(0,s.isEqualCaseInsensitive)(t,e)):l.getNonEvmAccountAddresses(r).some(t=>e===t)}),S={requiredScopes:(0,r.getInternalScopesObject)(y),optionalScopes:(0,r.getInternalScopesObject)(w),isMultichainOrigin:!0,sessionProperties:p},M=(0,r.setNonSCACaipAccountIdsInCaip25CaveatValue)(S,C);if(0===b.length){if(!f)return c(new o.JsonRpcError(5100,"Requested scopes are not supported"));M.optionalScopes[a.KnownCaipNamespace.Wallet]={accounts:[]}}const[A]=await l.requestPermissionsForOrigin({[r.Caip25EndowmentPermissionName]:{caveats:[{type:r.Caip25CaveatType,value:M}]}},{metadata:{promptToCreateSolanaAccount:f}}),T=A[r.Caip25EndowmentPermissionName],E=T?.caveats?.find(e=>e.type===r.Caip25CaveatType)?.value;if(!E)throw o.rpcErrors.internal();const I=(0,r.getSessionScopes)(E,{getNonEvmSupportedMethods:l.getNonEvmSupportedMethods}),{sessionProperties:_={}}=E;return l.trackSessionCreatedEvent?.(E),t.result={sessionScopes:I,sessionProperties:_},c()}catch(e){return c(e)}},hookNames:{findNetworkClientIdByChainId:!0,listAccounts:!0,requestPermissionsForOrigin:!0,getNonEvmSupportedMethods:!0,isNonEvmScopeSupported:!0,getNonEvmAccountAddresses:!0,trackSessionCreatedEvent:!0}}}}},{package:"@metamask/multichain-api-middleware",file:"node_modules/@metamask/multichain-api-middleware/dist/handlers/wallet-createSession.cjs"}],[2147,{"@metamask/chain-agnostic-permission":1329},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.walletGetSession=void 0;const r=e("@metamask/chain-agnostic-permission");n.walletGetSession={methodNames:["wallet_getSession"],implementation:async function(e,t,n,s,i){let o;try{o=i.getCaveatForOrigin(r.Caip25EndowmentPermissionName,r.Caip25CaveatType)}catch{}return o?(t.result={sessionScopes:(0,r.getSessionScopes)(o.value,{getNonEvmSupportedMethods:i.getNonEvmSupportedMethods})},s()):(t.result={sessionScopes:{}},s())},hookNames:{getCaveatForOrigin:!0,getNonEvmSupportedMethods:!0}}}}},{package:"@metamask/multichain-api-middleware",file:"node_modules/@metamask/multichain-api-middleware/dist/handlers/wallet-getSession.cjs"}],[2148,{"@metamask/chain-agnostic-permission":1329,"@metamask/rpc-errors":2485,"@metamask/utils":2908},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.walletInvokeMethod=void 0;const r=e("@metamask/chain-agnostic-permission"),s=e("@metamask/rpc-errors"),i=e("@metamask/utils");n.walletInvokeMethod={methodNames:["wallet_invokeMethod"],implementation:async function(e,t,n,o,a){const{scope:c,request:l}=e.params;let u;(0,r.assertIsInternalScopeString)(c);try{u=a.getCaveatForOrigin(r.Caip25EndowmentPermissionName,r.Caip25CaveatType)}catch{}if(!u)return o(s.providerErrors.unauthorized());const d=(0,r.getSessionScopes)(u.value,{getNonEvmSupportedMethods:a.getNonEvmSupportedMethods})[c];if(!d?.methods?.includes(l.method))return o(s.providerErrors.unauthorized());const{namespace:h,reference:p}=(0,r.parseScopeString)(c),m=h===i.KnownCaipNamespace.Wallet&&(!p||p===i.KnownCaipNamespace.Eip155)||h===i.KnownCaipNamespace.Eip155,g={...e,scope:c,method:l.method,params:l.params};if(m){let t;return h===i.KnownCaipNamespace.Wallet?t=a.getSelectedNetworkClientId():h===i.KnownCaipNamespace.Eip155&&p&&(t=a.findNetworkClientIdByChainId((0,i.numberToHex)(parseInt(p,10)))),t?(Object.assign(e,{...g,networkClientId:t}),n()):(console.error("failed to resolve network client for wallet_invokeMethod",e),o(s.rpcErrors.internal()))}try{t.result=await a.handleNonEvmRequestForOrigin({connectedAddresses:d.accounts,scope:c,request:g})}catch(e){return o(e)}return o()},hookNames:{getCaveatForOrigin:!0,findNetworkClientIdByChainId:!0,getSelectedNetworkClientId:!0,getNonEvmSupportedMethods:!0,handleNonEvmRequestForOrigin:!0}}}}},{package:"@metamask/multichain-api-middleware",file:"node_modules/@metamask/multichain-api-middleware/dist/handlers/wallet-invokeMethod.cjs"}],[2149,{"@metamask/chain-agnostic-permission":1329,"@metamask/permission-controller":2334,"@metamask/rpc-errors":2485},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.walletRevokeSession=void 0;const r=e("@metamask/chain-agnostic-permission"),s=e("@metamask/permission-controller"),i=e("@metamask/rpc-errors");n.walletRevokeSession={methodNames:["wallet_revokeSession"],implementation:async function(e,t,n,o,a){const{params:{scopes:c}}=e;try{c?.length?function(e,t){let n=t.getCaveatForOrigin(r.Caip25EndowmentPermissionName,r.Caip25CaveatType).value;for(const t of e){const e=r.Caip25CaveatMutators[r.Caip25CaveatType].removeScope(n,t);e.operation!==s.CaveatMutatorOperation.Noop&&(n=e?.value??{requiredScopes:{},optionalScopes:{},sessionProperties:{},isMultichainOrigin:!0})}(0,r.getCaipAccountIdsFromCaip25CaveatValue)(n).length?t.updateCaveat(r.Caip25EndowmentPermissionName,r.Caip25CaveatType,n):t.revokePermissionForOrigin(r.Caip25EndowmentPermissionName)}(c,a):a.revokePermissionForOrigin(r.Caip25EndowmentPermissionName)}catch(e){if(!(e instanceof s.UnrecognizedSubjectError||e instanceof s.PermissionDoesNotExistError))return console.error(e),o(i.rpcErrors.internal())}return t.result=!0,o()},hookNames:{revokePermissionForOrigin:!0,updateCaveat:!0,getCaveatForOrigin:!0}}}}},{package:"@metamask/multichain-api-middleware",file:"node_modules/@metamask/multichain-api-middleware/dist/handlers/wallet-revokeSession.cjs"}],[2150,{"./handlers/types.cjs":2145,"./handlers/wallet-createSession.cjs":2146,"./handlers/wallet-getSession.cjs":2147,"./handlers/wallet-invokeMethod.cjs":2148,"./handlers/wallet-revokeSession.cjs":2149,"./middlewares/MultichainMiddlewareManager.cjs":2151,"./middlewares/MultichainSubscriptionManager.cjs":2152,"./middlewares/multichainMethodCallValidatorMiddleware.cjs":2153},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MultichainApiNotifications=n.MultichainSubscriptionManager=n.MultichainMiddlewareManager=n.multichainMethodCallValidatorMiddleware=n.walletRevokeSession=n.walletInvokeMethod=n.walletGetSession=n.walletCreateSession=void 0;var r=e("./handlers/wallet-createSession.cjs");Object.defineProperty(n,"walletCreateSession",{enumerable:!0,get:function(){return r.walletCreateSession}});var s=e("./handlers/wallet-getSession.cjs");Object.defineProperty(n,"walletGetSession",{enumerable:!0,get:function(){return s.walletGetSession}});var i=e("./handlers/wallet-invokeMethod.cjs");Object.defineProperty(n,"walletInvokeMethod",{enumerable:!0,get:function(){return i.walletInvokeMethod}});var o=e("./handlers/wallet-revokeSession.cjs");Object.defineProperty(n,"walletRevokeSession",{enumerable:!0,get:function(){return o.walletRevokeSession}});var a=e("./middlewares/multichainMethodCallValidatorMiddleware.cjs");Object.defineProperty(n,"multichainMethodCallValidatorMiddleware",{enumerable:!0,get:function(){return a.multichainMethodCallValidatorMiddleware}});var c=e("./middlewares/MultichainMiddlewareManager.cjs");Object.defineProperty(n,"MultichainMiddlewareManager",{enumerable:!0,get:function(){return c.MultichainMiddlewareManager}});var l=e("./middlewares/MultichainSubscriptionManager.cjs");Object.defineProperty(n,"MultichainSubscriptionManager",{enumerable:!0,get:function(){return l.MultichainSubscriptionManager}});var u=e("./handlers/types.cjs");Object.defineProperty(n,"MultichainApiNotifications",{enumerable:!0,get:function(){return u.MultichainApiNotifications}})}}},{package:"@metamask/multichain-api-middleware",file:"node_modules/@metamask/multichain-api-middleware/dist/index.cjs"}],[2151,{"@metamask/rpc-errors":2485},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,s,i,o,a,c=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},l=this&&this.__classPrivateFieldSet||function(e,t,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n};Object.defineProperty(n,"__esModule",{value:!0}),n.MultichainMiddlewareManager=void 0;const u=e("@metamask/rpc-errors"),d=["eth_subscribe","eth_unsubscribe"];n.MultichainMiddlewareManager=class{constructor(){r.add(this),s.set(this,[])}addMiddleware(e){const{scope:t,origin:n,tabId:o}=e;c(this,r,"m",i).call(this,{scope:t,origin:n,tabId:o})||c(this,s,"f").push(e)}removeMiddlewareByScope(e){c(this,s,"f").forEach(t=>{t.scope===e&&c(this,r,"m",a).call(this,t)})}removeMiddlewareByScopeAndOrigin(e,t){c(this,s,"f").forEach(n=>{n.scope===e&&n.origin===t&&c(this,r,"m",a).call(this,n)})}removeMiddlewareByOriginAndTabId(e,t){c(this,s,"f").forEach(n=>{n.origin===e&&n.tabId===t&&c(this,r,"m",a).call(this,n)})}generateMultichainMiddlewareForOriginAndTabId(e,t){const n=(n,s,o,a)=>{const{scope:l}=n,h=c(this,r,"m",i).call(this,{scope:l,origin:e,tabId:t});return d.includes(n.method)?h?(h.middleware(n,s,o,a),undefined):a(u.rpcErrors.methodNotFound()):o()};return n.destroy=this.removeMiddlewareByOriginAndTabId.bind(this,e,t),n}},s=new WeakMap,r=new WeakSet,i=function({scope:e,origin:t,tabId:n}){return c(this,s,"f").find(r=>r.scope===e&&r.origin===t&&r.tabId===n)},o=function({scope:e,origin:t,tabId:n}){l(this,s,c(this,s,"f").filter(r=>r.scope!==e||r.origin!==t||r.tabId!==n),"f")},a=function(e){Promise.resolve(e.middleware.destroy?.()).catch(()=>{}),c(this,r,"m",o).call(this,e)}}}},{package:"@metamask/multichain-api-middleware",file:"node_modules/@metamask/multichain-api-middleware/dist/middlewares/MultichainMiddlewareManager.cjs"}],[2152,{"../handlers/types.cjs":2145,"@metamask/controller-utils":1349,"@metamask/eth-json-rpc-filters/subscriptionManager.js":1763,"@metamask/safe-event-emitter":2487,"@metamask/utils":2908},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,s,i,o,a,c,l,u=this&&this.__classPrivateFieldSet||function(e,t,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n},d=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},h=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.MultichainSubscriptionManager=void 0;const p=e("@metamask/controller-utils"),m=h(e("@metamask/eth-json-rpc-filters/subscriptionManager.js")),g=h(e("@metamask/safe-event-emitter")),f=e("@metamask/utils"),y=e("../handlers/types.cjs");class w extends g.default{constructor(e){super(),r.add(this),s.set(this,void 0),i.set(this,void 0),o.set(this,[]),u(this,s,e.findNetworkClientIdByChainId,"f"),u(this,i,e.getNetworkClientById,"f")}notify({scope:e,origin:t,tabId:n},{method:r,params:s}){this.emit("notification",t,n,{method:y.MultichainApiNotifications.walletNotify,params:{scope:e,notification:{method:r,params:s}}})}subscribe(e){const t=d(this,r,"m",a).call(this,e);if(t)return t.subscriptionManager;const n=d(this,s,"f").call(this,(0,p.toHex)((0,f.parseCaipChainId)(e.scope).reference)),c=d(this,i,"f").call(this,n),u=(0,m.default)({blockTracker:c.blockTracker,provider:c.provider});u.events.on("notification",t=>{this.notify(e,t)});const h={...e,subscriptionManager:u};return u.destroy=u.middleware.destroy,u.middleware.destroy=d(this,r,"m",l).bind(this,h),d(this,o,"f").push(h),u}unsubscribeByScope(e){d(this,o,"f").forEach(t=>{t.scope===e&&d(this,r,"m",l).call(this,t)})}unsubscribeByScopeAndOrigin(e,t){d(this,o,"f").forEach(n=>{n.scope===e&&n.origin===t&&d(this,r,"m",l).call(this,n)})}unsubscribeByOriginAndTabId(e,t){d(this,o,"f").forEach(n=>{n.origin===e&&n.tabId===t&&d(this,r,"m",l).call(this,n)})}}n.MultichainSubscriptionManager=w,s=new WeakMap,i=new WeakMap,o=new WeakMap,r=new WeakSet,a=function({scope:e,origin:t,tabId:n}){return d(this,o,"f").find(r=>r.scope===e&&r.origin===t&&r.tabId===n)},c=function({scope:e,origin:t,tabId:n}){u(this,o,d(this,o,"f").filter(r=>r.scope!==e||r.origin!==t||r.tabId!==n),"f")},l=function(e){e.subscriptionManager.destroy?.(),d(this,r,"m",c).call(this,e)}}}},{package:"@metamask/multichain-api-middleware",file:"node_modules/@metamask/multichain-api-middleware/dist/middlewares/MultichainSubscriptionManager.cjs"}],[2153,{"@metamask/api-specs":2156,"@metamask/json-rpc-engine":1994,"@metamask/rpc-errors":2485,"@metamask/utils":2908,"@open-rpc/schema-utils-js/build/dereference-document.js":2966,"@open-rpc/schema-utils-js/build/parse-open-rpc-document.js":2967,jsonschema:4636},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.multichainMethodCallValidatorMiddleware=void 0;const s=e("@metamask/api-specs"),i=e("@metamask/json-rpc-engine"),o=e("@metamask/rpc-errors"),a=e("@metamask/utils"),c=r(e("@open-rpc/schema-utils-js/build/dereference-document.js")),l=e("@open-rpc/schema-utils-js/build/parse-open-rpc-document.js"),u=e("jsonschema"),d=(e,t,n)=>{const r=`${t.name}${e.path.length>0?`.${e.path.join(".")}`:""} ${e.message}`;return o.rpcErrors.invalidParams({message:r,data:{param:t.name,path:e.path,schema:e.schema,got:n}})},h=new u.Validator,p=(0,c.default)(s.MultiChainOpenRPCDocument,(0,l.makeCustomResolver)({}));n.multichainMethodCallValidatorMiddleware=(0,i.createAsyncMiddleware)(async(e,t,n)=>{const r=await(async(e,t)=>{const n=(await p).methods.find(t=>t.name===e);if(!n||!(0,a.isObject)(n)||!("params"in n))return[o.rpcErrors.methodNotFound({data:{method:e}})];const r=[];for(const e of n.params){if(!(0,a.isObject)(t))return[o.rpcErrors.invalidParams()];const n=e,s=t[n.name],i=h.validate(s,n.schema,{required:n.required});i.errors&&r.push(...i.errors.map(e=>d(e,n,s)))}return r})(e.method,e.params);if(r.length>0)throw o.rpcErrors.invalidParams({data:r});return await n()})}}},{package:"@metamask/multichain-api-middleware",file:"node_modules/@metamask/multichain-api-middleware/dist/middlewares/multichainMethodCallValidatorMiddleware.cjs"}],[2154,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){t.exports={openrpc:"1.2.4",info:{title:"MetaMask MultiChain API",version:"1.0.0",description:"This provides the specs for the MultiChain API Layer for the MetaMask API"},methods:[{name:"wallet_notify",paramStructure:"by-name",params:[{name:"scope",description:"a valid `scope` string that has been previously authorized via `provider_authorize`",required:!0,schema:{$ref:"#/components/schemas/ScopeString"}},{name:"notification",description:"an object containing a JSON-RPC notification with `method` and `params`",deprecated:!1,required:!0,schema:{type:"object",properties:{method:{type:"string"},params:!0}}}]},{name:"wallet_invokeMethod",paramStructure:"by-name",params:[{name:"scope",description:"a valid `scope` string that has been previously authorized via `provider_authorize`",required:!0,schema:{$ref:"#/components/schemas/ScopeString"}},{name:"request",description:"an object containing a JSON-RPC request with `method` and `params`",deprecated:!1,required:!0,schema:{type:"object",properties:{method:{type:"string"},params:!0}}}],result:{name:"wallet_invokeMethodResult",schema:!0},examples:[{name:"wallet_invokeMethodExample",params:[{name:"scope",value:"eip155:1"},{name:"request",value:{method:"eth_getBalance",params:[]}}],result:{name:"wallet_invokeMethodResult",value:"0x1"}}]},{name:"wallet_revokeSession",description:"The `wallet_revokeSession` method revokes the entire active session.",params:[],result:{name:"wallet_revokeSessionResult",schema:{type:"boolean"}},examples:[{name:"wallet_revokeSessionExample",params:[],result:{name:"wallet_revokeSessionExampleResult",value:!0}}],errors:[{$ref:"#/components/errors/UnknownError"}]},{name:"wallet_sessionChanged",paramStructure:"by-name",description:"This notification is published by the wallet to notify the callers of updates to a shared session's authorization scopes. The event payload contains the new `sessionScopes`.",params:[{name:"sessionScopes",schema:{$ref:"#/components/schemas/SessionScopes"}}],examples:[{name:"wallet_sessionChangedExample",description:"Example of a wallet_sessionChanged notification.",params:[{name:"sessionScopes",value:{"eip155:1337":{accounts:["eip155:1337:0x5cfe73b6021e818b776b421b1c4db2474086a7e1"],methods:["personal_sign","eth_signTypedData_v4","wallet_watchAsset","eth_sendTransaction","eth_decrypt","eth_getEncryptionPublicKey","web3_clientVersion","eth_subscribe","eth_unsubscribe","wallet_swapAsset","eth_blockNumber","eth_call","eth_chainId","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_sendRawTransaction","eth_syncing","eth_uninstallFilter"],notifications:["eth_subscription"]},wallet:{accounts:[],methods:["wallet_registerOnboarding","wallet_scanQRCode"],notifications:[]},"wallet:eip155":{accounts:["wallet:eip155:0x5cfe73b6021e818b776b421b1c4db2474086a7e1"],methods:["wallet_addEthereumChain"],notifications:[]}}}]}]},{name:"wallet_getSession",description:"The `wallet_getSession` method returns an active session.",params:[],result:{name:"wallet_getSessionResult",schema:{type:"object",properties:{sessionScopes:{$ref:"#/components/schemas/SessionScopes"}}}},examples:[{name:"wallet_getSessionExample",description:"Example of a getSession request.",params:[],result:{name:"wallet_getSessionResultExample",value:{sessionScopes:{"eip155:1337":{accounts:["eip155:1337:0x5cfe73b6021e818b776b421b1c4db2474086a7e1"],methods:["personal_sign","eth_signTypedData_v4","wallet_watchAsset","eth_sendTransaction","eth_decrypt","eth_getEncryptionPublicKey","web3_clientVersion","eth_subscribe","eth_unsubscribe","wallet_swapAsset","eth_blockNumber","eth_call","eth_chainId","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_sendRawTransaction","eth_syncing","eth_uninstallFilter"],notifications:["eth_subscription"]},wallet:{accounts:[],methods:["wallet_registerOnboarding","wallet_scanQRCode"],notifications:[]},"wallet:eip155":{accounts:["wallet:eip155:0x5cfe73b6021e818b776b421b1c4db2474086a7e1"],methods:["wallet_addEthereumChain"],notifications:[]}}}}}]},{name:"wallet_createSession",paramStructure:"by-name",params:[{name:"requiredScopes",description:"Scopes that the wallet must support in order to be used with this provider.",schema:{type:"object",patternProperties:{"[-a-z0-9]{3,8}(:[-_a-zA-Z0-9]{1,32})?":{$ref:"#/components/schemas/Scope"}}}},{name:"optionalScopes",description:"Scopes that the wallet may support in order to be used with this provider.",schema:{type:"object",patternProperties:{"[-a-z0-9]{3,8}(:[-_a-zA-Z0-9]{1,32})?":{$ref:"#/components/schemas/Scope"}}}},{name:"sessionProperties",description:"Properties that the wallet may use to determine if the session is valid.",schema:{type:"object"}}],result:{name:"wallet_createSessionResult",schema:{type:"object",properties:{sessionScopes:{$ref:"#/components/schemas/SessionScopes"},sessionProperties:{type:"object"}}}},examples:[{name:"wallet_createSessionEthExample",description:"Example of a createSession request.",params:[{name:"optionalScopes",value:{"eip155:1337":{methods:["wallet_watchAsset","eth_sendTransaction","eth_decrypt","eth_getEncryptionPublicKey","web3_clientVersion","eth_subscribe","eth_unsubscribe","eth_blockNumber","eth_call","eth_chainId","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_sendRawTransaction","eth_syncing","eth_uninstallFilter"],notifications:["eth_subscription"]},wallet:{methods:["wallet_registerOnboarding","wallet_scanQRCode"],notifications:[]},"wallet:eip155":{methods:["wallet_addEthereumChain"],notifications:[]}}}],result:{name:"wallet_createSessionResultExample",value:{sessionProperties:{},sessionScopes:{"eip155:1337":{accounts:["eip155:1337:0x5cfe73b6021e818b776b421b1c4db2474086a7e1"],methods:["personal_sign","eth_signTypedData_v4","wallet_watchAsset","eth_sendTransaction","eth_decrypt","eth_getEncryptionPublicKey","web3_clientVersion","eth_subscribe","eth_unsubscribe","wallet_swapAsset","eth_blockNumber","eth_call","eth_chainId","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_sendRawTransaction","eth_syncing","eth_uninstallFilter"],notifications:["eth_subscription"]},wallet:{accounts:[],methods:["wallet_registerOnboarding","wallet_scanQRCode"],notifications:[]},"wallet:eip155":{accounts:["wallet:eip155:0x5cfe73b6021e818b776b421b1c4db2474086a7e1"],methods:["wallet_addEthereumChain"],notifications:[]}}}}},{name:"wallet_createSessionEthUnsupportedMethodsExample",description:"Example of a createSession request with unsupported eip155 methods.",params:[{name:"optionalScopes",value:{"eip155:1337":{methods:["not_supported"],notifications:[]},wallet:{methods:[],notifications:[]},"wallet:eip155":{methods:[],notifications:[]}}}],result:{name:"wallet_createSessionEthUnsupportedMethodsResultExample",value:{sessionProperties:{},sessionScopes:{"eip155:1337":{accounts:["eip155:1337:0x5cfe73b6021e818b776b421b1c4db2474086a7e1"],methods:["personal_sign","eth_signTypedData_v4","wallet_watchAsset","eth_sendTransaction","eth_decrypt","eth_getEncryptionPublicKey","web3_clientVersion","eth_subscribe","eth_unsubscribe","wallet_swapAsset","eth_blockNumber","eth_call","eth_chainId","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_sendRawTransaction","eth_syncing","eth_uninstallFilter"],notifications:["eth_subscription"]},wallet:{accounts:[],methods:["wallet_registerOnboarding","wallet_scanQRCode"],notifications:[]},"wallet:eip155":{accounts:["wallet:eip155:0x5cfe73b6021e818b776b421b1c4db2474086a7e1"],methods:["wallet_addEthereumChain"],notifications:[]}}}}},{name:"wallet_createSessionUnsupportedScopesExample",description:"Example of a createSession request with unsupported scopes.",params:[{name:"optionalScopes",value:{foobar:{methods:["eth_getBalance"],notifications:["eth_subscription"]},"eip155:1":{accounts:["eip155:1:0x5cfe73b6021e818b776b421b1c4db2474086a7e1"],methods:["personal_sign","eth_signTypedData_v4","wallet_watchAsset","eth_sendTransaction","eth_decrypt","eth_getEncryptionPublicKey","web3_clientVersion","eth_subscribe","eth_unsubscribe","wallet_swapAsset","eth_blockNumber","eth_call","eth_chainId","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_sendRawTransaction","eth_syncing","eth_uninstallFilter"],notifications:["eth_subscription"]}}}],result:{name:"wallet_createSessionUnsupportedScopesResultExample",value:{sessionProperties:{},sessionScopes:{"eip155:1":{accounts:["eip155:1:0x5cfe73b6021e818b776b421b1c4db2474086a7e1"],methods:["personal_sign","eth_signTypedData_v4","wallet_watchAsset","eth_sendTransaction","eth_decrypt","eth_getEncryptionPublicKey","web3_clientVersion","eth_subscribe","eth_unsubscribe","wallet_swapAsset","eth_blockNumber","eth_call","eth_chainId","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_sendRawTransaction","eth_syncing","eth_uninstallFilter"],notifications:["eth_subscription"]}}}}}],errors:[{$ref:"#/components/errors/UnknownError"},{code:5100,message:"Requested networks are not supported"},{code:5101,message:"Requested methods are not supported"},{code:5102,message:"Requested notifications are not supported"},{code:5300,message:"Invalid scopedProperties requested"},{code:5301,message:"scopedProperties can only be outside of sessionScopes"},{code:5302,message:"Invalid sessionProperties requested"}]}],components:{errors:{UnknownError:{code:5e3,message:"Unknown error with request"}},schemas:{SessionScopes:{type:"object",patternProperties:{"[-a-z0-9]{3,8}(:[-_a-zA-Z0-9]{1,32})?":{$ref:"#/components/schemas/Scope"}}},ScopeString:{type:"string",pattern:"[-a-z0-9]{3,8}(:[-_a-zA-Z0-9]{1,32})?"},Scope:{type:"object",title:"Scope",description:"Scope for a multi-chain connection",additionalProperties:!0,required:["notifications","methods"],properties:{scopes:{type:"array",items:{$ref:"#/components/schemas/ScopeString"}},methods:{description:"Methods that the wallet must support in order to be used with this provider.",type:"array",items:{type:"string"}},notifications:{description:"Notifications that the wallet must support in order to be used with this provider.",type:"array",items:{type:"string"}},rpcEndpoints:{description:"JSON-RPC endpoints for this namespace.",type:"array",items:{type:"string",format:"uri"}},rpcDocuments:{type:"array",description:"OpenRPC documents that define RPC methods in which to anchor the methods authorized in a CAIP-25 interaction.",items:{type:"string",format:"uri"}}}}}}}}}},{package:"@metamask/multichain-api-middleware>@metamask/api-specs",file:"node_modules/@metamask/multichain-api-middleware/node_modules/@metamask/api-specs/dist/build/multichain-openrpc.json"}]],[],{});