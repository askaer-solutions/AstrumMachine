LavaPack.loadBundle([[2658,{"@metamask/superstruct":2705},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.currency=void 0;const s=e("@metamask/superstruct");n.currency=function(e){const t=e.toLowerCase();return(0,s.coerce)((0,s.literal)(t),(0,s.literal)(e.toUpperCase()),e=>(0,s.create)(e.toLowerCase(),(0,s.literal)(t)))}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/currency.cjs"}],[2659,{rfdc:4992},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.deepClone=void 0;const r=s(e("rfdc"));n.deepClone=(0,r.default)({proto:!1,circles:!1})}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/deep-clone.cjs"}],[2660,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.DEFAULT_ENDOWMENTS=void 0,n.DEFAULT_ENDOWMENTS=Object.freeze(["atob","btoa","BigInt","console","crypto","Date","Math","setTimeout","clearTimeout","SubtleCrypto","TextDecoder","TextEncoder","URL","URLSearchParams","setInterval","clearInterval","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","isSecureContext","Intl","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array","DataView","ArrayBuffer","AbortController","AbortSignal"])}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/default-endowments.cjs"}],[2661,{"./array.cjs":2650,"@metamask/slip44":2423},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.getSlip44ProtocolName=n.getSnapDerivationPathName=n.SNAPS_DERIVATION_PATHS=void 0;const r=s(e("@metamask/slip44")),a=e("./array.cjs");function i(e){var t;return"1"===String(e)?"Test Networks":(null===(t=r.default[e])||void 0===t?void 0:t.name)??null}n.SNAPS_DERIVATION_PATHS=[{path:["m","44'","0'"],curve:"ed25519",name:"Test BIP-32 Path (ed25519)"},{path:["m","44'","1'"],curve:"secp256k1",name:"Testnet"},{path:["m","44'","0'"],curve:"secp256k1",name:"Bitcoin Legacy"},{path:["m","49'","0'"],curve:"secp256k1",name:"Bitcoin Nested SegWit"},{path:["m","49'","1'"],curve:"secp256k1",name:"Bitcoin Testnet Nested SegWit"},{path:["m","84'","0'"],curve:"secp256k1",name:"Bitcoin Native SegWit"},{path:["m","84'","1'"],curve:"secp256k1",name:"Bitcoin Testnet Native SegWit"},{path:["m","86'","0'"],curve:"secp256k1",name:"Bitcoin Taproot"},{path:["m","86'","1'"],curve:"secp256k1",name:"Bitcoin Testnet Taproot"},{path:["m","44'","501'"],curve:"ed25519",name:"Solana"},{path:["m","44'","501'","0'","0'"],curve:"ed25519",name:"Solana"},{path:["m","44'","2'"],curve:"secp256k1",name:"Litecoin"},{path:["m","44'","3'"],curve:"secp256k1",name:"Dogecoin"},{path:["m","44'","60'"],curve:"secp256k1",name:"Ethereum"},{path:["m","44'","118'"],curve:"secp256k1",name:"Atom"},{path:["m","44'","145'"],curve:"secp256k1",name:"Bitcoin Cash"},{path:["m","44'","637'"],curve:"ed25519",name:"Aptos"},{path:["m","44'","714'"],curve:"secp256k1",name:"Binance (BNB)"},{path:["m","44'","784'"],curve:"ed25519",name:"Sui"},{path:["m","44'","931'"],curve:"secp256k1",name:"THORChain (RUNE)"},{path:["m","44'","330'"],curve:"secp256k1",name:"Terra (LUNA)"},{path:["m","44'","459'"],curve:"secp256k1",name:"Kava"},{path:["m","44'","529'"],curve:"secp256k1",name:"Secret Network"},{path:["m","44'","397'","0'"],curve:"ed25519",name:"NEAR Protocol"},{path:["m","44'","1'","0'"],curve:"ed25519",name:"Testnet"},{path:["m","44'","472'"],curve:"ed25519",name:"Arweave"},{path:["m","44'","12586'"],curve:"secp256k1",name:"Mina"},{path:["m","44'","242'"],curve:"ed25519",name:"Nimiq"},{path:["m","44'","1729'","0'","0'"],curve:"ed25519",name:"Tezos"},{path:["m","1789'","0'"],curve:"ed25519",name:"Vega"},{path:["m","1852'","1815'"],curve:"ed25519Bip32",name:"Cardano"},{path:["m","44'","508'","0'","0'","0'"],curve:"ed25519",name:"MultiversX"},{path:["m","44'","709'"],curve:"secp256k1",name:"Avail"},{path:["m","44'","626'"],curve:"ed25519",name:"Kadena"},{path:["m","44'","632'"],curve:"ed25519",name:"Massa"}],n.getSnapDerivationPathName=function(e,t){const s=n.SNAPS_DERIVATION_PATHS.find(n=>n.curve===t&&(0,a.isEqual)(n.path,e));if(s)return s.name;if("secp256k1"===t&&"m"===e[0]&&"44'"===e[1]&&e[2].endsWith("'")){return i(e[2].slice(0,-1))??null}return null},n.getSlip44ProtocolName=i}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/derivation-paths.cjs"}],[2662,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.STATE_ENCRYPTION_MAGIC_VALUE=n.SIP_6_MAGIC_VALUE=void 0,n.SIP_6_MAGIC_VALUE="1399742832'",n.STATE_ENCRYPTION_MAGIC_VALUE="572232532'"}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/entropy.cjs"}],[2663,{"@metamask/rpc-errors":2384,"@metamask/snaps-sdk":2563,"@metamask/superstruct":2705,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){function s(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function r(e,t){return e.get(i(e,t))}function a(e,t,n){return e.set(i(e,t),n),n}function i(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}Object.defineProperty(n,"__esModule",{value:!0}),n.TrackableErrorStruct=n.unwrapError=n.isWrappedSnapError=n.isSerializedSnapError=n.isSnapError=n.WrappedSnapError=n.SNAP_ERROR_WRAPPER_MESSAGE=n.SNAP_ERROR_WRAPPER_CODE=void 0;const o=e("@metamask/rpc-errors"),c=e("@metamask/snaps-sdk"),u=e("@metamask/superstruct"),l=e("@metamask/utils");n.SNAP_ERROR_WRAPPER_CODE=-31001,n.SNAP_ERROR_WRAPPER_MESSAGE="Wrapped Snap Error";var d=new WeakMap,f=new WeakMap,h=new WeakMap;class p extends Error{constructor(e){const t=(0,c.getErrorMessage)(e);super(t),s(this,d,void 0),s(this,f,void 0),s(this,h,void 0),a(d,this,e),a(f,this,t),a(h,this,(0,c.getErrorStack)(e)??undefined)}get name(){return"WrappedSnapError"}get message(){return r(f,this)}get stack(){return r(h,this)}toJSON(){const e=m(r(d,this))?r(d,this).serialize():(0,o.serializeCause)(r(d,this));return{code:n.SNAP_ERROR_WRAPPER_CODE,message:n.SNAP_ERROR_WRAPPER_MESSAGE,data:{cause:e}}}serialize(){return this.toJSON()}}function m(e){if((0,l.isObject)(e)&&"serialize"in e&&"function"==typeof e.serialize){const t=e.serialize();return(0,l.isJsonRpcError)(t)&&g(t)}return!1}function g(e){return e.code===c.SNAP_ERROR_CODE&&e.message===c.SNAP_ERROR_MESSAGE}function b(e){return(0,l.isJsonRpcError)(e)&&e.code===n.SNAP_ERROR_WRAPPER_CODE&&e.message===n.SNAP_ERROR_WRAPPER_MESSAGE}function y(e,t,n,s){const r=new o.JsonRpcError(e,t,s);return r.stack=n??undefined,r}n.WrappedSnapError=p,n.isSnapError=m,n.isSerializedSnapError=g,n.isWrappedSnapError=b,n.unwrapError=function(e){if(b(e)){if((0,l.isJsonRpcError)(e.data.cause)){if(g(e.data.cause)){const{code:t,message:n,stack:s,data:r}=e.data.cause.data.cause;return[y(t,n,s,r),!0]}if((0,l.isObject)(e.data.cause.data)&&(0,l.isObject)(e.data.cause.data.cause)&&e.data.cause.message===e.data.cause.data.cause.message){const t=e.data.cause.data.cause,{code:n,message:s}=e.data.cause;return[y(n,s,(0,c.getErrorStack)(t)),!1]}const{code:t,message:n,stack:s,data:r}=e.data.cause;return[y(t,n,s,r),!1]}return[y(o.errorCodes.rpc.internal,(0,c.getErrorMessage)(e.data.cause),(0,c.getErrorStack)(e.data.cause)),!1]}if((0,l.isJsonRpcError)(e)){const{code:t,message:n,stack:s,data:r}=e;return[y(t,n,s,r),!1]}return[y(o.errorCodes.rpc.internal,(0,c.getErrorMessage)(e),(0,c.getErrorStack)(e)),!1]},n.TrackableErrorStruct=(0,u.object)({name:(0,u.string)(),message:(0,u.string)(),stack:(0,u.nullable)((0,u.string)()),cause:(0,u.nullable)((0,u.lazy)(()=>n.TrackableErrorStruct))})}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/errors.cjs"}],[2664,{"../time.cjs":2690,"@metamask/snaps-sdk":2563,"@metamask/superstruct":2705},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.OnAssetHistoricalPriceResponseStruct=n.AssetHistoricalPriceStruct=n.HistoricalPriceStruct=void 0;const s=e("@metamask/snaps-sdk"),r=e("@metamask/superstruct"),a=e("../time.cjs");n.HistoricalPriceStruct=(0,s.nonEmptyRecord)((0,r.union)([(0,r.literal)("all"),a.ISO8601DurationStruct]),(0,r.array)((0,r.tuple)([(0,r.number)(),(0,r.string)()]))),n.AssetHistoricalPriceStruct=(0,r.nullable)((0,r.object)({intervals:n.HistoricalPriceStruct,updateTime:(0,r.number)(),expirationTime:(0,r.optional)((0,r.number)())})),n.OnAssetHistoricalPriceResponseStruct=(0,r.object)({historicalPrice:n.AssetHistoricalPriceStruct})}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/handlers/asset-historical-price.cjs"}],[2665,{"@metamask/superstruct":2705,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.OnAssetsConversionResponseStruct=n.AssetConversionStruct=void 0;const s=e("@metamask/superstruct"),r=e("@metamask/utils");n.AssetConversionStruct=(0,s.object)({rate:(0,s.string)(),conversionTime:(0,s.number)(),expirationTime:(0,s.optional)((0,s.number)())}),n.OnAssetsConversionResponseStruct=(0,s.object)({conversionRates:(0,s.record)(r.CaipAssetTypeStruct,(0,s.record)(r.CaipAssetTypeStruct,(0,s.nullable)(n.AssetConversionStruct)))})}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/handlers/assets-conversion.cjs"}],[2666,{"../time.cjs":2690,"@metamask/snaps-sdk":2563,"@metamask/superstruct":2705,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.OnAssetsMarketDataResponseStruct=n.AssetMarketDataStruct=n.NonFungibleAssetMarketDataStruct=n.AssetValueStruct=n.FungibleAssetMarketDataStruct=n.PricePercentChangeStruct=void 0;const s=e("@metamask/snaps-sdk"),r=e("@metamask/superstruct"),a=e("@metamask/utils"),i=e("../time.cjs");n.PricePercentChangeStruct=(0,s.nonEmptyRecord)((0,r.union)([(0,r.literal)("all"),i.ISO8601DurationStruct]),(0,r.number)()),n.FungibleAssetMarketDataStruct=(0,r.object)({fungible:(0,r.literal)(!0),marketCap:(0,r.optional)((0,r.string)()),totalVolume:(0,r.optional)((0,r.string)()),circulatingSupply:(0,r.optional)((0,r.string)()),allTimeHigh:(0,r.optional)((0,r.string)()),allTimeLow:(0,r.optional)((0,r.string)()),pricePercentChange:(0,r.optional)(n.PricePercentChangeStruct)}),n.AssetValueStruct=(0,r.object)({asset:a.CaipAssetTypeOrIdStruct,amount:(0,r.string)()}),n.NonFungibleAssetMarketDataStruct=(0,r.object)({fungible:(0,r.literal)(!1),lastSale:(0,r.optional)(n.AssetValueStruct),topBid:(0,r.optional)(n.AssetValueStruct),floorPrice:(0,r.optional)(n.AssetValueStruct),rarity:(0,r.optional)((0,r.object)({ranking:(0,r.optional)((0,r.object)({source:(0,r.string)(),rank:(0,r.number)()})),metadata:(0,r.optional)((0,r.record)((0,r.string)(),(0,r.number)()))}))}),n.AssetMarketDataStruct=(0,s.selectiveUnion)(e=>(0,a.isObject)(e)&&e.fungible?n.FungibleAssetMarketDataStruct:n.NonFungibleAssetMarketDataStruct),n.OnAssetsMarketDataResponseStruct=(0,r.object)({marketData:(0,r.record)(a.CaipAssetTypeOrIdStruct,(0,r.record)(a.CaipAssetTypeStruct,(0,r.nullable)(n.AssetMarketDataStruct)))})}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/handlers/assets-market-data.cjs"}],[2667,{"./types.cjs":2674},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SNAP_EXPORT_NAMES=n.SNAP_EXPORTS=void 0;const s=e("./types.cjs");n.SNAP_EXPORTS={[s.HandlerType.OnRpcRequest]:{type:s.HandlerType.OnRpcRequest,required:!0,validator:e=>"function"==typeof e},[s.HandlerType.OnTransaction]:{type:s.HandlerType.OnTransaction,required:!0,validator:e=>"function"==typeof e},[s.HandlerType.OnCronjob]:{type:s.HandlerType.OnCronjob,required:!0,validator:e=>"function"==typeof e},[s.HandlerType.OnNameLookup]:{type:s.HandlerType.OnNameLookup,required:!0,validator:e=>"function"==typeof e},[s.HandlerType.OnInstall]:{type:s.HandlerType.OnInstall,required:!1,validator:e=>"function"==typeof e},[s.HandlerType.OnUpdate]:{type:s.HandlerType.OnUpdate,required:!1,validator:e=>"function"==typeof e},[s.HandlerType.OnStart]:{type:s.HandlerType.OnStart,required:!1,validator:e=>"function"==typeof e},[s.HandlerType.OnActive]:{type:s.HandlerType.OnActive,required:!1,validator:e=>"function"==typeof e},[s.HandlerType.OnInactive]:{type:s.HandlerType.OnInactive,required:!1,validator:e=>"function"==typeof e},[s.HandlerType.OnKeyringRequest]:{type:s.HandlerType.OnKeyringRequest,required:!0,validator:e=>"function"==typeof e},[s.HandlerType.OnHomePage]:{type:s.HandlerType.OnHomePage,required:!0,validator:e=>"function"==typeof e},[s.HandlerType.OnSettingsPage]:{type:s.HandlerType.OnSettingsPage,required:!0,validator:e=>"function"==typeof e},[s.HandlerType.OnSignature]:{type:s.HandlerType.OnSignature,required:!0,validator:e=>"function"==typeof e},[s.HandlerType.OnUserInput]:{type:s.HandlerType.OnUserInput,required:!1,validator:e=>"function"==typeof e},[s.HandlerType.OnAssetHistoricalPrice]:{type:s.HandlerType.OnAssetHistoricalPrice,required:!0,validator:e=>"function"==typeof e},[s.HandlerType.OnAssetsLookup]:{type:s.HandlerType.OnAssetsLookup,required:!0,validator:e=>"function"==typeof e},[s.HandlerType.OnAssetsConversion]:{type:s.HandlerType.OnAssetsConversion,required:!0,validator:e=>"function"==typeof e},[s.HandlerType.OnAssetsMarketData]:{type:s.HandlerType.OnAssetsMarketData,required:!0,validator:e=>"function"==typeof e},[s.HandlerType.OnProtocolRequest]:{type:s.HandlerType.OnProtocolRequest,required:!0,validator:e=>"function"==typeof e},[s.HandlerType.OnClientRequest]:{type:s.HandlerType.OnClientRequest,required:!0,validator:e=>"function"==typeof e},[s.HandlerType.OnWebSocketEvent]:{type:s.HandlerType.OnWebSocketEvent,required:!0,validator:e=>"function"==typeof e}},n.SNAP_EXPORT_NAMES=Object.values(s.HandlerType)}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/handlers/exports.cjs"}],[2668,{"@metamask/snaps-sdk":2563,"@metamask/superstruct":2705},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.OnHomePageResponseStruct=n.OnHomePageResponseWithIdStruct=n.OnHomePageResponseWithContentStruct=void 0;const s=e("@metamask/snaps-sdk"),r=e("@metamask/superstruct");n.OnHomePageResponseWithContentStruct=(0,r.object)({content:s.ComponentOrElementStruct}),n.OnHomePageResponseWithIdStruct=(0,r.object)({id:(0,r.string)()}),n.OnHomePageResponseStruct=(0,r.union)([n.OnHomePageResponseWithContentStruct,n.OnHomePageResponseWithIdStruct])}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/handlers/home-page.cjs"}],[2669,{"./asset-historical-price.cjs":2664,"./assets-conversion.cjs":2665,"./assets-market-data.cjs":2666,"./exports.cjs":2667,"./home-page.cjs":2668,"./name-lookup.cjs":2670,"./settings-page.cjs":2671,"./signature.cjs":2672,"./transaction.cjs":2673,"./types.cjs":2674},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=Object.create?function(e,t,n,s){s===undefined&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]},r=function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./asset-historical-price.cjs"),n),r(e("./assets-conversion.cjs"),n),r(e("./assets-market-data.cjs"),n),r(e("./exports.cjs"),n),r(e("./home-page.cjs"),n),r(e("./name-lookup.cjs"),n),r(e("./settings-page.cjs"),n),r(e("./signature.cjs"),n),r(e("./transaction.cjs"),n),r(e("./types.cjs"),n)}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/handlers/index.cjs"}],[267,{loglevel:4542,"webextension-polyfill":5398},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=a(e("webextension-polyfill")),r=a(e("loglevel"));function a(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.default=class{constructor(){i(this,"isSupported",void 0),this.isSupported=Boolean(s.default.storage.local),this.isSupported||r.default.error("Storage local API not available.")}async get(){if(!this.isSupported)return r.default.error("Storage local API not available."),null;const{local:e}=s.default.storage;return await e.get(["data","meta"])}async set({data:e,meta:t}){if(!this.isSupported)throw new Error("Metamask- cannot persist state to local store as this browser does not support this action");const{local:n}=s.default.storage;return await n.set({data:e,meta:t})}async reset(){if(!this.isSupported)throw new Error("Metamask- cannot persist state to local store as this browser does not support this action");const{local:e}=s.default.storage;return await e.remove(["data","meta"])}}}}},{package:"$root$",file:"app/scripts/lib/stores/extension-store.ts"}],[2670,{"@metamask/superstruct":2705},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.OnNameLookupResponseStruct=n.DomainResolutionResponseStruct=n.AddressResolutionResponseStruct=n.DomainResolutionStruct=n.AddressResolutionStruct=void 0;const s=e("@metamask/superstruct");n.AddressResolutionStruct=(0,s.object)({protocol:(0,s.string)(),resolvedDomain:(0,s.string)()}),n.DomainResolutionStruct=(0,s.object)({protocol:(0,s.string)(),resolvedAddress:(0,s.string)(),domainName:(0,s.string)()}),n.AddressResolutionResponseStruct=(0,s.object)({resolvedDomains:(0,s.size)((0,s.array)(n.AddressResolutionStruct),1,Infinity)}),n.DomainResolutionResponseStruct=(0,s.object)({resolvedAddresses:(0,s.size)((0,s.array)(n.DomainResolutionStruct),1,Infinity)}),n.OnNameLookupResponseStruct=(0,s.nullable)((0,s.union)([n.AddressResolutionResponseStruct,n.DomainResolutionResponseStruct]))}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/handlers/name-lookup.cjs"}],[2671,{"./home-page.cjs":2668},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.OnSettingsPageResponseStruct=void 0;const s=e("./home-page.cjs");n.OnSettingsPageResponseStruct=s.OnHomePageResponseStruct}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/handlers/settings-page.cjs"}],[2672,{"./transaction.cjs":2673},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.OnSignatureResponseStruct=void 0;const s=e("./transaction.cjs");n.OnSignatureResponseStruct=s.OnTransactionResponseStruct}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/handlers/signature.cjs"}],[2673,{"@metamask/snaps-sdk":2563,"@metamask/superstruct":2705},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.OnTransactionResponseStruct=n.OnTransactionResponseWithContentStruct=n.OnTransactionResponseWithIdStruct=n.OnTransactionSeverityResponseStruct=void 0;const s=e("@metamask/snaps-sdk"),r=e("@metamask/superstruct");n.OnTransactionSeverityResponseStruct=(0,r.object)({severity:(0,r.optional)((0,r.literal)(s.SeverityLevel.Critical))}),n.OnTransactionResponseWithIdStruct=(0,r.assign)(n.OnTransactionSeverityResponseStruct,(0,r.object)({id:(0,r.string)()})),n.OnTransactionResponseWithContentStruct=(0,r.assign)(n.OnTransactionSeverityResponseStruct,(0,r.object)({content:s.ComponentOrElementStruct})),n.OnTransactionResponseStruct=(0,r.nullable)((0,r.union)([n.OnTransactionResponseWithContentStruct,n.OnTransactionResponseWithIdStruct]))}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/handlers/transaction.cjs"}],[2674,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s;Object.defineProperty(n,"__esModule",{value:!0}),n.HandlerType=void 0,function(e){e.OnRpcRequest="onRpcRequest",e.OnSignature="onSignature",e.OnTransaction="onTransaction",e.OnCronjob="onCronjob",e.OnInstall="onInstall",e.OnUpdate="onUpdate",e.OnStart="onStart",e.OnActive="onActive",e.OnInactive="onInactive",e.OnNameLookup="onNameLookup",e.OnKeyringRequest="onKeyringRequest",e.OnHomePage="onHomePage",e.OnSettingsPage="onSettingsPage",e.OnUserInput="onUserInput",e.OnAssetsLookup="onAssetsLookup",e.OnAssetsConversion="onAssetsConversion",e.OnAssetHistoricalPrice="onAssetHistoricalPrice",e.OnAssetsMarketData="onAssetsMarketData",e.OnProtocolRequest="onProtocolRequest",e.OnClientRequest="onClientRequest",e.OnWebSocketEvent="onWebSocketEvent"}(s||(n.HandlerType=s={}))}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/handlers/types.cjs"}],[2675,{"./svg.cjs":2689,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getSvgDimensions=n.assertIsSnapIcon=n.SVG_MAX_BYTE_SIZE_TEXT=n.SVG_MAX_BYTE_SIZE=void 0;const s=e("@metamask/utils"),r=e("./svg.cjs");n.SVG_MAX_BYTE_SIZE=1e5,n.SVG_MAX_BYTE_SIZE_TEXT=`${Math.floor(n.SVG_MAX_BYTE_SIZE/1e3)}kb`,n.assertIsSnapIcon=function(e){(0,s.assert)(e.path.endsWith(".svg"),'Expected snap icon to end in ".svg".');const t="string"==typeof e.value?(0,s.stringToBytes)(e.value).byteLength:e.value.byteLength;(0,s.assert)(t<=n.SVG_MAX_BYTE_SIZE,`The specified SVG icon exceeds the maximum size of ${n.SVG_MAX_BYTE_SIZE_TEXT}.`),(0,s.assert)((0,r.isSvg)(e.toString()),"Snap icon must be a valid SVG.")},n.getSvgDimensions=function(e){try{const t=(0,r.parseSvg)(e),n=t["@_height"],a=t["@_width"];if(n&&a)return{height:n,width:a};const i=t["@_viewBox"];if(i){const[e,t,n,r]=i.split(" ");if(n&&r){const e=parseInt(n,10),t=parseInt(r,10);return(0,s.assert)(Number.isInteger(e)&&e>0),(0,s.assert)(Number.isInteger(t)&&t>0),{width:e,height:t}}}}catch{throw new Error("Snap icon must be a valid SVG.")}return null}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/icon.cjs"}],[2676,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createWindow=void 0,n.createWindow=async function({uri:e,id:t,sandbox:n=!0,testId:s="snaps-iframe"}){return await new Promise((r,a)=>{const i=document.createElement("iframe");i.setAttribute("id",t),i.setAttribute("data-testid",s),n&&i.setAttribute("sandbox","allow-scripts"),i.setAttribute("src",e),document.body.appendChild(i),i.addEventListener("load",()=>{i.contentWindow?r(i.contentWindow):a(new Error(`iframe.contentWindow not present on load for job "${t}".`))})})}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/iframe.cjs"}],[2677,{"./account.cjs":2649,"./array.cjs":2650,"./auxiliary-files.cjs":2651,"./base64.cjs":2652,"./bytes.cjs":2653,"./caveats.cjs":2654,"./checksum.cjs":2655,"./constants.cjs":2656,"./cronjob.cjs":2657,"./currency.cjs":2658,"./deep-clone.cjs":2659,"./default-endowments.cjs":2660,"./derivation-paths.cjs":2661,"./entropy.cjs":2662,"./errors.cjs":2663,"./handlers/index.cjs":2669,"./iframe.cjs":2676,"./json-rpc.cjs":2678,"./json.cjs":2679,"./localization.cjs":2680,"./logging.cjs":2681,"./manifest/index.cjs":2682,"./path.cjs":2684,"./platform-version.cjs":2685,"./snaps.cjs":2686,"./strings.cjs":2687,"./structs.cjs":2688,"./time.cjs":2690,"./types.cjs":2691,"./ui.cjs":2692,"./url.cjs":2693,"./validation.cjs":2694,"./versions.cjs":2695,"./virtual-file/index.cjs":2697},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=Object.create?function(e,t,n,s){s===undefined&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]},r=function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./account.cjs"),n),r(e("./array.cjs"),n),r(e("./auxiliary-files.cjs"),n),r(e("./base64.cjs"),n),r(e("./bytes.cjs"),n),r(e("./caveats.cjs"),n),r(e("./checksum.cjs"),n),r(e("./constants.cjs"),n),r(e("./cronjob.cjs"),n),r(e("./currency.cjs"),n),r(e("./deep-clone.cjs"),n),r(e("./default-endowments.cjs"),n),r(e("./derivation-paths.cjs"),n),r(e("./entropy.cjs"),n),r(e("./errors.cjs"),n),r(e("./handlers/index.cjs"),n),r(e("./iframe.cjs"),n),r(e("./json.cjs"),n),r(e("./json-rpc.cjs"),n),r(e("./localization.cjs"),n),r(e("./logging.cjs"),n),r(e("./manifest/index.cjs"),n),r(e("./path.cjs"),n),r(e("./platform-version.cjs"),n),r(e("./snaps.cjs"),n),r(e("./strings.cjs"),n),r(e("./structs.cjs"),n),r(e("./time.cjs"),n),r(e("./types.cjs"),n),r(e("./ui.cjs"),n),r(e("./url.cjs"),n),r(e("./validation.cjs"),n),r(e("./versions.cjs"),n),r(e("./virtual-file/index.cjs"),n)}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/index.cjs"}],[2678,{"@metamask/permission-controller":2260,"@metamask/superstruct":2705,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.assertIsJsonRpcSuccess=n.isOriginAllowed=n.assertIsKeyringOrigins=n.KeyringOriginsStruct=n.assertIsRpcOrigins=n.RpcOriginsStruct=void 0;const s=e("@metamask/permission-controller"),r=e("@metamask/superstruct"),a=e("@metamask/utils"),i=(0,r.array)((0,r.refine)((0,r.string)(),"Allowed origin",e=>!(e.split("*").length-1>2)||'No more than two wildcards ("*") are allowed in an origin specifier.'));function o(e,t){if("*"===e||e===t)return!0;const n=function(e){const t=e.replace(/[.*+?^${}()|[\]\\]/gu,"\\$&").replace(/\\\*/gu,".*");return RegExp(`^${t}$`,"u")}(e);return n.test(t)}n.RpcOriginsStruct=(0,r.refine)((0,r.object)({dapps:(0,r.optional)((0,r.boolean)()),snaps:(0,r.optional)((0,r.boolean)()),allowedOrigins:(0,r.optional)(i)}),"RPC origins",e=>!!Boolean(!0===e.snaps||!0===e.dapps||e.allowedOrigins&&e.allowedOrigins.length>0)||"Must specify at least one JSON-RPC origin."),n.assertIsRpcOrigins=function(e,t){(0,a.assertStruct)(e,n.RpcOriginsStruct,"Invalid JSON-RPC origins",t)},n.KeyringOriginsStruct=(0,r.object)({allowedOrigins:(0,r.optional)(i)}),n.assertIsKeyringOrigins=function(e,t){(0,a.assertStruct)(e,n.KeyringOriginsStruct,"Invalid keyring origins",t)},n.isOriginAllowed=function(e,t,n){var r;return"metamask"===n||(!(null===(r=e.allowedOrigins)||void 0===r||!r.some(e=>o(e,n)))||(!(t!==s.SubjectType.Website||!e.dapps)||Boolean(t===s.SubjectType.Snap&&e.snaps)))},n.assertIsJsonRpcSuccess=function(e){if(!(0,a.isJsonRpcSuccess)(e)){if((0,a.isJsonRpcFailure)(e))throw new Error(`JSON-RPC request failed: ${e.error.message}`);throw new Error("Invalid JSON-RPC response.")}}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/json-rpc.cjs"}],[2679,{"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getJsonSizeUnsafe=n.parseJson=void 0;const s=e("@metamask/utils");n.parseJson=function(e){return(0,s.getSafeJson)(JSON.parse(e))},n.getJsonSizeUnsafe=function(e){return JSON.stringify(e).length}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/json.cjs"}],[268,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){function s(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function r(e,t,n){return e.set(i(e,t),n),n}function a(e,t){return e.get(i(e,t))}function i(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}function o(e){return new Promise((t,n)=>{e.oncomplete=()=>t(),e.onerror=()=>n(e.error)})}Object.defineProperty(n,"__esModule",{value:!0}),n.IndexedDBStore=void 0;var c=new WeakMap;n.IndexedDBStore=class{constructor(){s(this,c,null)}async open(e,t){a(c,this)||await new Promise((n,s)=>{const a=indexedDB.open(e,t);a.onupgradeneeded=async()=>{const e=a.result;e.objectStoreNames.contains("store")||e.createObjectStore("store")},a.onsuccess=()=>{r(c,this,a.result),n()},a.onerror=()=>{s(a.error)}})}async set(e){if(!a(c,this))throw new Error("Database is not open");const t=Object.keys(e),n=a(c,this).transaction("store","readwrite"),s=n.objectStore("store");for(const n of t)s.put(e[n],n);await o(n)}async get(e){if(!a(c,this))throw new Error("Database is not open");const t=[...new Set(e)],n=a(c,this).transaction("store","readonly"),s=n.objectStore("store"),r=t.map(e=>s.get(e)),i=await Promise.all(r.map(e=>new Promise((t,n)=>{e.onsuccess=()=>t(e.result),e.onerror=()=>n(e.error)})));await o(n);const u=new Map(t.map((e,t)=>[e,i[t]]));return e.map(e=>u.get(e))}async remove(e){if(!a(c,this))throw new Error("Database is not open");const t=a(c,this).transaction("store","readwrite"),n=t.objectStore("store");for(const t of e)n.delete(t);await o(t)}async reset(){if(!a(c,this))throw new Error("Database is not open");const e=a(c,this).transaction("store","readwrite");e.objectStore("store").clear(),await o(e)}close(){a(c,this)&&(a(c,this).close(),r(c,this,null))}}}}},{package:"$root$",file:"app/scripts/lib/stores/indexeddb-store.ts"}],[2680,{"./json.cjs":2679,"@metamask/snaps-sdk":2563,"@metamask/superstruct":2705},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.validateSnapManifestLocalizations=n.getLocalizedSnapManifest=n.translate=n.TRANSLATION_REGEX=n.getLocalizationFile=n.getValidatedLocalizationFiles=n.LocalizationFileStruct=n.LOCALIZABLE_FIELDS=void 0;const s=e("@metamask/snaps-sdk"),r=e("@metamask/superstruct"),a=e("./json.cjs");function i(e,t){const n=t.find(t=>t.locale===e);return n||t.find(e=>"en"===e.locale)}function o(e,t){const s=e.matchAll(n.TRANSLATION_REGEX);return Array.from(s).reduce((n,[s,r])=>{if(!t)throw new Error(`Failed to translate "${e}": No localization file found.`);const a=t.messages[r.trim()];if(!a)throw new Error(`Failed to translate "${e}": No translation found for "${r.trim()}" in "${t.locale}" file.`);return n.replace(s,a.message)},e)}function c(e,t,s){const r=i(t,s);return n.LOCALIZABLE_FIELDS.reduce((e,t)=>{const n=o(e[t],r);return{...e,[t]:n}},e)}n.LOCALIZABLE_FIELDS=["description","proposedName"],n.LocalizationFileStruct=(0,r.object)({locale:(0,r.string)(),messages:(0,r.record)((0,r.string)(),(0,r.object)({message:(0,r.string)(),description:(0,r.optional)((0,r.string)())}))}),n.getValidatedLocalizationFiles=function(e){for(const t of e)try{t.result=(0,r.create)((0,a.parseJson)(t.toString()),n.LocalizationFileStruct)}catch(e){if(e instanceof r.StructError)throw new Error(`Failed to validate localization file "${t.path}": ${e.message}.`);if(e instanceof SyntaxError)throw new Error(`Failed to parse localization file "${t.path}" as JSON.`);throw e}return e},n.getLocalizationFile=i,n.TRANSLATION_REGEX=/\{\{\s?([a-zA-Z0-9-_\s]+)\s?\}\}/gu,n.translate=o,n.getLocalizedSnapManifest=c,n.validateSnapManifestLocalizations=function(e,t){try{t.filter(e=>"en"!==e.locale).forEach(n=>{c(e,n.locale,t)}),c(e,"en",t)}catch(e){throw new Error(`Failed to localize Snap manifest: ${(0,s.getErrorMessage)(e)}`)}}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/localization.cjs"}],[2681,{"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.logWarning=n.logError=n.logInfo=n.snapsLogger=void 0;const s=e("@metamask/utils");n.snapsLogger=(0,s.createProjectLogger)("snaps"),n.logInfo=function(e,...t){console.log(e,...t)},n.logError=function(e,...t){console.error(e,...t)},n.logWarning=function(e,...t){console.warn(e,...t)}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/logging.cjs"}],[2682,{"./validation.cjs":2683},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=Object.create?function(e,t,n,s){s===undefined&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]},r=function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./validation.cjs"),n)}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/manifest/index.cjs"}],[2683,{"../array.cjs":2650,"../cronjob.cjs":2657,"../entropy.cjs":2662,"../json-rpc.cjs":2678,"../snaps.cjs":2686,"../structs.cjs":2688,"../types.cjs":2691,"@metamask/key-tree":1967,"@metamask/superstruct":2705,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createSnapManifest=n.assertIsSnapManifest=n.isSnapManifest=n.SnapManifestStruct=n.InitialConnectionsStruct=n.SnapAuxilaryFilesStruct=n.SnapAuxiliaryFilesStruct=n.PermissionsStruct=n.EmptyObjectStruct=n.HandlerCaveatsStruct=n.ProtocolScopesStruct=n.MaxRequestTimeStruct=n.MAXIMUM_REQUEST_TIMEOUT=n.MINIMUM_REQUEST_TIMEOUT=n.LookupMatchersStruct=n.ChainIdsStruct=n.SnapIdsStruct=n.SemVerRangeStruct=n.SnapGetBip32EntropyPermissionsStruct=n.Bip32EntropyStruct=n.CurveStruct=n.bip32entropy=n.Bip32PathStruct=n.FORBIDDEN_COIN_TYPES=void 0;const s=e("@metamask/key-tree"),r=e("@metamask/superstruct"),a=e("@metamask/utils"),i=e("../array.cjs"),o=e("../cronjob.cjs"),c=e("../entropy.cjs"),u=e("../json-rpc.cjs"),l=e("../snaps.cjs"),d=e("../structs.cjs"),f=e("../types.cjs"),h=[c.SIP_6_MAGIC_VALUE,c.STATE_ENCRYPTION_MAGIC_VALUE];n.FORBIDDEN_COIN_TYPES=[60];const p=n.FORBIDDEN_COIN_TYPES.map(e=>["m","44'",`${e}'`]);n.Bip32PathStruct=(0,r.refine)((0,r.array)((0,r.string)()),"BIP-32 path",e=>0===e.length?"Path must be a non-empty BIP-32 derivation path array":"m"!==e[0]?'Path must start with "m".':e.length<3?"Paths must have a length of at least three.":e.slice(1).some(e=>!(0,s.isValidBIP32PathSegment)(e))?"Path must be a valid BIP-32 derivation path array.":h.includes(e[1])?`The purpose "${e[1]}" is not allowed for entropy derivation.`:!p.some(t=>(0,i.isEqual)(e.slice(0,t.length),t))||`The path "${e.join("/")}" is not allowed for entropy derivation.`);n.bip32entropy=e=>(0,r.refine)(e,"BIP-32 entropy",e=>"ed25519"!==e.curve||!e.path.slice(1).some(e=>!e.endsWith("'"))||"Ed25519 does not support unhardened paths."),n.CurveStruct=(0,r.enums)(["ed25519","secp256k1","ed25519Bip32"]),n.Bip32EntropyStruct=(0,n.bip32entropy)((0,r.type)({path:n.Bip32PathStruct,curve:n.CurveStruct})),n.SnapGetBip32EntropyPermissionsStruct=(0,r.size)((0,r.array)(n.Bip32EntropyStruct),1,Infinity),n.SemVerRangeStruct=(0,r.refine)((0,r.string)(),"SemVer range",e=>!!(0,a.isValidSemVerRange)(e)||"Expected a valid SemVer range."),n.SnapIdsStruct=(0,r.refine)((0,r.record)(l.SnapIdStruct,(0,r.object)({version:(0,r.optional)(n.SemVerRangeStruct)})),"SnapIds",e=>0!==Object.keys(e).length),n.ChainIdsStruct=(0,r.size)((0,r.array)(a.CaipChainIdStruct),1,Infinity),n.LookupMatchersStruct=(0,r.union)([(0,r.object)({tlds:(0,r.size)((0,r.array)((0,r.string)()),1,Infinity)}),(0,r.object)({schemes:(0,r.size)((0,r.array)((0,r.string)()),1,Infinity)}),(0,r.object)({tlds:(0,r.size)((0,r.array)((0,r.string)()),1,Infinity),schemes:(0,r.size)((0,r.array)((0,r.string)()),1,Infinity)})]),n.MINIMUM_REQUEST_TIMEOUT=(0,a.inMilliseconds)(5,a.Duration.Second),n.MAXIMUM_REQUEST_TIMEOUT=(0,a.inMilliseconds)(3,a.Duration.Minute),n.MaxRequestTimeStruct=(0,r.size)((0,r.integer)(),n.MINIMUM_REQUEST_TIMEOUT,n.MAXIMUM_REQUEST_TIMEOUT),n.ProtocolScopesStruct=(0,r.record)(a.CaipChainIdStruct,(0,r.object)({methods:(0,r.array)((0,r.string)())})),n.HandlerCaveatsStruct=(0,r.object)({maxRequestTime:(0,r.optional)(n.MaxRequestTimeStruct)}),n.EmptyObjectStruct=(0,r.object)({}),n.PermissionsStruct=(0,r.type)({"endowment:assets":(0,r.optional)((0,d.mergeStructs)(n.HandlerCaveatsStruct,(0,r.object)({scopes:n.ChainIdsStruct}))),"endowment:cronjob":(0,r.optional)((0,d.mergeStructs)(n.HandlerCaveatsStruct,(0,r.object)({jobs:(0,r.optional)(o.CronjobSpecificationArrayStruct)}))),"endowment:ethereum-provider":(0,r.optional)(n.EmptyObjectStruct),"endowment:keyring":(0,r.optional)((0,d.mergeStructs)(n.HandlerCaveatsStruct,u.KeyringOriginsStruct)),"endowment:protocol":(0,r.optional)((0,d.mergeStructs)(n.HandlerCaveatsStruct,(0,r.object)({scopes:n.ProtocolScopesStruct}))),"endowment:lifecycle-hooks":(0,r.optional)(n.HandlerCaveatsStruct),"endowment:name-lookup":(0,r.optional)((0,d.mergeStructs)(n.HandlerCaveatsStruct,(0,r.object)({chains:(0,r.optional)(n.ChainIdsStruct),matchers:(0,r.optional)(n.LookupMatchersStruct)}))),"endowment:network-access":(0,r.optional)(n.EmptyObjectStruct),"endowment:page-home":(0,r.optional)(n.HandlerCaveatsStruct),"endowment:rpc":(0,r.optional)((0,d.mergeStructs)(n.HandlerCaveatsStruct,u.RpcOriginsStruct)),"endowment:signature-insight":(0,r.optional)((0,d.mergeStructs)(n.HandlerCaveatsStruct,(0,r.object)({allowSignatureOrigin:(0,r.optional)((0,r.boolean)())}))),"endowment:transaction-insight":(0,r.optional)((0,d.mergeStructs)(n.HandlerCaveatsStruct,(0,r.object)({allowTransactionOrigin:(0,r.optional)((0,r.boolean)())}))),"endowment:webassembly":(0,r.optional)(n.EmptyObjectStruct),snap_dialog:(0,r.optional)(n.EmptyObjectStruct),snap_manageState:(0,r.optional)(n.EmptyObjectStruct),snap_manageAccounts:(0,r.optional)(n.EmptyObjectStruct),snap_notify:(0,r.optional)(n.EmptyObjectStruct),snap_getBip32Entropy:(0,r.optional)(n.SnapGetBip32EntropyPermissionsStruct),snap_getBip32PublicKey:(0,r.optional)(n.SnapGetBip32EntropyPermissionsStruct),snap_getBip44Entropy:(0,r.optional)((0,r.size)((0,r.array)((0,r.object)({coinType:(0,r.size)((0,r.integer)(),0,2**32-1)})),1,Infinity)),snap_getEntropy:(0,r.optional)(n.EmptyObjectStruct),snap_getLocale:(0,r.optional)(n.EmptyObjectStruct),wallet_snap:(0,r.optional)(n.SnapIdsStruct)}),n.SnapAuxiliaryFilesStruct=(0,r.array)((0,r.string)()),n.SnapAuxilaryFilesStruct=n.SnapAuxiliaryFilesStruct,n.InitialConnectionsStruct=(0,r.record)((0,r.intersection)([(0,r.string)(),(0,f.uri)()]),(0,r.object)({})),n.SnapManifestStruct=(0,r.object)({version:a.VersionStruct,description:(0,r.size)((0,r.string)(),1,280),proposedName:(0,r.size)((0,r.string)(),1,214),repository:(0,r.optional)((0,r.type)({type:(0,r.size)((0,r.string)(),1,Infinity),url:(0,r.size)((0,r.string)(),1,Infinity)})),source:(0,r.object)({shasum:a.ChecksumStruct,location:(0,r.object)({npm:(0,r.object)({filePath:(0,r.size)((0,r.string)(),1,Infinity),iconPath:(0,r.optional)((0,r.size)((0,r.string)(),1,Infinity)),packageName:f.NameStruct,registry:(0,r.union)([(0,r.literal)("https://registry.npmjs.org"),(0,r.literal)("https://registry.npmjs.org/")])})}),files:(0,r.optional)(n.SnapAuxiliaryFilesStruct),locales:(0,r.optional)(n.SnapAuxiliaryFilesStruct)}),initialConnections:(0,r.optional)(n.InitialConnectionsStruct),initialPermissions:n.PermissionsStruct,manifestVersion:(0,r.literal)("0.1"),platformVersion:(0,r.optional)(a.VersionStruct),$schema:(0,r.optional)((0,r.string)())}),n.isSnapManifest=function(e){return(0,r.is)(e,n.SnapManifestStruct)},n.assertIsSnapManifest=function(e){(0,a.assertStruct)(e,n.SnapManifestStruct,`"${f.NpmSnapFileNames.Manifest}" is invalid`)},n.createSnapManifest=function(e){return(0,r.create)(e,n.SnapManifestStruct)}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/manifest/validation.cjs"}],[2684,{"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.normalizeRelative=void 0;const s=e("@metamask/utils");n.normalizeRelative=function(e){return(0,s.assert)(!e.startsWith("/")),(0,s.assert)(-1===e.search(/:|\/\//u),`Path "${e}" potentially an URI instead of local relative`),e.startsWith("./")?e.slice(2):e}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/path.cjs"}],[2685,{"@metamask/snaps-sdk/package.json":2648},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.getPlatformVersion=void 0;const r=s(e("@metamask/snaps-sdk/package.json"));n.getPlatformVersion=function(){return r.default.version}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/platform-version.cjs"}],[2686,{"./caveats.cjs":2654,"./checksum.cjs":2655,"./types.cjs":2691,"@metamask/snaps-sdk":2563,"@metamask/superstruct":2705,"@metamask/utils":2799,"@scure/base":2876,"fast-json-stable-stringify":4108,"validate-npm-package-name":5382},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.verifyRequestedSnapPermissions=n.isSnapPermitted=n.assertIsValidSnapId=n.isSnapId=n.stripSnapPrefix=n.getSnapPrefix=n.SnapIdStruct=n.SnapIdPrefixStruct=n.HttpSnapIdStruct=n.NpmSnapIdStruct=n.LocalSnapIdStruct=n.BaseSnapIdStruct=n.LOCALHOST_HOSTNAMES=n.validateSnapShasum=n.getSnapChecksum=n.SnapStatusEvents=n.SnapStatus=n.PROPOSED_NAME_REGEX=void 0;const r=e("@metamask/snaps-sdk"),a=e("@metamask/superstruct"),i=e("@metamask/utils"),o=e("@scure/base"),c=s(e("fast-json-stable-stringify")),u=s(e("validate-npm-package-name")),l=e("./caveats.cjs"),d=e("./checksum.cjs"),f=e("./types.cjs");var h,p;function m(e){const t=e.clone();return delete t.result.source.shasum,t.value=(0,c.default)(t.result),t}async function g(e){const{manifest:t,sourceCode:n,svgIcon:s,auxiliaryFiles:r,localizationFiles:a}=e,i=[m(t),n,s,...r,...a].filter(e=>e!==undefined);return o.base64.encode(await(0,d.checksumFiles)(i))}n.PROPOSED_NAME_REGEX=/^(?:[A-Za-z0-9-_]+( [A-Za-z0-9-_]+)*)|(?:(?:@[A-Za-z0-9-*~][A-Za-z0-9-*._~]*\/)?[A-Za-z0-9-~][A-Za-z0-9-._~]*)$/u,function(e){e.Installing="installing",e.Updating="updating",e.Running="running",e.Stopped="stopped",e.Crashed="crashed"}(h||(n.SnapStatus=h={})),function(e){e.Start="START",e.Stop="STOP",e.Crash="CRASH",e.Update="UPDATE"}(p||(n.SnapStatusEvents=p={})),n.getSnapChecksum=g,n.validateSnapShasum=async function(e,t="Invalid Snap manifest: manifest shasum does not match computed shasum."){if(e.manifest.result.source.shasum!==await g(e))throw new Error(t)},n.LOCALHOST_HOSTNAMES=["localhost","127.0.0.1","[::1]"],n.BaseSnapIdStruct=(0,i.definePattern)("Base Snap Id",/^[\x21-\x7E]*$/u);const b=(0,f.uri)({protocol:(0,a.enums)(["http:","https:"]),hostname:(0,a.enums)(n.LOCALHOST_HOSTNAMES),hash:(0,a.empty)((0,a.string)()),search:(0,a.empty)((0,a.string)())});function y(e){const t=Object.values(f.SnapIdPrefixes).find(t=>e.startsWith(t));if(t!==undefined)return t;throw new Error(`Invalid or no prefix found for "${e}"`)}n.LocalSnapIdStruct=(0,a.refine)(n.BaseSnapIdStruct,"local Snap Id",e=>{if(!e.startsWith(f.SnapIdPrefixes.local))return`Expected local snap ID, got "${e}".`;const[t]=(0,a.validate)(e.slice(f.SnapIdPrefixes.local.length),b);return t??!0}),n.NpmSnapIdStruct=(0,a.intersection)([n.BaseSnapIdStruct,(0,f.uri)({protocol:(0,a.literal)(f.SnapIdPrefixes.npm),pathname:(0,a.refine)((0,a.string)(),"package name",function*(e){const t=e.startsWith("/")?e.slice(1):e,{errors:n,validForNewPackages:s,warnings:r}=(0,u.default)(t);return s||(n===undefined?((0,i.assert)(r!==undefined),yield*r):yield*n),!0}),search:(0,a.empty)((0,a.string)()),hash:(0,a.empty)((0,a.string)())})]),n.HttpSnapIdStruct=(0,a.intersection)([n.BaseSnapIdStruct,(0,f.uri)({protocol:(0,a.enums)(["http:","https:"]),search:(0,a.empty)((0,a.string)()),hash:(0,a.empty)((0,a.string)())})]),n.SnapIdPrefixStruct=(0,a.refine)((0,a.string)(),"Snap ID prefix",e=>{if(Object.values(f.SnapIdPrefixes).some(t=>e.startsWith(t)))return!0;return`Invalid or no prefix found. Expected Snap ID to start with one of: ${Object.values(f.SnapIdPrefixes).map(e=>`"${e}"`).join(", ")}, but received: "${e}"`}),n.SnapIdStruct=(0,r.selectiveUnion)(e=>"string"==typeof e&&e.startsWith(f.SnapIdPrefixes.npm)?n.NpmSnapIdStruct:"string"==typeof e&&e.startsWith(f.SnapIdPrefixes.local)?n.LocalSnapIdStruct:n.SnapIdPrefixStruct),n.getSnapPrefix=y,n.stripSnapPrefix=function(e){return e.replace(y(e),"")},n.isSnapId=function(e){return(0,a.is)(e,n.SnapIdStruct)},n.assertIsValidSnapId=function(e){(0,i.assertStruct)(e,n.SnapIdStruct,"Invalid snap ID")},n.isSnapPermitted=function(e,t){var n,s;return Boolean(null===(n=((null==e||null===(s=e.wallet_snap)||void 0===s||null===(s=s.caveats)||void 0===s?void 0:s.find(e=>e.type===l.SnapCaveatType.SnapIds))??{}).value)||void 0===n?void 0:n[t])},n.verifyRequestedSnapPermissions=function(e){(0,i.assert)((0,i.isObject)(e),"Requested permissions must be an object.");const{wallet_snap:t}=e;(0,i.assert)((0,i.isObject)(t),"wallet_snap is missing from the requested permissions.");const{caveats:n}=t;(0,i.assert)(Array.isArray(n)&&1===n.length,"wallet_snap must have a caveat property with a single-item array value.");const[s]=n;(0,i.assert)((0,i.isObject)(s)&&s.type===l.SnapCaveatType.SnapIds&&(0,i.isObject)(s.value),`The requested permissions do not have a valid ${l.SnapCaveatType.SnapIds} caveat.`)}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/snaps.cjs"}],[2687,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.indent=void 0,n.indent=function(e,t=2){return e.replace(/^/gmu," ".repeat(t))}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/strings.cjs"}],[2688,{"./strings.cjs":2687,"@metamask/snaps-sdk":2563,"@metamask/superstruct":2705,"@metamask/utils":2799,chalk:3782},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.mergeStructs=n.createUnion=n.validateUnion=n.getStructErrorMessage=n.getStructFailureMessage=n.getStructErrorPrefix=n.getUnionStructNames=n.getStructFromPath=n.createFromStruct=n.getError=n.arrayToGenerator=n.SnapsStructError=n.named=void 0;const s=e("@metamask/snaps-sdk"),r=e("@metamask/superstruct"),a=e("@metamask/utils"),i=e("chalk"),o=e("./strings.cjs");function c(e,t,n){return n?t(e):e}n.named=function(e,t){return new r.Struct({...t,type:e})};class u extends r.StructError{constructor(e,t,n,s,r,a=!0){super(s,r),this.name="SnapsStructError",this.message=`${t}.\n\n${g(e,[...r()],a)}${n?`\n\n${n}`:""}`}}function*l(e){for(const t of e)yield t}function d({struct:e,prefix:t,suffix:n="",error:s,colorize:r}){return new u(e,t,n,s,()=>l(s.failures()),r)}function f(e,t){return t.reduce((t,n)=>(0,a.isObject)(e.schema)&&e.schema[n]?e.schema[n]:t,e)}function h(e,t=!0){return Array.isArray(e.schema)?e.schema.map(({type:e})=>c(e,i.green,t)):null}function p(e,t=!0){return"never"===e.type||0===e.path.length?"":`At path: ${c(e.path.join("."),i.bold,t)} — `}function m(e,t,n=!0){const s=c(JSON.stringify(t.value),i.red,n),r=p(t,n);if("union"===t.type){const a=h(f(e,t.path),n);return a?`${r}Expected the value to be one of: ${a.join(", ")}, but received: ${s}.`:`${r}${t.message}.`}if("literal"===t.type){return`${r}${t.message.replace(/the literal `(.+)`,/u,`the value to be \`${c("$1",i.green,n)}\`,`).replace(/, but received: (.+)/u,`, but received: ${c("$1",i.red,n)}`)}.`}if("never"===t.type)return`Unknown key: ${c(t.path.join("."),i.bold,n)}, received: ${s}.`;if("size"===t.refinement){return`${r}${t.message.replace(/length between `(\d+)` and `(\d+)`/u,`length between ${c("$1",i.green,n)} and ${c("$2",i.green,n)},`).replace(/length of `(\d+)`/u,`length of ${c("$1",i.red,n)}`).replace(/a array/u,"an array")}.`}return t.refinement!==undefined?`${r}${t.message}.`:`${r}Expected a value of type ${c(t.type,i.green,n)}, but received: ${s}.`}function g(e,t,n=!0){return t.map(t=>(0,o.indent)(`• ${m(e,t,n)}`)).join("\n")}function b(e,t,n,i=!1){(0,a.assert)(t.schema,"Expected a struct with a schema. Make sure to use `union` from `@metamask/snaps-sdk`."),(0,a.assert)(t.schema.length>0,"Expected a non-empty array of structs.");const o=t.schema.map(e=>e.schema[n]),c=(0,r.type)({[n]:(0,s.union)(o)}),[u]=(0,r.validate)(e,c,{coerce:i});if(u)throw new Error(m(c,u.failures()[0],!1));const l=e,d=t.schema.filter(e=>(0,r.is)(l[n],e.schema[n]));(0,a.assert)(d.length>0,"Expected a struct to match the value.");const f=d.map(e=>(0,r.validate)(l,e,{coerce:i})),h=f.find(([e])=>!e);if(h)return h[1];(0,a.assert)(f[0][0],"Expected at least one error.");const p=f.reduce((e,[t])=>((0,a.assert)(t,"Expected an error."),t.failures().length<e.failures().length?t:e),f[0][0]);throw new Error(m(t,p.failures()[0],!1))}n.SnapsStructError=u,n.arrayToGenerator=l,n.getError=d,n.createFromStruct=function(e,t,n,s=""){try{return(0,r.create)(e,t)}catch(e){if(e instanceof r.StructError)throw d({struct:t,prefix:n,suffix:s,error:e});throw e}},n.getStructFromPath=f,n.getUnionStructNames=h,n.getStructErrorPrefix=p,n.getStructFailureMessage=m,n.getStructErrorMessage=g,n.validateUnion=b,n.createUnion=function(e,t,n){return b(e,t,n,!0)},n.mergeStructs=function(...e){const t=r.assign(...e);return new r.Struct({...t,*refiner(t,n){for(const s of e)yield*s.refiner(t,n)}})}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/structs.cjs"}],[2689,{"@metamask/utils":2799,"fast-xml-parser":4110},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isSvg=n.parseSvg=void 0;const s=e("@metamask/utils"),r=e("fast-xml-parser");function a(e){try{const t=e.trim();(0,s.assert)(t.length>0);const n=new r.XMLParser({ignoreAttributes:!1,parseAttributeValue:!0}).parse(t,!0);return(0,s.assert)((0,s.hasProperty)(n,"svg")),(0,s.isObject)(n.svg)?n.svg:{}}catch{throw new Error("Snap icon must be a valid SVG.")}}n.parseSvg=a,n.isSvg=function(e){try{return a(e),!0}catch{return!1}}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/svg.cjs"}],[269,{"../../../../shared/constants/errors":5420,"../../../../shared/lib/sentry":5511,"./indexeddb-store":268,"@metamask/utils":2799,lodash:4534,loglevel:4542},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.backedUpStateKeys=n.PersistenceManager=n.PersistenceError=void 0;var s,r=(s=e("loglevel"))&&s.__esModule?s:{default:s},a=e("lodash"),i=e("@metamask/utils"),o=e("../../../../shared/lib/sentry"),c=e("../../../../shared/constants/errors"),u=e("./indexeddb-store");function l(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function d(e,t){return e.get(h(e,t))}function f(e,t,n){return e.set(h(e,t),n),n}function h(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}function p(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const m=n.backedUpStateKeys=["KeyringController","AppMetadataController"];class g extends Error{constructor(e,t){super(e),p(this,"backup",void 0),this.name="PersistenceError",this.backup=t}}function b(e){const t=null==e?void 0:e.KeyringController;return(0,i.isObject)(t)&&(0,i.hasProperty)(t,"vault")&&Boolean(null==t?void 0:t.vault)}n.PersistenceError=g;const y="state-lock";var w=new WeakMap,T=new WeakMap,E=new WeakMap,S=new WeakMap,v=new WeakMap,k=new WeakMap,P=new WeakMap,I=new WeakMap,_=new WeakMap;n.PersistenceManager=class{constructor({localStore:e}){l(this,w,!1),l(this,T,null),l(this,E,void 0),l(this,S,!1),l(this,v,void 0),l(this,k,null),l(this,P,void 0),l(this,I,!1),l(this,_,undefined),f(v,this,e)}async open(){if(!d(I,this)){try{const e=new u.IndexedDBStore;await e.open("metamask-backup",1),f(k,this,e)}catch(e){if(!((0,i.isObject)(e)&&e instanceof DOMException&&"InvalidStateError"===e.name&&"A mutation operation was attempted on a database that did not allow mutations."===e.message))throw e;(0,o.captureException)(e),console.warn("Could not open backup database; automatic vault recovery will not be available."),console.error(e)}f(I,this,!0)}}setMetadata(e){f(E,this,e)}async set(e){var t;if(await this.open(),!e)throw new Error("MetaMask - updated state is missing");const n=d(E,this);if(!n)throw new Error('MetaMask - metadata must be set before calling "set"');const s=new AbortController;null===(t=d(_,this))||void 0===t||t.abort(),f(_,this,s),await navigator.locks.request(y,{mode:"exclusive",signal:s.signal},async()=>{f(_,this,undefined);try{await d(v,this).set({data:e,meta:n});const s=function(e,t){return{KeyringController:null==e?void 0:e.KeyringController,AppMetadataController:null==e?void 0:e.AppMetadataController,meta:t}}(e,n);if(b(s)){const e=JSON.stringify(s);var t;if(d(P,this)!==e)await(null===(t=d(k,this))||void 0===t?void 0:t.set(s)),f(P,this,e)}d(w,this)&&f(w,this,!1)}catch(e){d(w,this)||(f(w,this,!0),(0,o.captureException)(e)),r.default.error("error setting state in local store:",e)}finally{f(S,this,!0)}})}async get({validateVault:e}){return await this.open(),await navigator.locks.request(y,{mode:"shared"},async()=>{const t=await d(v,this).get();if(e&&!b(null==t?void 0:t.data)){const e=await this.getBackup();if(e&&Object.values(e).some(e=>e!==undefined))throw new g(c.MISSING_VAULT_ERROR,e)}return(0,a.isEmpty)(t)?(f(T,this,null),undefined):(d(S,this)||f(T,this,t),t)})}async reset(){await navigator.locks.request(y,{mode:"exclusive"},async()=>{var e;await Promise.all([d(v,this).reset(),await(null===(e=d(k,this))||void 0===e?void 0:e.reset())]),f(P,this,undefined),f(S,this,!1),f(w,this,!1),f(E,this,undefined),this.cleanUpMostRecentRetrievedState()})}async getBackup(){const e=d(k,this);if(!e)return undefined;const[t,n,s]=await e.get([...m,"meta"]);return{KeyringController:t,AppMetadataController:n,meta:s}}async logEncryptedVault(){let e,t=null;try{var n;e=null===(n=await this.get({validateVault:!1}))||void 0===n?void 0:n.data,t="primary database"}catch(e){console.error("Error getting state from persistence manager",e)}if(!b(e))try{e=await this.getBackup(),t="backup database"}catch(e){t=null,console.error("Error getting state from backup",e)}b(e)?(console.log(`MetaMask - Encrypted Vault from ${t}:`),console.log(e.KeyringController.vault)):console.log("MetaMask - No vault found in primary database or backup database")}get mostRecentRetrievedState(){return d(T,this)}cleanUpMostRecentRetrievedState(){d(T,this)&&f(T,this,null)}}}}},{package:"$root$",file:"app/scripts/lib/stores/persistence-manager.ts"}],[2690,{"@metamask/superstruct":2705,luxon:4545},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.toCensoredISO8601String=n.ISO8601DateStruct=n.ISO8601DurationStruct=void 0;const s=e("@metamask/superstruct"),r=e("luxon");n.ISO8601DurationStruct=(0,s.refine)((0,s.string)(),"ISO 8601 duration",e=>!!r.Duration.fromISO(e).isValid||"Not a valid ISO 8601 duration");const a=/Z|([+-]\d{2}:?\d{2})$/u;n.ISO8601DateStruct=(0,s.refine)((0,s.string)(),"ISO 8601 date",e=>r.DateTime.fromISO(e).isValid?!!a.test(e)||"ISO 8601 date must have timezone information":"Not a valid ISO 8601 date"),n.toCensoredISO8601String=function(e){return r.DateTime.fromISO(e,{setZone:!0}).startOf("second").toISO({suppressMilliseconds:!0})}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/time.cjs"}],[2691,{"@metamask/snaps-sdk":2563,"@metamask/superstruct":2705,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.WALLET_SNAP_PERMISSION_KEY=n.isValidUrl=n.uri=n.SNAP_STREAM_NAMES=n.SnapIdPrefixes=n.NpmSnapPackageJsonStruct=n.NameStruct=n.NpmSnapFileNames=void 0;const s=e("@metamask/snaps-sdk"),r=e("@metamask/superstruct"),a=e("@metamask/utils");var i,o,c;!function(e){e.PackageJson="package.json",e.Manifest="snap.manifest.json"}(i||(n.NpmSnapFileNames=i={})),n.NameStruct=(0,r.size)((0,a.definePattern)("Snap Name",/^(?:@[a-z0-9-*~][a-z0-9-*._~]*\/)?[a-z0-9-~][a-z0-9-._~]*$/u),1,214),n.NpmSnapPackageJsonStruct=(0,r.type)({version:a.VersionStruct,name:n.NameStruct,main:(0,r.optional)((0,r.size)((0,r.string)(),1,Infinity)),repository:(0,r.optional)((0,r.type)({type:(0,r.size)((0,r.string)(),1,Infinity),url:(0,r.size)((0,r.string)(),1,Infinity)}))}),function(e){e.npm="npm:",e.local="local:"}(o||(n.SnapIdPrefixes=o={})),function(e){e.JSON_RPC="jsonRpc",e.COMMAND="command"}(c||(n.SNAP_STREAM_NAMES=c={}));n.uri=(e={})=>(0,r.refine)((0,r.string)(),"uri",t=>{try{const n=new URL(t),s=(0,r.type)(e);return(0,r.assert)(n,s),!0}catch(e){return e instanceof r.StructError?(0,s.getErrorMessage)(e):`Expected URL, got "${t.toString()}"`}}),n.isValidUrl=function(e,t={}){return(0,r.is)(e,(0,n.uri)(t))},n.WALLET_SNAP_PERMISSION_KEY="wallet_snap"}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/types.cjs"}],[2692,{"./url.cjs":2693,"@metamask/snaps-sdk":2563,"@metamask/snaps-sdk/jsx":2647,"@metamask/snaps-sdk/jsx-runtime":2646,"@metamask/utils":2799,marked:4546},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.serialiseJsx=n.walkJsx=n.getJsxChildren=n.hasChildren=n.getTotalTextLength=n.validateJsxElements=n.validateAssetSelector=n.validateTextLinks=n.validateLink=n.getJsxElementFromComponent=n.getTextChildren=void 0;const s=e("@metamask/snaps-sdk/jsx-runtime"),r=e("@metamask/snaps-sdk"),a=e("@metamask/snaps-sdk/jsx"),i=e("@metamask/utils"),o=e("marked"),c=e("./url.cjs"),u=["https:","mailto:","metamask:"];function l(e){switch(e){case"primary":return"primary";case"secondary":return"destructive";default:return undefined}}function d(e){return 1===e.length?e[0]:e}function f(e){return e.tokens&&e.tokens.length>0?d(e.tokens.flatMap(p)):e.href}function h(e){return d(e.flatMap(p))}function p(e){switch(e.type){case"link":return(0,s.jsx)(a.Link,{href:e.href,children:f(e)});case"text":return e.text;case"strong":return(0,s.jsx)(a.Bold,{children:h(e.tokens)});case"em":return(0,s.jsx)(a.Italic,{children:h(e.tokens)});default:return null}}function m(e){const t=(0,o.lexer)(e,{gfm:!1}),n=[];return(0,o.walkTokens)(t,e=>{if("paragraph"===e.type){n.length>0&&n.push("\n\n");const{tokens:t}=e;n.push(...t.flatMap(p))}}),n.filter(e=>null!==e)}function g(e,t,n){try{const s=new URL(e);if((0,i.assert)(u.includes(s.protocol),`Protocol must be one of: ${u.join(", ")}.`),"metamask:"===s.protocol){const t=(0,c.parseMetaMaskUrl)(e);t.snapId&&(0,i.assert)(n(t.snapId),"The Snap being navigated to is not installed.")}else if("mailto:"===s.protocol){const e=s.pathname.split(",");for(const n of e){const e=n.split("@")[1];(0,i.assert)(!e.includes(":"));const s=`https://${e}`;(0,i.assert)(!t(s),"The specified URL is not allowed.")}return}(0,i.assert)(!t(s.href),"The specified URL is not allowed.")}catch(e){throw new Error(`Invalid URL: ${"ERR_ASSERTION"===(null==e?void 0:e.code)?e.message:"Unable to parse URL."}`)}}function b(e,t){const n=t(e);(0,i.assert)(n,`Could not find account for address: ${e}`)}function y(e){const{type:t}=e;switch(t){case r.NodeType.Panel:return e.children.reduce((e,t)=>e+y(t),0);case r.NodeType.Row:return y(e.value);case r.NodeType.Text:return e.value.length;default:return 0}}function w(e){return(0,i.hasProperty)(e.props,"children")}function T(e){return Boolean(e)&&!0!==e}function E(e){if(w(e)){if(Array.isArray(e.props.children))return e.props.children.filter(T).flat(Infinity);if(e.props.children)return[e.props.children]}return[]}function S(e,t,n=0){if(Array.isArray(e)){for(const s of e){const e=S(s,t,n);if(e!==undefined)return e}return undefined}const s=t(e,n);if(s!==undefined)return s;if((0,i.hasProperty)(e,"props")&&(0,i.isPlainObject)(e.props)&&(0,i.hasProperty)(e.props,"children")){const s=E(e);for(const e of s)if((0,i.isPlainObject)(e)){const s=S(e,t,n+1);if(s!==undefined)return s}}return undefined}function v(e){return Object.entries(e).filter(([e])=>"children"!==e).sort(([e],[t])=>e.localeCompare(t)).map(([e,t])=>{return` ${e}=${n=t,"string"==typeof n?`"${n}"`:`{${JSON.stringify(n)}}`}`;var n}).join("")}n.getTextChildren=m,n.getJsxElementFromComponent=function(e){return function(e){const t=y(e);(0,i.assert)(t<=5e4,"The text in a Snap UI may not be larger than 50 kB.")}(e),function e(t){switch(t.type){case r.NodeType.Address:return(0,s.jsx)(a.Address,{address:t.value});case r.NodeType.Button:return(0,s.jsx)(a.Button,{name:t.name,variant:l(t.variant),type:t.buttonType,children:t.value});case r.NodeType.Copyable:return(0,s.jsx)(a.Copyable,{value:t.value,sensitive:t.sensitive});case r.NodeType.Divider:return(0,s.jsx)(a.Divider,{});case r.NodeType.Form:return(0,s.jsx)(a.Form,{name:t.name,children:d(t.children.map(e))});case r.NodeType.Heading:return(0,s.jsx)(a.Heading,{children:t.value});case r.NodeType.Image:return(0,s.jsx)(a.Image,{src:t.value});case r.NodeType.Input:return(0,s.jsx)(a.Field,{label:t.label,error:t.error,children:(0,s.jsx)(a.Input,{name:t.name,type:t.inputType,value:t.value,placeholder:t.placeholder})});case r.NodeType.Panel:return(0,s.jsx)(a.Box,{children:d(t.children.map(e))});case r.NodeType.Row:return(0,s.jsx)(a.Row,{label:t.label,variant:t.variant,children:e(t.value)});case r.NodeType.Spinner:return(0,s.jsx)(a.Spinner,{});case r.NodeType.Text:return(0,s.jsx)(a.Text,{children:d(m(t.value))});default:return(0,i.assertExhaustive)(t)}}(e)},n.validateLink=g,n.validateTextLinks=function(e,t,n){const s=function(e){const t=(0,o.lexer)(e,{gfm:!1}),n=[];return(0,o.walkTokens)(t,e=>{"link"===e.type&&n.push(e)}),n}(e);for(const e of s)g(e.href,t,n)},n.validateAssetSelector=b,n.validateJsxElements=function(e,{isOnPhishingList:t,getSnap:n,getAccountByAddress:s}){S(e,e=>{switch(e.type){case"Link":g(e.props.href,t,n);break;case"AssetSelector":b(e.props.addresses[0],s)}})},n.getTotalTextLength=y,n.hasChildren=w,n.getJsxChildren=E,n.walkJsx=S,n.serialiseJsx=function e(t,n=0){if(Array.isArray(t))return t.map(t=>e(t,n)).join("");const s="  ".repeat(n);if("string"==typeof t)return`${s}${t}\n`;if(!t)return"";const{type:r,props:a}=t,o=n>0?"\n":"";if((0,i.hasProperty)(a,"children")){const t=e(a.children,n+1);return`${s}<${r}${v(a)}>\n${t}${s}</${r}>${o}`}return`${s}<${r}${v(a)} />${o}`}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/ui.cjs"}],[2693,{"./snaps.cjs":2686,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.parseMetaMaskUrl=n.SNAP_PATHS=n.CLIENT_PATHS=void 0;const s=e("@metamask/utils"),r=e("./snaps.cjs");n.CLIENT_PATHS=["/"],n.SNAP_PATHS=["/home"],n.parseMetaMaskUrl=function(e){const t=new URL(e),{protocol:a}=t;if("metamask:"!==a)throw new Error(`Unable to parse URL. Expected the protocol to be "metamask:", but received "${a}".`);const[i,...o]=t.href.replace("metamask://","").split("/"),c=`/${o.join("/")}`;switch(i){case"client":return(0,s.assert)(n.CLIENT_PATHS.includes(c),`Unable to navigate to "${c}". The provided path is not allowed.`),{authority:i,path:c};case"snap":return function(e){const t="Invalid MetaMask url:",a=(0,r.stripSnapPrefix)(e.slice(1)),i=e.slice(1).startsWith("npm:")?"npm:":"local:",o=a.startsWith("@"),c=a.split("/"),u=`/${c[c.length-1]}`;let l;if("local:"===i){const[e,,...r]=c.slice(0,-1);l=`${e}//${r.join("/")}`,(0,s.assert)(n.SNAP_PATHS.includes(u),`${t} invalid snap path.`)}else l=o?`${c[0]}/${c[1]}`:c[0],(0,s.assert)(o?3===c.length&&n.SNAP_PATHS.includes(u):2===c.length&&n.SNAP_PATHS.includes(u),`${t} invalid snap path.`);const d=`${i}${l}`;return(0,r.assertIsValidSnapId)(d),{authority:"snap",snapId:d,path:u}}(c);default:throw new Error(`Expected "metamask:" URL to start with "client" or "snap", but received "${i}".`)}}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/url.cjs"}],[2694,{"./icon.cjs":2675,"./localization.cjs":2680,"./manifest/validation.cjs":2683,"./snaps.cjs":2686},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.validateFetchedSnap=void 0;const s=e("./icon.cjs"),r=e("./localization.cjs"),a=e("./manifest/validation.cjs"),i=e("./snaps.cjs");n.validateFetchedSnap=async function(e){(0,a.assertIsSnapManifest)(e.manifest.result),await(0,i.validateSnapShasum)(e),(0,r.validateSnapManifestLocalizations)(e.manifest.result,e.localizationFiles.map(e=>e.result)),e.svgIcon&&(0,s.assertIsSnapIcon)(e.svgIcon)}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/validation.cjs"}],[2695,{"@metamask/superstruct":2705,"@metamask/utils":2799,semver:5252},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.resolveVersionRange=n.getTargetVersion=n.DEFAULT_REQUESTED_SNAP_VERSION=void 0;const s=e("@metamask/superstruct"),r=e("@metamask/utils"),a=e("semver");n.DEFAULT_REQUESTED_SNAP_VERSION="*",n.getTargetVersion=function(e,t){const n=(0,a.maxSatisfying)(e,t);return n||(0,a.maxSatisfying)(e,t,{includePrerelease:!0})},n.resolveVersionRange=function(e){return e===undefined||"latest"===e?[undefined,n.DEFAULT_REQUESTED_SNAP_VERSION]:(0,s.validate)(e,r.VersionRangeStruct)}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/versions.cjs"}],[2696,{"../deep-clone.cjs":2659,"@metamask/utils":2799,"@scure/base":2876},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){function s(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(n,"__esModule",{value:!0}),n.VirtualFile=void 0;const r=e("@metamask/utils"),a=e("@scure/base"),i=e("../deep-clone.cjs");class o{constructor(e){var t,n,r,a;let i;s(this,"value",void 0),s(this,"result",void 0),s(this,"data",void 0),s(this,"path",void 0),i="string"==typeof e||e instanceof Uint8Array?{value:e}:e,this.value=(null===(t=i)||void 0===t?void 0:t.value)??"",this.result=(null===(n=i)||void 0===n?void 0:n.result)??undefined,this.data=(null===(r=i)||void 0===r?void 0:r.data)??{},this.path=(null===(a=i)||void 0===a?void 0:a.path)??"/"}get size(){return"string"==typeof this.value?this.value.length:this.value.byteLength}toString(e){if("string"==typeof this.value)return(0,r.assert)(e===undefined,"Tried to encode string."),this.value;if(this.value instanceof Uint8Array&&"hex"===e)return(0,r.bytesToHex)(this.value);if(this.value instanceof Uint8Array&&"base64"===e)return a.base64.encode(this.value);return new TextDecoder(e).decode(this.value)}clone(){const e=new o;return"string"==typeof this.value?e.value=this.value:e.value=this.value.slice(0),e.result=(0,i.deepClone)(this.result),e.data=(0,i.deepClone)(this.data),e.path=this.path,e}}n.VirtualFile=o}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/virtual-file/VirtualFile.cjs"}],[2697,{"./VirtualFile.cjs":2696},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=Object.create?function(e,t,n,s){s===undefined&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]},r=function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./VirtualFile.cjs"),n)}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/virtual-file/index.cjs"}],[2698,{"./constants.cjs":2700,"./types.cjs":2703,"@metamask/base-controller":1222},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,a,i,o,c,u=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},l=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.SubscriptionController=n.getDefaultSubscriptionControllerState=void 0;const d=e("@metamask/base-controller"),f=e("./constants.cjs"),h=e("./types.cjs");function p(){return{subscriptions:[],trialedProducts:[]}}n.getDefaultSubscriptionControllerState=p;const m={subscriptions:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!0},customerId:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!0},trialedProducts:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},pricing:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0}};class g extends d.BaseController{constructor({messenger:e,state:t,subscriptionService:n}){super({name:f.controllerName,metadata:m,state:{subscriptions:[],trialedProducts:[],...t},messenger:e}),s.add(this),r.set(this,void 0),u(this,r,n,"f"),l(this,s,"m",a).call(this)}async getPricing(){const e=await l(this,r,"f").getPricing();return this.update(t=>{t.pricing=e}),e}async getSubscriptions(){const{subscriptions:e,customerId:t,trialedProducts:n}=await l(this,r,"f").getSubscriptions();return this.update(s=>{s.subscriptions=e,s.customerId=t,s.trialedProducts=n}),e}async cancelSubscription(e){l(this,s,"m",c).call(this,{subscriptionId:e.subscriptionId});const t=await l(this,r,"f").cancelSubscription({subscriptionId:e.subscriptionId});this.update(n=>{n.subscriptions=n.subscriptions.map(n=>n.id===e.subscriptionId?{...n,...t}:n)}),this.triggerAccessTokenRefresh()}async unCancelSubscription(e){l(this,s,"m",c).call(this,{subscriptionId:e.subscriptionId});const t=await l(this,r,"f").unCancelSubscription({subscriptionId:e.subscriptionId});this.update(n=>{n.subscriptions=n.subscriptions.map(n=>n.id===e.subscriptionId?{...n,...t}:n)}),this.triggerAccessTokenRefresh()}async startShieldSubscriptionWithCard(e){l(this,s,"m",o).call(this,{products:e.products});const t=await l(this,r,"f").startSubscriptionWithCard(e);return this.triggerAccessTokenRefresh(),t}async startSubscriptionWithCrypto(e){l(this,s,"m",o).call(this,{products:e.products});const t=await l(this,r,"f").startSubscriptionWithCrypto(e);return this.triggerAccessTokenRefresh(),t}async getCryptoApproveTransactionParams(e){const{pricing:t}=this.state;if(!t)throw new Error("Subscription pricing not found");const n=t.products.find(t=>t.name===e.productType);if(!n)throw new Error("Product price not found");const s=n.prices.find(t=>t.interval===e.interval);if(!s)throw new Error("Price not found");const r=t.paymentMethods.find(e=>e.type===h.PAYMENT_TYPES.byCrypto);if(!r)throw new Error("Chains payment info not found");const a=r.chains?.find(t=>t.chainId===e.chainId);if(!a)throw new Error("Invalid chain id");const i=a.tokens.find(t=>t.address===e.paymentTokenAddress);if(!i)throw new Error("Invalid token address");return{approveAmount:this.getTokenApproveAmount(s,i),paymentAddress:a.paymentAddress,paymentTokenAddress:e.paymentTokenAddress,chainId:e.chainId}}async updatePaymentMethod(e){if(e.paymentType===h.PAYMENT_TYPES.byCard){const{paymentType:t,...n}=e;return await l(this,r,"f").updatePaymentMethodCard(n)}if(e.paymentType===h.PAYMENT_TYPES.byCrypto){const{paymentType:t,...n}=e;return await l(this,r,"f").updatePaymentMethodCrypto(n),await this.getSubscriptions()}throw new Error("Invalid payment type")}getTokenApproveAmount(e,t){const n=t.conversionRate[e.currency];if(!n)throw new Error("Conversion rate not found");const r=10000n,a=BigInt(Math.round(Number(n)*Number(r)))/r,o=l(this,s,"m",i).call(this,e);return(BigInt(Math.round(o*Number(r)))/r*BigInt(10)**BigInt(t.decimals)/a).toString()}triggerAccessTokenRefresh(){this.messagingSystem.call("AuthenticationController:performSignOut")}async getBillingPortalUrl(){return await l(this,r,"f").getBillingPortalUrl()}}n.SubscriptionController=g,r=new WeakMap,s=new WeakSet,a=function(){this.messagingSystem.registerActionHandler("SubscriptionController:getSubscriptions",this.getSubscriptions.bind(this)),this.messagingSystem.registerActionHandler("SubscriptionController:cancelSubscription",this.cancelSubscription.bind(this)),this.messagingSystem.registerActionHandler("SubscriptionController:startShieldSubscriptionWithCard",this.startShieldSubscriptionWithCard.bind(this)),this.messagingSystem.registerActionHandler("SubscriptionController:getPricing",this.getPricing.bind(this)),this.messagingSystem.registerActionHandler("SubscriptionController:getCryptoApproveTransactionParams",this.getCryptoApproveTransactionParams.bind(this)),this.messagingSystem.registerActionHandler("SubscriptionController:startSubscriptionWithCrypto",this.startSubscriptionWithCrypto.bind(this)),this.messagingSystem.registerActionHandler("SubscriptionController:updatePaymentMethod",this.updatePaymentMethod.bind(this)),this.messagingSystem.registerActionHandler("SubscriptionController:getBillingPortalUrl",this.getBillingPortalUrl.bind(this))},i=function(e){return e.unitAmount/10**e.unitDecimals*e.minBillingCycles},o=function({products:e}){if(this.state.subscriptions.find(t=>t.products.some(t=>e.includes(t.name))))throw new Error(f.SubscriptionControllerErrorMessage.UserAlreadySubscribed)},c=function(e){if(!this.state.subscriptions.find(t=>t.id===e.subscriptionId))throw new Error(f.SubscriptionControllerErrorMessage.UserNotSubscribed)}}}},{package:"@metamask/subscription-controller",file:"node_modules/@metamask/subscription-controller/dist/SubscriptionController.cjs"}],[2699,{"./constants.cjs":2700,"./errors.cjs":2701,"@metamask/controller-utils":1301},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,a,i,o=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},c=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.SubscriptionService=n.SUBSCRIPTION_URL=void 0;const u=e("@metamask/controller-utils"),l=e("./constants.cjs"),d=e("./errors.cjs");n.SUBSCRIPTION_URL=(e,t)=>`${(0,l.getEnvUrls)(e).subscriptionApiUrl}/v1/${t}`;n.SubscriptionService=class{constructor(e){s.add(this),r.set(this,void 0),o(this,r,e.env,"f"),this.authUtils=e.auth}async getSubscriptions(){return await c(this,s,"m",a).call(this,"subscriptions")}async cancelSubscription(e){const t=`subscriptions/${e.subscriptionId}/cancel`;return await c(this,s,"m",a).call(this,t,"POST",{})}async unCancelSubscription(e){const t=`subscriptions/${e.subscriptionId}/uncancel`;return await c(this,s,"m",a).call(this,t,"POST",{})}async startSubscriptionWithCard(e){if(0===e.products.length)throw new d.SubscriptionServiceError(l.SubscriptionControllerErrorMessage.SubscriptionProductsEmpty);return await c(this,s,"m",a).call(this,"subscriptions/card","POST",e)}async startSubscriptionWithCrypto(e){return await c(this,s,"m",a).call(this,"subscriptions/crypto","POST",e)}async updatePaymentMethodCard(e){const t=`subscriptions/${e.subscriptionId}/payment-method/card`;return await c(this,s,"m",a).call(this,t,"PATCH",{...e,subscriptionId:undefined})}async updatePaymentMethodCrypto(e){const t=`subscriptions/${e.subscriptionId}/payment-method/crypto`;await c(this,s,"m",a).call(this,t,"PATCH",{...e,subscriptionId:undefined})}async getPricing(){return await c(this,s,"m",a).call(this,"pricing")}async getBillingPortalUrl(){return await c(this,s,"m",a).call(this,"billing-portal")}},r=new WeakMap,s=new WeakSet,a=async function(e,t="GET",a){try{const o=await c(this,s,"m",i).call(this),l=new URL((0,n.SUBSCRIPTION_URL)(c(this,r,"f"),e));return await(0,u.handleFetch)(l.toString(),{method:t,headers:{"Content-Type":"application/json",...o},body:a?JSON.stringify(a):undefined})}catch(e){const t=e instanceof Error?e.message:JSON.stringify(e);throw new d.SubscriptionServiceError(`failed to make request. ${t}`)}},i=async function(){return{Authorization:`Bearer ${await this.authUtils.getAccessToken()}`}}}}},{package:"@metamask/subscription-controller",file:"node_modules/@metamask/subscription-controller/dist/SubscriptionService.cjs"}],[270,{"../../../../shared/modules/fetch-with-timeout":5533,loglevel:4542},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=r(e("loglevel"));function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t,n){o(e,t),t.set(e,n)}function o(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function c(e,t){return e.get(l(e,t))}function u(e,t,n){return e.set(l(e,t),n),n}function l(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const d=(0,r(e("../../../../shared/modules/fetch-with-timeout")).default)();var f=new WeakMap,h=new WeakMap,p=new WeakMap,m=new WeakSet;async function g(){try{const e=await d("http://localhost:12345/state.json");e.ok?u(p,this,await e.json()):s.default.debug(`Received response with a status of ${e.status} ${e.statusText}`)}catch(e){console.log("error",e),e instanceof Error?s.default.debug(`Error loading network state: '${e.message}'`):s.default.debug("Error loading network state: An unknown error occurred")}finally{u(f,this,!0)}}n.default=class{constructor(){var e,t;o(e=this,t=m),t.add(e),i(this,f,!1),i(this,h,void 0),i(this,p,null),a(this,"isSupported",!0),u(h,this,l(m,this,g).call(this))}async get(){return c(f,this)||await c(h,this),c(p,this)}async set(e){if(!e)throw new Error("MetaMask - updated state is missing");c(f,this)||await c(h,this),u(p,this,e)}async reset(){u(f,this,!1),u(p,this,null),u(h,this,l(m,this,g).call(this)),await c(h,this)}}}}},{package:"$root$",file:"app/scripts/lib/stores/read-only-network-store.ts"}],[2700,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s;Object.defineProperty(n,"__esModule",{value:!0}),n.SubscriptionControllerErrorMessage=n.getEnvUrls=n.Env=n.controllerName=void 0,n.controllerName="SubscriptionController",function(e){e.DEV="dev",e.UAT="uat",e.PRD="prd"}(s||(n.Env=s={}));const r={dev:{subscriptionApiUrl:"https://subscription.dev-api.cx.metamask.io"},uat:{subscriptionApiUrl:"https://subscription.uat-api.cx.metamask.io"},prd:{subscriptionApiUrl:"https://subscription.api.cx.metamask.io"}};var a;n.getEnvUrls=function(e){if(!r[e])throw new Error("invalid environment configuration");return r[e]},function(e){e.UserAlreadySubscribed="SubscriptionController - User is already subscribed",e.UserNotSubscribed="SubscriptionController - User is not subscribed",e.SubscriptionProductsEmpty="SubscriptionController - Subscription products array cannot be empty"}(a||(n.SubscriptionControllerErrorMessage=a={}))}}},{package:"@metamask/subscription-controller",file:"node_modules/@metamask/subscription-controller/dist/constants.cjs"}],[2701,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SubscriptionServiceError=void 0;class s extends Error{constructor(e){super(e),this.name="SubscriptionServiceError"}}n.SubscriptionServiceError=s}}},{package:"@metamask/subscription-controller",file:"node_modules/@metamask/subscription-controller/dist/errors.cjs"}],[2702,{"./SubscriptionController.cjs":2698,"./SubscriptionService.cjs":2699,"./constants.cjs":2700,"./errors.cjs":2701,"./types.cjs":2703},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SubscriptionService=n.SubscriptionControllerErrorMessage=n.Env=n.SubscriptionServiceError=n.PAYMENT_TYPES=n.RECURRING_INTERVALS=n.PRODUCT_TYPES=n.SUBSCRIPTION_STATUSES=n.getDefaultSubscriptionControllerState=n.SubscriptionController=void 0;var s=e("./SubscriptionController.cjs");Object.defineProperty(n,"SubscriptionController",{enumerable:!0,get:function(){return s.SubscriptionController}}),Object.defineProperty(n,"getDefaultSubscriptionControllerState",{enumerable:!0,get:function(){return s.getDefaultSubscriptionControllerState}});var r=e("./types.cjs");Object.defineProperty(n,"SUBSCRIPTION_STATUSES",{enumerable:!0,get:function(){return r.SUBSCRIPTION_STATUSES}}),Object.defineProperty(n,"PRODUCT_TYPES",{enumerable:!0,get:function(){return r.PRODUCT_TYPES}}),Object.defineProperty(n,"RECURRING_INTERVALS",{enumerable:!0,get:function(){return r.RECURRING_INTERVALS}}),Object.defineProperty(n,"PAYMENT_TYPES",{enumerable:!0,get:function(){return r.PAYMENT_TYPES}});var a=e("./errors.cjs");Object.defineProperty(n,"SubscriptionServiceError",{enumerable:!0,get:function(){return a.SubscriptionServiceError}});var i=e("./constants.cjs");Object.defineProperty(n,"Env",{enumerable:!0,get:function(){return i.Env}}),Object.defineProperty(n,"SubscriptionControllerErrorMessage",{enumerable:!0,get:function(){return i.SubscriptionControllerErrorMessage}});var o=e("./SubscriptionService.cjs");Object.defineProperty(n,"SubscriptionService",{enumerable:!0,get:function(){return o.SubscriptionService}})}}},{package:"@metamask/subscription-controller",file:"node_modules/@metamask/subscription-controller/dist/index.cjs"}],[2703,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.CRYPTO_PAYMENT_METHOD_ERRORS=n.SUBSCRIPTION_STATUSES=n.RECURRING_INTERVALS=n.PAYMENT_TYPES=n.PRODUCT_TYPES=void 0,n.PRODUCT_TYPES={SHIELD:"shield"},n.PAYMENT_TYPES={byCard:"card",byCrypto:"crypto"},n.RECURRING_INTERVALS={month:"month",year:"year"},n.SUBSCRIPTION_STATUSES={incomplete:"incomplete",incompleteExpired:"incomplete_expired",provisional:"provisional",trialing:"trialing",active:"active",pastDue:"past_due",unpaid:"unpaid",canceled:"canceled",paused:"paused"},n.CRYPTO_PAYMENT_METHOD_ERRORS={APPROVAL_TRANSACTION_TOO_OLD:"approval_transaction_too_old",APPROVAL_TRANSACTION_REVERTED:"approval_transaction_reverted",APPROVAL_TRANSACTION_MAX_VERIFICATION_ATTEMPTS_REACHED:"approval_transaction_max_verification_attempts_reached",INSUFFICIENT_BALANCE:"insufficient_balance",INSUFFICIENT_ALLOWANCE:"insufficient_allowance"}}}},{package:"@metamask/subscription-controller",file:"node_modules/@metamask/subscription-controller/dist/types.cjs"}],[2704,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.StructError=void 0;class s extends TypeError{constructor(e,t){let n;const{message:s,explanation:r,...a}=e,{path:i}=e,o=0===i.length?s:`At path: ${i.join(".")} -- ${s}`;super(r??o),null!==r&&r!==undefined&&(this.cause=o),Object.assign(this,a),this.name=this.constructor.name,this.failures=()=>n??(n=[e,...t()])}}n.StructError=s}}},{package:"@metamask/superstruct",file:"node_modules/@metamask/superstruct/dist/error.cjs"}],[2705,{"./error.cjs":2704,"./struct.cjs":2706,"./structs/coercions.cjs":2707,"./structs/refinements.cjs":2708,"./structs/types.cjs":2709,"./structs/utilities.cjs":2710},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){s===undefined&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./error.cjs"),n),r(e("./struct.cjs"),n),r(e("./structs/coercions.cjs"),n),r(e("./structs/refinements.cjs"),n),r(e("./structs/types.cjs"),n),r(e("./structs/utilities.cjs"),n)}}},{package:"@metamask/superstruct",file:"node_modules/@metamask/superstruct/dist/index.cjs"}],[2706,{"./error.cjs":2704,"./utils.cjs":2711},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.validate=n.is=n.mask=n.create=n.assert=n.ExactOptionalStruct=n.Struct=void 0;const s=e("./error.cjs"),r=e("./utils.cjs");class a{constructor(e){const{type:t,schema:n,validator:s,refiner:a,coercer:i=e=>e,entries:o=function*(){}}=e;this.type=t,this.schema=n,this.entries=o,this.coercer=i,this.validator=s?(e,t)=>{const n=s(e,t);return(0,r.toFailures)(n,t,this,e)}:()=>[],this.refiner=a?(e,t)=>{const n=a(e,t);return(0,r.toFailures)(n,t,this,e)}:()=>[]}assert(e,t){return o(e,this,t)}create(e,t){return c(e,this,t)}is(e){return l(e,this)}mask(e,t){return u(e,this,t)}validate(e,t={}){return d(e,this,t)}}n.Struct=a;const i="EXACT_OPTIONAL";function o(e,t,n){const s=d(e,t,{message:n});if(s[0])throw s[0]}function c(e,t,n){const s=d(e,t,{coerce:!0,message:n});if(s[0])throw s[0];return s[1]}function u(e,t,n){const s=d(e,t,{coerce:!0,mask:!0,message:n});if(s[0])throw s[0];return s[1]}function l(e,t){return!d(e,t)[0]}function d(e,t,n={}){const a=(0,r.run)(e,t,n),i=(0,r.shiftIterator)(a);if(i[0]){return[new s.StructError(i[0],function*(){for(const e of a)e[0]&&(yield e[0])}),undefined]}const o=i[1];return[undefined,o]}n.ExactOptionalStruct=class extends a{constructor(e){super({...e,type:`exact optional ${e.type}`}),this.brand=i}static isExactOptional(e){return(0,r.isObject)(e)&&"brand"in e&&e.brand===i}},n.assert=o,n.create=c,n.mask=u,n.is=l,n.validate=d}}},{package:"@metamask/superstruct",file:"node_modules/@metamask/superstruct/dist/struct.cjs"}],[2707,{"../struct.cjs":2706,"../utils.cjs":2711,"./types.cjs":2709},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.trimmed=n.defaulted=n.coerce=void 0;const s=e("../struct.cjs"),r=e("../utils.cjs"),a=e("./types.cjs");function i(e,t,n){return new s.Struct({...e,coercer:(r,a)=>(0,s.is)(r,t)?e.coercer(n(r,a),a):e.coercer(r,a)})}n.coerce=i,n.defaulted=function(e,t,n={}){return i(e,(0,a.unknown)(),e=>{const s="function"==typeof t?t():t;if(e===undefined)return s;if(!n.strict&&(0,r.isPlainObject)(e)&&(0,r.isPlainObject)(s)){const t={...e};let n=!1;for(const e in s)t[e]===undefined&&(t[e]=s[e],n=!0);if(n)return t}return e})},n.trimmed=function(e){return i(e,(0,a.string)(),e=>e.trim())}}}},{package:"@metamask/superstruct",file:"node_modules/@metamask/superstruct/dist/structs/coercions.cjs"}],[2708,{"../struct.cjs":2706,"../utils.cjs":2711},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.refine=n.size=n.pattern=n.nonempty=n.min=n.max=n.empty=void 0;const s=e("../struct.cjs"),r=e("../utils.cjs");function a(e){return e instanceof Map||e instanceof Set?e.size:e.length}function i(e,t,n){return new s.Struct({...e,*refiner(s,a){yield*e.refiner(s,a);const i=n(s,a),o=(0,r.toFailures)(i,a,e,s);for(const e of o)yield{...e,refinement:t}}})}n.empty=function(e){return i(e,"empty",t=>{const n=a(t);return 0===n||`Expected an empty ${e.type} but received one with a size of \`${n}\``})},n.max=function(e,t,n={}){const{exclusive:s}=n;return i(e,"max",n=>s?n<t:n<=t||`Expected a ${e.type} less than ${s?"":"or equal to "}${t} but received \`${n}\``)},n.min=function(e,t,n={}){const{exclusive:s}=n;return i(e,"min",n=>s?n>t:n>=t||`Expected a ${e.type} greater than ${s?"":"or equal to "}${t} but received \`${n}\``)},n.nonempty=function(e){return i(e,"nonempty",t=>a(t)>0||`Expected a nonempty ${e.type} but received an empty one`)},n.pattern=function(e,t){return i(e,"pattern",n=>t.test(n)||`Expected a ${e.type} matching \`/${t.source}/\` but received "${n}"`)},n.size=function(e,t,n=t){const s=`Expected a ${e.type}`,r=t===n?`of \`${t}\``:`between \`${t}\` and \`${n}\``;return i(e,"size",e=>{if("number"==typeof e||e instanceof Date)return t<=e&&e<=n||`${s} ${r} but received \`${e}\``;if(e instanceof Map||e instanceof Set){const{size:a}=e;return t<=a&&a<=n||`${s} with a size ${r} but received one with a size of \`${a}\``}const{length:a}=e;return t<=a&&a<=n||`${s} with a length ${r} but received one with a length of \`${a}\``})},n.refine=i}}},{package:"@metamask/superstruct",file:"node_modules/@metamask/superstruct/dist/structs/refinements.cjs"}],[2709,{"../struct.cjs":2706,"../utils.cjs":2711,"./utilities.cjs":2710},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.unknown=n.union=n.type=n.tuple=n.string=n.set=n.regexp=n.record=n.exactOptional=n.optional=n.object=n.number=n.nullable=n.never=n.map=n.literal=n.intersection=n.integer=n.instance=n.func=n.enums=n.date=n.boolean=n.bigint=n.array=n.any=void 0;const s=e("../struct.cjs"),r=e("../utils.cjs"),a=e("./utilities.cjs");function i(){return(0,a.define)("never",()=>!1)}n.any=function(){return(0,a.define)("any",()=>!0)},n.array=function(e){return new s.Struct({type:"array",schema:e,*entries(t){if(e&&Array.isArray(t))for(const[n,s]of t.entries())yield[n,s,e]},coercer:e=>Array.isArray(e)?e.slice():e,validator:e=>Array.isArray(e)||`Expected an array value, but received: ${(0,r.print)(e)}`})},n.bigint=function(){return(0,a.define)("bigint",e=>"bigint"==typeof e)},n.boolean=function(){return(0,a.define)("boolean",e=>"boolean"==typeof e)},n.date=function(){return(0,a.define)("date",e=>e instanceof Date&&!isNaN(e.getTime())||`Expected a valid \`Date\` object, but received: ${(0,r.print)(e)}`)},n.enums=function(e){const t={},n=e.map(e=>(0,r.print)(e)).join();for(const n of e)t[n]=n;return new s.Struct({type:"enums",schema:t,validator:t=>e.includes(t)||`Expected one of \`${n}\`, but received: ${(0,r.print)(t)}`})},n.func=function(){return(0,a.define)("func",e=>"function"==typeof e||`Expected a function, but received: ${(0,r.print)(e)}`)},n.instance=function(e){return(0,a.define)("instance",t=>t instanceof e||`Expected a \`${e.name}\` instance, but received: ${(0,r.print)(t)}`)},n.integer=function(){return(0,a.define)("integer",e=>"number"==typeof e&&!isNaN(e)&&Number.isInteger(e)||`Expected an integer, but received: ${(0,r.print)(e)}`)},n.intersection=function(e){return new s.Struct({type:"intersection",schema:null,*entries(t,n){for(const{entries:s}of e)yield*s(t,n)},*validator(t,n){for(const{validator:s}of e)yield*s(t,n)},*refiner(t,n){for(const{refiner:s}of e)yield*s(t,n)}})},n.literal=function(e){const t=(0,r.print)(e),n=typeof e;return new s.Struct({type:"literal",schema:"string"===n||"number"===n||"boolean"===n?e:null,validator:n=>n===e||`Expected the literal \`${t}\`, but received: ${(0,r.print)(n)}`})},n.map=function(e,t){return new s.Struct({type:"map",schema:null,*entries(n){if(e&&t&&n instanceof Map)for(const[s,r]of n.entries())yield[s,s,e],yield[s,r,t]},coercer:e=>e instanceof Map?new Map(e):e,validator:e=>e instanceof Map||`Expected a \`Map\` object, but received: ${(0,r.print)(e)}`})},n.never=i,n.nullable=function(e){return new s.Struct({...e,validator:(t,n)=>null===t||e.validator(t,n),refiner:(t,n)=>null===t||e.refiner(t,n)})},n.number=function(){return(0,a.define)("number",e=>"number"==typeof e&&!isNaN(e)||`Expected a number, but received: ${(0,r.print)(e)}`)},n.object=function(e){const t=e?Object.keys(e):[],n=i();return new s.Struct({type:"object",schema:e??null,*entries(a){if(e&&(0,r.isObject)(a)){const r=new Set(Object.keys(a));for(const n of t){r.delete(n);const t=e[n];s.ExactOptionalStruct.isExactOptional(t)&&!Object.prototype.hasOwnProperty.call(a,n)||(yield[n,a[n],e[n]])}for(const e of r)yield[e,a[e],n]}},validator:e=>(0,r.isObject)(e)||`Expected an object, but received: ${(0,r.print)(e)}`,coercer:e=>(0,r.isObject)(e)?{...e}:e})},n.optional=function(e){return new s.Struct({...e,validator:(t,n)=>t===undefined||e.validator(t,n),refiner:(t,n)=>t===undefined||e.refiner(t,n)})},n.exactOptional=function(e){return new s.ExactOptionalStruct(e)},n.record=function(e,t){return new s.Struct({type:"record",schema:null,*entries(n){if((0,r.isObject)(n))for(const s in n){const r=n[s];yield[s,s,e],yield[s,r,t]}},validator:e=>(0,r.isObject)(e)||`Expected an object, but received: ${(0,r.print)(e)}`})},n.regexp=function(){return(0,a.define)("regexp",e=>e instanceof RegExp)},n.set=function(e){return new s.Struct({type:"set",schema:null,*entries(t){if(e&&t instanceof Set)for(const n of t)yield[n,n,e]},coercer:e=>e instanceof Set?new Set(e):e,validator:e=>e instanceof Set||`Expected a \`Set\` object, but received: ${(0,r.print)(e)}`})},n.string=function(){return(0,a.define)("string",e=>"string"==typeof e||`Expected a string, but received: ${(0,r.print)(e)}`)},n.tuple=function(e){const t=i();return new s.Struct({type:"tuple",schema:null,*entries(n){if(Array.isArray(n)){const s=Math.max(e.length,n.length);for(let r=0;r<s;r++)yield[r,n[r],e[r]||t]}},validator:e=>Array.isArray(e)||`Expected an array, but received: ${(0,r.print)(e)}`})},n.type=function(e){const t=Object.keys(e);return new s.Struct({type:"type",schema:e,*entries(n){if((0,r.isObject)(n))for(const s of t)yield[s,n[s],e[s]]},validator:e=>(0,r.isObject)(e)||`Expected an object, but received: ${(0,r.print)(e)}`,coercer:e=>(0,r.isObject)(e)?{...e}:e})},n.union=function(e){const t=e.map(e=>e.type).join(" | ");return new s.Struct({type:"union",schema:null,coercer(t){for(const n of e){const[e,s]=n.validate(t,{coerce:!0});if(!e)return s}return t},validator(n,s){const a=[];for(const t of e){const[...e]=(0,r.run)(n,t,s),[i]=e;if(!i?.[0])return[];for(const[t]of e)t&&a.push(t)}return[`Expected the value to satisfy a union of \`${t}\`, but received: ${(0,r.print)(n)}`,...a]}})},n.unknown=function(){return(0,a.define)("unknown",()=>!0)}}}},{package:"@metamask/superstruct",file:"node_modules/@metamask/superstruct/dist/structs/types.cjs"}],[271,{"@metamask/object-multiplex":2248,"readable-stream":4977},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isStreamWritable=function(e){var t;return Boolean(e.writable&&!e.destroyed&&!(null!==(t=e._writableState)&&void 0!==t&&t.ended))},n.setupMultiplex=function(e){const t=new r.default;return(0,a.pipeline)(e,t,e,e=>{var t;!e||null!==(t=e.message)&&void 0!==t&&t.match("Premature close")||console.error(e)}),t};var s,r=(s=e("@metamask/object-multiplex"))&&s.__esModule?s:{default:s},a=e("readable-stream")}}},{package:"$root$",file:"app/scripts/lib/stream-utils.js"}],[2710,{"../struct.cjs":2706,"./types.cjs":2709},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.pick=n.partial=n.omit=n.lazy=n.dynamic=n.deprecated=n.define=n.assign=void 0;const s=e("../struct.cjs"),r=e("./types.cjs");n.assign=function(...e){const t="type"===e[0]?.type,n=e.map(({schema:e})=>e),s=Object.assign({},...n);return t?(0,r.type)(s):(0,r.object)(s)},n.define=function(e,t){return new s.Struct({type:e,schema:null,validator:t})},n.deprecated=function(e,t){return new s.Struct({...e,refiner:(t,n)=>t===undefined||e.refiner(t,n),validator:(n,s)=>n===undefined||(t(n,s),e.validator(n,s))})},n.dynamic=function(e){return new s.Struct({type:"dynamic",schema:null,*entries(t,n){const s=e(t,n);yield*s.entries(t,n)},validator:(t,n)=>e(t,n).validator(t,n),coercer:(t,n)=>e(t,n).coercer(t,n),refiner:(t,n)=>e(t,n).refiner(t,n)})},n.lazy=function(e){let t;return new s.Struct({type:"lazy",schema:null,*entries(n,s){t??(t=e()),yield*t.entries(n,s)},validator:(n,s)=>(t??(t=e()),t.validator(n,s)),coercer:(n,s)=>(t??(t=e()),t.coercer(n,s)),refiner:(n,s)=>(t??(t=e()),t.refiner(n,s))})},n.omit=function(e,t){const{schema:n}=e,s={...n};for(const e of t)delete s[e];return"type"===e.type?(0,r.type)(s):(0,r.object)(s)},n.partial=function(e){const t=e instanceof s.Struct,n=t?{...e.schema}:{...e};for(const e in n)n[e]=(0,r.optional)(n[e]);return t&&"type"===e.type?(0,r.type)(n):(0,r.object)(n)},n.pick=function(e,t){const{schema:n}=e,s={};for(const e of t)s[e]=n[e];return"type"===e.type?(0,r.type)(s):(0,r.object)(s)}}}},{package:"@metamask/superstruct",file:"node_modules/@metamask/superstruct/dist/structs/utilities.cjs"}],[2711,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){function s(e){return"object"==typeof e&&null!==e}function r(e){return"symbol"==typeof e?e.toString():"string"==typeof e?JSON.stringify(e):`${e}`}function a(e,t,n,s){if(!0===e)return undefined;!1===e?e={}:"string"==typeof e&&(e={message:e});const{path:a,branch:i}=t,{type:o}=n,{refinement:c,message:u=`Expected a value of type \`${o}\`${c?` with refinement \`${c}\``:""}, but received: \`${r(s)}\``}=e;return{value:s,type:o,refinement:c,key:a[a.length-1],path:a,branch:i,...e,message:u}}Object.defineProperty(n,"__esModule",{value:!0}),n.run=n.toFailures=n.toFailure=n.shiftIterator=n.print=n.isPlainObject=n.isObject=void 0,n.isObject=s,n.isPlainObject=function(e){if("[object Object]"!==Object.prototype.toString.call(e))return!1;const t=Object.getPrototypeOf(e);return null===t||t===Object.prototype},n.print=r,n.shiftIterator=function(e){const{done:t,value:n}=e.next();return t?undefined:n},n.toFailure=a,n.toFailures=function*(e,t,n,r){(function(e){return s(e)&&"function"==typeof e[Symbol.iterator]})(e)||(e=[e]);for(const s of e){const e=a(s,t,n,r);e&&(yield e)}},n.run=function*e(t,n,r={}){const{path:a=[],branch:i=[t],coerce:o=!1,mask:c=!1}=r,u={path:a,branch:i};if(o&&(t=n.coercer(t,u),c&&"type"!==n.type&&s(n.schema)&&s(t)&&!Array.isArray(t)))for(const e in t)n.schema[e]===undefined&&delete t[e];let l="valid";for(const e of n.validator(t,u))e.explanation=r.message,l="not_valid",yield[e,undefined];for(let[d,f,h]of n.entries(t,u)){const n=e(f,h,{path:d===undefined?a:[...a,d],branch:d===undefined?i:[...i,f],coerce:o,mask:c,message:r.message});for(const e of n)e[0]?(l=null===e[0].refinement||e[0].refinement===undefined?"not_valid":"not_refined",yield[e[0],undefined]):o&&(f=e[1],d===undefined?t=f:t instanceof Map?t.set(d,f):t instanceof Set?t.add(f):s(t)&&(f!==undefined||d in t)&&(t[d]=f))}if("not_valid"!==l)for(const e of n.refiner(t,u))e.explanation=r.message,l="not_refined",yield[e,undefined];"valid"===l&&(yield[undefined,t])}}}},{package:"@metamask/superstruct",file:"node_modules/@metamask/superstruct/dist/utils.cjs"}],[2712,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createEventEmitterProxy=void 0;const s=()=>!0,r=["newListener","removeListener"],a=e=>!r.includes(e);n.createEventEmitterProxy=function(e,{eventFilter:t=s}={}){const n="skipInternal"===t?a:t;if("function"!=typeof n)throw new Error("createEventEmitterProxy - Invalid eventFilter");let r=[],i=e,o=e=>{const t=i;i=e,r.forEach(({name:n,handler:s,addedWith:r,filtered:a})=>{a||e[r](n,s),t.off(n,s)})};const c=(e,t)=>{r=r.filter(n=>e!==n.name||t!==n.handler&&t!==n.unwrappedHandler)};return new Proxy(i,{get(e,t,s){if("setTarget"===t)return o;const a=i[t];return"function"==typeof a?function(...e){const o=e[1];if("once"===t){const t=(...n)=>(c(e[0],t),o(...n));e[1]=t}if("on"===t||"addListener"===t||"prependListener"===t||"once"===t)r.push({addedWith:t,name:e[0],unwrappedHandler:o,handler:e[1],filtered:!n(e[0])});else if("off"===t||"removeListener"===t){const t=r.find(({name:t,unwrappedHandler:n})=>t===e[0]&&n===e[1]);if(t===undefined)return i;c(e[0],e[1]),e[1]=t.handler}return a.apply(this===s?i:this,e)}:a},set:(e,t,n)=>"setTarget"===t?(o=n,!0):(i[t]=n,!0)})}}}},{package:"@metamask/network-controller>@metamask/swappable-obj-proxy",file:"node_modules/@metamask/swappable-obj-proxy/dist/createEventEmitterProxy.js"}],[2713,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createSwappableProxy=void 0,n.createSwappableProxy=function(e){let t=e,n=e=>{t=e};return new Proxy(t,{get(e,s,r){if("setTarget"===s)return n;const a=t[s];return a instanceof Function?function(...e){return a.apply(this===r?t:this,e)}:a},set:(e,s,r)=>"setTarget"===s?(n=r,!0):(t[s]=r,!0)})}}}},{package:"@metamask/network-controller>@metamask/swappable-obj-proxy",file:"node_modules/@metamask/swappable-obj-proxy/dist/createSwappableProxy.js"}],[2714,{"./createEventEmitterProxy":2712,"./createSwappableProxy":2713,"./types":2715},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){s===undefined&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./createEventEmitterProxy"),n),r(e("./createSwappableProxy"),n),r(e("./types"),n)}}},{package:"@metamask/network-controller>@metamask/swappable-obj-proxy",file:"node_modules/@metamask/swappable-obj-proxy/dist/index.js"}],[2715,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0})}}},{package:"@metamask/network-controller>@metamask/swappable-obj-proxy",file:"node_modules/@metamask/swappable-obj-proxy/dist/types.js"}],[2716,{"./constants.cjs":2718,"./errors.cjs":2719,"./utils.cjs":2729,"@metamask/auth-network-utils":1214,"@toruslabs/http-helpers":2730},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.authenticateUser=n.createAuthResponseHandler=void 0;const s=e("@metamask/auth-network-utils"),r=e("@toruslabs/http-helpers"),a=e("./constants.cjs"),i=e("./errors.cjs"),o=e("./utils.cjs");n.createAuthResponseHandler=(e,t)=>{let n=null;return async()=>{const r=(0,s.filterCompletedRequests)(e);if(r.length>=a.AUTHENTICATION_THRESHOLD){n??(n=Date.now());const e=Date.now()-n>1e3;if(t||e){const e=r.map(e=>{const{pubKey:t,keyIndex:n}=e.result;return{pubKey:t,keyIndex:n}}),t=(0,s.thresholdSame)(e,a.AUTHENTICATION_THRESHOLD);if(!t)throw i.TOPRFError.invalidAuthenticateResults(`Authentication threshold met, but pubKey/keyIndex data inconsistent: ${JSON.stringify(e)}`);return{authRequestResults:r.map(e=>e.result),isNewUser:!t.pubKey}}return undefined}if(t)throw i.TOPRFError.invalidAuthenticateResults(`Authentication threshold not met after all requests processed. Expected: ${a.AUTHENTICATION_THRESHOLD}, got: ${r.length}`);return undefined}};n.authenticateUser=async e=>{const{idToken:t,nodeEndpointsMap:c,authConnectionId:u,userId:l,commitmentSignatures:d,groupedAuthConnectionId:f,hashedIdToken:h,sessionPrivateKey:p}=e,m=(e=>{const t=e.groupedAuthConnectionId?{subVerifierAuthParams:[{subVerifierIdToken:e.idToken,subVerifier:e.authConnectionId}]}:undefined;if(e.groupedAuthConnectionId&&!e.hashedIdToken)throw i.TOPRFError.fromCode(i.TOPRFErrorCode.NoHashedIdToken);return{authData:{authenticationContext:{idToken:e.groupedAuthConnectionId&&e.hashedIdToken?e.hashedIdToken:e.idToken,verifier:e.groupedAuthConnectionId??e.authConnectionId,verifierId:e.userId},singleIdVerifierParams:t},commitmentSignatures:e.commitmentSignatures,clientTime:Math.floor(Date.now()/1e3).toString()}})({idToken:t,authConnectionId:u,userId:l,commitmentSignatures:d,groupedAuthConnectionId:f,hashedIdToken:h}),g=Object.values(c).map(async e=>(async(e,t)=>{const n=(0,r.generateJsonRPCObject)(a.JRPC_METHODS.AUTHENTICATE_REQUEST,t);return(0,o.postJRPCRequest)(e,n)})(e,m)),b=await(0,s.Some)(g,async(e,t)=>(0,n.createAuthResponseHandler)(e,t.allSettled)());return{authTokensData:await Promise.all(b.authRequestResults.map(async e=>{const{authToken:t,nodeIndex:n,nodePubKey:s,pubKey:r,keyIndex:a}=e;return{authToken:await(0,o.decryptAuthToken)(t,p),nodeIndex:n,nodePubKey:s,pubKey:r,keyIndex:a}})),isNewUser:b.isNewUser}}}}},{package:"@metamask/seedless-onboarding-controller>@metamask/toprf-secure-backup",file:"node_modules/@metamask/toprf-secure-backup/dist/authenticateRequest.cjs"}],[2717,{"./constants.cjs":2718,"./errors.cjs":2719,"./utils.cjs":2729,"@metamask/auth-network-utils":1214,"@noble/hashes/utils":2855,"@toruslabs/http-helpers":2730},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.commitIdToken=n.createHandleCommitmentResponses=void 0;const s=e("@metamask/auth-network-utils"),r=e("@noble/hashes/utils"),a=e("@toruslabs/http-helpers"),i=e("./constants.cjs"),o=e("./errors.cjs"),c=e("./utils.cjs");n.createHandleCommitmentResponses=(e,t)=>{let n=null;return async()=>{const r=(0,s.filterCompletedRequests)(e);if(r.length>=i.COMMIT_RESPONSE_THRESHOLD){n??(n=Date.now());const e=Date.now()-n>1e3;return t||e?r.map(e=>e.result):undefined}if(t)throw o.TOPRFError.invalidCommitResults(`Threshold not met after all requests processed. Expected: ${i.COMMIT_RESPONSE_THRESHOLD}, got: ${r.length}`);return undefined}};n.commitIdToken=async e=>{const{idToken:t,endpoints:o,authConnectionId:u,sessionPubKeyX:l,sessionPubKeyY:d}=e,f=((e,t,n,s)=>({tokenCommitment:e,verifier:t,tempPubKeyX:n,tempPubKeyY:s}))((0,s.keccak256AndHexify)((0,r.utf8ToBytes)(t)).slice(2),u,l,d),h=o.map(async e=>(async(e,t)=>{const n=(0,a.generateJsonRPCObject)(i.JRPC_METHODS.COMMITMENT_REQUEST,t);return(0,c.postJRPCRequest)(e,n)})(e,f));return(0,s.Some)(h,async(e,t)=>(0,n.createHandleCommitmentResponses)(e,t.allSettled)())}}}},{package:"@metamask/seedless-onboarding-controller>@metamask/toprf-secure-backup",file:"node_modules/@metamask/toprf-secure-backup/dist/commitRequest.cjs"}],[2718,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s;Object.defineProperty(n,"__esModule",{value:!0}),n.JsonRpcErrorCodes=n.PW_BACKUP_ITEM_ID=n.MAX_PASSWORD_CHAIN_LENGTH=n.FIRST_KEY_INDEX=n.GENERATE_SHARE_THRESHOLD=n.GET_PUB_KEY_THRESHOLD=n.TOPRF_EVAL_THRESHOLD=n.AUTHENTICATION_THRESHOLD=n.COMMIT_RESPONSE_THRESHOLD=n.JRPC_METHODS=void 0,n.JRPC_METHODS={COMMITMENT_REQUEST:"TOPRFCommitmentRequest",AUTHENTICATE_REQUEST:"TOPRFAuthenticateRequest",STORE_KEY_SHARES_REQUEST:"TOPRFStoreKeyShareRequest",RESET_RATE_LIMIT_REQUEST:"TOPRFResetRateLimitRequest",TOPRF_EVAL_REQUEST:"TOPRFEvalRequest",GET_PUB_KEY_REQUEST:"TOPRFGetPubKeyRequest"},n.COMMIT_RESPONSE_THRESHOLD=4,n.AUTHENTICATION_THRESHOLD=4,n.TOPRF_EVAL_THRESHOLD=3,n.GET_PUB_KEY_THRESHOLD=3,n.GENERATE_SHARE_THRESHOLD=3,n.FIRST_KEY_INDEX=1,n.MAX_PASSWORD_CHAIN_LENGTH=10,n.PW_BACKUP_ITEM_ID="PW_BACKUP",function(e){e[e.ErrorCodeInvalidParams=-32602]="ErrorCodeInvalidParams",e[e.ErrorCodeInternal=-32603]="ErrorCodeInternal"}(s||(n.JsonRpcErrorCodes=s={}))}}},{package:"@metamask/seedless-onboarding-controller>@metamask/toprf-secure-backup",file:"node_modules/@metamask/toprf-secure-backup/dist/constants.cjs"}],[2719,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s;Object.defineProperty(n,"__esModule",{value:!0}),n.TOPRFError=n.TOPRFErrorCode=void 0,function(e){e[e.Default=1e3]="Default",e[e.InvalidAuthenticateResults=1001]="InvalidAuthenticateResults",e[e.InvalidCommitResults=1002]="InvalidCommitResults",e[e.PwdInputRateLimitExceeded=1003]="PwdInputRateLimitExceeded",e[e.InsufficientValidResponses=1004]="InsufficientValidResponses",e[e.CouldNotDeriveThresholdAuthPubKey=1005]="CouldNotDeriveThresholdAuthPubKey",e[e.CouldNotDeriveEncryptionKey=1006]="CouldNotDeriveEncryptionKey",e[e.EndpointNotFound=1007]="EndpointNotFound",e[e.InsufficientAuthTokens=1008]="InsufficientAuthTokens",e[e.RateLimitExceeded=1009]="RateLimitExceeded",e[e.InvalidAuthToken=1010]="InvalidAuthToken",e[e.AuthTokenExpired=1011]="AuthTokenExpired",e[e.JsonRpcError=1012]="JsonRpcError",e[e.CouldNotFetchPassword=1013]="CouldNotFetchPassword",e[e.NoHashedIdToken=1014]="NoHashedIdToken",e[e.MaxKeyChainLengthExceeded=1015]="MaxKeyChainLengthExceeded"}(s||(n.TOPRFErrorCode=s={}));class r extends Error{constructor(e,t,n){super(t),this.code=e,this.meta=n,Object.defineProperty(this,"name",{value:"TOPRFError"})}static fromCode(e,t="",n){const a=t?` ${t}`:"";return r.messages[e]?new r(e,`${r.messages[e]}${a}`,n):new r(1e3,`${r.messages[s.Default]}${a}`,n)}static default(e=""){return new r(s.Default,`${r.messages[s.Default]} ${e}`)}static invalidAuthenticateResults(e=""){return r.fromCode(s.InvalidAuthenticateResults,e)}static invalidCommitResults(e=""){return r.fromCode(s.InvalidCommitResults,e)}static pwdInputRateLimitExceeded(e=""){return r.fromCode(s.PwdInputRateLimitExceeded,e)}static insufficientValidResponses(e=""){return r.fromCode(s.InsufficientValidResponses,e)}static couldNotDeriveThresholdAuthPubKey(e=""){return r.fromCode(s.CouldNotDeriveThresholdAuthPubKey,e)}static couldNotDeriveEncryptionKey(e=""){return r.fromCode(s.CouldNotDeriveEncryptionKey,e)}static endpointNotFound(e=""){return r.fromCode(s.EndpointNotFound,e)}static insufficientAuthTokens(e=""){return r.fromCode(s.InsufficientAuthTokens,e)}static rateLimitExceeded(e,t=""){return r.fromCode(s.RateLimitExceeded,t||e.message,{rateLimitDetails:e})}static invalidAuthToken(e=""){return r.fromCode(s.InvalidAuthToken,e)}static authTokenExpired(e=""){return r.fromCode(s.AuthTokenExpired,e)}static jsonRpcError(e){return r.fromCode(s.JsonRpcError,e)}static couldNotFetchPassword(e=""){return r.fromCode(s.CouldNotFetchPassword,e)}static maxKeyChainLengthExceeded(e=""){return r.fromCode(s.MaxKeyChainLengthExceeded,e)}toJSON(){return{name:this.name,code:this.code,message:this.message,meta:this.meta}}toString(){return JSON.stringify(this.toJSON())}}n.TOPRFError=r,r.messages={[s.Default]:"Something went wrong.",[s.InvalidAuthenticateResults]:"Invalid authenticate results.",[s.InvalidCommitResults]:"Invalid commit results.",[s.PwdInputRateLimitExceeded]:"Rate limit exceeded for password input attempts.",[s.InsufficientValidResponses]:"Insufficient valid responses.",[s.CouldNotDeriveThresholdAuthPubKey]:"Could not derive threshold auth pub key.",[s.CouldNotDeriveEncryptionKey]:"Could not derive encryption key.",[s.EndpointNotFound]:"Endpoint not found.",[s.InsufficientAuthTokens]:"Insufficient number of auth tokens.",[s.RateLimitExceeded]:"Rate limit error from server.",[s.InvalidAuthToken]:"Invalid auth token.",[s.AuthTokenExpired]:"Auth token expired.",[s.JsonRpcError]:"Json rpc error.",[s.CouldNotFetchPassword]:"Could not fetch password.",[s.MaxKeyChainLengthExceeded]:"Exceeded maximum key chain length.",[s.NoHashedIdToken]:"hashedIdToken is required when using single-id(aggregate) verifier."}}}},{package:"@metamask/seedless-onboarding-controller>@metamask/toprf-secure-backup",file:"node_modules/@metamask/toprf-secure-backup/dist/errors.cjs"}],[2720,{"./constants.cjs":2718,"./errors.cjs":2719,"./utils.cjs":2729,"@metamask/auth-network-utils":1214,"@noble/hashes/utils":2855,"@toruslabs/http-helpers":2730},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getPubKey=n.validatePubKey=void 0;const s=e("@metamask/auth-network-utils"),r=e("@noble/hashes/utils"),a=e("@toruslabs/http-helpers"),i=e("./constants.cjs"),o=e("./errors.cjs"),c=e("./utils.cjs");n.validatePubKey=async e=>{const t=(0,s.filterCompletedRequests)(e);if(t.length<i.GET_PUB_KEY_THRESHOLD)throw o.TOPRFError.insufficientValidResponses(`Insufficient get pub key request results, expected ${i.GET_PUB_KEY_THRESHOLD} but got ${t.length}`);const n=(0,s.thresholdSame)(t.map(e=>({pubKey:e.result?.pubKey,keyIndex:e.result?.keyIndex})),i.GET_PUB_KEY_THRESHOLD);if(!n?.pubKey||!n?.keyIndex)throw o.TOPRFError.couldNotDeriveThresholdAuthPubKey();return{authPubKey:(0,r.hexToBytes)(n.pubKey),keyIndex:n.keyIndex}};n.getPubKey=async e=>{const{authTokens:t,nodeEndpointsMap:r,authConnectionId:u,userId:l,groupedAuthConnectionId:d}=e;if(t.length<i.GET_PUB_KEY_THRESHOLD)throw o.TOPRFError.insufficientAuthTokens(`At least ${i.GET_PUB_KEY_THRESHOLD} auth tokens are required.`);const f=(0,c.mergeEndpointsWithAuthTokens)(t,r).map(async({endpoint:e,authToken:t})=>{const n=((e,t,n,s)=>({authToken:e,verifier:s??t,verifierId:n}))(t.authToken,u,l,d);return(async(e,t)=>{const n=(0,a.generateJsonRPCObject)(i.JRPC_METHODS.GET_PUB_KEY_REQUEST,t);return(0,c.postJRPCRequest)(e,n)})(e,n)});return(0,s.Some)(f,async e=>(0,n.validatePubKey)(e))}}}},{package:"@metamask/seedless-onboarding-controller>@metamask/toprf-secure-backup",file:"node_modules/@metamask/toprf-secure-backup/dist/getPubKeyRequest.cjs"}],[2721,{"./errors.cjs":2719,"./toprfSecureBackup.cjs":2728,"./utils.cjs":2729},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){s===undefined&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.TOPRFErrorCode=n.TOPRFError=void 0,r(e("./toprfSecureBackup.cjs"),n);var a=e("./errors.cjs");Object.defineProperty(n,"TOPRFError",{enumerable:!0,get:function(){return a.TOPRFError}}),Object.defineProperty(n,"TOPRFErrorCode",{enumerable:!0,get:function(){return a.TOPRFErrorCode}}),r(e("./utils.cjs"),n)}}},{package:"@metamask/seedless-onboarding-controller>@metamask/toprf-secure-backup",file:"node_modules/@metamask/toprf-secure-backup/dist/index.cjs"}],[2722,{"@noble/curves/abstract/utils":2837,"@noble/curves/secp256k1":2840,"@noble/hashes/hkdf":2845,"@noble/hashes/sha2":2851},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.derivePwEncKey=n.deriveEncryptionKey=n.deriveAuthenticationKeyPair=void 0;const s=e("@noble/curves/abstract/utils"),r=e("@noble/curves/secp256k1"),a=e("@noble/hashes/hkdf"),i=e("@noble/hashes/sha2");n.deriveAuthenticationKeyPair=function(e){const t=(0,a.hkdf)(i.sha256,e,undefined,"authentication-key",32),n=(0,s.bytesToNumberBE)(t)%r.secp256k1.CURVE.n;return{sk:n,pk:r.secp256k1.getPublicKey(n,!1)}},n.deriveEncryptionKey=function(e){return(0,a.hkdf)(i.sha256,e,undefined,"encryption-key",32)},n.derivePwEncKey=function(e){return(0,a.hkdf)(i.sha256,e,undefined,"pwd-encryption-key",32)}}}},{package:"@metamask/seedless-onboarding-controller>@metamask/toprf-secure-backup",file:"node_modules/@metamask/toprf-secure-backup/dist/keyDerivation.cjs"}],[2723,{"./constants.cjs":2718,"@metamask/auth-network-utils":1214,"@noble/ciphers/aes":2827,"@noble/ciphers/webcrypto":2830,"@noble/curves/secp256k1":2840,"@noble/hashes/sha3":2853,"@noble/hashes/utils":2855,buffer:3760},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){var s,r,a,i,o,c,u,l,d,f,h,p,m,g,b,y=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},w=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.MetadataStore=n.MetadataStoreError=n.MetadataLockStatus=void 0;const T=e("@metamask/auth-network-utils"),E=e("@noble/ciphers/aes"),S=e("@noble/ciphers/webcrypto"),v=e("@noble/curves/secp256k1"),k=e("@noble/hashes/sha3"),P=e("@noble/hashes/utils"),I=e("./constants.cjs");var _;!function(e){e[e.FAILED=0]="FAILED",e[e.SUCCESS=1]="SUCCESS"}(_||(n.MetadataLockStatus=_={}));class x extends Error{constructor(e){super(e),this.name="MetadataStoreError",Object.setPrototypeOf(this,x.prototype)}}n.MetadataStoreError=x;n.MetadataStore=class{constructor(e){s.add(this),r.set(this,"srp-backup"),a.set(this,void 0),i.set(this,void 0),y(this,a,e.metadataEndpoint,"f"),y(this,i,e.fetchMetadataAccessCreds,"f")}async addSecretDataItem(e){try{const{secretData:t,encKey:n,authKeyPair:r}=e;await w(this,s,"m",o).call(this,{secretData:t,encKey:n,authKeyPair:r,metadataEndpoint:w(this,a,"f")})}catch(e){throw new x(`failed to add metadata: ${e.message}`)}}async batchAddSecretData(e){try{const{secretData:t,encKey:n,authKeyPair:r}=e;await w(this,s,"m",c).call(this,{secretData:t,encKey:n,authKeyPair:r,metadataEndpoint:w(this,a,"f")})}catch(e){throw new x(`failed to add batch metadata: ${e.message}`)}}async fetchAllSecretDataItems(e,t,n){try{return await w(this,s,"m",u).call(this,{encKey:e,authKeyPair:t,metadataEndpoint:w(this,a,"f"),itemId:n})}catch(e){throw new x(`failed to fetch metadata: ${e.message}`)}}async acquireMetadataLock(e){const{status:t,id:n}=await w(this,s,"m",l).call(this,w(this,a,"f"),e);if(t!==_.SUCCESS)throw new x("Failed to acquire metadata lock");if(!n)throw new x("Failed to acquire metadata lock. Missing lock id");return n}async releaseMetadataLock(e,t){const n=await w(this,s,"m",d).call(this,w(this,a,"f"),e,t);if(n!==_.SUCCESS)throw new x(`Failed to release metadata lock with id ${t}`);return n}},r=new WeakMap,a=new WeakMap,i=new WeakMap,s=new WeakSet,o=async function(e){try{const t=`${e.metadataEndpoint}/enc_account_data/set`,n=w(this,s,"m",g).call(this,e.secretData.data,e.encKey),r=await w(this,s,"m",f).call(this,{itemId:e.secretData.itemId,data:n},e.authKeyPair),a=JSON.stringify(r),i=await fetch(t,{headers:{"Content-Type":"application/json"},method:"POST",body:a});if(!i.ok){const e=await i.json();throw new Error(`HTTP error message: ${e.error}`)}return(await i.json()).success}catch(e){const t=e.message||"Unknown error";throw new x(`failed to upsert metadata: ${t}`)}},c=async function(e){const t=Array.isArray(e.encKey)?e.encKey:e.secretData.map(()=>e.encKey);if(t.length!==e.secretData.length)throw new x("encKey must be of same length as secretData");try{const n=`${e.metadataEndpoint}/enc_account_data/batch_set`,r=e.secretData.map((e,n)=>({data:w(this,s,"m",g).call(this,e.data,t[n]),itemId:e.itemId})),a=await w(this,s,"m",f).call(this,r,e.authKeyPair),i=await fetch(n,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(a)});if(!i.ok){const e=await i.json();throw new Error(`HTTP error message: ${e.error}`)}return(await i.json()).success}catch(e){const t=e.message||"Unknown error";throw new x(`failed to upsert metadata: ${t}`)}},u=async function(e){try{const n=`${e.metadataEndpoint}/enc_account_data/get`,r=await w(this,s,"m",h).call(this,e.authKeyPair,e.itemId),a=await fetch(n,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(r)});if(!a.ok){const e=await a.json();throw new Error(`HTTP error message: ${e.error}`)}const i=await a.json();if(!i.data)throw new x("Failed to fetch metadata");return i.data.filter((t,n)=>e.itemId?i.ids[n]===e.itemId:i.ids[n]!==I.PW_BACKUP_ITEM_ID).map((n,r)=>{const a=new Uint8Array(t.from(n,"base64"));return{itemId:i.ids[r],data:w(this,s,"m",b).call(this,a,e.encKey)}}).filter(e=>e.data.length>0)}catch(e){const t=e.message||"Unknown error";throw new x(`failed to fetch metadata: ${t}`)}},l=async function(e,t){try{const n=w(this,s,"m",p).call(this,t),r=`${e}/acquireLock`,a=await fetch(r,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(n)});if(!a.ok){const e=await a.json();throw new Error(`HTTP error message: ${e.error}`)}const i=await a.json();return{status:i.status,id:i.id}}catch(e){const t=e.message||"Unknown error";throw new x(`failed to acquire metadata lock: ${t}`)}},d=async function(e,t,n){try{const r=w(this,s,"m",p).call(this,t,n),a=`${e}/releaseLock`,i=await fetch(a,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(r)});if(!i.ok){const e=await i.json();throw new Error(`HTTP error message: ${e.error}`)}return(await i.json()).status}catch(e){const t=e.message||"Unknown error";throw new x(`failed to release metadata lock: ${t}`)}},f=async function(e,n){const a=Date.now().toString(),o=w(this,r,"f"),{metadataAccessToken:c}=await w(this,i,"f").call(this),u={timestamp:a,feature:o,authToken:c};Array.isArray(e)?u.data=e.map(e=>{const n=e.data;return{data:t.from(n).toString("base64"),itemId:e.itemId}}):(u.data=t.from(e.data).toString("base64"),u.itemId=e.itemId);const{pk:l,sk:d}=n,f=w(this,s,"m",m).call(this,u,d),h=(0,P.bytesToHex)(l);return{...u,signature:f,pubKey:h}},h=async function(e,t){const n=Date.now().toString(),a=w(this,r,"f"),{pk:o,sk:c}=e,{metadataAccessToken:u}=await w(this,i,"f").call(this),l={feature:a,timestamp:n,itemId:t,authToken:u},d=w(this,s,"m",m).call(this,l,c),f=(0,P.bytesToHex)(o);return{...l,pubKey:f,signature:d}},p=function(e,t){const{pk:n,sk:r}=e,a={timestamp:Date.now()};return{data:a,signature:w(this,s,"m",m).call(this,a,r,!0),key:(0,P.bytesToHex)(n),id:t}},m=function(e,t,n=!1){const s=(0,T.safeStringify)(e),r=(0,k.keccak_256)(s),a=v.secp256k1.sign(r,t);return n?a.toDERHex():a.toCompactHex()},g=function(e,t){return(0,S.managedNonce)(E.gcm)(t).encrypt(e)},b=function(e,t){return(0,S.managedNonce)(E.gcm)(t).decrypt(e)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/seedless-onboarding-controller>@metamask/toprf-secure-backup",file:"node_modules/@metamask/toprf-secure-backup/dist/metadata.cjs"}],[2724,{"@noble/curves/abstract/modular":2835,"@noble/curves/abstract/utils":2837,"@noble/curves/secp256k1":2840},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.OPRF=n.generateRandomScalar=void 0;const s=e("@noble/curves/abstract/modular"),r=e("@noble/curves/abstract/utils"),a=e("@noble/curves/secp256k1");function i(){return(0,r.bytesToNumberBE)(a.secp256k1.utils.randomPrivateKey())}n.generateRandomScalar=i;const o=(0,s.Field)(a.secp256k1.CURVE.n);n.OPRF=class{static blind(e){const t=i(),n=(0,a.hashToCurve)(e).multiply(t);return{a:a.secp256k1.ProjectivePoint.fromAffine(n.toAffine()),r:t}}static blindEval(e,t){return t.multiply(e)}static async unblindAndHash(e,t,n,s){const r=o.inv(n),i=t.multiply(r);let c=a.secp256k1.CURVE.hash(new Uint8Array([...e,...i.toRawBytes()]));if(s){const e=c.length;c=await s.deriveKey(c.slice(0,e/2),c.slice(e/2))}return c}static async localEval(e,t,n){const{a:s,r:r}=this.blind(t),a=s.multiply(e);return this.unblindAndHash(t,a,r,n)}}}}},{package:"@metamask/seedless-onboarding-controller>@metamask/toprf-secure-backup",file:"node_modules/@metamask/toprf-secure-backup/dist/oprf.cjs"}],[2725,{"./constants.cjs":2718,"./errors.cjs":2719,"./utils.cjs":2729,"@metamask/auth-network-utils":1214,"@noble/hashes/sha3":2853,"@toruslabs/http-helpers":2730},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.resetRateLimits=n.validateThresholdResetRateLimitResponses=n.sendResetRateLimitRequest=void 0;const s=e("@metamask/auth-network-utils"),r=e("@noble/hashes/sha3"),a=e("@toruslabs/http-helpers"),i=e("./constants.cjs"),o=e("./errors.cjs"),c=e("./utils.cjs");n.sendResetRateLimitRequest=async(e,t)=>{const n=(0,a.generateJsonRPCObject)(i.JRPC_METHODS.RESET_RATE_LIMIT_REQUEST,t);return(0,c.postJRPCRequest)(e,n)};n.validateThresholdResetRateLimitResponses=(e,t)=>{const n=(0,s.filterCompletedRequests)(e);if(n.length<t)throw o.TOPRFError.insufficientValidResponses(`invalid reset rate limit results, expected ${t} but got ${n.length}`);return!0};n.resetRateLimits=async e=>{const{authTokens:t,nodeEndpointsMap:a,authConnectionId:i,groupedAuthConnectionId:o,userId:u,authPrivKey:l}=e,d=(0,c.mergeEndpointsWithAuthTokens)(t,a).map(async({endpoint:e,authToken:t})=>{const a=(0,s.toSnakeCaseKeys)({timestamp:Date.now(),nodeIndex:t.nodeIndex,action:"reset_ratelimit"}),d=(0,s.safeStringify)(a,{cmp:c.preserveKeyOrder}),f=(0,r.keccak_256)(d),h=(0,c.createEthereumSignature)(f,l),p=((e,t,n,s,r,a)=>({authToken:e,signature:t,signedData:n,verifier:a??s,verifierId:r}))(t.authToken,h,d,i,u,o);return(0,n.sendResetRateLimitRequest)(e,p)});return(0,s.Some)(d,async e=>(0,n.validateThresholdResetRateLimitResponses)(e,t.length))}}}},{package:"@metamask/seedless-onboarding-controller>@metamask/toprf-secure-backup",file:"node_modules/@metamask/toprf-secure-backup/dist/resetRateLimits.cjs"}],[2726,{"./constants.cjs":2718,"./utils.cjs":2729,"@metamask/auth-network-utils":1214,"@toruslabs/http-helpers":2730},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.changeKeyShares=n.createKeyChangeRequestParams=n.storeKeyShares=n.sendStoreKeySharesRequest=n.createStoreKeySharesRequestParams=void 0;const s=e("@metamask/auth-network-utils"),r=e("@toruslabs/http-helpers"),a=e("./constants.cjs"),i=e("./utils.cjs");n.createStoreKeySharesRequestParams=async e=>{const{nodeEndpointsMap:t,authTokens:n,authConnectionId:r,groupedAuthConnectionId:a,userId:o,keyShareIndex:c,oprfKey:u,authPubKey:l}=e,d=await(0,i.generateShareImportItems)(t,n,u,c);return{verifier:a??r,verifierId:o,pubKey:(0,s.uint8ArrayToHex)(l),shareImportItems:d}};n.sendStoreKeySharesRequest=async(e,t)=>{const n=(0,r.generateJsonRPCObject)(a.JRPC_METHODS.STORE_KEY_SHARES_REQUEST,(0,s.toSnakeCaseKeys)(t));return(0,i.postJRPCRequest)(e,n)};n.storeKeyShares=async e=>{const{authTokens:t,nodeEndpointsMap:r,authConnectionId:a,groupedAuthConnectionId:o,userId:c,keyShareIndex:u,oprfKey:l,authPubKey:d}=e,f=await(0,n.createStoreKeySharesRequestParams)({nodeEndpointsMap:r,authTokens:t,authConnectionId:a,groupedAuthConnectionId:o,userId:c,keyShareIndex:u,oprfKey:l,authPubKey:d}),h=r[(0,s.getProxyCoordinatorNodeIndex)(t.map(e=>e.nodeIndex),o??a,c)],p=await(0,n.sendStoreKeySharesRequest)(h,f);if((0,s.isJSONRPCError)(p.error)){throw(0,i.parseJsonRpcError)(p.error)}return p};n.createKeyChangeRequestParams=async e=>{const{nodeEndpointsMap:t,authTokens:n,keyShareIndex:r,newOprfKey:a,newAuthPubKey:o,oldAuthPrivKey:c,authConnectionId:u,groupedAuthConnectionId:l,userId:d}=e,f=await(0,i.generateShareImportItems)(t,n,a,r,c);return{pubKey:(0,s.uint8ArrayToHex)(o),shareImportItems:f,verifier:l??u,verifierId:d}};n.changeKeyShares=async e=>{const{nodeEndpointsMap:t,authTokens:r,keyShareIndex:a,newOprfKey:o,newAuthPubKey:c,oldAuthPrivKey:u,authConnectionId:l,groupedAuthConnectionId:d,userId:f}=e,h=await(0,n.createKeyChangeRequestParams)({nodeEndpointsMap:t,authTokens:r,keyShareIndex:a,newOprfKey:o,newAuthPubKey:c,oldAuthPrivKey:u,authConnectionId:l,groupedAuthConnectionId:d,userId:f}),p=t[(0,s.getProxyCoordinatorNodeIndex)(r.map(e=>e.nodeIndex),l,f)],m=await(0,n.sendStoreKeySharesRequest)(p,h);if((0,s.isJSONRPCError)(m.error)){throw(0,i.parseJsonRpcError)(m.error)}return m}}}},{package:"@metamask/seedless-onboarding-controller>@metamask/toprf-secure-backup",file:"node_modules/@metamask/toprf-secure-backup/dist/storeSharesRequest.cjs"}],[2727,{"./constants.cjs":2718,"./errors.cjs":2719,"./keyDerivation.cjs":2722,"./oprf.cjs":2724,"./utils.cjs":2729,"@metamask/auth-network-utils":1214,"@noble/curves/secp256k1":2840,"@toruslabs/http-helpers":2730},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.recoverTOPRFSeed=n.validateSeed=void 0;const s=e("@metamask/auth-network-utils"),r=e("@noble/curves/secp256k1"),a=e("@toruslabs/http-helpers"),i=e("./constants.cjs"),o=e("./errors.cjs"),c=e("./keyDerivation.cjs"),u=e("./oprf.cjs"),l=e("./utils.cjs");n.validateSeed=async(e,t,n,a)=>{let d=(0,l.checkRateLimitErrors)(n);if(d)throw o.TOPRFError.rateLimitExceeded(d);const f=(0,s.filterCompletedRequests)(n);if(f.length<i.TOPRF_EVAL_THRESHOLD)throw o.TOPRFError.insufficientValidResponses(`Insufficient toprf eval request results, expected ${i.TOPRF_EVAL_THRESHOLD} but got ${f.length}`);const h=(0,s.thresholdSame)(f.map(e=>e.result?.pubKey),i.TOPRF_EVAL_THRESHOLD);if(!h)throw o.TOPRFError.couldNotDeriveThresholdAuthPubKey();const p=f.reduce((e,t)=>{const n=t.result;if(!("object"==typeof(s=n)&&null!==s&&"blindedOutputX"in s&&"string"==typeof s.blindedOutputX&&"blindedOutputY"in s&&"string"==typeof s.blindedOutputY&&"nodeIndex"in s&&"number"==typeof s.nodeIndex&&"keyShareIndex"in s&&"number"==typeof s.keyShareIndex&&"pubKey"in s&&"string"==typeof s.pubKey))return e;var s;const{blindedOutputX:a,blindedOutputY:i,nodeIndex:o,keyShareIndex:c}=n;return e.push({blindedOutput:r.secp256k1.ProjectivePoint.fromAffine({x:BigInt(`0x${a}`),y:BigInt(`0x${i}`)}),nodeIndex:o,keyShareIndex:c}),e},[]);if(p.length<i.TOPRF_EVAL_THRESHOLD)throw o.TOPRFError.insufficientValidResponses(`Insufficient valid blinded outputs, expected: ${i.TOPRF_EVAL_THRESHOLD}, received: ${p.length}`);const m=await(async(e,t,n,a,o)=>{const l=(0,s.kCombinations)(e.length,i.TOPRF_EVAL_THRESHOLD);for(const i of l){const l=e.filter((e,t)=>i.includes(t)),d=l.map(e=>e.blindedOutput),f=l.map(e=>BigInt(e.nodeIndex)),h=(0,s.lagrangeInterpolationForPoints)(r.secp256k1.CURVE.n,d,f),p=await u.OPRF.unblindAndHash(t,h,n,o),{pk:m}=(0,c.deriveAuthenticationKeyPair)(p),g=r.secp256k1.ProjectivePoint.fromHex(m),b=r.secp256k1.ProjectivePoint.fromHex(a);if(g.equals(b))return{seed:p,keyShareIndex:l[0].keyShareIndex}}return null})(p,e,t,h,a);if(!m){if(d=(0,l.extractRateLimitErrorFromResults)(n),d)throw o.TOPRFError.rateLimitExceeded(d);throw o.TOPRFError.couldNotDeriveEncryptionKey()}return m};n.recoverTOPRFSeed=async e=>{const{authTokens:t,nodeEndpointsMap:r,authConnectionId:c,groupedAuthConnectionId:d,userId:f,userInput:h,keyDeriver:p}=e;if(t.length<i.TOPRF_EVAL_THRESHOLD)throw o.TOPRFError.insufficientAuthTokens(`At least ${i.TOPRF_EVAL_THRESHOLD} auth tokens are required.`);const{a:m,r:g}=u.OPRF.blind(h),b=(0,l.mergeEndpointsWithAuthTokens)(t,r).map(async({endpoint:e,authToken:t})=>{const n=((e,t,n,s,r,a)=>({authToken:e,shareCoefficient:"1",blindedInputX:t,blindedInputY:n,verifier:a??s,verifierId:r}))(t.authToken,m.x.toString(16),m.y.toString(16),c,f,d);return(async(e,t)=>{const n=(0,a.generateJsonRPCObject)(i.JRPC_METHODS.TOPRF_EVAL_REQUEST,t);return(0,l.postJRPCRequest)(e,n)})(e,n)});try{return await(0,s.Some)(b,async e=>(0,n.validateSeed)(h,g,e,p))}catch(e){throw(0,l.getTOPRFError)(e)}}}}},{package:"@metamask/seedless-onboarding-controller>@metamask/toprf-secure-backup",file:"node_modules/@metamask/toprf-secure-backup/dist/toprfEvalRequest.cjs"}],[2728,{"./authenticateRequest.cjs":2716,"./commitRequest.cjs":2717,"./constants.cjs":2718,"./errors.cjs":2719,"./getPubKeyRequest.cjs":2720,"./keyDerivation.cjs":2722,"./metadata.cjs":2723,"./oprf.cjs":2724,"./resetRateLimits.cjs":2725,"./storeSharesRequest.cjs":2726,"./toprfEvalRequest.cjs":2727,"./utils.cjs":2729,"@metamask/auth-network-utils":1214,"@noble/ciphers/utils":2829,"@noble/curves/abstract/utils":2837,"@noble/curves/secp256k1":2840,"@noble/hashes/utils":2855,"@toruslabs/fetch-node-details":2897,buffer:3760},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){var s,r,a,i,o,c,u,l,d,f,h,p,m=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},g=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.ToprfSecureBackup=void 0;const b=e("@metamask/auth-network-utils"),y=e("@noble/ciphers/utils"),w=e("@noble/curves/abstract/utils"),T=e("@noble/curves/secp256k1"),E=e("@noble/hashes/utils"),S=e("@toruslabs/fetch-node-details"),v=e("./authenticateRequest.cjs"),k=e("./commitRequest.cjs"),P=e("./constants.cjs"),I=e("./errors.cjs"),_=e("./getPubKeyRequest.cjs"),x=e("./keyDerivation.cjs"),j=e("./metadata.cjs"),A=e("./oprf.cjs"),C=e("./resetRateLimits.cjs"),R=e("./storeSharesRequest.cjs"),O=e("./toprfEvalRequest.cjs"),M=e("./utils.cjs");class B{constructor(e){s.add(this),a.set(this,void 0),i.set(this,void 0),o.set(this,void 0),c.set(this,void 0),u.set(this,void 0),m(this,a,new S.NodeDetailManager({network:e.network}),"f"),m(this,i,e.nodeDetailsOverride,"f"),m(this,o,e.keyDeriver,"f"),m(this,c,e.fetchMetadataAccessCreds,"f"),g(this,s,"m",l).call(this).catch(()=>{})}async authenticate(e){const{nodeEndpoints:n,nodeEndpointsMap:r}=await g(this,s,"m",l).call(this);let a=T.secp256k1.utils.randomPrivateKey();try{const s=T.secp256k1.ProjectivePoint.fromPrivateKey(a),i=s.x.toString(16),o=s.y.toString(16);let c;e.groupedAuthConnectionId&&(c=(0,b.remove0x)((0,b.keccak256AndHexify)(t.from(e.idTokens[0],"utf8"))));const u=await(0,k.commitIdToken)({idToken:c??e.idTokens[0],authConnectionId:e.groupedAuthConnectionId??e.authConnectionId,sessionPubKeyX:i,sessionPubKeyY:o,endpoints:n}),l=u.reduce((e,t)=>(e[t.nodeIndex]=r[t.nodeIndex],e),{}),{authTokensData:d,isNewUser:f}=await(0,v.authenticateUser)({idToken:e.idTokens[0],authConnectionId:e.authConnectionId,userId:e.userId,sessionPrivateKey:a,nodeEndpointsMap:l,commitmentSignatures:u,groupedAuthConnectionId:e.groupedAuthConnectionId,hashedIdToken:c});return{nodeAuthTokens:d.map(e=>({authToken:e.authToken,nodeIndex:e.nodeIndex,nodePubKey:e.nodePubKey})),isNewUser:f}}finally{a.fill(0),a=null}}async createLocalKey(e){const{password:t,oprfKey:n=(0,A.generateRandomScalar)()}=e;let s=null;try{s=(0,w.utf8ToBytes)(t);const e=await A.OPRF.localEval(n,s,g(this,o,"f")),r=(0,x.deriveAuthenticationKeyPair)(e),a=(0,x.deriveEncryptionKey)(e);return{oprfKey:n,seed:e,authKeyPair:r,encKey:a,pwEncKey:(0,x.derivePwEncKey)(e)}}finally{s&&(s.fill(0),s=null)}}async persistLocalKey(e){const{nodeAuthTokens:t,oprfKey:n,authPubKey:r,authConnectionId:a,groupedAuthConnectionId:i,userId:o,keyShareIndex:c=P.FIRST_KEY_INDEX,oldAuthKeyPair:u}=e,{nodeEndpointsMap:d}=await g(this,s,"m",l).call(this),f=t.reduce((e,t)=>(e[t.nodeIndex]=d[t.nodeIndex],e),{});u?await(0,R.changeKeyShares)({nodeEndpointsMap:f,authConnectionId:a,groupedAuthConnectionId:i,userId:o,authTokens:t,keyShareIndex:c,newOprfKey:n,newAuthPubKey:r,oldAuthPrivKey:u.sk}):await(0,R.storeKeyShares)({nodeEndpointsMap:f,authConnectionId:a,groupedAuthConnectionId:i,userId:o,authTokens:t,keyShareIndex:c,oprfKey:n,authPubKey:r})}async createAndPersistEncKey(e){const{nodeAuthTokens:t,password:n,authConnectionId:s,userId:r}=e,{oprfKey:a,authKeyPair:i,encKey:o,pwEncKey:c}=await this.createLocalKey({password:n});return await this.persistLocalKey({nodeAuthTokens:t,oprfKey:a,authPubKey:i.pk,authConnectionId:s,userId:r}),{authKeyPair:{sk:i.sk,pk:i.pk},encKey:o,pwEncKey:c}}async recoverEncKey(e){const{nodeAuthTokens:t,password:n,authConnectionId:r,groupedAuthConnectionId:a,userId:i}=e;let c=null,u=null;try{const{nodeEndpointsMap:e}=await g(this,s,"m",l).call(this);c=(0,w.utf8ToBytes)(n);const{seed:d,keyShareIndex:f}=await(0,O.recoverTOPRFSeed)({authTokens:t,nodeEndpointsMap:e,authConnectionId:r,groupedAuthConnectionId:a,userId:i,userInput:c,keyDeriver:g(this,o,"f")});u=d;const h=(0,x.deriveAuthenticationKeyPair)(u),p=(0,x.deriveEncryptionKey)(u),m=(0,x.derivePwEncKey)(u),b=new Promise((n,s)=>{(0,C.resetRateLimits)({authTokens:t,nodeEndpointsMap:e,authConnectionId:r,groupedAuthConnectionId:a,userId:i,authPrivKey:h.sk}).then(()=>n()).catch(e=>{s(e)})});return{authKeyPair:h,encKey:p,pwEncKey:m,keyShareIndex:f,rateLimitResetResult:b}}finally{c&&(c.fill(0),c=null),u&&(u.fill(0),u=null)}}async changeEncKey(e){const{nodeAuthTokens:t,authConnectionId:n,groupedAuthConnectionId:r,userId:a,oldEncKey:i,oldPwEncKey:o,oldAuthKeyPair:c,newPassword:u,newKeyShareIndex:l,pregeneratedOprfKey:f}=e;if(!f&&!u)throw new Error("Either newPassword or pregeneratedOprfKey is required");if(f&&u)throw new Error("Only one of newPassword or pregeneratedOprfKey is allowed");const{oprfKey:h,authKeyPair:p,encKey:m,pwEncKey:b}=u?await this.createLocalKey({password:u}):f;let y,w,T;try{y=await g(this,s,"m",d).call(this),[w,T]=await Promise.all([y.acquireMetadataLock(c),y.acquireMetadataLock(p)]);const e=(await y.fetchAllSecretDataItems(i,c)).map(e=>({data:e.data}));if(!e||0===e.length)throw new Error("No existing data found to change key");const u=[{data:N("",o,c),itemId:P.PW_BACKUP_ITEM_ID},...e],f=[b,...e.map(()=>m)];return await y.batchAddSecretData({secretData:u,encKey:f,authKeyPair:p}),await this.persistLocalKey({nodeAuthTokens:t,oprfKey:h,authPubKey:p.pk,authConnectionId:n,groupedAuthConnectionId:r,userId:a,keyShareIndex:l,oldAuthKeyPair:c}),{authKeyPair:p,encKey:m,pwEncKey:b}}finally{if(y&&w&&T)try{await Promise.all([y.releaseMetadataLock(c,w),y.releaseMetadataLock(p,T)])}catch(e){console.error("Failed to release metadata lock:",e)}}}async addSecretDataItem(e){const t=await g(this,s,"m",d).call(this);await t.addSecretDataItem({...e,secretData:{data:e.secretData}})}async batchAddSecretDataItems(e){const t=await g(this,s,"m",d).call(this);let n;try{n=await t.acquireMetadataLock(e.authKeyPair),await t.batchAddSecretData({...e,secretData:e.secretData.map(e=>({data:e}))})}finally{if(n)try{await t.releaseMetadataLock(e.authKeyPair,n)}catch(e){console.error("Failed to release metadata lock:",e)}}}async fetchAllSecretDataItems(e){const t=await g(this,s,"m",d).call(this);return(await t.fetchAllSecretDataItems(e.decKey,e.authKeyPair)).map(e=>e.data)}async fetchAuthPubKey(e){const{nodeAuthTokens:t,authConnectionId:n,userId:r,groupedAuthConnectionId:a}=e,{nodeEndpointsMap:i}=await g(this,s,"m",l).call(this);return(0,_.getPubKey)({authTokens:t,nodeEndpointsMap:i,authConnectionId:n,userId:r,groupedAuthConnectionId:a})}async recoverPwEncKey(e){const{targetAuthPubKey:t,curPwEncKey:n,curAuthKeyPair:r,maxPwChainLength:a=P.MAX_PASSWORD_CHAIN_LENGTH}=e;let i={password:"",encKey:n,authKeyPair:r};for(let e=0;e<a;e++)try{if(i=await g(this,s,"m",h).call(this,{encKey:i.encKey,authKeyPair:i.authKeyPair}),(0,y.equalBytes)(i.authKeyPair.pk,t))return{pwEncKey:i.encKey}}catch(e){throw I.TOPRFError.couldNotFetchPassword(e.message)}throw I.TOPRFError.maxKeyChainLengthExceeded()}}function N(e,t,n){return(0,w.utf8ToBytes)(JSON.stringify({pw:e,encKey:(0,E.bytesToHex)(t),authKeyPair:{sk:n.sk.toString(),pk:(0,E.bytesToHex)(n.pk)}}))}n.ToprfSecureBackup=B,r=B,a=new WeakMap,i=new WeakMap,o=new WeakMap,c=new WeakMap,u=new WeakMap,s=new WeakSet,l=async function(){let e=g(this,i,"f")?.indexes,t=g(this,i,"f")?.pubKeys,n=g(this,i,"f")?.endpoints;if(e&&t&&Array.isArray(n))return g(r,r,"m",p).call(r,e,t,n),{nodeEndpoints:n,nodeEndpointsMap:(0,M.createNodeEndpointsMap)(n,e),nodeIndexes:e,nodePubkeys:t};const{torusNodeSSSEndpoints:s,torusIndexes:o,torusNodePub:c}=await g(this,a,"f").getNodeDetails({verifier:"auth-connection-id",verifierId:"user-id"});if(e??(e=o),t??(t=c),!Array.isArray(n)){if(!s){throw new Error("Failed to get node details")}n=n?s.map(e=>{const t=new URL(e);return t.pathname=n,t.href}):s}return g(r,r,"m",p).call(r,e,t,n),{nodeEndpoints:n,nodeEndpointsMap:(0,M.createNodeEndpointsMap)(n,e),nodeIndexes:e,nodePubkeys:t}},d=async function(){if(g(this,u,"f"))return g(this,u,"f");const{nodeEndpointsMap:e}=await g(this,s,"m",l).call(this),t=(await g(this,s,"m",f).call(this,e))[1],n=new j.MetadataStore({metadataEndpoint:t,fetchMetadataAccessCreds:g(this,c,"f")});return m(this,u,n,"f"),n},f=async function(e){const t={};return Object.entries(e).forEach(([e,n])=>{const s=new URL(n);t[e]=`${s.origin}/metadata`}),t},h=async function(e){const t=await g(this,s,"m",d).call(this),n=await t.fetchAllSecretDataItems(e.encKey,e.authKeyPair,P.PW_BACKUP_ITEM_ID);if(0===n.length)throw new Error("Failed to get previous password and keys");const r=function(e){const t=JSON.parse((0,y.bytesToUtf8)(e));return{pw:t.pw,encKey:(0,E.hexToBytes)(t.encKey),authKeyPair:{sk:BigInt(t.authKeyPair.sk),pk:(0,E.hexToBytes)(t.authKeyPair.pk)}}}(n[0].data);return{password:r.pw,encKey:r.encKey,authKeyPair:r.authKeyPair}},p=function(e,t,n){if(e.length!==t.length||e.length!==n.length){throw new Error("Node details arrays (indexes, pubKeys, endpoints) must have equal lengths")}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/seedless-onboarding-controller>@metamask/toprf-secure-backup",file:"node_modules/@metamask/toprf-secure-backup/dist/toprfSecureBackup.cjs"}],[2729,{"./constants.cjs":2718,"./errors.cjs":2719,"@metamask/auth-network-utils":1214,"@noble/curves/secp256k1":2840,"@noble/hashes/sha3":2853,"@toruslabs/eccrypto":2896,"@toruslabs/http-helpers":2730,"bn.js":3699,buffer:3760},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.preserveKeyOrder=n.getTOPRFError=n.parseJsonRpcError=n.mergeEndpointsWithAuthTokens=n.checkRateLimitErrors=n.extractRateLimitErrorFromResults=n.getMaxRateLimitError=n.createNodeEndpointsMap=n.generateShareImportItems=n.createKeyChangeShareImportItems=n.createNewUserShareImportItems=n.createKeyChangeProof=n.createEthereumSignature=n.prepareNodeShares=n.decryptAuthToken=n.postJRPCRequest=n.bigIntToBN=void 0;const r=e("@metamask/auth-network-utils"),a=e("@noble/curves/secp256k1"),i=e("@noble/hashes/sha3"),o=e("@toruslabs/eccrypto"),c=e("@toruslabs/http-helpers"),u=s(e("bn.js")),l=e("./constants.cjs"),d=e("./errors.cjs");n.bigIntToBN=e=>new u.default(e.toString());n.postJRPCRequest=async(e,t)=>{const n={...t};return n.params=(0,r.toSnakeCaseKeys)(t.params),(0,c.post)(e,n,{},{logTracingHeader:!1}).then(e=>(e.result&&(e.result=(0,r.toCamelCaseKeys)(e.result)),e)).catch(e=>({id:t.id,jsonrpc:"2.0",error:{code:-32e3,message:"Internal error",data:e}}))};n.decryptAuthToken=async(e,n)=>{const s=JSON.parse(e),a=(0,r.encParamsHexToBuf)(s.metadata),i=await(0,o.decrypt)(t.from(n),{...a,ciphertext:t.from(s.data,"hex")});return t.from(i).toString("base64")};const f=async(e,n)=>{const s=await(0,o.encrypt)(n,e,{padding:!0}),a=(0,r.encryptedParamsBufToHex)(s);return{data:t.from(s.ciphertext).toString("hex"),metadata:{...a}}};n.prepareNodeShares=(e,t)=>{const s=(0,n.bigIntToBN)(t),a=(0,r.getSecp256K1Curve)(),i=Object.keys(e).map(e=>parseInt(e,10)),o=((e,t,n,s)=>{const a=t.map(e=>new u.default(e)),i=s-1;return(0,r.generateRandomPolynomial)(e,i,n).generateShares(a)})(a,i,s,l.GENERATE_SHARE_THRESHOLD);return{shares:o,nodeIndexes:i}};n.createEthereumSignature=(e,t)=>{const n=t.toString(16).padStart(64,"0"),s=a.secp256k1.sign(e,n);return s.toCompactHex()+(s.recovery+27).toString(16).padStart(2,"0")};n.createKeyChangeProof=(e,s,a,o)=>{const c=Math.floor(Date.now()/1e3),u=(e=>e.toArrayLike(t,"be",32).toString("base64"))(e),l=(0,r.toSnakeCaseKeys)({shareData:u,keyShareIndex:s,nodeIndex:a,timestamp:c}),d=JSON.stringify(l),f=(0,i.keccak_256)(d);return{oldKeySignature:(0,n.createEthereumSignature)(f,o),signatureTimestamp:c}};n.createNewUserShareImportItems=async(e,n,s,r)=>Promise.all(s.map(async s=>{const{nodePubKey:a,nodeIndex:i,authToken:o}=s,c=new u.default(i).toString("hex",64),l=e[c].toJSON(),d=await f(t.from(l.share,"hex"),t.from(a,"hex")),h=await f(t.from(o,"base64"),t.from(a,"hex"));return{encryptedShare:JSON.stringify(d),encryptedAuthToken:JSON.stringify(h),keyShareIndex:r,nodeIndex:i,sssEndpoint:n[i]}}));n.createKeyChangeShareImportItems=async(e,s,r,a,i)=>Promise.all(r.map(async r=>{const{nodePubKey:o,nodeIndex:c,authToken:l}=r,d=new u.default(c).toString("hex",64),h=e[d].toJSON(),p=new u.default(h.share,16),m=(0,n.createKeyChangeProof)(p,a,c,i),g=await f(t.from(h.share,"hex"),t.from(o,"hex")),b=await f(t.from(l,"base64"),t.from(o,"hex"));return{encryptedShare:JSON.stringify(g),encryptedAuthToken:JSON.stringify(b),keyShareIndex:a,nodeIndex:c,sssEndpoint:s[c],...m}}));n.generateShareImportItems=async(e,t,s,r,...a)=>{const{shares:i}=(0,n.prepareNodeShares)(e,s),o=a[0];return o!==undefined?(0,n.createKeyChangeShareImportItems)(i,e,t,r,o):(0,n.createNewUserShareImportItems)(i,e,t,r)};function h(e,t){return e.remainingTime>t.remainingTime?e:t}function p(e){if(!(0,r.isJSONRPCError)(e)||-32602!==e.code||"Rate limit exceeded"!==e.message||!e.data)return undefined;const t=(0,r.toCamelCaseKeys)(e.data);return"string"!=typeof t?.message||"number"!=typeof t?.remainingTime||"number"!=typeof t?.lockTime||"number"!=typeof t?.guessCount?undefined:{message:t.message,remainingTime:t.remainingTime,lockTime:t.lockTime,guessCount:t.guessCount}}n.createNodeEndpointsMap=(e,t)=>t.reduce((t,n)=>(t[n]=e[n-1],t),{}),n.getMaxRateLimitError=h,n.extractRateLimitErrorFromResults=function(e){let t;for(const n of e)if(n.result?.lockTimeSeconds&&n.result.lockTimeSeconds>0&&n.result.guessCount){const e={remainingTime:n.result.lockTimeSeconds,message:"Rate limit exceeded",lockTime:n.result.lockTimeSeconds,guessCount:n.result.guessCount};t=t?h(t,e):e}return t},n.checkRateLimitErrors=function(e){const t=(0,r.filterErrorResponses)(e);let n;for(const e of t){const t=p(e.error);t&&(n=n?h(n,t):t)}return n},n.mergeEndpointsWithAuthTokens=function(e,t){return e.map(e=>{const n=t[e.nodeIndex];if(!n)throw d.TOPRFError.endpointNotFound(`Endpoint not found for node index ${e.nodeIndex}`);return{endpoint:n,authToken:e}})},n.parseJsonRpcError=function(e){if(e.code===l.JsonRpcErrorCodes.ErrorCodeInvalidParams){if(e.message.toLowerCase().includes("auth token expired"))return d.TOPRFError.authTokenExpired();if(e.message.toLowerCase().includes("invalid auth token"))return d.TOPRFError.invalidAuthToken();let t=e.message;if("string"==typeof e.data)t=e.data;else if(e.data){const n=(0,r.toCamelCaseKeys)(e.data);t=JSON.stringify(n)}return d.TOPRFError.jsonRpcError(t)}if(e.code===l.JsonRpcErrorCodes.ErrorCodeInternal){const t=e.data??e.message;return d.TOPRFError.jsonRpcError(t)}return d.TOPRFError.default(e.message)},n.getTOPRFError=function(e){return e instanceof r.SomeError&&e.predicate&&e.predicate instanceof d.TOPRFError?e.predicate:e},n.preserveKeyOrder=function(e,t){return 0}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/seedless-onboarding-controller>@metamask/toprf-secure-backup",file:"node_modules/@metamask/toprf-secure-backup/dist/utils.cjs"}],[2730,{"@babel/runtime/helpers/objectSpread2":539,deepmerge:3914,loglevel:4542},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=e("@babel/runtime/helpers/objectSpread2"),r=e("deepmerge"),a=e("loglevel");const i=a.getLogger("http-helpers");i.setLevel(a.levels.INFO);let o="torus-default",c="";const u="x-api-key",l="x-embed-host";let d=null;const f=[],h=[];async function p(e,t){let n=null;try{n=new URL(e)}catch{}if(d&&n&&(f.includes(n.origin)||h.includes(n.pathname))){return await d.startSpan({name:e,op:"http.client"},async()=>await fetch(e,t))}return fetch(e,t)}function m(){const e={};return o&&(e[u]=o),c&&(e[l]=c),e}function g(e){i.info(`Response: ${e.status} ${e.statusText}`),i.info(`Url: ${e.url}`)}const b=async(e,t)=>{let n=null;try{const s=new Promise((t,s)=>{n=setTimeout(()=>{s(new Error(`Timed out in ${e}ms`))},e)}),r=await Promise.race([t,s]);return null!=n&&clearTimeout(n),r}catch(e){throw null!=n&&clearTimeout(n),e}},y=async(e,t={},n={})=>{const a={mode:"cors",headers:{}};n.useAPIKey&&(a.headers=s(s({},a.headers),m())),t.method="GET";const i=r(a,t),o=await p(e,i);if(o.ok){const e=o.headers.get("content-type");return null!=e&&e.includes("application/json")?o.json():o.text()}throw g(o),o};n.clearAPIKey=function(){o="torus-default"},n.clearEmbedHost=function(){c=""},n.enableSentryTracing=function(e,t,n){d=e,f.push(...t),h.push(...n)},n.gatewayAuthHeader=u,n.gatewayEmbedHostHeader=l,n.generateJsonRPCObject=(e,t)=>({jsonrpc:"2.0",method:e,id:10,params:t}),n.get=y,n.getAPIKey=function(){return o},n.getEmbedHost=function(){return c},n.patch=async(e,t={},n={},a={})=>{const i={mode:"cors",headers:{"Content-Type":"application/json; charset=utf-8"}};a.useAPIKey&&(i.headers=s(s({},i.headers),m())),n.method="PATCH";const o=r(i,n);a.isUrlEncodedData?(o.body=t,"application/json; charset=utf-8"===o.headers["Content-Type"]&&delete o.headers["Content-Type"]):o.body=JSON.stringify(t);const c=await p(e,o);if(c.ok){const e=c.headers.get("content-type");return null!=e&&e.includes("application/json")?c.json():c.text()}throw g(c),c},n.post=(e,t={},n={},a={})=>{const o={mode:"cors",headers:{"Content-Type":"application/json; charset=utf-8"}};a.useAPIKey&&(o.headers=s(s({},o.headers),m())),n.method="POST";const c=r(o,n);return a.isUrlEncodedData?(c.body=t,"application/json; charset=utf-8"===c.headers["Content-Type"]&&delete c.headers["Content-Type"]):c.body=JSON.stringify(t),b(a.timeout||6e4,p(e,c).then(e=>{if(a.logTracingHeader&&function(e){const t=e.headers.get("x-web3-correlation-id");t&&i.info(`Request tracing with traceID = ${t}`)}(e),e.ok){const t=e.headers.get("content-type");return null!=t&&t.includes("application/json")?e.json():e.text()}throw g(e),e}))},n.promiseRace=(e,t,n=6e4)=>Promise.race([y(e,t),new Promise((e,t)=>{setTimeout(()=>{t(new Error("timed out"))},n)})]),n.promiseTimeout=b,n.put=async(e,t={},n={},a={})=>{const i={mode:"cors",headers:{"Content-Type":"application/json; charset=utf-8"}};a.useAPIKey&&(i.headers=s(s({},i.headers),m())),n.method="PUT";const o=r(i,n);a.isUrlEncodedData?(o.body=t,"application/json; charset=utf-8"===o.headers["Content-Type"]&&delete o.headers["Content-Type"]):o.body=JSON.stringify(t);const c=await p(e,o);if(c.ok){const e=c.headers.get("content-type");return null!=e&&e.includes("application/json")?c.json():c.text()}throw g(c),c},n.remove=async(e,t={},n={},a={})=>{const i={mode:"cors",headers:{"Content-Type":"application/json; charset=utf-8"}};a.useAPIKey&&(i.headers=s(s({},i.headers),m())),n.method="DELETE";const o=r(i,n);a.isUrlEncodedData?(o.body=t,"application/json; charset=utf-8"===o.headers["Content-Type"]&&delete o.headers["Content-Type"]):o.body=JSON.stringify(t);const c=await p(e,o);if(c.ok){const e=c.headers.get("content-type");return null!=e&&e.includes("application/json")?c.json():c.text()}throw g(c),c},n.setAPIKey=function(e){o=e},n.setEmbedHost=function(e){c=e},n.setLogLevel=function(e){i.setLevel(e)}}}},{package:"@metamask/seedless-onboarding-controller>@metamask/toprf-secure-backup>@toruslabs/http-helpers",file:"node_modules/@metamask/toprf-secure-backup/node_modules/@toruslabs/http-helpers/dist/lib.cjs/index.js"}],[2731,{"./api/accounts-api.cjs":2732,"./gas-flows/DefaultGasFeeFlow.cjs":2736,"./gas-flows/LineaGasFeeFlow.cjs":2737,"./gas-flows/OptimismLayer1GasFeeFlow.cjs":2738,"./gas-flows/RandomisedEstimationsGasFeeFlow.cjs":2740,"./gas-flows/ScrollLayer1GasFeeFlow.cjs":2741,"./gas-flows/TestGasFeeFlow.cjs":2742,"./helpers/AccountsApiRemoteTransactionSource.cjs":2743,"./helpers/GasFeePoller.cjs":2744,"./helpers/IncomingTransactionHelper.cjs":2745,"./helpers/MethodDataHelper.cjs":2746,"./helpers/MultichainTrackingHelper.cjs":2747,"./helpers/PendingTransactionTracker.cjs":2748,"./helpers/ResimulateHelper.cjs":2749,"./hooks/ExtraTransactionsPublishHook.cjs":2752,"./logger.cjs":2755,"./types.cjs":2756,"./utils/balance-changes.cjs":2757,"./utils/batch.cjs":2758,"./utils/eip7702.cjs":2759,"./utils/external-transactions.cjs":2760,"./utils/gas-fee-tokens.cjs":2762,"./utils/gas-fees.cjs":2763,"./utils/gas-flow.cjs":2764,"./utils/gas.cjs":2765,"./utils/history.cjs":2766,"./utils/layer1-gas-fee-flow.cjs":2767,"./utils/nonce.cjs":2768,"./utils/prepare.cjs":2769,"./utils/retry.cjs":2770,"./utils/swaps.cjs":2772,"./utils/transaction-type.cjs":2773,"./utils/utils.cjs":2774,"./utils/validation.cjs":2775,"@metamask/base-controller":1222,"@metamask/controller-utils":1301,"@metamask/eth-query":1831,"@metamask/network-controller":2168,"@metamask/nonce-tracker":2201,"@metamask/rpc-errors":2384,"@metamask/utils":2799,events:4072,lodash:4534,uuid:5366},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,a,i,o,c,u,l,d,f,h,p,m,g,b,y,w,T,E,S,v,k,P,I,_,x,j,A,C,R,O,M,B,N,F,L,D,G,U,H,$,K,q,W,V,z,J,X,Y,Z,Q,ee,te,ne,se,re,ae,ie,oe,ce,ue,le,de,fe,he,pe,me,ge,be,ye,we,Te,Ee,Se,ve,ke,Pe,Ie,_e,xe,je,Ae,Ce,Re,Oe,Me,Be,Ne,Fe,Le,De,Ge,Ue,He,$e,Ke,qe,We,Ve,ze,Je,Xe,Ye,Ze,Qe,et,tt=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},nt=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)},st=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.TransactionController=n.ApprovalState=n.SPEED_UP_RATE=n.CANCEL_RATE=void 0;const rt=e("@metamask/base-controller"),at=e("@metamask/controller-utils"),it=st(e("@metamask/eth-query")),ot=e("@metamask/network-controller"),ct=e("@metamask/nonce-tracker"),ut=e("@metamask/rpc-errors"),lt=e("@metamask/utils"),dt=e("events"),ft=e("lodash"),ht=e("uuid"),pt=e("./api/accounts-api.cjs"),mt=e("./gas-flows/DefaultGasFeeFlow.cjs"),gt=e("./gas-flows/LineaGasFeeFlow.cjs"),bt=e("./gas-flows/OptimismLayer1GasFeeFlow.cjs"),yt=e("./gas-flows/RandomisedEstimationsGasFeeFlow.cjs"),wt=e("./gas-flows/ScrollLayer1GasFeeFlow.cjs"),Tt=e("./gas-flows/TestGasFeeFlow.cjs"),Et=e("./helpers/AccountsApiRemoteTransactionSource.cjs"),St=e("./helpers/GasFeePoller.cjs"),vt=e("./helpers/IncomingTransactionHelper.cjs"),kt=e("./helpers/MethodDataHelper.cjs"),Pt=e("./helpers/MultichainTrackingHelper.cjs"),It=e("./helpers/PendingTransactionTracker.cjs"),_t=e("./helpers/ResimulateHelper.cjs"),xt=e("./hooks/ExtraTransactionsPublishHook.cjs"),jt=e("./logger.cjs"),At=e("./types.cjs"),Ct=e("./utils/balance-changes.cjs"),Rt=e("./utils/batch.cjs"),Ot=e("./utils/eip7702.cjs"),Mt=e("./utils/external-transactions.cjs"),Bt=e("./utils/gas.cjs"),Nt=e("./utils/gas-fee-tokens.cjs"),Ft=e("./utils/gas-fees.cjs"),Lt=e("./utils/gas-flow.cjs"),Dt=e("./utils/history.cjs"),Gt=e("./utils/layer1-gas-fee-flow.cjs"),Ut=e("./utils/nonce.cjs"),Ht=e("./utils/prepare.cjs"),$t=e("./utils/retry.cjs"),Kt=e("./utils/swaps.cjs"),qt=e("./utils/transaction-type.cjs"),Wt=e("./utils/utils.cjs"),Vt=e("./utils/validation.cjs"),zt={transactions:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!0},transactionBatches:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!0},methodData:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!0},lastFetchedBlockNumbers:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!1},submitHistory:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!1}};n.CANCEL_RATE=1.1,n.SPEED_UP_RATE=1.1;const Jt="TransactionController";var Xt;!function(e){e.Approved="approved",e.NotApproved="not-approved",e.SkippedViaBeforePublishHook="skipped-via-before-publish-hook"}(Xt||(n.ApprovalState=Xt={}));class Yt extends rt.BaseController{constructor(e){const{disableHistory:t,disableSendFlowHistory:n,disableSwaps:q,getCurrentAccountEIP1559Compatibility:W,getCurrentNetworkEIP1559Compatibility:V,getExternalPendingTransactions:z,getGasFeeEstimates:X,getNetworkClientRegistry:Y,getNetworkState:Z,getPermittedAccounts:Q,getSavedGasFees:ee,getSimulationConfig:ne,hooks:se,incomingTransactions:re={},isAutomaticGasFeeUpdateEnabled:ae,isEIP7702GasFeeTokensEnabled:ie,isFirstTimeInteractionEnabled:oe,isSimulationEnabled:ce,messenger:ue,pendingTransactions:le={},publicKeyEIP7702:de,securityProviderRequest:he,sign:pe,state:me,testGasFeeFlows:ge,trace:be,transactionHistoryLimit:ye=40}=e;super({name:Jt,metadata:zt,messenger:ue,state:{methodData:{},transactions:[],transactionBatches:[],lastFetchedBlockNumbers:{},submitHistory:[],...me}}),s.add(this),r.set(this,void 0),a.set(this,void 0),i.set(this,void 0),o.set(this,new Set),c.set(this,void 0),u.set(this,void 0),l.set(this,void 0),d.set(this,void 0),f.set(this,void 0),h.set(this,void 0),p.set(this,void 0),m.set(this,void 0),g.set(this,void 0),b.set(this,void 0),y.set(this,void 0),w.set(this,void 0),T.set(this,void 0),E.set(this,void 0),S.set(this,void 0),v.set(this,new dt.EventEmitter),k.set(this,void 0),P.set(this,void 0),I.set(this,void 0),_.set(this,void 0),x.set(this,void 0),j.set(this,void 0),A.set(this,void 0),C.set(this,void 0),R.set(this,void 0),O.set(this,void 0),M.set(this,void 0),B.set(this,void 0),N.set(this,void 0),F.set(this,void 0),L.set(this,void 0),D.set(this,void 0),G.set(this,new Map),U.set(this,new Set),H.set(this,void 0),$.set(this,void 0),K.set(this,void 0),je.set(this,()=>{nt(this,O,"f").checkForPendingTransactionAndStartPolling()}),this.messagingSystem=ue,tt(this,r,se?.afterAdd??(()=>Promise.resolve({})),"f"),tt(this,a,se?.afterSign??(()=>!0),"f"),tt(this,i,se?.afterSimulate??(()=>Promise.resolve({})),"f"),tt(this,c,se?.beforeCheckPendingTransaction??(()=>Promise.resolve(!0)),"f"),tt(this,u,se?.beforePublish??(()=>Promise.resolve(!0)),"f"),tt(this,l,se?.beforeSign??(()=>Promise.resolve({})),"f"),tt(this,f,se?.getAdditionalSignArguments??(()=>[]),"f"),tt(this,h,W??(()=>Promise.resolve(!0)),"f"),tt(this,p,V,"f"),tt(this,m,z??(()=>[]),"f"),tt(this,g,X||(()=>Promise.resolve({})),"f"),tt(this,b,Z,"f"),tt(this,y,Q,"f"),tt(this,w,ee??(e=>undefined),"f"),tt(this,T,ne??(()=>Promise.resolve({})),"f"),tt(this,S,re,"f"),tt(this,k,ae??(e=>!1),"f"),tt(this,P,ie??(()=>Promise.resolve(!1)),"f"),tt(this,I,oe??(()=>!0),"f"),tt(this,_,t??!1,"f"),tt(this,x,n??!1,"f"),tt(this,j,ce??(()=>!0),"f"),tt(this,A,q??!1,"f"),tt(this,M,le,"f"),tt(this,B,de,"f"),tt(this,N,se?.publish??(()=>Promise.resolve({transactionHash:undefined})),"f"),tt(this,F,se?.publishBatch,"f"),tt(this,L,he,"f"),tt(this,D,pe,"f"),tt(this,H,!0===ge,"f"),tt(this,$,be??((e,t)=>t?.()),"f"),tt(this,K,ye,"f");const we=e=>this.messagingSystem.call("NetworkController:findNetworkClientIdByChainId",e);tt(this,O,new Pt.MultichainTrackingHelper({findNetworkClientIdByChainId:we,getNetworkClientById:e=>this.messagingSystem.call("NetworkController:getNetworkClientById",e),getNetworkClientRegistry:Y,removePendingTransactionTrackerListeners:nt(this,s,"m",Re).bind(this),createNonceTracker:nt(this,s,"m",_e).bind(this),createPendingTransactionTracker:nt(this,s,"m",xe).bind(this),onNetworkStateChange:e=>{this.messagingSystem.subscribe("NetworkController:stateChange",e)}}),"f"),nt(this,O,"f").initialize(),tt(this,d,nt(this,s,"m",Fe).call(this),"f"),tt(this,C,nt(this,s,"m",Le).call(this),"f");const Te=new St.GasFeePoller({findNetworkClientIdByChainId:we,gasFeeFlows:nt(this,d,"f"),getGasFeeControllerEstimates:nt(this,g,"f"),getProvider:e=>nt(this,s,"m",fe).call(this,{networkClientId:e}),getTransactions:()=>this.state.transactions,getTransactionBatches:()=>this.state.transactionBatches,layer1GasFeeFlows:nt(this,C,"f"),messenger:this.messagingSystem,onStateChange:e=>{this.messagingSystem.subscribe("TransactionController:stateChange",e)}});Te.hub.on("transaction-updated",nt(this,s,"m",He).bind(this)),Te.hub.on("transaction-batch-updated",nt(this,s,"m",$e).bind(this)),tt(this,R,new kt.MethodDataHelper({getProvider:e=>nt(this,s,"m",fe).call(this,{networkClientId:e}),getState:()=>this.state.methodData}),"f"),nt(this,R,"f").hub.on("update",({fourBytePrefix:e,methodData:t})=>{this.update(n=>{n.methodData[e]=t})}),tt(this,E,new vt.IncomingTransactionHelper({client:nt(this,S,"f").client,getCurrentAccount:()=>nt(this,s,"m",qe).call(this),getLocalTransactions:()=>this.state.transactions,includeTokenTransfers:nt(this,S,"f").includeTokenTransfers,isEnabled:nt(this,S,"f").isEnabled,messenger:this.messagingSystem,remoteTransactionSource:new Et.AccountsApiRemoteTransactionSource,trimTransactions:nt(this,s,"m",te).bind(this),updateTransactions:nt(this,S,"f").updateTransactions}),"f"),nt(this,s,"m",Ce).call(this,nt(this,E,"f")),this.messagingSystem.subscribe("TransactionController:stateChange",nt(this,je,"f")),new _t.ResimulateHelper({simulateTransaction:nt(this,s,"m",Ue).bind(this),onTransactionsUpdate:e=>{this.messagingSystem.subscribe("TransactionController:stateChange",e,e=>e.transactions)},getTransactions:()=>this.state.transactions}),nt(this,s,"m",J).call(this),nt(this,je,"f").call(this),nt(this,s,"m",Je).call(this)}destroy(){nt(this,s,"m",Ae).call(this)}async handleMethodData(e,t){return nt(this,R,"f").lookup(e,t)}async addTransactionBatch(e){const{blockTracker:t}=this.messagingSystem.call("NetworkController:getNetworkClientById",e.networkClientId);return await(0,Rt.addTransactionBatch)({addTransaction:this.addTransaction.bind(this),getChainId:nt(this,s,"m",ue).bind(this),getEthQuery:e=>nt(this,s,"m",de).call(this,{networkClientId:e}),getGasFeeEstimates:nt(this,g,"f"),getInternalAccounts:nt(this,s,"m",We).bind(this),getSimulationConfig:nt(this,T,"f").bind(this),getPendingTransactionTracker:e=>nt(this,s,"m",xe).call(this,{provider:nt(this,s,"m",fe).call(this,{networkClientId:e}),blockTracker:t,chainId:nt(this,s,"m",ue).call(this,e),networkClientId:e}),getTransaction:e=>nt(this,s,"m",ie).call(this,e),isSimulationEnabled:nt(this,j,"f"),messenger:this.messagingSystem,publishBatchHook:nt(this,F,"f"),publicKeyEIP7702:nt(this,B,"f"),publishTransaction:(e,t)=>nt(this,s,"m",Q).call(this,e,t),request:e,signTransaction:nt(this,s,"m",Se).bind(this),update:this.update.bind(this),updateTransaction:nt(this,s,"m",De).bind(this)})}async isAtomicBatchSupported(e){return(0,Rt.isAtomicBatchSupported)({...e,getEthQuery:e=>nt(this,s,"m",de).call(this,{chainId:e}),messenger:this.messagingSystem,publicKeyEIP7702:nt(this,B,"f")})}async addTransaction(e,t){(0,jt.projectLogger)("Adding transaction",e,t);const{actionId:n,assetsFiatValues:a,batchId:i,deviceConfirmedOn:o,disableGasBuffer:c,isGasFeeIncluded:u,method:l,nestedTransactions:d,networkClientId:f,origin:h,publishHook:p,requireApproval:m,securityAlertResponse:g,sendFlowHistory:b,swaps:w={},traceContext:T,type:E}=t;if(e=(0,Wt.normalizeTransactionParams)(e),!nt(this,O,"f").has(f))throw new Error(`Network client not found - ${f}`);const S=nt(this,s,"m",ue).call(this,f),v=nt(this,s,"m",de).call(this,{networkClientId:f}),k=h===undefined?undefined:await(nt(this,y,"f")?.call(this,h)),P=nt(this,s,"m",We).call(this);await(0,Vt.validateTransactionOrigin)({data:e.data,from:e.from,internalAccounts:P,origin:h,permittedAddresses:k,txParams:e,type:E});const I=(0,Ot.getDelegationAddress)(e.from,v).catch(()=>undefined),j=await nt(this,s,"m",Ee).call(this,f);(0,Vt.validateTxParams)(e,j,S),e.type||(0,Wt.setEnvelopeType)(e,j);if(i?.length&&this.state.transactions.some(e=>e.batchId?.toLowerCase()===i?.toLowerCase())&&h&&h!==at.ORIGIN_METAMASK)throw new ut.JsonRpcError(Vt.ErrorCode.DuplicateBundleId,"Batch ID already exists");const C=nt(this,s,"m",pe).call(this,e,h),R=E??(await(0,qt.determineTransactionType)(e,v)).type,M=await I,B=nt(this,s,"m",ye).call(this,n);let N=B?(0,ft.cloneDeep)(B):{actionId:n,assetsFiatValues:a,batchId:i,chainId:S,dappSuggestedGasFees:C,delegationAddress:M,deviceConfirmedOn:o,disableGasBuffer:c,id:(0,ht.v1)(),isGasFeeIncluded:u,isFirstTimeInteraction:undefined,nestedTransactions:d,networkClientId:f,origin:h,securityAlertResponse:g,status:At.TransactionStatus.unapproved,time:Date.now(),txParams:e,type:R,userEditedGasLimit:!1,verifiedOnBlockchain:!1};const{updateTransaction:F}=await nt(this,r,"f").call(this,{transactionMeta:N});if(F&&((0,jt.projectLogger)("Updating transaction using afterAdd hook"),N.txParamsOriginal=(0,ft.cloneDeep)(N.txParams),F(N)),await nt(this,$,"f").call(this,{name:"Estimate Gas Properties",parentContext:T},e=>nt(this,s,"m",z).call(this,N,{traceContext:e})),!B){if(l&&nt(this,L,"f")){const e=await nt(this,L,"f").call(this,N,l);N.securityProviderResponse=e}nt(this,x,"f")||(N.sendFlowHistory=b??[]),nt(this,_,"f")||(N=(0,Dt.addInitialHistorySnapshot)(N)),N=(0,Kt.updateSwapsTransaction)(N,R,w,{isSwapsDisabled:nt(this,A,"f"),cancelTransaction:nt(this,s,"m",ee).bind(this),messenger:this.messagingSystem}),nt(this,s,"m",V).call(this,N),!1!==m?(nt(this,s,"m",Ue).call(this,N,{traceContext:T}).catch(e=>{throw(0,jt.projectLogger)("Error while updating simulation data",e),e}),nt(this,s,"m",Ge).call(this,N,{traceContext:T}).catch(e=>{(0,jt.projectLogger)("Error while updating first interaction properties",e)})):(0,jt.projectLogger)("Skipping simulation & first interaction update as approval not required"),this.messagingSystem.publish(`${Jt}:unapprovedTransactionAdded`,N)}return{result:nt(this,s,"m",Y).call(this,N,{actionId:n,isExisting:Boolean(B),publishHook:p,requireApproval:m,traceContext:T}),transactionMeta:N}}startIncomingTransactionPolling(){nt(this,E,"f").start()}stopIncomingTransactionPolling(){nt(this,E,"f").stop()}async updateIncomingTransactions({tags:e}={}){await nt(this,E,"f").update({tags:e})}async stopTransaction(e,t,{estimatedBaseFee:r,actionId:a}={}){await nt(this,s,"m",q).call(this,{actionId:a,estimatedBaseFee:r,gasValues:t,label:"cancel",rate:n.CANCEL_RATE,transactionId:e,transactionType:At.TransactionType.cancel,prepareTransactionParams:e=>{delete e.data,e.to=e.from,e.value="0x0"},afterSubmit:e=>{this.messagingSystem.publish(`${Jt}:transactionFinished`,e),nt(this,v,"f").emit(`${e.id}:finished`,e)}})}async speedUpTransaction(e,t,{actionId:r,estimatedBaseFee:a}={}){await nt(this,s,"m",q).call(this,{actionId:r,estimatedBaseFee:a,gasValues:t,label:"speed up",rate:n.SPEED_UP_RATE,transactionId:e,transactionType:At.TransactionType.retry,afterSubmit:e=>{this.messagingSystem.publish(`${Jt}:speedupTransactionAdded`,e)}})}async estimateGas(e,t,{ignoreDelegationSignatures:n}={}){const r=nt(this,s,"m",de).call(this,{networkClientId:t}),{estimatedGas:a,simulationFails:i}=await(0,Bt.estimateGas)({chainId:nt(this,s,"m",ue).call(this,t),ethQuery:r,ignoreDelegationSignatures:n,isSimulationEnabled:nt(this,j,"f").call(this),getSimulationConfig:nt(this,T,"f"),messenger:this.messagingSystem,txParams:e});return{gas:a,simulationFails:i}}async estimateGasBuffered(e,t,n){const r=nt(this,s,"m",de).call(this,{networkClientId:n}),{blockGasLimit:a,estimatedGas:i,simulationFails:o}=await(0,Bt.estimateGas)({chainId:nt(this,s,"m",ue).call(this,n),ethQuery:r,isSimulationEnabled:nt(this,j,"f").call(this),getSimulationConfig:nt(this,T,"f"),messenger:this.messagingSystem,txParams:e});return{gas:(0,Bt.addGasBuffer)(i,a,t),simulationFails:o}}updateTransaction(e,t){const{id:n}=e;nt(this,s,"m",De).call(this,{transactionId:n,note:t},()=>({...e}))}updateSecurityAlertResponse(e,t){if(!t)throw new Error("updateSecurityAlertResponse: securityAlertResponse should not be null");const n=nt(this,s,"m",ae).call(this,e);if(!n)throw new Error("Cannot update security alert response as no transaction metadata found");const r={...n,securityAlertResponse:t};this.updateTransaction(r,`${Jt}:updatesecurityAlertResponse - securityAlertResponse updated`)}wipeTransactions({address:e,chainId:t}={}){if(!t&&!e)return void this.update(e=>{e.transactions=[]});const n=this.state.transactions.filter(({chainId:n,txParams:s,type:r})=>{if(!(!t||t===n))return!0;return!(!e||s.from?.toLowerCase()===e.toLowerCase()||r===At.TransactionType.incoming&&s.to?.toLowerCase()===e.toLowerCase())});this.update(e=>{e.transactions=nt(this,s,"m",te).call(this,n)})}async confirmExternalTransaction(e,t,n){const r=nt(this,s,"m",me).call(this,e);try{const e=r.id,a={...r,status:At.TransactionStatus.confirmed,txReceipt:t};n&&(a.baseFeePerGas=n),nt(this,s,"m",ge).call(this,e),this.updateTransaction(a,`${Jt}:confirmExternalTransaction - Add external transaction`),nt(this,s,"m",ve).call(this,a),nt(this,s,"m",Ie).call(this,a).catch(e=>{throw(0,jt.projectLogger)("Error while updating post balance",e),e}),this.messagingSystem.publish(`${Jt}:transactionConfirmed`,a)}catch(e){console.error("Failed to confirm external transaction",e)}}updateTransactionSendFlowHistory(e,t,n){if(nt(this,x,"f"))throw new Error("Send flow history is disabled for the current transaction controller");const r=nt(this,s,"m",ae).call(this,e);if(!r)throw new Error("Cannot update send flow history as no transaction metadata found");(0,Wt.validateIfTransactionUnapproved)(r,"updateTransactionSendFlowHistory");const a=r.sendFlowHistory??[];if(t===a.length){const e={...r,sendFlowHistory:[...a,...n]};this.updateTransaction(e,`${Jt}:updateTransactionSendFlowHistory - sendFlowHistory updated`)}return nt(this,s,"m",ae).call(this,e)}updateTransactionGasFees(e,{defaultGasEstimates:t,estimateUsed:n,estimateSuggested:r,gas:a,gasLimit:i,gasPrice:o,maxPriorityFeePerGas:c,maxFeePerGas:u,originalGasEstimate:l,userEditedGasLimit:d,userFeeLevel:f}){const h=nt(this,s,"m",ae).call(this,e);if(!h)throw new Error("Cannot update transaction as no transaction metadata found");(0,Wt.validateIfTransactionUnapproved)(h,"updateTransactionGasFees");const p=(0,ft.cloneDeep)(h),m=h.gasFeeEstimates,g=nt(this,k,"f").call(this,h),b=f,y=Object.values(At.GasFeeEstimateLevel).includes(b),w=m&&g&&y;w&&(0,St.updateTransactionGasEstimates)({txMeta:p,userFeeLevel:b});const T={gas:a,gasLimit:i};w?Object.assign(T,{gasPrice:p.txParams.gasPrice,maxPriorityFeePerGas:p.txParams.maxPriorityFeePerGas,maxFeePerGas:p.txParams.maxFeePerGas}):Object.assign(T,{gasPrice:o,maxPriorityFeePerGas:c,maxFeePerGas:u});const E={txParams:(0,ft.pickBy)(T),defaultGasEstimates:t,estimateUsed:n,estimateSuggested:r,originalGasEstimate:l,userEditedGasLimit:d,userFeeLevel:b},S=(0,ft.pickBy)(E);return nt(this,s,"m",De).call(this,{transactionId:e,note:`${Jt}:updateTransactionGasFees - gas values updated`,skipResimulateCheck:!0},e=>{const{txParams:t,...n}=S;Object.assign(e,n),t&&Object.assign(e.txParams,t)}),nt(this,s,"m",ae).call(this,e)}updatePreviousGasParams(e,{gasLimit:t,maxFeePerGas:n,maxPriorityFeePerGas:r}){const a=nt(this,s,"m",ae).call(this,e);if(!a)throw new Error("Cannot update transaction as no transaction metadata found");(0,Wt.validateIfTransactionUnapproved)(a,"updatePreviousGasParams");const i={previousGas:{gasLimit:t,maxFeePerGas:n,maxPriorityFeePerGas:r}};i.previousGas=(0,ft.pickBy)(i.previousGas);const o=(0,ft.merge)({},a,i);return this.updateTransaction(o,`${Jt}:updatePreviousGasParams - Previous gas values updated`),nt(this,s,"m",ae).call(this,e)}async getNonceLock(e,t){return nt(this,O,"f").getNonceLock(e,t)}async updateEditableParams(e,{containerTypes:t,data:n,from:r,gas:a,gasPrice:i,maxFeePerGas:o,maxPriorityFeePerGas:c,to:u,updateType:l,value:d}){const f=nt(this,s,"m",ae).call(this,e);if(!f)throw new Error("Cannot update editable params as no transaction metadata found");(0,Wt.validateIfTransactionUnapproved)(f,"updateEditableParams");const h={txParams:{data:n,from:r,to:u,value:d,gas:a,gasPrice:i,maxFeePerGas:o,maxPriorityFeePerGas:c}};h.txParams=(0,ft.pickBy)(h.txParams);const p=(0,ft.merge)({},f,h),{networkClientId:m}=f,g=nt(this,s,"m",fe).call(this,{networkClientId:m}),b=new it.default(g);if(!1!==l){const{type:e}=await(0,qt.determineTransactionType)(p.txParams,b);p.type=e}return t&&(p.containerTypes=t),await(0,Gt.updateTransactionLayer1GasFee)({layer1GasFeeFlows:nt(this,C,"f"),messenger:this.messagingSystem,provider:g,transactionMeta:p}),this.updateTransaction(p,`Update Editable Params for ${e}`),nt(this,s,"m",ae).call(this,e)}setTransactionActive(e,t){if(!nt(this,s,"m",ae).call(this,e))throw new Error(`Transaction with id ${e} not found`);nt(this,s,"m",De).call(this,{transactionId:e,note:"TransactionController#setTransactionActive - Transaction isActive updated",skipHistory:!0,skipValidation:!0,skipResimulateCheck:!0},e=>{e.isActive=t})}async approveTransactionsWithSameNonce(e=[],{hasNonce:t}={}){if((0,jt.projectLogger)("Approving transactions with same nonce",{transactions:e}),0===e.length)return"";const n=e[0],{chainId:r}=n,a=nt(this,s,"m",le).call(this,{chainId:r}),i=(0,Ht.prepareTransaction)(r,n),c=(0,Ht.serializeTransaction)(i);if(nt(this,o,"f").has(c))return"";let u,l;nt(this,o,"f").add(c);try{const r=n.from;l=!0!==t?await this.getNonceLock(r,a):undefined;const i=l?(0,lt.add0x)(l.nextNonce.toString(16)):n.nonce;l&&(0,jt.projectLogger)("Using nonce from nonce tracker",i,l.nonceDetails),u=await Promise.all(e.map(e=>(e.nonce=i,nt(this,s,"m",W).call(this,e.chainId,e))))}catch(e){throw(0,jt.projectLogger)("Error while signing transactions with same nonce",e),e}finally{l?.releaseLock(),nt(this,o,"f").delete(c)}return u}updateCustodialTransaction(e){const{transactionId:t,errorMessage:n,hash:r,status:a,gasLimit:i,gasPrice:o,maxFeePerGas:c,maxPriorityFeePerGas:u,nonce:l,type:d}=e,f=nt(this,s,"m",ae).call(this,t);if(!f)throw new Error("Cannot update custodial transaction as no transaction metadata found");if(a&&![At.TransactionStatus.submitted,At.TransactionStatus.signed,At.TransactionStatus.failed].includes(a))throw new Error(`Cannot update custodial transaction with status: ${a}`);const h=(0,ft.merge)({},f,(0,ft.pickBy)({hash:r,status:a}));return h.status===At.TransactionStatus.submitted&&(h.submittedTime=(new Date).getTime()),h.status===At.TransactionStatus.failed&&(h.error=(0,Wt.normalizeTxError)(new Error(n))),h.txParams=(0,ft.merge)({},h.txParams,(0,ft.pickBy)({gasLimit:i,gasPrice:o,maxFeePerGas:c,maxPriorityFeePerGas:u,nonce:l,type:d})),d===At.TransactionEnvelopeType.legacy&&(delete h.txParams.maxFeePerGas,delete h.txParams.maxPriorityFeePerGas),this.updateTransaction(h,`${Jt}:updateCustodialTransaction - Custodial transaction updated`),a&&[At.TransactionStatus.submitted,At.TransactionStatus.failed].includes(a)&&(this.messagingSystem.publish(`${Jt}:transactionFinished`,h),nt(this,v,"f").emit(`${h.id}:finished`,h)),h}getTransactions({initialList:e,limit:t,searchCriteria:n={}}={}){const s=(0,ft.mapValues)(n,e=>"function"==typeof e?e:t=>t===e),r=e??this.state.transactions,a=(0,ft.sortBy)((0,ft.pickBy)(r,e=>{for(const[t,n]of Object.entries(s))if(t in e.txParams){if(!1===n(e.txParams[t]))return!1}else if(!1===n(e[t]))return!1;return!0}),"time");if(t!==undefined){const e=new Set,n=[];for(let s=a.length-1;s>-1;s--){const r=a[s],{nonce:i}=r.txParams;if(!e.has(i)){if(!(e.size<t))continue;e.add(i)}n.unshift(r)}return n}return a}async estimateGasFee({transactionParams:e,chainId:t,networkClientId:n}){const{id:s,provider:r}=nt(this,O,"f").getNetworkClient({chainId:t,networkClientId:n}),a={txParams:e,chainId:t,networkClientId:s},i=(0,Lt.getGasFeeFlow)(a,nt(this,d,"f"),this.messagingSystem),o=new it.default(r),c=await nt(this,g,"f").call(this,{networkClientId:s});return i.getGasFees({ethQuery:o,gasFeeControllerData:c,messenger:this.messagingSystem,transactionMeta:a})}async getLayer1GasFee({transactionParams:e,chainId:t,networkClientId:n}){const r=nt(this,s,"m",fe).call(this,{chainId:t,networkClientId:n});return await(0,Gt.getTransactionLayer1GasFee)({layer1GasFeeFlows:nt(this,C,"f"),messenger:this.messagingSystem,provider:r,transactionMeta:{txParams:e,chainId:t}})}clearUnapprovedTransactions(){const e=this.state.transactions.filter(({status:e})=>e!==At.TransactionStatus.unapproved);this.update(t=>{t.transactions=nt(this,s,"m",te).call(this,e)})}abortTransactionSigning(e){if(!nt(this,s,"m",ae).call(this,e))throw new Error("Cannot abort signing as no transaction metadata found");const t=nt(this,G,"f").get(e);if(!t)throw new Error("Cannot abort signing as transaction is not waiting for signing");t(),nt(this,G,"f").delete(e)}async updateAtomicBatchData({transactionId:e,transactionIndex:t,transactionData:n}){(0,jt.projectLogger)("Updating atomic batch data",{transactionId:e,transactionIndex:t,transactionData:n});const r=nt(this,s,"m",De).call(this,{transactionId:e,note:"TransactionController#updateAtomicBatchData - Atomic batch data updated"},e=>{const{nestedTransactions:s,txParams:r}=e,a=r.from,i=s?.[t];if(!i)throw new Error(`Nested transaction not found with index - ${t}`);i.data=n;const o=(0,Ot.generateEIP7702BatchTransaction)(a,s);e.txParams.data=o.data}),a=(0,ft.cloneDeep)({...r,txParams:{...r.txParams,gas:undefined}});return await nt(this,s,"m",ze).call(this,a),nt(this,s,"m",De).call(this,{transactionId:e,note:"TransactionController#updateAtomicBatchData - Gas estimate updated"},e=>{e.txParams.gas=a.txParams.gas,e.simulationFails=a.simulationFails,e.gasLimitNoBuffer=a.gasLimitNoBuffer}),r.txParams.data}updateBatchTransactions({transactionId:e,batchTransactions:t}){(0,jt.projectLogger)("Updating batch transactions",{transactionId:e,batchTransactions:t}),nt(this,s,"m",De).call(this,{transactionId:e,note:"TransactionController#updateBatchTransactions - Batch transactions updated"},e=>{e.batchTransactions=t})}updateSelectedGasFeeToken(e,t){nt(this,s,"m",De).call(this,{transactionId:e},e=>{const n=e.gasFeeTokens?.some(e=>e.tokenAddress.toLowerCase()===t?.toLowerCase());if(t&&!n)throw new Error(`No matching gas fee token found with address - ${t}`);e.selectedGasFeeToken=t})}updateRequiredTransactionIds({transactionId:e,requiredTransactionIds:t,append:n}){nt(this,s,"m",De).call(this,{transactionId:e},e=>{const{requiredTransactionIds:s}=e;e.requiredTransactionIds=[...s&&!1!==n?s:[],...t]})}}n.TransactionController=Yt,r=new WeakMap,a=new WeakMap,i=new WeakMap,o=new WeakMap,c=new WeakMap,u=new WeakMap,l=new WeakMap,d=new WeakMap,f=new WeakMap,h=new WeakMap,p=new WeakMap,m=new WeakMap,g=new WeakMap,b=new WeakMap,y=new WeakMap,w=new WeakMap,T=new WeakMap,E=new WeakMap,S=new WeakMap,v=new WeakMap,k=new WeakMap,P=new WeakMap,I=new WeakMap,_=new WeakMap,x=new WeakMap,j=new WeakMap,A=new WeakMap,C=new WeakMap,R=new WeakMap,O=new WeakMap,M=new WeakMap,B=new WeakMap,N=new WeakMap,F=new WeakMap,L=new WeakMap,D=new WeakMap,G=new WeakMap,U=new WeakMap,H=new WeakMap,$=new WeakMap,K=new WeakMap,je=new WeakMap,s=new WeakSet,q=async function({actionId:e,afterSubmit:t,estimatedBaseFee:n,gasValues:r,label:a,prepareTransactionParams:i,rate:o,transactionId:c,transactionType:u}){if(nt(this,s,"m",ye).call(this,e))return;r&&(r=(0,Wt.normalizeGasFeeValues)(r),(0,Wt.validateGasValues)(r)),(0,jt.projectLogger)(`Creating ${a} transaction`,c,r);const l=nt(this,s,"m",ae).call(this,c);if(!l)return;if(!nt(this,D,"f"))throw new Error("No sign method defined.");const d=(0,$t.getTransactionParamsWithIncreasedGasFee)(l.txParams,o,r);i?.(d);const f=(0,Ht.prepareTransaction)(l.chainId,d),h=await nt(this,D,"f").call(this,f,l.txParams.from),p=nt(this,s,"m",Te).call(this,l,h),m=(0,Ht.serializeTransaction)(h),g=d.maxFeePerGas??d.gasPrice,b=d.maxFeePerGas?p.txParams.maxFeePerGas:p.txParams.gasPrice;(0,jt.projectLogger)(`Submitting ${a} transaction`,{oldFee:b,newFee:g,txParams:d});const{networkClientId:y}=l,w=nt(this,s,"m",de).call(this,{networkClientId:y}),T={...p,actionId:e,estimatedBaseFee:n,id:(0,ht.v1)(),originalGasEstimate:l.txParams.gas,originalType:l.type,rawTx:m,time:Date.now(),txParams:d,type:u},E=await nt(this,s,"m",Be).call(this,w,{...T,origin:a});T.hash=E,nt(this,s,"m",V).call(this,T),this.messagingSystem.publish(`${Jt}:transactionApproved`,{transactionMeta:T,actionId:e}),this.messagingSystem.publish(`${Jt}:transactionSubmitted`,{transactionMeta:T,actionId:e}),t?.(T)},W=async function(e,t){if(!nt(this,D,"f"))throw new Error("No sign method defined.");const n=(0,Wt.normalizeTransactionParams)(t),s=(0,Wt.isEIP1559Transaction)(n)?At.TransactionEnvelopeType.feeMarket:At.TransactionEnvelopeType.legacy,r={...n,type:s,gasLimit:n.gas,chainId:e},{from:a}=r,i=(0,Ht.prepareTransaction)(e,r),o=await nt(this,D,"f").call(this,i,a);return(0,Ht.serializeTransaction)(o)},V=function(e){(0,Vt.validateTxParams)(e.txParams),this.update(t=>{t.transactions=nt(this,s,"m",te).call(this,[...t.transactions,e])})},z=async function(e,{traceContext:t}={}){const n=e.txParams.type!==At.TransactionEnvelopeType.legacy&&await nt(this,s,"m",Ee).call(this,e.networkClientId),{networkClientId:r}=e,a=nt(this,s,"m",de).call(this,{networkClientId:r}),i=nt(this,s,"m",fe).call(this,{networkClientId:r});await nt(this,$,"f").call(this,{name:"Update Gas",parentContext:t},async()=>{await nt(this,s,"m",ze).call(this,e)}),await nt(this,$,"f").call(this,{name:"Update Gas Fees",parentContext:t},async()=>await(0,Ft.updateGasFees)({eip1559:n,ethQuery:a,gasFeeFlows:nt(this,d,"f"),getGasFeeEstimates:nt(this,g,"f"),getSavedGasFees:nt(this,w,"f").bind(this),messenger:this.messagingSystem,txMeta:e})),await nt(this,$,"f").call(this,{name:"Update Layer 1 Gas Fees",parentContext:t},async()=>await(0,Gt.updateTransactionLayer1GasFee)({layer1GasFeeFlows:nt(this,C,"f"),messenger:this.messagingSystem,provider:i,transactionMeta:e}))},J=function(){this.clearUnapprovedTransactions(),nt(this,s,"m",X).call(this)},X=function(){const e=this.state.transactions.filter(e=>[At.TransactionStatus.approved,At.TransactionStatus.signed].includes(e.status));for(const t of e)nt(this,s,"m",Qe).call(this,t,new Error("Transaction incomplete at startup"))},Y=async function(e,{actionId:t,isExisting:n=!1,publishHook:r,requireApproval:a,shouldShowRequest:i=!0,traceContext:o}){const c=e.id;let u;const{meta:l,isCompleted:d}=nt(this,s,"m",ce).call(this,c),f=d?Promise.resolve(l):nt(this,s,"m",we).call(this,c);if(l&&!n&&!d)try{if(!1!==a){const t=await nt(this,$,"f").call(this,{name:"Await Approval",parentContext:o},t=>nt(this,s,"m",re).call(this,e,{shouldShowRequest:i,traceContext:t}));u=t.resultCallbacks;const n=t.value,r=n?.txMeta;r&&((0,jt.projectLogger)("Updating transaction with approval data",{customNonce:r.customNonceValue,params:r.txParams}),this.updateTransaction(r,"TransactionController#processApproval - Updated with approval data"))}const{isCompleted:n}=nt(this,s,"m",ce).call(this,c);if(!n){await nt(this,s,"m",Z).call(this,c,o,r)===Xt.SkippedViaBeforePublishHook&&u&&u.success();const e=nt(this,s,"m",ae).call(this,c);this.messagingSystem.publish(`${Jt}:transactionApproved`,{transactionMeta:e,actionId:t})}}catch(e){const n=e,{isCompleted:r}=nt(this,s,"m",ce).call(this,c);r||(nt(this,s,"m",Ye).call(this,n)?nt(this,s,"m",Ze).call(this,c,t,n):nt(this,s,"m",Qe).call(this,l,n,t))}finally{nt(this,U,"f").delete(c)}const h=await f;switch(h?.status){case At.TransactionStatus.failed:const e=h.error;throw u?.error(e),ut.rpcErrors.internal(e.message);case At.TransactionStatus.submitted:return u?.success(),h.hash;default:const t=ut.rpcErrors.internal(`MetaMask Tx Signature: Unknown problem: ${JSON.stringify(h||c)}`);throw u?.error(t),t}},Z=async function(e,t,n){let r,a,i=nt(this,s,"m",ie).call(this,e);(0,jt.projectLogger)("Approving transaction",i);try{if(!nt(this,D,"f"))return nt(this,s,"m",Qe).call(this,i,new Error("No sign method defined.")),Xt.NotApproved;if(!i.chainId)return nt(this,s,"m",Qe).call(this,i,new Error("No chainId defined.")),Xt.NotApproved;if(nt(this,o,"f").has(e))return(0,jt.projectLogger)("Skipping approval as signing in progress",e),Xt.NotApproved;nt(this,o,"f").add(e),r=()=>nt(this,o,"f").delete(e);const[c,l]=await(0,Ut.getNextNonce)(i,e=>nt(this,O,"f").getNonceLock(e,i.networkClientId));a=l,i=nt(this,s,"m",De).call(this,{transactionId:e,note:"TransactionController#approveTransaction - Transaction approved"},e=>{const{chainId:t,txParams:n}=e,{gas:s,type:r}=n;e.status=At.TransactionStatus.approved,e.txParams.chainId=t,e.txParams.gasLimit=s,e.txParams.nonce=c,!r&&(0,Wt.isEIP1559Transaction)(n)&&(e.txParams.type=At.TransactionEnvelopeType.feeMarket)}),nt(this,s,"m",ve).call(this,i);const d=await nt(this,$,"f").call(this,{name:"Sign",parentContext:t},()=>nt(this,s,"m",Se).call(this,i));if(!await nt(this,u,"f").call(this,i))return(0,jt.projectLogger)("Skipping publishing transaction based on hook"),this.messagingSystem.publish(`${Jt}:transactionPublishingSkipped`,i),Xt.SkippedViaBeforePublishHook;if(!d&&!i.isExternalSign)return Xt.NotApproved;const{networkClientId:f}=i,h=nt(this,s,"m",de).call(this,{networkClientId:f});let p;const m=i.type===At.TransactionType.swap;let g;if(m&&((0,jt.projectLogger)("Determining pre-transaction balance"),p=await(0,at.query)(h,"getBalance",[i.txParams.from])),(0,jt.projectLogger)("Publishing transaction",i.txParams),a?.(),a=undefined,i.batchTransactions?.length){(0,jt.projectLogger)("Found batch transactions",i.batchTransactions);const e=new xt.ExtraTransactionsPublishHook({addTransactionBatch:this.addTransactionBatch.bind(this)});n=e.getHook()}return await nt(this,$,"f").call(this,{name:"Publish",parentContext:t},async()=>{const e=n??nt(this,N,"f");({transactionHash:g}=await e(i,d??"0x")),g===undefined&&(g=await nt(this,s,"m",Q).call(this,h,{...i,rawTx:d}))}),(0,jt.projectLogger)("Publish successful",g),i=nt(this,s,"m",De).call(this,{transactionId:e,note:"TransactionController#approveTransaction - Transaction submitted"},e=>{e.hash=g,e.status=At.TransactionStatus.submitted,e.submittedTime=(new Date).getTime(),m&&(e.preTxBalance=p,(0,jt.projectLogger)("Updated pre-transaction balance",p))}),this.messagingSystem.publish(`${Jt}:transactionSubmitted`,{transactionMeta:i}),this.messagingSystem.publish(`${Jt}:transactionFinished`,i),nt(this,v,"f").emit(`${e}:finished`,i),nt(this,s,"m",ve).call(this,i),Xt.Approved}catch(e){return nt(this,s,"m",Qe).call(this,i,e),Xt.NotApproved}finally{r?.(),a?.()}},Q=async function(e,t,{skipSubmitHistory:n}={}){const r=await(0,at.query)(e,"sendRawTransaction",[t.rawTx]);return!0!==n&&nt(this,s,"m",Ve).call(this,t,r),r},ee=function(e,t,n){const r=nt(this,s,"m",ae).call(this,e);if(!r)return;nt(this,s,"m",Xe).call(this,e);const a={...r,status:At.TransactionStatus.rejected,error:(0,Wt.normalizeTxError)(n??ut.providerErrors.userRejectedRequest())};this.messagingSystem.publish(`${Jt}:transactionFinished`,a),nt(this,v,"f").emit(`${r.id}:finished`,a),this.messagingSystem.publish(`${Jt}:transactionRejected`,{transactionMeta:a,actionId:t}),nt(this,s,"m",ve).call(this,a)},te=function(e){const t=new Set,n=[...e].sort((e,t)=>e.time>t.time?-1:1).filter(e=>{const{chainId:n,status:r,txParams:a,time:i}=e;if(a){const e=`${String(a.nonce)}-${(0,at.convertHexToDecimal)(n)}-${new Date(i).toDateString()}`;if(t.has(e))return!0;if(t.size<nt(this,K,"f")||!nt(this,s,"m",ne).call(this,r))return t.add(e),!0}return!1});return n.reverse(),n},ne=function(e){return e===At.TransactionStatus.rejected||e===At.TransactionStatus.confirmed||e===At.TransactionStatus.failed},se=function(e){return[At.TransactionStatus.confirmed,At.TransactionStatus.failed,At.TransactionStatus.rejected,At.TransactionStatus.submitted].includes(e)},re=async function(e,{shouldShowRequest:t,traceContext:n}){const r=nt(this,s,"m",oe).call(this,e),{origin:a}=e,i=at.ApprovalType.Transaction,o={txId:e.id};return await nt(this,$,"f").call(this,{name:"Notification Display",id:r,parentContext:n}),await this.messagingSystem.call("ApprovalController:addRequest",{id:r,origin:a||at.ORIGIN_METAMASK,type:i,requestData:o,expectsResult:!0},t)},ae=function(e){const{transactions:t}=this.state;return t.find(({id:t})=>t===e)},ie=function(e,t="TransactionController"){const n=nt(this,s,"m",ae).call(this,e);if(!n)throw new Error(`${t}: No transaction found with id ${e}`);return n},oe=function(e){return String(e.id)},ce=function(e){const t=nt(this,s,"m",ae).call(this,e);if(!t)return{meta:undefined,isCompleted:!1};return{meta:t,isCompleted:nt(this,s,"m",se).call(this,t.status)}},ue=function(e){return nt(this,O,"f").getNetworkClient({networkClientId:e}).configuration.chainId},le=function({chainId:e,networkClientId:t}){return t||nt(this,O,"f").getNetworkClient({chainId:e}).id},de=function({chainId:e,networkClientId:t}){return new it.default(nt(this,s,"m",fe).call(this,{chainId:e,networkClientId:t}))},fe=function({chainId:e,networkClientId:t}){return nt(this,O,"f").getNetworkClient({chainId:e,networkClientId:t}).provider},he=function(e){if(!e.length)return;const t=[];for(const n of e){const{chainId:e}=n;try{const r=nt(this,s,"m",le).call(this,{chainId:e});t.push({...n,networkClientId:r})}catch(t){(0,jt.projectLogger)("Failed to get network client ID for incoming transaction",{chainId:e,error:t})}}this.update(e=>{const{transactions:n}=e;e.transactions=nt(this,s,"m",te).call(this,[...t,...n]),(0,jt.projectLogger)("Added incoming transactions to state",t.length,t)}),this.messagingSystem.publish(`${Jt}:incomingTransactionsReceived`,t)},pe=function(e,t){if(!t||t===at.ORIGIN_METAMASK)return undefined;const{gasPrice:n,maxFeePerGas:s,maxPriorityFeePerGas:r,gas:a}=e;if(n===undefined&&s===undefined&&r===undefined&&a===undefined)return undefined;const i={};return n!==undefined?i.gasPrice=n:s===undefined&&r===undefined||(i.maxFeePerGas=s,i.maxPriorityFeePerGas=r),a!==undefined&&(i.gas=a),i},me=function(e){const{chainId:t}=e,{transactions:n}=this.state,r=e?.txParams?.from,a=n.filter(e=>e.txParams.from===r&&e.chainId===t),i=a.filter(e=>e.status===At.TransactionStatus.confirmed),o=a.filter(e=>e.status===At.TransactionStatus.submitted);(0,Mt.validateConfirmedExternalTransaction)(e,i,o);const c=0!==(e.history??[]).length||nt(this,_,"f")?e:(0,Dt.addInitialHistorySnapshot)(e);return this.update(e=>{e.transactions=nt(this,s,"m",te).call(this,[...e.transactions,c])}),c},ge=function(e){const t=nt(this,s,"m",ae).call(this,e);if(!t)return;const n=t.txParams?.nonce,r=t.txParams?.from,{chainId:a}=t,i=this.state.transactions.filter(t=>t.id!==e&&t.txParams.from===r&&n&&t.txParams.nonce===n&&t.chainId===a&&t.type!==At.TransactionType.incoming),o=i.map(e=>e.id);if(0!==i.length){this.update(e=>{for(const n of e.transactions)o.includes(n.id)&&(n.replacedBy=t?.hash,n.replacedById=t?.id)});for(const e of this.state.transactions)o.includes(e.id)&&e.status!==At.TransactionStatus.failed&&nt(this,s,"m",be).call(this,e)}},be=function(e){const t={...e,status:At.TransactionStatus.dropped};this.messagingSystem.publish(`${Jt}:transactionDropped`,{transactionMeta:t}),this.updateTransaction(t,"TransactionController#setTransactionStatusDropped - Transaction dropped"),nt(this,s,"m",ve).call(this,t)},ye=function(e){return this.state.transactions.find(t=>e&&t.actionId===e)},we=async function(e){return new Promise(t=>{nt(this,v,"f").once(`${e}:finished`,e=>{t(e)})})},Te=function(e,t){const n=(0,ft.cloneDeep)(e);for(const e of["r","s","v"]){const s=t[e];s!==undefined&&null!==s&&(n[e]=(0,lt.add0x)(s.toString(16)))}return n},Ee=async function(e){const t=await nt(this,p,"f").call(this,e),n=await nt(this,h,"f").call(this);return t&&n},Se=async function(e){const{chainId:t,id:n,isExternalSign:r,txParams:i}=e;if(r)return(0,jt.projectLogger)("Skipping sign as signed externally"),undefined;const{authorizationList:c,from:u}=i,d=await(0,Ot.signAuthorizationList)({authorizationList:c,messenger:this.messagingSystem,transactionMeta:e});d&&nt(this,s,"m",De).call(this,{transactionId:n},e=>{e.txParams.authorizationList=d}),(0,jt.projectLogger)("Calling before sign hook",e);const{updateTransaction:h}=await nt(this,l,"f").call(this,{transactionMeta:e})??{};h&&(nt(this,s,"m",De).call(this,{transactionId:n,skipResimulateCheck:!0,note:"beforeSign Hook"},h),(0,jt.projectLogger)("Updated transaction after before sign hook"));const p=nt(this,s,"m",ie).call(this,n),{txParams:m}=p,g=(0,Ht.prepareTransaction)(t,m);nt(this,o,"f").add(n),(0,jt.projectLogger)("Signing transaction",m);const b=await new Promise((e,t)=>{nt(this,D,"f")?.call(this,g,u,...nt(this,f,"f").call(this,p)).then(e,t),nt(this,G,"f").set(n,()=>t(new Error("Signing aborted by user")))});if(nt(this,G,"f").delete(n),!b)return(0,jt.projectLogger)("Skipping signed status as no signed transaction"),undefined;const y=(0,ft.cloneDeep)(p);if(!nt(this,a,"f").call(this,y,b))return this.updateTransaction(y,"TransactionController#signTransaction - Update after sign"),(0,jt.projectLogger)("Skipping signed status based on hook"),undefined;const w={...nt(this,s,"m",Te).call(this,y,b),status:At.TransactionStatus.signed,txParams:m};this.updateTransaction(w,"TransactionController#approveTransaction - Transaction signed"),nt(this,s,"m",ve).call(this,w);const T=(0,Ht.serializeTransaction)(b),E=(0,ft.merge)({},w,{rawTx:T});return this.updateTransaction(E,"TransactionController#approveTransaction - RawTransaction added"),T},ve=function(e){this.messagingSystem.publish(`${Jt}:transactionStatusUpdated`,{transactionMeta:e})},ke=function(e,t,n){return(0,Ut.getAndFormatTransactionsForNonceTracker)(n,t,e,this.state.transactions)},Pe=function(e){(0,jt.projectLogger)("Processing confirmed transaction",e.id),nt(this,s,"m",ge).call(this,e.id),this.messagingSystem.publish(`${Jt}:transactionConfirmed`,e),nt(this,s,"m",ve).call(this,e),nt(this,s,"m",Ie).call(this,e).catch(e=>{throw(0,jt.projectLogger)("Error while updating post balance",e),e})},Ie=async function(e){try{const{networkClientId:t,type:n}=e;if(n!==At.TransactionType.swap)return;const r=nt(this,s,"m",de).call(this,{networkClientId:t}),{updatedTransactionMeta:a,approvalTransactionMeta:i}=await(0,Kt.updatePostTransactionBalance)(e,{ethQuery:r,getTransaction:nt(this,s,"m",ae).bind(this),updateTransaction:this.updateTransaction.bind(this)});this.messagingSystem.publish(`${Jt}:postTransactionBalanceUpdated`,{transactionMeta:a,approvalTransactionMeta:i})}catch(e){(0,jt.projectLogger)("Error while updating post transaction balance",e)}},_e=function({provider:e,blockTracker:t,chainId:n}){return new ct.NonceTracker({provider:e,blockTracker:t,getPendingTransactions:nt(this,s,"m",Me).bind(this,n),getConfirmedTransactions:nt(this,s,"m",ke).bind(this,[At.TransactionStatus.confirmed],n)})},xe=function({provider:e,blockTracker:t,chainId:n,networkClientId:r}){const a=new it.default(e),i=new It.PendingTransactionTracker({blockTracker:t,getChainId:()=>n,getEthQuery:()=>a,getNetworkClientId:()=>r,getTransactions:()=>this.state.transactions,isResubmitEnabled:nt(this,M,"f").isResubmitEnabled,getGlobalLock:()=>nt(this,O,"f").acquireNonceLockForChainIdKey({chainId:n}),messenger:this.messagingSystem,publishTransaction:(e,t)=>nt(this,s,"m",Q).call(this,e,t,{skipSubmitHistory:!0}),hooks:{beforeCheckPendingTransaction:nt(this,c,"f").bind(this)}});return nt(this,s,"m",Oe).call(this,i),i},Ae=function(){nt(this,O,"f").stopAllTracking()},Ce=function(e){e.hub.on("transactions",nt(this,s,"m",he).bind(this))},Re=function(e){e.hub.removeAllListeners("transaction-confirmed"),e.hub.removeAllListeners("transaction-dropped"),e.hub.removeAllListeners("transaction-failed"),e.hub.removeAllListeners("transaction-updated")},Oe=function(e){e.hub.on("transaction-confirmed",nt(this,s,"m",Pe).bind(this)),e.hub.on("transaction-dropped",nt(this,s,"m",be).bind(this)),e.hub.on("transaction-failed",nt(this,s,"m",Qe).bind(this)),e.hub.on("transaction-updated",this.updateTransaction.bind(this))},Me=function(e,t){return[...nt(this,s,"m",ke).call(this,[At.TransactionStatus.approved,At.TransactionStatus.signed,At.TransactionStatus.submitted],t,e),...nt(this,m,"f").call(this,t,e)]},Be=async function(e,t){try{return await nt(this,s,"m",Q).call(this,e,t)}catch(e){if(nt(this,s,"m",Ne).call(this,e))throw new Error("Previous transaction is already confirmed");throw e}},Ne=function(e){return e?.message?.includes("nonce too low")||e?.data?.message?.includes("nonce too low")},Fe=function(){return nt(this,H,"f")?[new Tt.TestGasFeeFlow]:[new yt.RandomisedEstimationsGasFeeFlow,new gt.LineaGasFeeFlow,new mt.DefaultGasFeeFlow]},Le=function(){return[new bt.OptimismLayer1GasFeeFlow,new wt.ScrollLayer1GasFeeFlow]},De=function({transactionId:e,note:t,skipHistory:n,skipValidation:r,skipResimulateCheck:a},i){let o;this.update(s=>{const c=s.transactions.findIndex(({id:t})=>t===e);if(-1===c)throw new Error(`Cannot update transaction as ID not found - ${e}`);let u=s.transactions[c];const l=(0,ft.cloneDeep)(u);u=i(u)??u,!0!==r&&(u.txParams=(0,Wt.normalizeTransactionParams)(u.txParams),(0,Vt.validateTxParams)(u.txParams)),!a&&nt(this,j,"f").call(this)&&(o=(0,_t.shouldResimulate)(l,u));nt(this,_,"f")||n||(u=(0,Dt.updateTransactionHistory)(u,t??"Transaction updated")),s.transactions[c]=u});const c=nt(this,s,"m",ae).call(this,e);return o?.resimulate&&nt(this,s,"m",Ue).call(this,c,{blockTime:o.blockTime}).catch(e=>{throw(0,jt.projectLogger)("Error during re-simulation",e),e}),c},Ge=async function(e,{traceContext:t}={}){if(!nt(this,I,"f").call(this))return;const{chainId:n,id:r,txParams:{to:a,from:i}}=e,o={chainId:(0,lt.hexToNumber)(n),to:a,from:i};(0,Vt.validateParamTo)(a);if(!this.state.transactions.find(e=>e.chainId===n&&e.txParams.from===i&&e.txParams.to===a&&e.id!==r))try{const{count:e}=await nt(this,$,"f").call(this,{name:"Account Address Relationship",parentContext:t},()=>(0,pt.getAccountAddressRelationship)(o)),n=e===undefined?undefined:0===e;if(!nt(this,s,"m",ae).call(this,r))return void(0,jt.projectLogger)("Cannot update first time interaction as transaction not found",r);nt(this,s,"m",De).call(this,{transactionId:r,note:"TransactionController#updateFirstInteraction - Update first time interaction"},e=>{e.isFirstTimeInteraction=n}),(0,jt.projectLogger)("Updated first time interaction",r,{isFirstTimeInteraction:n})}catch(e){(0,jt.projectLogger)("Error fetching account address relationship, skipping first time interaction update",e)}},Ue=async function(e,{blockTime:t,traceContext:n}={}){const{chainId:r,id:a,nestedTransactions:i,networkClientId:o,simulationData:c,txParams:u}=e;let l,d={error:{code:At.SimulationErrorCode.Disabled,message:"Simulation disabled"},tokenBalanceChanges:[]},f=[],h=!1;const p=nt(this,U,"f").has(a);if(nt(this,j,"f").call(this)&&!p){const a=await nt(this,$,"f").call(this,{name:"Simulate",parentContext:n},()=>(0,Ct.getBalanceChanges)({blockTime:t,chainId:r,ethQuery:nt(this,s,"m",de).call(this,{networkClientId:o}),getSimulationConfig:nt(this,T,"f"),nestedTransactions:i,txParams:u}));d=a.simulationData,l=a.gasUsed,t&&c&&(0,_t.hasSimulationDataChanged)(c,d)&&(d={...d,isUpdatedAfterSecurityCheck:!0});const p=await(0,Nt.getGasFeeTokens)({chainId:r,getSimulationConfig:nt(this,T,"f"),isEIP7702GasFeeTokensEnabled:nt(this,P,"f"),messenger:this.messagingSystem,publicKeyEIP7702:nt(this,B,"f"),transactionMeta:e});f=p?.gasFeeTokens??[],h=p?.isGasFeeSponsored??!1}if(!nt(this,s,"m",ae).call(this,a))return void(0,jt.projectLogger)("Cannot update simulation data as transaction not found",a,d);const m=nt(this,s,"m",De).call(this,{transactionId:a,note:"TransactionController#updateSimulationData - Update simulation data",skipResimulateCheck:Boolean(t)},e=>{e.gasFeeTokens=f,e.isGasFeeSponsored=h,e.gasUsed=l,p||(e.simulationData=d)});(0,jt.projectLogger)("Updated simulation data",a,m),await nt(this,s,"m",et).call(this,m)},He=function({transactionId:e,gasFeeEstimates:t,gasFeeEstimatesLoaded:n,layer1GasFee:r}){nt(this,s,"m",De).call(this,{transactionId:e,skipHistory:!0},e=>{(0,St.updateTransactionGasProperties)({txMeta:e,gasFeeEstimates:t,gasFeeEstimatesLoaded:n,isTxParamsGasFeeUpdatesEnabled:nt(this,k,"f"),layer1GasFee:r})})},$e=function({transactionBatchId:e,gasFeeEstimates:t}){nt(this,s,"m",Ke).call(this,e,e=>({...e,gasFeeEstimates:t}))},Ke=function(e,t){this.update(n=>{const s=n.transactionBatches.findIndex(t=>t.id===e);if(-1===s)throw new Error(`Cannot update batch, ID not found - ${e}`);const r=n.transactionBatches[s],a=t(r);n.transactionBatches[s]=a??r})},qe=function(){return this.messagingSystem.call("AccountsController:getSelectedAccount")},We=function(){const e=this.messagingSystem.call("AccountsController:getState");return Object.values(e.internalAccounts?.accounts??{}).filter(e=>"eip155:eoa"===e.type).map(e=>e.address)},Ve=function(e,t){const{chainId:n,networkClientId:s,origin:r,rawTx:a,txParams:i}=e,{networkConfigurationsByChainId:o}=nt(this,b,"f").call(this),c=o[n],u=c?.rpcEndpoints.find(e=>e.networkClientId===s),l=u?.url,d={chainId:n,hash:t,networkType:u?.name??s,networkUrl:l,origin:r,rawTransaction:a,time:Date.now(),transaction:i};(0,jt.projectLogger)("Updating submit history",d),this.update(e=>{const{submitHistory:t}=e;100===t.length&&t.pop(),t.unshift(d)})},ze=async function(e){const{chainId:t,networkClientId:n}=e,r=nt(this,O,"f").getNetworkClient({networkClientId:n}).configuration.type===ot.NetworkClientType.Custom,a=nt(this,s,"m",de).call(this,{networkClientId:n});await(0,Bt.updateGas)({chainId:t,ethQuery:a,isCustomNetwork:r,isSimulationEnabled:nt(this,j,"f").call(this),getSimulationConfig:nt(this,T,"f"),messenger:this.messagingSystem,txMeta:e})},Je=function(){this.messagingSystem.registerActionHandler(`${Jt}:confirmExternalTransaction`,this.confirmExternalTransaction.bind(this)),this.messagingSystem.registerActionHandler(`${Jt}:estimateGas`,this.estimateGas.bind(this)),this.messagingSystem.registerActionHandler(`${Jt}:getNonceLock`,this.getNonceLock.bind(this)),this.messagingSystem.registerActionHandler(`${Jt}:getTransactions`,this.getTransactions.bind(this)),this.messagingSystem.registerActionHandler(`${Jt}:updateCustodialTransaction`,this.updateCustodialTransaction.bind(this)),this.messagingSystem.registerActionHandler(`${Jt}:updateTransaction`,this.updateTransaction.bind(this))},Xe=function(e){this.update(t=>{const n=t.transactions.filter(({id:t})=>t!==e);t.transactions=nt(this,s,"m",te).call(this,n)})},Ye=function(e){return[ut.errorCodes.provider.userRejectedRequest,Vt.ErrorCode.RejectedUpgrade].includes(e.code)},Ze=function(e,t,n){if(nt(this,s,"m",ee).call(this,e,t,n),n.code===ut.errorCodes.provider.userRejectedRequest)throw ut.providerErrors.userRejectedRequest({message:"MetaMask Tx Signature: User denied transaction signature.",data:n?.data});throw n},Qe=function(e,t,n){let r;try{r=nt(this,s,"m",De).call(this,{transactionId:e.id,note:"TransactionController#failTransaction - Add error message and set status to failed",skipValidation:!0},e=>{e.status=At.TransactionStatus.failed,e.error=(0,Wt.normalizeTxError)(t)})}catch(n){(0,jt.projectLogger)("Failed to mark transaction as failed",n),r={...e,status:At.TransactionStatus.failed,error:(0,Wt.normalizeTxError)(t)}}this.messagingSystem.publish(`${Jt}:transactionFailed`,{actionId:n,error:t.message,transactionMeta:r}),nt(this,s,"m",ve).call(this,r),this.messagingSystem.publish(`${Jt}:transactionFinished`,r),nt(this,v,"f").emit(`${e.id}:finished`,r)},et=async function(e){(0,jt.projectLogger)("Calling afterSimulate hook",e);const{id:t}=e,n=await nt(this,i,"f").call(this,{transactionMeta:e}),{skipSimulation:r,updateTransaction:a}=n||{};if(r?nt(this,U,"f").add(t):!1===r&&nt(this,U,"f").delete(t),!a)return;const o=nt(this,s,"m",De).call(this,{transactionId:t,skipResimulateCheck:!0,note:"afterSimulate Hook"},e=>{e.txParamsOriginal=(0,ft.cloneDeep)(e.txParams),a(e)});(0,jt.projectLogger)("Updated transaction with afterSimulate data",o)}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/TransactionController.cjs"}],[2732,{"../errors.cjs":2735,"../logger.cjs":2755,"@metamask/controller-utils":1301,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getAccountTransactions=n.getAccountAddressRelationship=void 0;const s=e("@metamask/controller-utils"),r=e("@metamask/utils"),a=e("../errors.cjs"),i=e("../logger.cjs"),o="https://accounts.api.cx.metamask.io",c=`${o}/v1/accounts/`,u="x-metamask-clientproduct",l="metamask-transaction-controller",d=[1,10,56,137,8453,42161,59144,534352,1329],f=(0,r.createModuleLogger)(i.projectLogger,"accounts-api");n.getAccountAddressRelationship=async function(e){const{chainId:t,from:n,to:r}=e;if(!d.includes(t))throw f("Unsupported chain ID for account relationship API",t),new a.FirstTimeInteractionError("Unsupported chain ID");const i=`${o}/v1/networks/${t}/accounts/${n}/relationships/${r}`;f("Getting account address relationship",{request:e,url:i});const c={[u]:l},h=await(0,s.successfulFetch)(i,{headers:c});if(204===h.status)return{count:0};const p=await h.json();if(f("Retrieved account address relationship",p),p.error){const{code:e,message:t}=p.error;throw new a.FirstTimeInteractionError(t,e)}return p},n.getAccountTransactions=async function(e){const{address:t,chainIds:n,cursor:r,endTimestamp:a,sortDirection:i,startTimestamp:o,tags:d}=e;let h=`${c}${t}/transactions`;const p=[];if(n){const e=n.join(",");p.push(`networks=${e}`)}o&&p.push(`startTimestamp=${o}`),a&&p.push(`endTimestamp=${a}`),r&&p.push(`cursor=${r}`),i&&p.push(`sortDirection=${i}`),p.length&&(h+=`?${p.join("&")}`),f("Getting account transactions",{request:e,url:h});const m=[l,...d||[]].join("__"),g={[u]:m},b=await(0,s.successfulFetch)(h,{headers:g}),y=await b.json();return f("Retrieved account transactions",y),y}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/api/accounts-api.cjs"}],[2733,{"../constants.cjs":2734,"../errors.cjs":2735,"../logger.cjs":2755,"@metamask/controller-utils":1301,"@metamask/utils":2799,lodash:4534},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.simulateTransactions=void 0;const s=e("@metamask/controller-utils"),r=e("@metamask/utils"),a=e("lodash"),i=e("../constants.cjs"),o=e("../errors.cjs"),c=e("../logger.cjs"),u=(0,r.createModuleLogger)(c.projectLogger,"simulation-api"),l="networks";let d=0;function f(e){return"https://tx-sentinel-{0}.api.cx.metamask.io/".replace("{0}",e)}n.simulateTransactions=async function(e,t){let n=await async function(e){const t=await async function(){const e=`${f("ethereum-mainnet")}${l}`,t=await fetch(e);return t.json()}(),n=(0,s.convertHexToDecimal)(e),r=t[n];if(!r?.confirmations)throw u("Chain is not supported",e),new o.SimulationChainNotSupportedError(e);return f(r.network)}(e);const{newUrl:r,authorization:c}=await t.getSimulationConfig(n)||{};r&&(n=r);const h=d;d+=1;const p=function(e){const t=(0,a.cloneDeep)(e);for(const e of t.transactions){const n=e.to?.toLowerCase();i.DELEGATION_MANAGER_ADDRESSES.includes(n)&&(t.overrides=t.overrides||{},t.overrides[n]={code:i.CODE_DELEGATION_MANAGER_NO_SIGNATURE_ERRORS})}return t}(t);u("Sending request",n,t);const m={"Content-Type":"application/json"};c&&(m.Authorization=c);const g=await fetch(n,{method:"POST",headers:m,body:JSON.stringify({id:String(h),jsonrpc:"2.0",method:"infura_simulateTransactions",params:[p]})}),b=await g.json();if(u("Received response",b),b.error){const{code:e,message:t}=b.error;throw new o.SimulationError(t,e)}return b?.result}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/api/simulation-api.cjs"}],[2734,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.CODE_DELEGATION_MANAGER_NO_SIGNATURE_ERRORS=n.DELEGATION_MANAGER_ADDRESSES=n.ABI_IERC7821=n.ABI_SIMULATION_ERC721_LEGACY=n.ABI_SIMULATION_ERC20_WRAPPED=n.CHAIN_IDS=void 0,n.CHAIN_IDS={MAINNET:"0x1",GOERLI:"0x5",BASE:"0x2105",BASE_TESTNET:"0x14a33",BSC:"0x38",BSC_TESTNET:"0x61",OPTIMISM:"0xa",OPTIMISM_TESTNET:"0x1a4",OPBNB:"0xcc",OPBNB_TESTNET:"0x15eb",OPTIMISM_SEPOLIA:"0xaa37dc",POLYGON:"0x89",POLYGON_TESTNET:"0x13881",AVALANCHE:"0xa86a",AVALANCHE_TESTNET:"0xa869",FANTOM:"0xfa",FANTOM_TESTNET:"0xfa2",SEPOLIA:"0xaa36a7",LINEA_GOERLI:"0xe704",LINEA_SEPOLIA:"0xe705",LINEA_MAINNET:"0xe708",MOONBEAM:"0x504",MOONBEAM_TESTNET:"0x507",MOONRIVER:"0x505",GNOSIS:"0x64",ARBITRUM:"0xa4b1",ZKSYNC_ERA:"0x144",ZORA:"0x76adf1",SCROLL:"0x82750",SCROLL_SEPOLIA:"0x8274f",MEGAETH_TESTNET:"0x18c6",SEI:"0x531"},n.ABI_SIMULATION_ERC20_WRAPPED=[{anonymous:!1,inputs:[{indexed:!0,name:"to",type:"address"},{indexed:!1,name:"wad",type:"uint256"}],name:"Deposit",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!1,name:"wad",type:"uint256"}],name:"Withdrawal",type:"event"}],n.ABI_SIMULATION_ERC721_LEGACY=[{anonymous:!1,inputs:[{indexed:!1,name:"_from",type:"address"},{indexed:!1,name:"_to",type:"address"},{indexed:!1,name:"_tokenId",type:"uint256"}],name:"Transfer",type:"event"}],n.ABI_IERC7821=[{type:"function",name:"execute",inputs:[{name:"mode",type:"bytes32",internalType:"ModeCode"},{name:"executionData",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"supportsExecutionMode",inputs:[{name:"mode",type:"bytes32",internalType:"ModeCode"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"}],n.DELEGATION_MANAGER_ADDRESSES=["0xdb9b1e94b5b69df7e401ddbede43491141047db3"],n.CODE_DELEGATION_MANAGER_NO_SIGNATURE_ERRORS="0x608060405234801561001057600080fd5b506004361061012c5760003560e01c806383ebb771116100ad578063acb8cc4911610071578063acb8cc491461027f578063cef6d2091461029f578063e30c3978146102b2578063f2fde38b146102c3578063ffa1ad74146102d657600080fd5b806383ebb771146102065780638456cb591461020e57806384b0196e146102165780638da5cb5b14610231578063a3f4df7e1461024257600080fd5b806358909ebc116100f457806358909ebc146101b05780635c975abb146101d157806366134607146101e3578063715018a6146101f657806379ba5097146101fe57600080fd5b80631b13cac2146101315780632d40d0521461014d5780633ed01015146101805780633f4ba83a14610195578063499340471461019d575b600080fd5b61013a60001981565b6040519081526020015b60405180910390f35b61017061015b36600461207e565b60046020526000908152604090205460ff1681565b6040519015158152602001610144565b61019361018e366004612097565b6102fa565b005b6101936103f4565b6101936101ab366004612097565b610406565b6101b9610a1181565b6040516001600160a01b039091168152602001610144565b600154600160a01b900460ff16610170565b61013a6101f1366004612097565b6104f6565b61019361050f565b610193610521565b61013a61056a565b610193610579565b61021e610589565b6040516101449796959493929190612128565b6000546001600160a01b03166101b9565b610272604051806040016040528060118152602001702232b632b3b0ba34b7b726b0b730b3b2b960791b81525081565b60405161014491906121c1565b610272604051806040016040528060018152602001603160f81b81525081565b6101936102ad36600461221f565b6105cf565b6001546001600160a01b03166101b9565b6101936102d13660046122d4565b611829565b610272604051806040016040528060058152602001640312e332e360dc1b81525081565b61030a60408201602083016122d4565b6001600160a01b03811633146103335760405163b9f0f17160e01b815260040160405180910390fd5b600061033e836104f6565b60008181526004602052604090205490915060ff1661037057604051637952fbad60e11b815260040160405180910390fd5b6000818152600460209081526040909120805460ff19169055610395908401846122d4565b6001600160a01b03166103ae60408501602086016122d4565b6001600160a01b0316827f3feadce88fc1b49db633a56fd5307ed6ee18734df83bcc4011daa720c9cd95f1866040516103e7919061241c565b60405180910390a4505050565b6103fc61189a565b6104046118c7565b565b61041660408201602083016122d4565b6001600160a01b038116331461043f5760405163b9f0f17160e01b815260040160405180910390fd5b600061044a836104f6565b60008181526004602052604090205490915060ff161561047c57604051625ecddb60e01b815260040160405180910390fd5b6000818152600460209081526040909120805460ff191660011790556104a4908401846122d4565b6001600160a01b03166104bd60408501602086016122d4565b6001600160a01b0316827fea589ba9473ee1fe77d352c7ed919747715a5d22931b972de9b02a907c66d5dd866040516103e7919061241c565b6000610509610504836127bb565b61191c565b92915050565b61051761189a565b61040460006119b7565b60015433906001600160a01b0316811461055e5760405163118cdaa760e01b81526001600160a01b03821660048201526024015b60405180910390fd5b610567816119b7565b50565b60006105746119d0565b905090565b61058161189a565b610404611afb565b60006060806000806000606061059d611b3e565b6105a5611b6b565b60408051600080825260208201909252600f60f81b9b939a50919850469750309650945092509050565b6105d7611b98565b8481811415806105e75750808414155b1561060557604051631bcaf69f60e01b815260040160405180910390fd5b6000816001600160401b0381111561061f5761061f6124ed565b60405190808252806020026020018201604052801561065257816020015b606081526020019060019003908161063d5790505b5090506000826001600160401b0381111561066f5761066f6124ed565b6040519080825280602002602001820160405280156106a257816020015b606081526020019060019003908161068d5790505b50905060005b83811015610c195760008a8a838181106106c4576106c46127c7565b90506020028101906106d691906127dd565b8101906106e39190612823565b905080516000036107d1576040805160008082526020820190925290610765565b6107526040518060c0016040528060006001600160a01b0316815260200160006001600160a01b03168152602001600080191681526020016060815260200160008152602001606081525090565b8152602001906001900390816107045790505b50848381518110610778576107786127c7565b602090810291909101015260006040519080825280602002602001820160405280156107ae578160200160208202803683370190505b508383815181106107c1576107c16127c7565b6020026020010181905250610c10565b808483815181106107e4576107e46127c7565b6020026020010181905250600081516001600160401b0381111561080a5761080a6124ed565b604051908082528060200260200182016040528015610833578160200160208202803683370190505b50905080848481518110610849576108496127c7565b6020026020010181905250336001600160a01b031682600081518110610871576108716127c7565b6020026020010151600001516001600160a01b0316141580156108c65750610a116001600160a01b0316826000815181106108ae576108ae6127c7565b6020026020010151600001516001600160a01b031614155b156108e457604051632d618d8160e21b815260040160405180910390fd5b60005b8251811015610a4d576000838281518110610904576109046127c7565b602002602001015190506109178161191c565b838381518110610929576109296127c7565b60200260200101818152505080602001516001600160a01b03163b6000036109a657600061099e61099461095b61056a565b86868151811061096d5761096d6127c7565b602002602001015160405161190160f01b8152600281019290925260228201526042902090565b8360a00151611bc3565b905050610a44565b60006109c56109b361056a565b85858151811061096d5761096d6127c7565b9050600082602001516001600160a01b0316631626ba7e838560a001516040518363ffffffff1660e01b81526004016109ff9291906128d3565b602060405180830381865afa158015610a1c573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610a4091906128f4565b5050505b506001016108e7565b5060005b8251811015610c0d5760046000838381518110610a7057610a706127c7565b60209081029190910181015182528101919091526040016000205460ff1615610aac576040516302dd502960e11b815260040160405180910390fd5b60018351610aba9190612934565b8114610bc35781610acc826001612947565b81518110610adc57610adc6127c7565b6020026020010151838281518110610af657610af66127c7565b60200260200101516040015114610b2057604051636f6a1b8760e11b815260040160405180910390fd5b600083610b2e836001612947565b81518110610b3e57610b3e6127c7565b6020026020010151600001519050610a116001600160a01b0316816001600160a01b031614158015610b9f5750806001600160a01b0316848381518110610b8757610b876127c7565b6020026020010151602001516001600160a01b031614155b15610bbd57604051632d618d8160e21b815260040160405180910390fd5b50610c05565b60001960001b838281518110610bdb57610bdb6127c7565b60200260200101516040015114610c0557604051636f6a1b8760e11b815260040160405180910390fd5b600101610a51565b50505b506001016106a8565b5060005b83811015610e3e576000838281518110610c3957610c396127c7565b6020026020010151511115610e365760005b838281518110610c5d57610c5d6127c7565b602002602001015151811015610e34576000848381518110610c8157610c816127c7565b60200260200101518281518110610c9a57610c9a6127c7565b602002602001015160600151905060005b8151811015610e2a576000828281518110610cc857610cc86127c7565b6020026020010151600001519050806001600160a01b031663414c3e33848481518110610cf757610cf76127c7565b602002602001015160200151858581518110610d1557610d156127c7565b6020026020010151604001518f8f8a818110610d3357610d336127c7565b905060200201358e8e8b818110610d4c57610d4c6127c7565b9050602002810190610d5e91906127dd565b8c8c81518110610d7057610d706127c7565b60200260200101518b81518110610d8957610d896127c7565b60200260200101518e8d81518110610da357610da36127c7565b60200260200101518c81518110610dbc57610dbc6127c7565b602002602001015160200151336040518963ffffffff1660e01b8152600401610dec98979695949392919061295a565b600060405180830381600087803b158015610e0657600080fd5b505af1158015610e1a573d6000803e3d6000fd5b5050505050806001019050610cab565b5050600101610c4b565b505b600101610c1d565b5060005b8381101561146257828181518110610e5c57610e5c6127c7565b602002602001015151600003610f1a573363d691c964898984818110610e8457610e846127c7565b90506020020135888885818110610e9d57610e9d6127c7565b9050602002810190610eaf91906127dd565b6040518463ffffffff1660e01b8152600401610ecd939291906129c5565b6000604051808303816000875af1158015610eec573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f19168201604052610f1491908101906129e8565b5061145a565b60005b838281518110610f2f57610f2f6127c7565b602002602001015151811015611106576000848381518110610f5357610f536127c7565b60200260200101518281518110610f6c57610f6c6127c7565b602002602001015160600151905060005b81518110156110fc576000828281518110610f9a57610f9a6127c7565b6020026020010151600001519050806001600160a01b031663a145832a848481518110610fc957610fc96127c7565b602002602001015160200151858581518110610fe757610fe76127c7565b6020026020010151604001518f8f8a818110611005576110056127c7565b905060200201358e8e8b81811061101e5761101e6127c7565b905060200281019061103091906127dd565b8c8c81518110611042576110426127c7565b60200260200101518b8151811061105b5761105b6127c7565b60200260200101518e8d81518110611075576110756127c7565b60200260200101518c8151811061108e5761108e6127c7565b602002602001015160200151336040518963ffffffff1660e01b81526004016110be98979695949392919061295a565b600060405180830381600087803b1580156110d857600080fd5b505af11580156110ec573d6000803e3d6000fd5b5050505050806001019050610f7d565b5050600101610f1d565b50828181518110611119576111196127c7565b60200260200101516001848381518110611135576111356127c7565b6020026020010151516111489190612934565b81518110611158576111586127c7565b6020026020010151602001516001600160a01b031663d691c964898984818110611184576111846127c7565b9050602002013588888581811061119d5761119d6127c7565b90506020028101906111af91906127dd565b6040518463ffffffff1660e01b81526004016111cd939291906129c5565b6000604051808303816000875af11580156111ec573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f1916820160405261121491908101906129e8565b506000838281518110611229576112296127c7565b60200260200101515190505b801561145857600084838151811061124f5761124f6127c7565b60200260200101516001836112649190612934565b81518110611274576112746127c7565b60200260200101516060015190506000815190505b80156114455760008261129d600184612934565b815181106112ad576112ad6127c7565b6020026020010151600001519050806001600160a01b031663d3eddcc5846001856112d89190612934565b815181106112e8576112e86127c7565b602002602001015160200151856001866113029190612934565b81518110611312576113126127c7565b6020026020010151604001518f8f8a818110611330576113306127c7565b905060200201358e8e8b818110611349576113496127c7565b905060200281019061135b91906127dd565b8c8c8151811061136d5761136d6127c7565b602002602001015160018c6113829190612934565b81518110611392576113926127c7565b60200260200101518e8d815181106113ac576113ac6127c7565b602002602001015160018d6113c19190612934565b815181106113d1576113d16127c7565b602002602001015160200151336040518963ffffffff1660e01b815260040161140198979695949392919061295a565b600060405180830381600087803b15801561141b57600080fd5b505af115801561142f573d6000803e3d6000fd5b50505050508061143e90612ac7565b9050611289565b50508061145190612ac7565b9050611235565b505b600101610e42565b5060005b838110156116de576000838281518110611482576114826127c7565b60200260200101515111156116d65760008382815181106114a5576114a56127c7565b60200260200101515190505b80156116d45760008483815181106114cb576114cb6127c7565b60200260200101516001836114e09190612934565b815181106114f0576114f06127c7565b60200260200101516060015190506000815190505b80156116c157600082611519600184612934565b81518110611529576115296127c7565b6020026020010151600001519050806001600160a01b031663ed463367846001856115549190612934565b81518110611564576115646127c7565b6020026020010151602001518560018661157e9190612934565b8151811061158e5761158e6127c7565b6020026020010151604001518f8f8a8181106115ac576115ac6127c7565b905060200201358e8e8b8181106115c5576115c56127c7565b90506020028101906115d791906127dd565b8c8c815181106115e9576115e96127c7565b602002602001015160018c6115fe9190612934565b8151811061160e5761160e6127c7565b60200260200101518e8d81518110611628576116286127c7565b602002602001015160018d61163d9190612934565b8151811061164d5761164d6127c7565b602002602001015160200151336040518963ffffffff1660e01b815260040161167d98979695949392919061295a565b600060405180830381600087803b15801561169757600080fd5b505af11580156116ab573d6000803e3d6000fd5b5050505050806116ba90612ac7565b9050611505565b5050806116cd90612ac7565b90506114b1565b505b600101611466565b5060005b8381101561181d5760008382815181106116fe576116fe6127c7565b60200260200101515111156118155760005b838281518110611722576117226127c7565b60200260200101515181101561181357336001600160a01b031684838151811061174e5761174e6127c7565b6020026020010151600186858151811061176a5761176a6127c7565b60200260200101515161177d9190612934565b8151811061178d5761178d6127c7565b6020026020010151602001516001600160a01b03167f40dadaa36c6c2e3d7317e24757451ffb2d603d875f0ad5e92c5dd156573b18738685815181106117d5576117d56127c7565b602002602001015184815181106117ee576117ee6127c7565b60200260200101516040516118039190612ade565b60405180910390a3600101611710565b505b6001016116e2565b50505050505050505050565b61183161189a565b600180546001600160a01b0383166001600160a01b031990911681179091556118626000546001600160a01b031690565b6001600160a01b03167f38d16b8cac22d99fc7c124b9cd0de2d3fa1faef420bfe791d8c362d765e2270060405160405180910390a350565b6000546001600160a01b031633146104045760405163118cdaa760e01b8152336004820152602401610555565b6118cf611bed565b6001805460ff60a01b191690557f5db9ee0a495bf2e6ff9c91a7834c1ba4fdd244a5e8aa4e537bd38aeae4b073aa335b6040516001600160a01b03909116815260200160405180910390a1565b6000807f88c1d2ecf185adf710588203a5f263f0ff61be0d33da39792cde19ba9aa4331e83600001518460200151856040015161195c8760600151611c17565b6080808901516040805160208101989098526001600160a01b03968716908801529490931660608601529184015260a083015260c082015260e0015b60408051601f1981840301815291905280516020909101209392505050565b600180546001600160a01b031916905561056781611ce2565b6000306001600160a01b037f000000000000000000000000000000000000000000000000000000000000000016148015611a2957507f000000000000000000000000000000000000000000000000000000000000000046145b15611a5357507f000000000000000000000000000000000000000000000000000000000000000090565b610574604080517f8b73c3c69bb8fe3d512ecc4cf759cc79239f7b179b0ffacaa9a75d522b39400f60208201527f0000000000000000000000000000000000000000000000000000000000000000918101919091527f000000000000000000000000000000000000000000000000000000000000000060608201524660808201523060a082015260009060c00160405160208183030381529060405280519060200120905090565b611b03611b98565b6001805460ff60a01b1916600160a01b1790557f62e78cea01bee320cd4e420270b5ea74000d11b0c9f74754ebdbfc544b05a2586118ff3390565b60606105747f00000000000000000000000000000000000000000000000000000000000000006002611d32565b60606105747f00000000000000000000000000000000000000000000000000000000000000006003611d32565b600154600160a01b900460ff16156104045760405163d93c066560e01b815260040160405180910390fd5b600080600080611bd38686611ddd565b925092509250611be38282611e2a565b5090949350505050565b600154600160a01b900460ff1661040457604051638dfc202b60e01b815260040160405180910390fd5b60008082516001600160401b03811115611c3357611c336124ed565b604051908082528060200260200182016040528015611c5c578160200160208202803683370190505b50905060005b8351811015611cb257611c8d848281518110611c8057611c806127c7565b6020026020010151611ee7565b828281518110611c9f57611c9f6127c7565b6020908102919091010152600101611c62565b5080604051602001611cc49190612bcb565b60405160208183030381529060405280519060200120915050919050565b600080546001600160a01b038381166001600160a01b0319831681178455604051919092169283917f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e09190a35050565b606060ff8314611d4c57611d4583611f48565b9050610509565b818054611d5890612c01565b80601f0160208091040260200160405190810160405280929190818152602001828054611d8490612c01565b8015611dd15780601f10611da657610100808354040283529160200191611dd1565b820191906000526020600020905b815481529060010190602001808311611db457829003601f168201915b50505050509050610509565b60008060008351604103611e175760208401516040850151606086015160001a611e0988828585611f87565b955095509550505050611e23565b50508151600091506002905b9250925092565b6000826003811115611e3e57611e3e612c3b565b03611e47575050565b6001826003811115611e5b57611e5b612c3b565b03611e795760405163f645eedf60e01b815260040160405180910390fd5b6002826003811115611e8d57611e8d612c3b565b03611eae5760405163fce698f760e01b815260048101829052602401610555565b6003826003811115611ec257611ec2612c3b565b03611ee3576040516335e2f38360e21b815260048101829052602401610555565b5050565b6000807f80ad7e1b04ee6d994a125f4714ca0720908bd80ed16063ec8aee4b88e9253e2d8360000151846020015180519060200120604051602001611998939291909283526001600160a01b03919091166020830152604082015260600190565b60606000611f5583612056565b604080516020808252818301909252919250600091906020820181803683375050509182525060208101929092525090565b600080807f7fffffffffffffffffffffffffffffff5d576e7357a4501ddfe92f46681b20a0841115611fc2575060009150600390508261204c565b604080516000808252602082018084528a905260ff891692820192909252606081018790526080810186905260019060a0016020604051602081039080840390855afa158015612016573d6000803e3d6000fd5b5050604051601f1901519150506001600160a01b0381166120425750600092506001915082905061204c565b9250600091508190505b9450945094915050565b600060ff8216601f81111561050957604051632cd44ac360e21b815260040160405180910390fd5b60006020828403121561209057600080fd5b5035919050565b6000602082840312156120a957600080fd5b81356001600160401b038111156120bf57600080fd5b820160c081850312156120d157600080fd5b9392505050565b60005b838110156120f35781810151838201526020016120db565b50506000910152565b600081518084526121148160208601602086016120d8565b601f01601f19169290920160200192915050565b60ff60f81b881681526000602060e0602084015261214960e084018a6120fc565b838103604085015261215b818a6120fc565b606085018990526001600160a01b038816608086015260a0850187905284810360c08601528551808252602080880193509091019060005b818110156121af57835183529284019291840191600101612193565b50909c9b505050505050505050505050565b6020815260006120d160208301846120fc565b60008083601f8401126121e657600080fd5b5081356001600160401b038111156121fd57600080fd5b6020830191508360208260051b850101111561221857600080fd5b9250929050565b6000806000806000806060878903121561223857600080fd5b86356001600160401b038082111561224f57600080fd5b61225b8a838b016121d4565b9098509650602089013591508082111561227457600080fd5b6122808a838b016121d4565b9096509450604089013591508082111561229957600080fd5b506122a689828a016121d4565b979a9699509497509295939492505050565b80356001600160a01b03811681146122cf57600080fd5b919050565b6000602082840312156122e657600080fd5b6120d1826122b8565b6000808335601e1984360301811261230657600080fd5b83016020810192503590506001600160401b0381111561232557600080fd5b80360382131561221857600080fd5b81835281816020850137506000828201602090810191909152601f909101601f19169091010190565b60008383855260208086019550808560051b830101846000805b8881101561240e57858403601f19018a52823536899003605e1901811261239c578283fd5b880160606001600160a01b036123b1836122b8565b1686526123c0878301836122ef565b82898901526123d28389018284612334565b9250505060406123e4818401846122ef565b9350878303828901526123f8838583612334565b9d89019d97505050938601935050600101612377565b509198975050505050505050565b6020815260006001600160a01b0380612434856122b8565b16602084015280612447602086016122b8565b16604084015250604083013560608301526060830135601e1984360301811261246f57600080fd5b83016020810190356001600160401b0381111561248b57600080fd5b8060051b360382131561249d57600080fd5b60c060808501526124b260e08501828461235d565b915050608084013560a08401526124cc60a08501856122ef565b848303601f190160c08601526124e3838284612334565b9695505050505050565b634e487b7160e01b600052604160045260246000fd5b604051606081016001600160401b0381118282101715612525576125256124ed565b60405290565b60405160c081016001600160401b0381118282101715612525576125256124ed565b604051601f8201601f191681016001600160401b0381118282101715612575576125756124ed565b604052919050565b60006001600160401b03821115612596576125966124ed565b5060051b60200190565b60006001600160401b038211156125b9576125b96124ed565b50601f01601f191660200190565b600082601f8301126125d857600080fd5b81356125eb6125e6826125a0565b61254d565b81815284602083860101111561260057600080fd5b816020850160208301376000918101602001919091529392505050565b600082601f83011261262e57600080fd5b8135602061263e6125e68361257d565b82815260059290921b8401810191818101908684111561265d57600080fd5b8286015b8481101561270c5780356001600160401b03808211156126815760008081fd5b908801906060828b03601f190181131561269b5760008081fd5b6126a3612503565b6126ae8885016122b8565b8152604080850135848111156126c45760008081fd5b6126d28e8b838901016125c7565b838b0152509184013591838311156126ea5760008081fd5b6126f88d8a858801016125c7565b908201528652505050918301918301612661565b509695505050505050565b600060c0828403121561272957600080fd5b61273161252b565b905061273c826122b8565b815261274a602083016122b8565b60208201526040820135604082015260608201356001600160401b038082111561277357600080fd5b61277f8583860161261d565b60608401526080840135608084015260a08401359150808211156127a257600080fd5b506127af848285016125c7565b60a08301525092915050565b60006105093683612717565b634e487b7160e01b600052603260045260246000fd5b6000808335601e198436030181126127f457600080fd5b8301803591506001600160401b0382111561280e57600080fd5b60200191503681900382131561221857600080fd5b6000602080838503121561283657600080fd5b82356001600160401b038082111561284d57600080fd5b818501915085601f83011261286157600080fd5b813561286f6125e68261257d565b81815260059190911b8301840190848101908883111561288e57600080fd5b8585015b838110156128c6578035858111156128aa5760008081fd5b6128b88b89838a0101612717565b845250918601918601612892565b5098975050505050505050565b8281526040602082015260006128ec60408301846120fc565b949350505050565b60006020828403121561290657600080fd5b81516001600160e01b0319811681146120d157600080fd5b634e487b7160e01b600052601160045260246000fd5b818103818111156105095761050961291e565b808201808211156105095761050961291e565b60e08152600061296d60e083018b6120fc565b828103602084015261297f818b6120fc565b9050886040840152828103606084015261299a81888a612334565b608084019690965250506001600160a01b0392831660a0820152911660c09091015295945050505050565b8381526040602082015260006129df604083018486612334565b95945050505050565b600060208083850312156129fb57600080fd5b82516001600160401b0380821115612a1257600080fd5b818501915085601f830112612a2657600080fd5b8151612a346125e68261257d565b81815260059190911b83018401908481019088831115612a5357600080fd5b8585015b838110156128c657805185811115612a6f5760008081fd5b8601603f81018b13612a815760008081fd5b878101516040612a936125e6836125a0565b8281528d82848601011115612aa85760008081fd5b612ab7838c83018487016120d8565b8652505050918601918601612a57565b600081612ad657612ad661291e565b506000190190565b602080825282516001600160a01b0390811683830152838201518116604080850191909152808501516060808601919091528086015160c06080870152805160e0870181905260009594610100600583901b8901810195919493870193919290890190885b81811015612b9d5760ff198b8903018352855187815116895289810151858b8b0152612b71868b01826120fc565b918701518a83038b890152919050612b8981836120fc565b995050509488019491880191600101612b43565b50505050505050608085015160a085015260a08501519150601f198482030160c08501526129df81836120fc565b815160009082906020808601845b83811015612bf557815185529382019390820190600101612bd9565b50929695505050505050565b600181811c90821680612c1557607f821691505b602082108103612c3557634e487b7160e01b600052602260045260246000fd5b50919050565b634e487b7160e01b600052602160045260246000fdfea264697066735822122073f8fd2b36b643aff6f988638bc7c8ab2f41546c01a777524170b479e36618c564736f6c63430008170033"}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/constants.cjs"}],[2735,{"./types.cjs":2756},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SimulationRevertedError=n.SimulationInvalidResponseError=n.SimulationChainNotSupportedError=n.FirstTimeInteractionError=n.SimulationError=void 0;const s=e("./types.cjs");class r extends Error{constructor(e,t){super(e??"Simulation failed"),this.code=t}}n.SimulationError=r;class a extends Error{constructor(e,t){super(e??"Error checking first time interaction"),this.code=t}}n.FirstTimeInteractionError=a;n.SimulationChainNotSupportedError=class extends r{constructor(e){super(`Chain is not supported: ${e}`,s.SimulationErrorCode.ChainNotSupported)}};n.SimulationInvalidResponseError=class extends r{constructor(){super("Invalid response from simulation API",s.SimulationErrorCode.InvalidResponse)}};n.SimulationRevertedError=class extends r{constructor(){super("Transaction was reverted",s.SimulationErrorCode.Reverted)}}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/errors.cjs"}],[2736,{"../logger.cjs":2755,"../types.cjs":2756,"../utils/gas-fees.cjs":2763,"@metamask/gas-fee-controller":1919,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,a,i,o,c,u=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.DefaultGasFeeFlow=void 0;const l=e("@metamask/gas-fee-controller"),d=e("@metamask/utils"),f=e("../logger.cjs"),h=e("../types.cjs"),p=e("../utils/gas-fees.cjs"),m=(0,d.createModuleLogger)(f.projectLogger,"default-gas-fee-flow");n.DefaultGasFeeFlow=class{constructor(){s.add(this)}matchesTransaction(){return!0}async getGasFees(e){const{gasFeeControllerData:t}=e,{gasEstimateType:n,gasFeeEstimates:o}=t;let c;switch(n){case l.GAS_ESTIMATE_TYPES.FEE_MARKET:m("Using fee market estimates",o),c=u(this,s,"m",r).call(this,o);break;case l.GAS_ESTIMATE_TYPES.LEGACY:m("Using legacy estimates",o),c=u(this,s,"m",a).call(this,o);break;case l.GAS_ESTIMATE_TYPES.ETH_GASPRICE:m("Using eth_gasPrice estimates",o),c=u(this,s,"m",i).call(this,o);break;default:throw new Error(`Unsupported gas estimate type: ${n}`)}return{estimates:c}}},s=new WeakSet,r=function(e){const t=Object.values(h.GasFeeEstimateLevel).reduce((t,n)=>({...t,[n]:u(this,s,"m",o).call(this,e,n)}),{});return{type:h.GasFeeEstimateType.FeeMarket,...t}},a=function(e){const t=Object.values(h.GasFeeEstimateLevel).reduce((t,n)=>({...t,[n]:u(this,s,"m",c).call(this,e,n)}),{});return{type:h.GasFeeEstimateType.Legacy,...t}},i=function(e){return{type:h.GasFeeEstimateType.GasPrice,gasPrice:(0,p.gweiDecimalToWeiHex)(e.gasPrice)}},o=function(e,t){return{maxFeePerGas:(0,p.gweiDecimalToWeiHex)(e[t].suggestedMaxFeePerGas),maxPriorityFeePerGas:(0,p.gweiDecimalToWeiHex)(e[t].suggestedMaxPriorityFeePerGas)}},c=function(e,t){return(0,p.gweiDecimalToWeiHex)(e[t])}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/gas-flows/DefaultGasFeeFlow.cjs"}],[2737,{"../logger.cjs":2755,"../types.cjs":2756,"./DefaultGasFeeFlow.cjs":2736,"@metamask/controller-utils":1301,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,a,i,o,c,u=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.LineaGasFeeFlow=void 0;const l=e("@metamask/controller-utils"),d=e("@metamask/utils"),f=e("./DefaultGasFeeFlow.cjs"),h=e("../logger.cjs"),p=e("../types.cjs"),m=(0,d.createModuleLogger)(h.projectLogger,"linea-gas-fee-flow"),g=[l.ChainId["linea-mainnet"],l.ChainId["linea-goerli"],l.ChainId["linea-sepolia"]],b={low:1,medium:1.35,high:1.7},y={low:1,medium:1.05,high:1.1};n.LineaGasFeeFlow=class{constructor(){s.add(this)}matchesTransaction({transactionMeta:e}){return g.includes(e.chainId)}async getGasFees(e){try{return await u(this,s,"m",r).call(this,e)}catch(t){return m("Using default flow as fallback due to error",t),(new f.DefaultGasFeeFlow).getGasFees(e)}}},s=new WeakSet,r=async function(e){const{ethQuery:t,transactionMeta:n}=e,r=await u(this,s,"m",a).call(this,n,t);m("Received Linea response",r);const d=u(this,s,"m",i).call(this,r.baseFeePerGas,b);m("Generated base fees",u(this,s,"m",c).call(this,d));const f=u(this,s,"m",i).call(this,r.priorityFeePerGas,y);m("Generated priority fees",u(this,s,"m",c).call(this,f));const h=u(this,s,"m",o).call(this,d,f);m("Generated max fees",u(this,s,"m",c).call(this,h));return{estimates:Object.values(p.GasFeeEstimateLevel).reduce((e,t)=>({...e,[t]:{maxFeePerGas:(0,l.toHex)(h[t]),maxPriorityFeePerGas:(0,l.toHex)(f[t])}}),{type:p.GasFeeEstimateType.FeeMarket})}},a=function(e,t){return(0,l.query)(t,"linea_estimateGas",[{from:e.txParams.from,to:e.txParams.to,value:e.txParams.value,input:e.txParams.data}])},i=function(e,t){const n=(0,l.hexToBN)(e);return{low:n.muln(t.low),medium:n.muln(t.medium),high:n.muln(t.high)}},o=function(e,t){return{low:e.low.add(t.low),medium:e.medium.add(t.medium),high:e.high.add(t.high)}},c=function(e){return Object.values(p.GasFeeEstimateLevel).map(t=>e[t].toString(10))}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/gas-flows/LineaGasFeeFlow.cjs"}],[2738,{"../constants.cjs":2734,"./OracleLayer1GasFeeFlow.cjs":2739},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.OptimismLayer1GasFeeFlow=void 0;const s=e("./OracleLayer1GasFeeFlow.cjs"),r=e("../constants.cjs"),a=[r.CHAIN_IDS.OPTIMISM,r.CHAIN_IDS.OPTIMISM_TESTNET,r.CHAIN_IDS.BASE,r.CHAIN_IDS.BASE_TESTNET,r.CHAIN_IDS.OPBNB,r.CHAIN_IDS.OPBNB_TESTNET,r.CHAIN_IDS.ZORA];class i extends s.OracleLayer1GasFeeFlow{constructor(){super("0x420000000000000000000000000000000000000F")}matchesTransaction({transactionMeta:e}){return a.includes(e.chainId)}}n.OptimismLayer1GasFeeFlow=i}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/gas-flows/OptimismLayer1GasFeeFlow.cjs"}],[2739,{"../logger.cjs":2755,"../utils/prepare.cjs":2769,"@ethersproject/contracts":654,"@ethersproject/providers":692,"@metamask/utils":2799,buffer:3760},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){var s,r,a,i,o,c,u=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},l=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.OracleLayer1GasFeeFlow=void 0;const d=e("@ethersproject/contracts"),f=e("@ethersproject/providers"),h=e("@metamask/utils"),p=e("../logger.cjs"),m=e("../utils/prepare.cjs"),g=(0,h.createModuleLogger)(p.projectLogger,"oracle-layer1-gas-fee-flow"),b=[{inputs:[{internalType:"bytes",name:"_data",type:"bytes"}],name:"getL1Fee",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"}];n.OracleLayer1GasFeeFlow=class{constructor(e,t){s.add(this),r.set(this,void 0),a.set(this,void 0),u(this,r,e,"f"),u(this,a,t??!1,"f")}async getLayer1Fee(e){try{return await l(this,s,"m",i).call(this,e)}catch(e){throw g("Failed to get oracle layer 1 gas fee",e),new Error("Failed to get oracle layer 1 gas fee")}}},r=new WeakMap,a=new WeakMap,s=new WeakSet,i=async function(e){const{provider:t,transactionMeta:n}=e,i=new d.Contract(l(this,r,"f"),b,new f.Web3Provider(t)),c=l(this,s,"m",o).call(this,n,l(this,a,"f")).serialize(),u=await i.getL1Fee(c);if(u===undefined)throw new Error("No value returned from oracle contract");return{layer1Fee:u.toHexString()}},o=function(e,n){const r=l(this,s,"m",c).call(this,e),{chainId:a}=e;let i=(0,m.prepareTransaction)(a,r);if(n){const e=t.from("abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789","hex");i=i.sign(e)}return i},c=function(e){return{...e.txParams,gasLimit:e.txParams.gas}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/gas-flows/OracleLayer1GasFeeFlow.cjs"}],[2740,{"../logger.cjs":2755,"../types.cjs":2756,"../utils/feature-flags.cjs":2761,"../utils/gas-fees.cjs":2763,"./DefaultGasFeeFlow.cjs":2736,"@metamask/gas-fee-controller":1919,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,a,i,o,c=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.randomiseDecimalGWEIAndConvertToHex=n.RandomisedEstimationsGasFeeFlow=void 0;const u=e("@metamask/gas-fee-controller"),l=e("@metamask/utils"),d=e("./DefaultGasFeeFlow.cjs"),f=e("../logger.cjs"),h=e("../types.cjs"),p=e("../utils/feature-flags.cjs"),m=e("../utils/gas-fees.cjs"),g=(0,l.createModuleLogger)(f.projectLogger,"randomised-estimation-gas-fee-flow");function b(e,t,n){const s=(0,m.gweiDecimalToWeiDecimal)(e),r=s.length,a=Math.min(t,r-n);if(0===Number(s)||a<=0)return`0x${Number(s).toString(16)}`;const i=r-a,o=s.slice(0,i),c=s.slice(-a),u=function(e,t){const n=10**e;return t+Math.floor(Math.random()*(n-t))}(a,Number(c)),d=`0x${(BigInt(o+"0".repeat(a))+BigInt(u)).toString(16)}`;return(0,l.add0x)(d)}n.RandomisedEstimationsGasFeeFlow=class{constructor(){s.add(this)}matchesTransaction({transactionMeta:e,messenger:t}){const{chainId:n}=e;return(0,p.getGasFeeRandomisation)(t).randomisedGasFeeDigits[n]!==undefined}async getGasFees(e){try{return await c(this,s,"m",a).call(this,e)}catch(t){return g("Using default flow as fallback due to error",t),await c(this,s,"m",r).call(this,e)}}},s=new WeakSet,r=async function(e){return(new d.DefaultGasFeeFlow).getGasFees(e)},a=async function(e){const{messenger:t,gasFeeControllerData:n,transactionMeta:a}=e,{gasEstimateType:o,gasFeeEstimates:l}=n,d=(0,p.getGasFeeRandomisation)(t),f=d.randomisedGasFeeDigits[a.chainId],h=d.preservedNumberOfDigits??2;if(o===u.GAS_ESTIMATE_TYPES.FEE_MARKET){g("Randomising fee market estimates",l);const e=c(this,s,"m",i).call(this,l,f,h);return g("Added randomised fee market estimates",e),{estimates:e}}return await c(this,s,"m",r).call(this,e)},i=function(e,t,n){const r=Object.values(h.GasFeeEstimateLevel).reduce((r,a)=>({...r,[a]:c(this,s,"m",o).call(this,e,a,t,n)}),{});return{type:h.GasFeeEstimateType.FeeMarket,...r}},o=function(e,t,n,s){return{maxFeePerGas:(0,m.gweiDecimalToWeiHex)(e[t].suggestedMaxFeePerGas),maxPriorityFeePerGas:b(e[t].suggestedMaxPriorityFeePerGas,n,s)}},n.randomiseDecimalGWEIAndConvertToHex=b}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/gas-flows/RandomisedEstimationsGasFeeFlow.cjs"}],[2741,{"../constants.cjs":2734,"./OracleLayer1GasFeeFlow.cjs":2739},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ScrollLayer1GasFeeFlow=void 0;const s=e("./OracleLayer1GasFeeFlow.cjs"),r=e("../constants.cjs"),a=[r.CHAIN_IDS.SCROLL,r.CHAIN_IDS.SCROLL_SEPOLIA];class i extends s.OracleLayer1GasFeeFlow{constructor(){super("0x5300000000000000000000000000000000000002",!0)}matchesTransaction({transactionMeta:e}){return a.includes(e.chainId)}}n.ScrollLayer1GasFeeFlow=i}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/gas-flows/ScrollLayer1GasFeeFlow.cjs"}],[2742,{"../types.cjs":2756,"@metamask/controller-utils":1301},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,a,i=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)},o=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n};Object.defineProperty(n,"__esModule",{value:!0}),n.TestGasFeeFlow=void 0;const c=e("@metamask/controller-utils"),u=e("../types.cjs"),l=1e15;n.TestGasFeeFlow=class{constructor(){s.add(this),r.set(this,1)}matchesTransaction(){return!0}async getGasFees(e){const{transactionMeta:t}=e,{txParams:n}=t,{gas:c}=n;if(!c)throw new Error("Cannot estimate fee without gas value");const d=parseInt(c,16),f=.5*l,h=(i(this,r,"f")+1)*l,p=i(this,r,"f")*l,m=h-f,g=p-f,b=h+f,y=p+f;return o(this,r,i(this,r,"f")+1,"f"),{estimates:{type:u.GasFeeEstimateType.FeeMarket,low:{maxFeePerGas:i(this,s,"m",a).call(this,m,d),maxPriorityFeePerGas:i(this,s,"m",a).call(this,g,d)},medium:{maxFeePerGas:i(this,s,"m",a).call(this,h,d),maxPriorityFeePerGas:i(this,s,"m",a).call(this,p,d)},high:{maxFeePerGas:i(this,s,"m",a).call(this,b,d),maxPriorityFeePerGas:i(this,s,"m",a).call(this,y,d)}}}}},r=new WeakMap,s=new WeakSet,a=function(e,t){const n=Math.ceil(e/t);return(0,c.toHex)(n)}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/gas-flows/TestGasFeeFlow.cjs"}],[2743,{"../api/accounts-api.cjs":2732,"../constants.cjs":2734,"../index.cjs":2754,"../logger.cjs":2755,"../types.cjs":2756,"@metamask/controller-utils":1301,"bn.js":3699,uuid:5366},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,a,i,o=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.AccountsApiRemoteTransactionSource=n.SUPPORTED_CHAIN_IDS=void 0;const u=e("@metamask/controller-utils"),l=c(e("bn.js")),d=e("uuid"),f=e("../index.cjs"),h=e("../api/accounts-api.cjs"),p=e("../constants.cjs"),m=e("../logger.cjs"),g=e("../types.cjs");n.SUPPORTED_CHAIN_IDS=[p.CHAIN_IDS.MAINNET,p.CHAIN_IDS.POLYGON,p.CHAIN_IDS.BSC,p.CHAIN_IDS.LINEA_MAINNET,p.CHAIN_IDS.BASE,p.CHAIN_IDS.OPTIMISM,p.CHAIN_IDS.ARBITRUM,p.CHAIN_IDS.SCROLL,p.CHAIN_IDS.SEI];const b=(0,m.createModuleLogger)(m.incomingTransactionsLogger,"accounts-api-source");n.AccountsApiRemoteTransactionSource=class{constructor(){s.add(this)}getSupportedChains(){return n.SUPPORTED_CHAIN_IDS}async fetchTransactions(e){const{address:t}=e,c=await o(this,s,"m",r).call(this,e,n.SUPPORTED_CHAIN_IDS);b("Fetched transactions",c.length,c);const u=await Promise.all(c.map(e=>o(this,s,"m",i).call(this,t,e)));b("Normalized transactions",u);const l=o(this,s,"m",a).call(this,e,u);return b("Filtered transactions",l.length,l),l}},s=new WeakSet,r=async function(e,t){const{address:n,tags:s}=e,r=[];try{const e=await(0,h.getAccountTransactions)({address:n,chainIds:t,sortDirection:"DESC",tags:s});e?.data&&r.push(...e.data)}catch(e){b("Error while fetching transactions",e)}return r},a=function(e,t){const{address:n,includeTokenTransfers:s,updateTransactions:r}=e;let a=t;return r||(a=a.filter(e=>e.txParams.to===n)),s||(a=a.filter(e=>!e.isTransfer)),a},i=async function(e,t){const n=String(t.blockNumber),s=`0x${t.chainId.toString(16)}`,{hash:r}=t,a=new Date(t.timestamp).getTime(),i=(0,d.v1)({msecs:a}),{from:o}=t,c=(0,u.BNToHex)(new l.default(t.gas)),h=(0,u.BNToHex)(new l.default(t.gasPrice)),p=(0,u.BNToHex)(new l.default(t.gasUsed)),m=(0,u.BNToHex)(new l.default(t.nonce)),b=t.methodId,y=g.TransactionType.incoming,w=t.isError?g.TransactionStatus.failed:g.TransactionStatus.confirmed,T=t.valueTransfers.find(t=>(t.to.toLowerCase()===e.toLowerCase()||t.from.toLowerCase()===e.toLowerCase())&&t.contractAddress),E=T?.to.toLowerCase()===e.toLowerCase()&&o.toLowerCase()!==e.toLowerCase(),S=o.toLowerCase()===e.toLowerCase(),v=T?.amount,k=T?.contractAddress,P=T?.decimal,I=T?.symbol,_=(0,u.BNToHex)(new l.default(E?T?.amount??t.value:t.value)),x=E?e:t.to,j={blockNumber:n,chainId:s,error:w===g.TransactionStatus.failed?new Error("Transaction failed"):undefined,hash:r,id:i,isTransfer:E,networkClientId:"",status:w,time:a,toSmartContract:!1,transferInformation:T?{amount:v,contractAddress:k,decimals:P,symbol:I}:undefined,txParams:{chainId:s,data:b,from:o,gas:c,gasPrice:h,gasUsed:p,nonce:m,to:x,value:_},type:y,verifiedOnBlockchain:!1};return S&&(j.type=(await(0,f.determineTransactionType)(j.txParams)).type),j}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/helpers/AccountsApiRemoteTransactionSource.cjs"}],[2744,{"../gas-flows/DefaultGasFeeFlow.cjs":2736,"../logger.cjs":2755,"../types.cjs":2756,"../utils/gas-flow.cjs":2764,"../utils/layer1-gas-fee-flow.cjs":2767,"@metamask/eth-query":1831,"@metamask/utils":2799,events:4072},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,a,i,o,c,u,l,d,f,h,p,m,g,b,y,w,T,E,S,v,k,P,I=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},_=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)},x=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.updateTransactionGasEstimates=n.updateTransactionGasProperties=n.GasFeePoller=void 0;const j=x(e("@metamask/eth-query")),A=e("@metamask/utils"),C=x(e("events")),R=e("../gas-flows/DefaultGasFeeFlow.cjs"),O=e("../logger.cjs"),M=e("../types.cjs"),B=e("../utils/gas-flow.cjs"),N=e("../utils/layer1-gas-fee-flow.cjs"),F=(0,A.createModuleLogger)(O.projectLogger,"gas-fee-poller");function L(e,t,n,s){const{type:r}=t;if(s){if(r===M.GasFeeEstimateType.FeeMarket){const s=t;e.maxFeePerGas=s[n]?.maxFeePerGas,e.maxPriorityFeePerGas=s[n]?.maxPriorityFeePerGas}if(r===M.GasFeeEstimateType.GasPrice){const n=t;e.maxFeePerGas=n.gasPrice,e.maxPriorityFeePerGas=n.gasPrice}if(r===M.GasFeeEstimateType.Legacy){const s=t[n];e.maxFeePerGas=s,e.maxPriorityFeePerGas=s}delete e.gasPrice}else{if(r===M.GasFeeEstimateType.FeeMarket){const s=t;e.gasPrice=s[n]?.maxFeePerGas}if(r===M.GasFeeEstimateType.GasPrice){const n=t;e.gasPrice=n.gasPrice}if(r===M.GasFeeEstimateType.Legacy){const s=t;e.gasPrice=s[n]}delete e.maxFeePerGas,delete e.maxPriorityFeePerGas}}n.GasFeePoller=class{constructor({findNetworkClientIdByChainId:e,gasFeeFlows:t,getGasFeeControllerEstimates:n,getProvider:g,getTransactions:b,getTransactionBatches:y,layer1GasFeeFlows:w,messenger:T,onStateChange:E}){s.add(this),this.hub=new C.default,r.set(this,void 0),a.set(this,void 0),i.set(this,void 0),o.set(this,void 0),c.set(this,void 0),u.set(this,void 0),l.set(this,void 0),d.set(this,void 0),f.set(this,void 0),h.set(this,!1),I(this,r,e,"f"),I(this,a,t,"f"),I(this,l,w,"f"),I(this,i,n,"f"),I(this,o,g,"f"),I(this,c,b,"f"),I(this,u,y,"f"),I(this,d,T,"f"),E(()=>{const e=_(this,s,"m",v).call(this),t=_(this,s,"m",k).call(this);e.length||t.length?_(this,s,"m",p).call(this):_(this,s,"m",m).call(this)})}},r=new WeakMap,a=new WeakMap,i=new WeakMap,o=new WeakMap,c=new WeakMap,u=new WeakMap,l=new WeakMap,d=new WeakMap,f=new WeakMap,h=new WeakMap,s=new WeakSet,p=function(){_(this,h,"f")||(_(this,s,"m",g).call(this),I(this,h,!0,"f"),F("Started polling"))},m=function(){_(this,h,"f")&&(clearTimeout(_(this,f,"f")),I(this,f,undefined,"f"),I(this,h,!1,"f"),F("Stopped polling"))},g=async function e(){await _(this,s,"m",b).call(this),await _(this,s,"m",y).call(this),I(this,f,setTimeout(()=>_(this,s,"m",e).call(this),1e4),"f")},b=async function(){const e=_(this,s,"m",v).call(this);if(!e.length)return;F("Found unapproved transactions",e.length);const t=await _(this,s,"m",P).call(this,e);F("Retrieved gas fee controller data",t),await Promise.all(e.flatMap(e=>{const{chainId:n}=e,r=t.get(n);return _(this,s,"m",w).call(this,e,r)}))},y=async function(){const e=_(this,s,"m",k).call(this);if(!e.length)return;F("Found unapproved transaction batches",e.length);const t=await _(this,s,"m",P).call(this,e);F("Retrieved gas fee controller data",t),await Promise.all(e.flatMap(e=>{const{chainId:n}=e,r=t.get(n);return _(this,s,"m",T).call(this,e,r)}))},w=async function(e,t){const{id:n}=e,[r,a]=await Promise.all([_(this,s,"m",E).call(this,e,t),_(this,s,"m",S).call(this,e)]);(r||a)&&this.hub.emit("transaction-updated",{transactionId:n,gasFeeEstimates:r?.gasFeeEstimates,gasFeeEstimatesLoaded:r?.gasFeeEstimatesLoaded,layer1GasFee:a})},T=async function(e,t){const{id:n}=e,s=new j.default(_(this,o,"f").call(this,e.networkClientId)),r=new R.DefaultGasFeeFlow,a={ethQuery:s,gasFeeControllerData:t,messenger:_(this,d,"f"),transactionMeta:{...e,txParams:{...e.transactions?.[0],from:e.from,gas:e.gas},time:Date.now()}};let i;try{i=(await r.getGasFees(a)).estimates}catch(t){F("Failed to get gas fees for batch",e.id,t)}i&&this.hub.emit("transaction-batch-updated",{transactionBatchId:n,gasFeeEstimates:i,gasFeeEstimatesLoaded:!0})},E=async function(e,t){const{networkClientId:n}=e,s=new j.default(_(this,o,"f").call(this,n)),r=(0,B.getGasFeeFlow)(e,_(this,a,"f"),_(this,d,"f"));r&&F("Found gas fee flow",r.constructor.name,e.id);const i={ethQuery:s,gasFeeControllerData:t,messenger:_(this,d,"f"),transactionMeta:e};let c;if(r)try{c=(await r.getGasFees(i)).estimates}catch(t){F("Failed to get suggested gas fees",e.id,t)}return!c&&e.gasFeeEstimatesLoaded?undefined:(F("Updated gas fee estimates",{gasFeeEstimates:c,transaction:e.id}),{gasFeeEstimates:c,gasFeeEstimatesLoaded:!0})},S=async function(e){const{networkClientId:t}=e,n=_(this,o,"f").call(this,t),s=await(0,N.getTransactionLayer1GasFee)({layer1GasFeeFlows:_(this,l,"f"),messenger:_(this,d,"f"),provider:n,transactionMeta:e});return s&&F("Updated layer 1 gas fee",s,e.id),s},v=function(){return _(this,c,"f").call(this).filter(e=>e.status===M.TransactionStatus.unapproved)},k=function(){return _(this,u,"f").call(this).filter(e=>e.status===M.TransactionStatus.unapproved)},P=async function(e){const t=new Map;for(const n of e){const{chainId:e,networkClientId:s}=n;if(t.has(e))continue;const a=s??_(this,r,"f").call(this,e);t.set(e,a)}F("Extracted network client IDs by chain ID",t);const n=Array.from(t.entries()).map(async([e,t])=>[e,await _(this,i,"f").call(this,{networkClientId:t})]);return new Map(await Promise.all(n))},n.updateTransactionGasProperties=function({gasFeeEstimates:e,gasFeeEstimatesLoaded:t,isTxParamsGasFeeUpdatesEnabled:n,layer1GasFee:s,txMeta:r}){const a=r.userFeeLevel,i=Object.values(M.GasFeeEstimateLevel).includes(a);if(n(r)&&i&&e){const t=r.txParams.type!==M.TransactionEnvelopeType.legacy;L(r.txParams,e,a,t)}e&&(r.gasFeeEstimates=e),t!==undefined&&(r.gasFeeEstimatesLoaded=t),s&&(r.layer1GasFee=s)},n.updateTransactionGasEstimates=function({txMeta:e,userFeeLevel:t}){const{txParams:n,gasFeeEstimates:s}=e;if(!s)return;L(n,s,t,e.txParams.type!==M.TransactionEnvelopeType.legacy)}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/helpers/GasFeePoller.cjs"}],[2745,{"../logger.cjs":2755,"../utils/feature-flags.cjs":2761,events:4072},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,a,i,o,c,u,l,d,f,h,p,m,g,b,y,w,T=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},E=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)},S=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.IncomingTransactionHelper=void 0;const v=S(e("events")),k=e("../logger.cjs"),P=e("../utils/feature-flags.cjs");n.IncomingTransactionHelper=class{constructor({client:e,getCurrentAccount:t,getLocalTransactions:n,includeTokenTransfers:m,isEnabled:g,messenger:b,remoteTransactionSource:y,trimTransactions:w,updateTransactions:E}){s.add(this),r.set(this,void 0),a.set(this,void 0),i.set(this,void 0),o.set(this,void 0),c.set(this,void 0),u.set(this,void 0),l.set(this,void 0),d.set(this,void 0),f.set(this,void 0),h.set(this,void 0),p.set(this,void 0),this.hub=new v.default,T(this,r,e,"f"),T(this,a,t,"f"),T(this,i,n,"f"),T(this,o,m,"f"),T(this,c,g??(()=>!0),"f"),T(this,u,!1,"f"),T(this,l,b,"f"),T(this,d,y,"f"),T(this,h,w,"f"),T(this,p,E,"f")}start(){if(E(this,u,"f"))return;if(!E(this,s,"m",b).call(this))return;const e=E(this,s,"m",y).call(this);(0,k.incomingTransactionsLogger)("Started polling",{interval:e}),T(this,u,!0,"f"),E(this,s,"m",m).call(this).catch(e=>{(0,k.incomingTransactionsLogger)("Initial polling failed",e)})}stop(){E(this,f,"f")&&clearTimeout(E(this,f,"f")),E(this,u,"f")&&(T(this,u,!1,"f"),(0,k.incomingTransactionsLogger)("Stopped polling"))}async update({isInterval:e,tags:t}={}){const n=E(this,s,"m",w).call(this,t,e);if((0,k.incomingTransactionsLogger)("Checking for incoming transactions",{isInterval:Boolean(e),tags:n}),!E(this,s,"m",b).call(this))return;const r=E(this,a,"f").call(this),c=E(this,o,"f")??!0,u=E(this,p,"f")??!1;let l=[];try{l=await E(this,d,"f").fetchTransactions({address:r.address,includeTokenTransfers:c,tags:n,updateTransactions:u})}catch(e){return void(0,k.incomingTransactionsLogger)("Error while fetching remote transactions",e)}if(!l.length)return;E(this,s,"m",g).call(this,l),(0,k.incomingTransactionsLogger)("Found potential transactions",l.length,l);const f=E(this,i,"f").call(this),m=l.filter(e=>!f.some(t=>t.hash?.toLowerCase()===e.hash?.toLowerCase()&&t.txParams.from?.toLowerCase()===e.txParams.from?.toLowerCase()&&t.type===e.type));if(!m.length)return void(0,k.incomingTransactionsLogger)("All transactions are already known");(0,k.incomingTransactionsLogger)("Found unique transactions",m.length,m);const y=E(this,h,"f").call(this,[...m,...f]),T=m.map(e=>e.id),S=y.filter(e=>T.includes(e.id));S.length?((0,k.incomingTransactionsLogger)("Adding new transactions",S.length,S),this.hub.emit("transactions",S)):(0,k.incomingTransactionsLogger)("All unique transactions truncated due to limit")}},r=new WeakMap,a=new WeakMap,i=new WeakMap,o=new WeakMap,c=new WeakMap,u=new WeakMap,l=new WeakMap,d=new WeakMap,f=new WeakMap,h=new WeakMap,p=new WeakMap,s=new WeakSet,m=async function e(){try{await this.update({isInterval:!0})}catch(e){console.error("Error while checking incoming transactions",e)}E(this,u,"f")&&T(this,f,setTimeout(()=>E(this,s,"m",e).call(this),E(this,s,"m",y).call(this)),"f")},g=function(e){e.sort((e,t)=>e.time<t.time?-1:1)},b=function(){return E(this,c,"f").call(this)},y=function(){return(0,P.getIncomingTransactionsPollingInterval)(E(this,l,"f"))},w=function(e,t){const n=[];return E(this,r,"f")&&n.push(E(this,r,"f")),e?.length?n.push(...e):t&&n.push("automatic-polling"),n?.length?n:undefined}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/helpers/IncomingTransactionHelper.cjs"}],[2746,{"../logger.cjs":2755,"@metamask/utils":2799,"async-mutex":3582,"eth-method-registry":3985,events:4072},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,a,i,o,c,u=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},l=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)},d=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.MethodDataHelper=void 0;const f=e("@metamask/utils"),h=e("async-mutex"),p=e("eth-method-registry"),m=d(e("events")),g=e("../logger.cjs"),b=(0,f.createModuleLogger)(g.projectLogger,"method-data");n.MethodDataHelper=class{constructor({getProvider:e,getState:t}){s.add(this),r.set(this,void 0),a.set(this,void 0),i.set(this,void 0),o.set(this,new h.Mutex),this.hub=new m.default,u(this,r,e,"f"),u(this,a,t,"f"),u(this,i,new Map,"f")}async lookup(e,t){b("lookup",e,t);const n=await l(this,o,"f").acquire();try{const n=l(this,a,"f").call(this)[e];if(n)return b("Cached",n),n;let o=l(this,i,"f").get(t);if(!o){const e=l(this,r,"f").call(this,t);o=new p.MethodRegistry({provider:e}),l(this,i,"f").set(t,o),b("Created registry",t)}const u=await l(this,s,"m",c).call(this,e,o);return b("Result",u),this.hub.emit("update",{fourBytePrefix:e,methodData:u}),u}finally{n()}}},r=new WeakMap,a=new WeakMap,i=new WeakMap,o=new WeakMap,s=new WeakSet,c=async function(e,t){const n=await t.lookup(e);if(!n)return b("No method found",e),{registryMethod:"",parsedRegistryMethod:{name:undefined,args:undefined}};b("Parsing",n);return{registryMethod:n,parsedRegistryMethod:t.parse(n)}}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/helpers/MethodDataHelper.cjs"}],[2747,{"../logger.cjs":2755,"async-mutex":3582},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,a,i,o,c,u,l,d,f,h,p,m=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},g=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.MultichainTrackingHelper=void 0;const b=e("async-mutex"),y=e("../logger.cjs"),w=(0,y.createModuleLogger)(y.projectLogger,"multichain-tracking");n.MultichainTrackingHelper=class{constructor({findNetworkClientIdByChainId:e,getNetworkClientById:t,getNetworkClientRegistry:n,removePendingTransactionTrackerListeners:b,createNonceTracker:y,createPendingTransactionTracker:T,onNetworkStateChange:E}){s.add(this),r.set(this,void 0),a.set(this,void 0),i.set(this,void 0),o.set(this,void 0),c.set(this,void 0),u.set(this,void 0),l.set(this,new Map),d.set(this,new Map),this.checkForPendingTransactionAndStartPolling=()=>{for(const[,e]of g(this,d,"f"))e.pendingTransactionTracker.startIfPendingTransactions()},f.set(this,e=>{const t=Object.keys(e),n=Array.from(g(this,d,"f").keys()),r=n.filter(e=>!t.includes(e));r.forEach(e=>{g(this,s,"m",h).call(this,e)});const a=t.filter(e=>!n.includes(e));a.forEach(e=>{g(this,s,"m",p).call(this,e)}),a.length&&w("Added trackers",a),r.length&&w("Removed trackers",r)}),m(this,r,e,"f"),m(this,a,t,"f"),m(this,i,n,"f"),m(this,o,b,"f"),m(this,c,y,"f"),m(this,u,T,"f"),E((e,t)=>{const n=g(this,i,"f").call(this);t.forEach(({op:e,path:t})=>{if("remove"===e&&"networkConfigurations"===t[0]){const e=t[1];delete n[e]}}),g(this,f,"f").call(this,n)})}initialize(){const e=g(this,i,"f").call(this);g(this,f,"f").call(this,e),w("Initialized")}has(e){return g(this,d,"f").has(e)}async acquireNonceLockForChainIdKey({chainId:e,key:t="global"}){let n=g(this,l,"f").get(e);n||(n=new Map,g(this,l,"f").set(e,n));let s=n.get(t);return s||(s=new b.Mutex,n.set(t,s)),await s.acquire()}async getNonceLock(e,t){const n=g(this,a,"f").call(this,t),s=await this.acquireNonceLockForChainIdKey({chainId:n.configuration.chainId,key:e}),r=g(this,d,"f").get(t)?.nonceTracker;if(!r)throw new Error(`Missing nonce tracker for network client ID - ${t}`);try{const t=await r.getNonceLock(e),n=()=>{t.releaseLock(),s?.()};return{...t,releaseLock:n}}catch(e){throw s?.(),e}}stopAllTracking(){for(const[e]of g(this,d,"f"))g(this,s,"m",h).call(this,e)}getNetworkClient({chainId:e,networkClientId:t}){if(!t&&!e)throw new Error("Cannot locate network client without networkClientId or chainId");let n,s=t;try{t&&(n=g(this,a,"f").call(this,t))}catch(n){if(w("No network client found with ID",t),!e)throw n}return!n&&e&&(s=g(this,r,"f").call(this,e),n=g(this,a,"f").call(this,s)),{...n,id:s}}},r=new WeakMap,a=new WeakMap,i=new WeakMap,o=new WeakMap,c=new WeakMap,u=new WeakMap,l=new WeakMap,d=new WeakMap,f=new WeakMap,s=new WeakSet,h=function(e){const t=g(this,d,"f").get(e);t&&(t.pendingTransactionTracker.stop(),g(this,o,"f").call(this,t.pendingTransactionTracker),g(this,d,"f").delete(e))},p=function(e){if(g(this,d,"f").get(e))return;const{provider:t,blockTracker:n,configuration:{chainId:s}}=g(this,a,"f").call(this,e),r=g(this,c,"f").call(this,{provider:t,blockTracker:n,chainId:s}),i=g(this,u,"f").call(this,{provider:t,blockTracker:n,chainId:s,networkClientId:e});g(this,d,"f").set(e,{nonceTracker:r,pendingTransactionTracker:i})}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/helpers/MultichainTrackingHelper.cjs"}],[2748,{"../logger.cjs":2755,"../types.cjs":2756,"./TransactionPoller.cjs":2750,"@metamask/controller-utils":1301,events:4072,lodash:4534},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,a,i,o,c,u,l,d,f,h,p,m,g,b,y,w,T,E,S,v,k,P,I,_,x,j,A,C,R,O,M,B,N,F,L,D,G=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},U=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)},H=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.PendingTransactionTracker=void 0;const $=e("@metamask/controller-utils"),K=H(e("events")),q=e("lodash"),W=e("./TransactionPoller.cjs"),V=e("../logger.cjs"),z=e("../types.cjs"),J=["replacement transaction underpriced","known transaction","gas price too low to replace","transaction with the same hash was already imported","gateway timeout","nonce too low"],X=(0,V.createModuleLogger)(V.projectLogger,"pending-transactions");n.PendingTransactionTracker=class{constructor({blockTracker:e,getChainId:t,getEthQuery:n,getGlobalLock:T,getNetworkClientId:E,getTransactions:S,hooks:v,isResubmitEnabled:k,messenger:P,publishTransaction:I}){s.add(this),r.set(this,void 0),a.set(this,void 0),i.set(this,void 0),o.set(this,void 0),c.set(this,void 0),u.set(this,void 0),l.set(this,void 0),d.set(this,void 0),f.set(this,void 0),h.set(this,void 0),p.set(this,void 0),m.set(this,void 0),g.set(this,void 0),b.set(this,void 0),this.startIfPendingTransactions=()=>{const e=U(this,s,"m",A).call(this);e.length?U(this,s,"m",y).call(this,e):this.stop()},this.hub=new K.default,G(this,r,new Map,"f"),G(this,a,t,"f"),G(this,i,n,"f"),G(this,o,E,"f"),G(this,c,S,"f"),G(this,u,k??(()=>!0),"f"),G(this,l,U(this,s,"m",w).bind(this),"f"),G(this,f,T,"f"),G(this,h,I,"f"),G(this,p,!1,"f"),G(this,g,undefined,"f"),G(this,m,new W.TransactionPoller({blockTracker:e,chainId:t(),messenger:P}),"f"),G(this,b,v?.beforeCheckPendingTransaction??(()=>Promise.resolve(!0)),"f"),G(this,d,(0,V.createModuleLogger)(X,`${t()}:${E()}`),"f")}addTransactionToPoll(e){U(this,s,"m",y).call(this,[e]),G(this,g,e,"f")}async forceCheckTransaction(e){const t=await U(this,f,"f").call(this);try{await U(this,s,"m",I).call(this,e)}catch(e){U(this,d,"f").call(this,"Failed to check transaction",e)}finally{t()}}stop(){U(this,p,"f")&&(U(this,m,"f").stop(),G(this,p,!1,"f"),U(this,d,"f").call(this,"Stopped polling"))}},r=new WeakMap,a=new WeakMap,i=new WeakMap,o=new WeakMap,c=new WeakMap,u=new WeakMap,l=new WeakMap,d=new WeakMap,f=new WeakMap,h=new WeakMap,p=new WeakMap,m=new WeakMap,g=new WeakMap,b=new WeakMap,s=new WeakSet,y=function(e){U(this,m,"f").setPendingTransactions(e),U(this,p,"f")||(U(this,m,"f").start(U(this,l,"f")),G(this,p,!0,"f"),U(this,d,"f").call(this,"Started polling"))},w=async function(e){const t=await U(this,f,"f").call(this);try{await U(this,s,"m",T).call(this)}catch(e){U(this,d,"f").call(this,"Failed to check transactions",e)}finally{t()}try{await U(this,s,"m",E).call(this,e)}catch(e){U(this,d,"f").call(this,"Failed to resubmit transactions",e)}},T=async function(){U(this,d,"f").call(this,"Checking transactions");const e=[...U(this,s,"m",A).call(this),...U(this,g,"f")?[U(this,g,"f")]:[]];e.length?(U(this,d,"f").call(this,"Found pending transactions to check",{count:e.length,ids:e.map(e=>e.id)}),await Promise.all(e.map(e=>U(this,s,"m",I).call(this,e)))):U(this,d,"f").call(this,"No pending transactions to check")},E=async function(e){if(!U(this,u,"f").call(this)||!U(this,p,"f"))return;U(this,d,"f").call(this,"Resubmitting transactions");const t=U(this,s,"m",A).call(this);if(t.length){U(this,d,"f").call(this,"Found pending transactions to resubmit",{count:t.length,ids:t.map(e=>e.id)});for(const n of t)try{await U(this,s,"m",v).call(this,n,e)}catch(e){const t=e.value?.message?.toLowerCase()||e.message?.toLowerCase()||String(e);if(U(this,s,"m",S).call(this,t)){U(this,d,"f").call(this,"Ignoring known transaction error",t);continue}U(this,s,"m",C).call(this,n,e.message,"There was an error when resubmitting this transaction.")}}else U(this,d,"f").call(this,"No pending transactions to resubmit")},S=function(e){return J.some(t=>e.includes(t))},v=async function(e,t){if(!U(this,s,"m",k).call(this,e,t))return;if(!await U(this,b,"f").call(this,e))return;const n=U(this,i,"f").call(this,e.networkClientId);await U(this,h,"f").call(this,n,e);const r=(e.retryCount??0)+1;U(this,s,"m",M).call(this,(0,q.merge)({},e,{retryCount:r}),"PendingTransactionTracker:transaction-retry - Retry count increased")},k=function(e,t){const n=(0,q.cloneDeep)(e);n.firstRetryBlockNumber||(n.firstRetryBlockNumber=t,U(this,s,"m",M).call(this,n,"PendingTransactionTracker:#isResubmitDue - First retry block number set"));const{firstRetryBlockNumber:r}=n,a=Number.parseInt(t,16)-Number.parseInt(r,16),i=e.retryCount||0;return a>=Math.min(50,Math.pow(2,i))},P=function(e){U(this,g,"f")?.id===e&&G(this,g,undefined,"f")},I=async function(e){const{hash:t,id:n}=e;if(!t&&await U(this,b,"f").call(this,e)){const t=new Error("We had an error while submitting this transaction, please try again.");return t.name="NoTxHashError",void U(this,s,"m",R).call(this,e,t)}if(U(this,s,"m",j).call(this,e))return U(this,d,"f").call(this,"Nonce already taken",n),void U(this,s,"m",O).call(this,e);try{const n=await U(this,s,"m",B).call(this,t),r="0x1"===n?.status;if("0x0"===n?.status)return U(this,d,"f").call(this,"Transaction receipt has failed status"),void U(this,s,"m",R).call(this,e,new Error("Transaction dropped or replaced"));const{blockNumber:a,blockHash:i}=n||{};if(r&&a&&i)return void await U(this,s,"m",_).call(this,e,{...n,blockNumber:a,blockHash:i})}catch(t){return U(this,d,"f").call(this,"Failed to check transaction",n,t),void U(this,s,"m",C).call(this,e,t.message,"There was a problem loading this transaction.")}await U(this,s,"m",x).call(this,e)&&U(this,s,"m",O).call(this,e)},_=async function(e,t){const{id:n}=e,{blockHash:r}=t;if(U(this,d,"f").call(this,"Transaction confirmed",n),U(this,g,"f"))return U(this,s,"m",P).call(this,e.id),void this.hub.emit("transaction-confirmed",e);const{baseFeePerGas:a,timestamp:i}=await U(this,s,"m",N).call(this,r,!1),o=(0,q.cloneDeep)(e);o.baseFeePerGas=a,o.blockTimestamp=i,o.status=z.TransactionStatus.confirmed,o.txParams={...o.txParams,gasUsed:t.gasUsed},o.txReceipt=t,o.verifiedOnBlockchain=!0,U(this,s,"m",M).call(this,o,"PendingTransactionTracker:#onTransactionConfirmed - Transaction confirmed"),this.hub.emit("transaction-confirmed",o)},x=async function(e){const{hash:t,id:n,txParams:{nonce:a,from:i}}=e;if(!a||!t)return!1;const o=await U(this,s,"m",F).call(this,i),c=parseInt(o,16);if(parseInt(a,16)>=c)return!1;let u=U(this,r,"f").get(t);return u===undefined&&(u=0,U(this,r,"f").set(t,u)),u<3?(U(this,d,"f").call(this,"Incrementing dropped block count",{id:n,droppedBlockCount:u}),U(this,r,"f").set(t,u+1),!1):(U(this,d,"f").call(this,"Hit dropped block count",n),U(this,r,"f").delete(t),!0)},j=function(e){const{id:t,txParams:n}=e;return U(this,s,"m",L).call(this).some(e=>e.id!==t&&e.txParams.from===n.from&&e.status===z.TransactionStatus.confirmed&&e.txParams.nonce&&e.txParams.nonce===n.nonce&&e.type!==z.TransactionType.incoming)},A=function(){return U(this,s,"m",D).call(this).filter(e=>e.status===z.TransactionStatus.submitted&&!e.verifiedOnBlockchain&&!e.isUserOperation)},C=function(e,t,n){U(this,s,"m",M).call(this,{...e,warning:{error:t,message:n}},"PendingTransactionTracker:#warnTransaction - Warning added")},R=function(e,t){U(this,d,"f").call(this,"Transaction failed",e.id,t),U(this,s,"m",P).call(this,e.id),this.hub.emit("transaction-failed",e,t)},O=function(e){U(this,d,"f").call(this,"Transaction dropped",e.id),U(this,s,"m",P).call(this,e.id),this.hub.emit("transaction-dropped",e)},M=function(e,t){this.hub.emit("transaction-updated",e,t)},B=async function(e){return await(0,$.query)(U(this,i,"f").call(this),"getTransactionReceipt",[e])},N=async function(e,t){return await(0,$.query)(U(this,i,"f").call(this),"getBlockByHash",[e,t])},F=async function(e){return await(0,$.query)(U(this,i,"f").call(this),"getTransactionCount",[e])},L=function(){const e=U(this,a,"f").call(this);return U(this,c,"f").call(this).filter(t=>t.chainId===e)},D=function(){const e=U(this,o,"f").call(this);return U(this,c,"f").call(this).filter(t=>t.networkClientId===e)}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/helpers/PendingTransactionTracker.cjs"}],[2749,{"../logger.cjs":2755,"../types.cjs":2756,"../utils/utils.cjs":2774,"@metamask/utils":2799,"bn.js":3699,lodash:4534},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,a,i,o,c,u,l,d,f=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},h=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.hasSimulationDataChanged=n.shouldResimulate=n.ResimulateHelper=n.RESIMULATE_INTERVAL_MS=n.BLOCK_TIME_ADDITIONAL_SECONDS=n.VALUE_COMPARISON_PERCENT_THRESHOLD=n.BLOCKAID_RESULT_TYPE_MALICIOUS=n.RESIMULATE_PARAMS=void 0;const p=e("@metamask/utils"),m=e("bn.js"),g=e("lodash"),b=e("../logger.cjs"),y=e("../types.cjs"),w=e("../utils/utils.cjs"),T=(0,b.createModuleLogger)(b.projectLogger,"resimulate-helper");n.RESIMULATE_PARAMS=["to","value","data"],n.BLOCKAID_RESULT_TYPE_MALICIOUS="Malicious",n.VALUE_COMPARISON_PERCENT_THRESHOLD=5,n.BLOCK_TIME_ADDITIONAL_SECONDS=60,n.RESIMULATE_INTERVAL_MS=3e3;function E(e,t){return!S(e?.difference??"0x0",t?.difference??"0x0",!1===e?.isDecrease,!1===t?.isDecrease)}function S(e,t,s,r){let a=new m.BN((0,p.remove0x)(e),"hex"),i=new m.BN((0,p.remove0x)(t),"hex");return s&&(a=a.neg()),r&&(i=i.neg()),(0,w.getPercentageChange)(a,i)<=n.VALUE_COMPARISON_PERCENT_THRESHOLD}n.ResimulateHelper=class{constructor({getTransactions:e,simulateTransaction:t,onTransactionsUpdate:n}){s.add(this),r.set(this,new Map),a.set(this,void 0),i.set(this,void 0),f(this,a,e,"f"),f(this,i,t,"f"),n(h(this,s,"m",o).bind(this))}},r=new WeakMap,a=new WeakMap,i=new WeakMap,s=new WeakSet,o=function(){const e=h(this,a,"f").call(this).filter(e=>e.status===y.TransactionStatus.unapproved),t=new Set(e.map(e=>e.id));new Set([...t,...h(this,r,"f").keys()]).forEach(t=>{const n=e.find(e=>e.id===t);n?.isActive?h(this,s,"m",c).call(this,n):h(this,s,"m",l).call(this,t)})},c=function(e){const{id:t}=e;if(h(this,r,"f").has(t))return;const a=()=>{h(this,i,"f").call(this,e).catch(e=>{T("Error during transaction resimulation",e)}).finally(()=>{h(this,r,"f").has(t)&&h(this,s,"m",u).call(this,t,a)})};h(this,s,"m",u).call(this,t,a),T(`Started resimulating transaction ${t} every ${n.RESIMULATE_INTERVAL_MS} milliseconds`)},u=function(e,t){const s=setTimeout(t,n.RESIMULATE_INTERVAL_MS);h(this,r,"f").set(e,s)},l=function(e){h(this,r,"f").has(e)&&(h(this,s,"m",d).call(this,e),T(`Stopped resimulating transaction ${e} every ${n.RESIMULATE_INTERVAL_MS} milliseconds`))},d=function(e){const t=h(this,r,"f").get(e);t&&(clearTimeout(t),h(this,r,"f").delete(e))},n.shouldResimulate=function(e,t){const{id:s}=t,r=function(e,t){const{id:s,txParams:r}=t,{txParams:a}=e;if(!a||(0,g.isEqual)(a,r))return!1;const i=Object.keys(r).filter(e=>r[e]!==a[e]);return T("Transaction parameters updated",{transactionId:s,updatedProperties:i,originalParams:a,newParams:r}),n.RESIMULATE_PARAMS.some(e=>i.includes(e))}(e,t),a=function(e,t){const{securityAlertResponse:s}=e,{id:r,securityAlertResponse:a}=t;if((0,g.isEqual)(s,a))return!1;return T("Security alert updated",{transactionId:r,originalSecurityAlertResponse:s,newSecurityAlertResponse:a}),a?.result_type===n.BLOCKAID_RESULT_TYPE_MALICIOUS}(e,t),i=function(e,t){const{simulationData:n}=e,{simulationData:s,txParams:r}=t;if(!s||(0,g.isEqual)(n,s))return!1;return!S(r?.value??"0x0",s?.nativeBalanceChange?.difference??"0x0",!1,!1===s?.nativeBalanceChange?.isDecrease)}(e,t),o=r||a||i;let c;if(a||i){c=Math.floor(Date.now()/1e3)+n.BLOCK_TIME_ADDITIONAL_SECONDS}return o&&T("Transaction should be resimulated",{transactionId:s,blockTime:c,parametersUpdated:r,securityAlert:a,valueAndNativeBalanceMismatch:i}),{blockTime:c,resimulate:o}},n.hasSimulationDataChanged=function(e,t){if((0,g.isEqual)(e,t))return!1;if(E(e?.nativeBalanceChange,t?.nativeBalanceChange))return T("Simulation data native balance changed"),!0;if(e.tokenBalanceChanges.length!==t.tokenBalanceChanges.length)return!0;for(const n of e.tokenBalanceChanges){const e=t.tokenBalanceChanges.find(({address:e,id:t})=>e===n.address&&t===n.id);if(!e)return T("Missing new token balance",{address:n.address,id:n.id}),!0;if(E(n,e))return T("Simulation data token balance changed",{originalTokenBalanceChange:n,newTokenBalanceChange:e}),!0}return!1}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/helpers/ResimulateHelper.cjs"}],[2750,{"../logger.cjs":2755,"../utils/feature-flags.cjs":2761,"@metamask/utils":2799,lodash:4534},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,a,i,o,c,u,l,d,f,h,p,m,g,b=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},y=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.TransactionPoller=void 0;const w=e("@metamask/utils"),T=e("lodash"),E=e("../logger.cjs"),S=e("../utils/feature-flags.cjs"),v=(0,w.createModuleLogger)(E.projectLogger,"transaction-poller");n.TransactionPoller=class{constructor({blockTracker:e,chainId:t,messenger:n}){s.add(this),r.set(this,0),a.set(this,void 0),i.set(this,void 0),o.set(this,void 0),c.set(this,void 0),u.set(this,void 0),l.set(this,void 0),d.set(this,!1),f.set(this,void 0),b(this,a,e,"f"),b(this,i,t,"f"),b(this,o,n,"f")}start(e){y(this,d,"f")||(b(this,u,e,"f"),b(this,d,!0,"f"),y(this,s,"m",h).call(this),v("Started"))}stop(){y(this,d,"f")&&(b(this,d,!1,"f"),b(this,u,undefined,"f"),b(this,r,0,"f"),b(this,l,undefined,"f"),y(this,s,"m",m).call(this),y(this,s,"m",g).call(this),v("Stopped"))}setPendingTransactions(e){const t=(y(this,l,"f")??[]).map(e=>e.id);b(this,l,e,"f");const n=e.map(e=>e.id),a=!(0,T.isEqual)(t,n);y(this,d,"f")&&a&&(v("Detected new pending transactions",n),b(this,r,0,"f"),y(this,c,"f")&&(y(this,s,"m",g).call(this),y(this,s,"m",h).call(this)))}},r=new WeakMap,a=new WeakMap,i=new WeakMap,o=new WeakMap,c=new WeakMap,u=new WeakMap,l=new WeakMap,d=new WeakMap,f=new WeakMap,s=new WeakSet,h=function e(){if(!y(this,d,"f"))return;const{countMax:t,intervalMs:n}=(0,S.getAcceleratedPollingParams)(y(this,i,"f"),y(this,o,"f"));if(y(this,r,"f")>=t)return b(this,c,e=>y(this,s,"m",p).call(this,!1,e),"f"),y(this,a,"f").on("latest",y(this,c,"f")),void v("Added block tracker listener");y(this,s,"m",m).call(this),b(this,f,setTimeout(async()=>{await y(this,s,"m",p).call(this,!0),y(this,s,"m",e).call(this)},n),"f")},p=async function(e,t){e?v("Accelerated interval",y(this,r,"f")+1):v("Block tracker interval",t);const n=t??await y(this,a,"f").getLatestBlock();await(y(this,u,"f")?.call(this,n)),e&&y(this,d,"f")&&b(this,r,y(this,r,"f")+1,"f")},m=function(){y(this,f,"f")&&(clearTimeout(y(this,f,"f")),b(this,f,undefined,"f"))},g=function(){y(this,c,"f")&&(y(this,a,"f").removeListener("latest",y(this,c,"f")),b(this,c,undefined,"f"))}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/helpers/TransactionPoller.cjs"}],[2751,{"../logger.cjs":2755,"@metamask/utils":2799,lodash:4534},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,a,i,o,c=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},u=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.CollectPublishHook=void 0;const l=e("@metamask/utils"),d=e("lodash"),f=e("../logger.cjs"),h=(0,l.createModuleLogger)(f.projectLogger,"collect-publish-hook");n.CollectPublishHook=class{constructor(e){s.add(this),r.set(this,void 0),a.set(this,void 0),i.set(this,void 0),c(this,i,(0,l.createDeferredPromise)(),"f"),c(this,r,[],"f"),c(this,a,e,"f")}getHook(){return u(this,s,"m",o).bind(this)}ready(){return u(this,i,"f").promise}success(e){if(h("Success",{transactionHashes:e}),e.length!==u(this,a,"f"))throw new Error("Transaction hash count mismatch");for(let t=0;t<u(this,r,"f").length;t++){const n=u(this,r,"f")[t],s=e[t];n.promise.resolve({transactionHash:s})}}error(e){h("Error",{error:e});for(const t of u(this,r,"f"))t.promise.reject(e)}},r=new WeakMap,a=new WeakMap,i=new WeakMap,s=new WeakSet,o=function(e,t){const n=e.txParams.nonce??"0x0",s=parseInt(n,16);h("Processing transaction",{nonce:s,signedTx:t,transactionMeta:e});const o=(0,l.createDeferredPromise)();if(u(this,r,"f").push({nonce:s,promise:o,signedTransaction:t}),c(this,r,(0,d.sortBy)(u(this,r,"f"),e=>e.nonce),"f"),u(this,r,"f").length===u(this,a,"f")){h("All transactions signed");const e=u(this,r,"f").map(e=>e.signedTransaction);u(this,i,"f").resolve({signedTransactions:e})}return o.promise}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/hooks/CollectPublishHook.cjs"}],[2752,{"../logger.cjs":2755,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,a,i=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},o=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.ExtraTransactionsPublishHook=void 0;const c=e("@metamask/utils"),u=e("../logger.cjs"),l=(0,c.createModuleLogger)(u.projectLogger,"extra-transactions-publish-hook");n.ExtraTransactionsPublishHook=class{constructor({addTransactionBatch:e}){s.add(this),r.set(this,void 0),i(this,r,e,"f")}getHook(){return o(this,s,"m",a).bind(this)}},r=new WeakMap,s=new WeakSet,a=async function(e,t){l("Publishing transaction as batch",{transactionMeta:e,signedTx:t});const{batchTransactions:n,batchTransactionsOptions:s,id:a,networkClientId:i,txParams:u}=e,d=u.from,f=u.to,h=u.data,p=u.value,m=u.gas,g=u.maxFeePerGas,b=u.maxPriorityFeePerGas,y=t,w=(0,c.createDeferredPromise)(),T={existingTransaction:{id:a,onPublish:({transactionHash:e})=>{w.resolve({transactionHash:e})},signedTransaction:y},params:{data:h,gas:m,maxFeePerGas:g,maxPriorityFeePerGas:b,to:f,value:p}},E=(n??[]).map(e=>{const{isAfter:t,type:n,...s}=e;return{isAfter:t,params:s,type:n}}),S=[...E.filter(e=>!1===e.isAfter).map(({isAfter:e,...t})=>({...t})),T,...E.filter(e=>e.isAfter===undefined||e.isAfter).map(({isAfter:e,...t})=>({...t}))];l("Adding transaction batch",{from:d,networkClientId:i,transactions:S});const v=s??{disable7702:!0,disableHook:!1,disableSequential:!0};return await o(this,r,"f").call(this,{from:d,networkClientId:i,requireApproval:!1,transactions:S,...v}),w.promise}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/hooks/ExtraTransactionsPublishHook.cjs"}],[2753,{"../logger.cjs":2755,"@metamask/rpc-errors":2384,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,a,i,o,c,u,l,d,f,h,p=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},m=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.SequentialPublishBatchHook=void 0;const g=e("@metamask/rpc-errors"),b=e("@metamask/utils"),y=e("../logger.cjs"),w=(0,b.createModuleLogger)(y.projectLogger,"sequential-publish-batch-hook");n.SequentialPublishBatchHook=class{constructor({publishTransaction:e,getTransaction:t,getPendingTransactionTracker:n,getEthQuery:u}){s.add(this),r.set(this,void 0),a.set(this,void 0),i.set(this,void 0),o.set(this,void 0),c.set(this,{}),p(this,r,e,"f"),p(this,a,t,"f"),p(this,i,u,"f"),p(this,o,n,"f")}getHook(){return m(this,s,"m",u).bind(this)}},r=new WeakMap,a=new WeakMap,i=new WeakMap,o=new WeakMap,c=new WeakMap,s=new WeakSet,u=async function({from:e,networkClientId:t,transactions:n}){w("Starting sequential publish batch hook",{from:e,networkClientId:t});const c=m(this,o,"f").call(this,t),u=[];for(const e of n)try{const n=m(this,a,"f").call(this,String(e.id)),o=await m(this,r,"f").call(this,m(this,i,"f").call(this,t),n);w("Transaction published",{transactionHash:o});const d={...n,hash:o},f=m(this,s,"m",l).call(this,c,d.id,d.hash);c.addTransactionToPoll(d),await f,u.push({transactionHash:o})}catch(t){throw w("Batch transaction failed",{transaction:e,error:t}),c.stop(),g.rpcErrors.internal("Failed to publish batch transaction")}return w("Sequential publish batch hook completed",{results:u}),c.stop(),{results:u}},l=async function(e,t,n){return new Promise((r,a)=>{const i=m(this,s,"m",d).bind(this,t,n,r,e),o=m(this,s,"m",f).bind(this,t,n,a,e);m(this,c,"f")[t]={onConfirmed:i,onFailedOrDropped:o},e.hub.on("transaction-confirmed",i),e.hub.on("transaction-failed",o),e.hub.on("transaction-dropped",o)})},d=function(e,t,n,r,a){a.id===e&&(w("Transaction confirmed",{transactionHash:t}),m(this,s,"m",h).call(this,r,e),n(a))},f=function(e,t,n,r,a,i){a.id===e&&(w("Transaction failed or dropped",{transactionHash:t,error:i}),m(this,s,"m",h).call(this,r,e),n(new Error(`Transaction ${t} failed or dropped.`)))},h=function(e,t){const n=m(this,c,"f")[t];e.hub.off("transaction-confirmed",n.onConfirmed),e.hub.off("transaction-failed",n.onFailedOrDropped),e.hub.off("transaction-dropped",n.onFailedOrDropped),delete m(this,c,"f")[t]}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/hooks/SequentialPublishBatchHook.cjs"}],[2754,{"./TransactionController.cjs":2731,"./constants.cjs":2734,"./helpers/AccountsApiRemoteTransactionSource.cjs":2743,"./types.cjs":2756,"./utils/gas-flow.cjs":2764,"./utils/history.cjs":2766,"./utils/prepare.cjs":2769,"./utils/transaction-type.cjs":2773,"./utils/utils.cjs":2774},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.HARDFORK=n.INCOMING_TRANSACTIONS_SUPPORTED_CHAIN_IDS=n.CHAIN_IDS=n.normalizeTransactionParams=n.isEIP1559Transaction=n.mergeGasFeeEstimates=n.determineTransactionType=n.MAX_TRANSACTION_HISTORY_LENGTH=n.DISPLAYED_TRANSACTION_HISTORY_PATHS=n.WalletDevice=n.UserFeeLevel=n.TransactionType=n.TransactionStatus=n.TransactionEnvelopeType=n.TransactionContainerType=n.SimulationTokenStandard=n.SimulationErrorCode=n.GasFeeEstimateType=n.GasFeeEstimateLevel=n.TransactionController=n.SPEED_UP_RATE=n.CANCEL_RATE=void 0;var s=e("./TransactionController.cjs");Object.defineProperty(n,"CANCEL_RATE",{enumerable:!0,get:function(){return s.CANCEL_RATE}}),Object.defineProperty(n,"SPEED_UP_RATE",{enumerable:!0,get:function(){return s.SPEED_UP_RATE}}),Object.defineProperty(n,"TransactionController",{enumerable:!0,get:function(){return s.TransactionController}});var r=e("./types.cjs");Object.defineProperty(n,"GasFeeEstimateLevel",{enumerable:!0,get:function(){return r.GasFeeEstimateLevel}}),Object.defineProperty(n,"GasFeeEstimateType",{enumerable:!0,get:function(){return r.GasFeeEstimateType}}),Object.defineProperty(n,"SimulationErrorCode",{enumerable:!0,get:function(){return r.SimulationErrorCode}}),Object.defineProperty(n,"SimulationTokenStandard",{enumerable:!0,get:function(){return r.SimulationTokenStandard}}),Object.defineProperty(n,"TransactionContainerType",{enumerable:!0,get:function(){return r.TransactionContainerType}}),Object.defineProperty(n,"TransactionEnvelopeType",{enumerable:!0,get:function(){return r.TransactionEnvelopeType}}),Object.defineProperty(n,"TransactionStatus",{enumerable:!0,get:function(){return r.TransactionStatus}}),Object.defineProperty(n,"TransactionType",{enumerable:!0,get:function(){return r.TransactionType}}),Object.defineProperty(n,"UserFeeLevel",{enumerable:!0,get:function(){return r.UserFeeLevel}}),Object.defineProperty(n,"WalletDevice",{enumerable:!0,get:function(){return r.WalletDevice}});var a=e("./utils/history.cjs");Object.defineProperty(n,"DISPLAYED_TRANSACTION_HISTORY_PATHS",{enumerable:!0,get:function(){return a.DISPLAYED_TRANSACTION_HISTORY_PATHS}}),Object.defineProperty(n,"MAX_TRANSACTION_HISTORY_LENGTH",{enumerable:!0,get:function(){return a.MAX_TRANSACTION_HISTORY_LENGTH}});var i=e("./utils/transaction-type.cjs");Object.defineProperty(n,"determineTransactionType",{enumerable:!0,get:function(){return i.determineTransactionType}});var o=e("./utils/gas-flow.cjs");Object.defineProperty(n,"mergeGasFeeEstimates",{enumerable:!0,get:function(){return o.mergeGasFeeEstimates}});var c=e("./utils/utils.cjs");Object.defineProperty(n,"isEIP1559Transaction",{enumerable:!0,get:function(){return c.isEIP1559Transaction}}),Object.defineProperty(n,"normalizeTransactionParams",{enumerable:!0,get:function(){return c.normalizeTransactionParams}});var u=e("./constants.cjs");Object.defineProperty(n,"CHAIN_IDS",{enumerable:!0,get:function(){return u.CHAIN_IDS}});var l=e("./helpers/AccountsApiRemoteTransactionSource.cjs");Object.defineProperty(n,"INCOMING_TRANSACTIONS_SUPPORTED_CHAIN_IDS",{enumerable:!0,get:function(){return l.SUPPORTED_CHAIN_IDS}});var d=e("./utils/prepare.cjs");Object.defineProperty(n,"HARDFORK",{enumerable:!0,get:function(){return d.HARDFORK}})}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/index.cjs"}],[2755,{"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createModuleLogger=n.incomingTransactionsLogger=n.projectLogger=void 0;const s=e("@metamask/utils");Object.defineProperty(n,"createModuleLogger",{enumerable:!0,get:function(){return s.createModuleLogger}}),n.projectLogger=(0,s.createProjectLogger)("transaction-controller"),n.incomingTransactionsLogger=(0,s.createModuleLogger)(n.projectLogger,"incoming-transactions")}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/logger.cjs"}],[2756,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,a,i,o,c,u,l,d,f;Object.defineProperty(n,"__esModule",{value:!0}),n.SimulationErrorCode=n.SimulationTokenStandard=n.GasFeeEstimateType=n.GasFeeEstimateLevel=n.UserFeeLevel=n.TransactionEnvelopeType=n.TransactionContainerType=n.TransactionType=n.WalletDevice=n.TransactionStatus=void 0,function(e){e.unapproved="unapproved",e.approved="approved",e.signed="signed",e.submitted="submitted",e.confirmed="confirmed",e.failed="failed",e.dropped="dropped",e.rejected="rejected",e.cancelled="cancelled"}(s||(n.TransactionStatus=s={})),function(e){e.MM_MOBILE="metamask_mobile",e.MM_EXTENSION="metamask_extension",e.OTHER="other_device"}(r||(n.WalletDevice=r={})),function(e){e.batch="batch",e.bridge="bridge",e.bridgeApproval="bridgeApproval",e.cancel="cancel",e.contractInteraction="contractInteraction",e.deployContract="contractDeployment",e.ethDecrypt="eth_decrypt",e.ethGetEncryptionPublicKey="eth_getEncryptionPublicKey",e.gasPayment="gas_payment",e.incoming="incoming",e.lendingDeposit="lendingDeposit",e.lendingWithdraw="lendingWithdraw",e.perpsDeposit="perpsDeposit",e.personalSign="personal_sign",e.retry="retry",e.revokeDelegation="revokeDelegation",e.simpleSend="simpleSend",e.signTypedData="eth_signTypedData",e.smart="smart",e.stakingClaim="stakingClaim",e.stakingDeposit="stakingDeposit",e.stakingUnstake="stakingUnstake",e.swap="swap",e.swapAndSend="swapAndSend",e.swapApproval="swapApproval",e.tokenMethodApprove="approve",e.tokenMethodSafeTransferFrom="safetransferfrom",e.tokenMethodTransfer="transfer",e.tokenMethodTransferFrom="transferfrom",e.tokenMethodSetApprovalForAll="setapprovalforall",e.tokenMethodIncreaseAllowance="increaseAllowance"}(a||(n.TransactionType=a={})),function(e){e.EnforcedSimulations="enforcedSimulations"}(i||(n.TransactionContainerType=i={})),function(e){e.legacy="0x0",e.accessList="0x1",e.feeMarket="0x2",e.setCode="0x4"}(o||(n.TransactionEnvelopeType=o={})),function(e){e.CUSTOM="custom",e.DAPP_SUGGESTED="dappSuggested",e.MEDIUM="medium"}(c||(n.UserFeeLevel=c={})),function(e){e.Low="low",e.Medium="medium",e.High="high"}(u||(n.GasFeeEstimateLevel=u={})),function(e){e.FeeMarket="fee-market",e.Legacy="legacy",e.GasPrice="eth_gasPrice"}(l||(n.GasFeeEstimateType=l={})),function(e){e.erc20="erc20",e.erc721="erc721",e.erc1155="erc1155"}(d||(n.SimulationTokenStandard=d={})),function(e){e.ChainNotSupported="chain-not-supported",e.Disabled="disabled",e.InvalidResponse="invalid-response",e.Reverted="reverted"}(f||(n.SimulationErrorCode=f={}))}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/types.cjs"}],[2757,{"../api/simulation-api.cjs":2733,"../constants.cjs":2734,"../errors.cjs":2735,"../logger.cjs":2755,"../types.cjs":2756,"@ethersproject/abi":631,"@metamask/controller-utils":1301,"@metamask/metamask-eth-abis":2064,"@metamask/utils":2799,"bn.js":3699},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.getBalanceChanges=n.SupportedToken=void 0;const r=e("@ethersproject/abi"),a=e("@metamask/controller-utils"),i=e("@metamask/metamask-eth-abis"),o=e("@metamask/utils"),c=s(e("bn.js")),u=e("../api/simulation-api.cjs"),l=e("../constants.cjs"),d=e("../errors.cjs"),f=e("../logger.cjs"),h=e("../types.cjs");var p;!function(e){e.ERC20="erc20",e.ERC721="erc721",e.ERC1155="erc1155",e.ERC20_WRAPPED="erc20Wrapped",e.ERC721_LEGACY="erc721Legacy"}(p||(n.SupportedToken=p={}));const m=(0,o.createModuleLogger)(f.projectLogger,"balance-changes"),g=["Transfer","TransferSingle","TransferBatch","Deposit","Withdrawal"],b={[p.ERC20]:{abi:i.abiERC20,standard:h.SimulationTokenStandard.erc20},[p.ERC721]:{abi:i.abiERC721,standard:h.SimulationTokenStandard.erc721},[p.ERC1155]:{abi:i.abiERC1155,standard:h.SimulationTokenStandard.erc1155},[p.ERC20_WRAPPED]:{abi:l.ABI_SIMULATION_ERC20_WRAPPED,standard:h.SimulationTokenStandard.erc20},[p.ERC721_LEGACY]:{abi:l.ABI_SIMULATION_ERC721_LEGACY,standard:h.SimulationTokenStandard.erc721}},y=["execution reverted","insufficient funds for gas"];function w(e){if(Array.isArray(e))return e.map(w);let t=e;return t=t.toHexString?.()??t,t=t.toLowerCase?.()??t,t}function T(e){return"Transfer"===e.name&&e.tokenStandard===h.SimulationTokenStandard.erc721&&0===parseInt(e.args.from,16)}function E(e){return e.tokenStandard===h.SimulationTokenStandard.erc721?[e.args.tokenId]:e.tokenStandard===h.SimulationTokenStandard.erc1155&&"TransferSingle"===e.name?[e.args.id]:e.tokenStandard===h.SimulationTokenStandard.erc1155&&"TransferBatch"===e.name?e.args.ids:[undefined]}function S(e){switch(e){case h.SimulationTokenStandard.erc721:return new r.Interface(i.abiERC721);case h.SimulationTokenStandard.erc1155:return new r.Interface(i.abiERC1155);default:return new r.Interface(i.abiERC20)}}function v(e,t,n){const s=S(t.standard);try{if(t.standard===h.SimulationTokenStandard.erc721){const t=s.decodeFunctionResult("ownerOf",n.return);return t[0].toLowerCase()===e.toLowerCase()?"0x1":"0x0"}const r=s.decodeFunctionResult("balanceOf",n.return);return(0,a.toHex)(r[0])}catch(e){throw m("Failed to decode balance transaction",e,{token:t,response:n}),new d.SimulationError(`Failed to decode balance transaction for token ${t.address}: ${String(e)}`)}}function k(e,t,n){const s=S(e);switch(e){case h.SimulationTokenStandard.erc721:return s.encodeFunctionData("ownerOf",[n]);case h.SimulationTokenStandard.erc1155:return s.encodeFunctionData("balanceOf",[t,n]);default:return s.encodeFunctionData("balanceOf",[t])}}function P(e){return[...e.logs??[],...(e.calls??[]).map(e=>P(e)).flat()]}function I(e,t,n=0){const s=(0,a.hexToBN)(t).add(new c.default(n)),r=(0,a.hexToBN)(e),i=s.sub(r),o=i.isNeg(),u=(0,a.toHex)(i.abs());return i.isZero()?(m("Balance change is zero"),undefined):{previousBalance:e,newBalance:(0,a.toHex)(s),difference:u,isDecrease:o}}async function _({request:e,params:t,before:n=[],after:s=[]}){const{blockTime:r,chainId:i,ethQuery:o,getSimulationConfig:l,txParams:d}=e,{authorizationList:f}=d,h=d.from,p=f?.map(e=>({address:e.address,from:h})),g=[...n,{authorizationList:p,data:d.data,from:d.from,gas:d.gas,maxFeePerGas:d.maxFeePerGas??d.gasPrice,maxPriorityFeePerGas:d.maxPriorityFeePerGas??d.gasPrice,to:d.to,value:d.value},...s],b=function(e){const{txParams:t}=e,n=(0,a.hexToBN)(t.gas??"0x0"),s=(0,a.hexToBN)(t.maxFeePerGas??t.gasPrice??"0x0"),r=(0,a.hexToBN)(t.value??"0x0"),i=(e.nestedTransactions??[]).map(e=>(0,a.hexToBN)(e.value??"0x0")).reduce((e,t)=>e.add(t),new c.default(0));return n.mul(s).add(r).add(i)}(e),y=(0,a.toHex)(b);m("Required balance",y);const w=await(0,a.query)(o,"getBalance",[h,"latest"]),T=(0,a.hexToBN)(w);m("Current balance",w);const E=T.lt(b);return await(0,u.simulateTransactions)(i,{...t,getSimulationConfig:l,transactions:g,withGas:!0,withDefaultBlockOverrides:!0,...r&&{blockOverrides:{...t?.blockOverrides,time:(0,a.toHex)(r)}},...E&&{overrides:{...t?.overrides,[h]:{...t?.overrides?.[h],balance:y}}}})}n.getBalanceChanges=async function(e){m("Request",e);try{const t=await _({request:e,params:{withCallTrace:!0,withLogs:!0}}),n=t.transactions?.[0]?.error;if(n)throw new d.SimulationError(n);const s=function(e,t){const n=t.transactions[0];if(!n)return undefined;const{txParams:s}=e,r=s.from,{stateDiff:a}=n,i=a?.pre?.[r]?.balance,o=a?.post?.[r]?.balance;if(!i||!o)return undefined;return I(i,o,n.gasCost)}(e,t),a=function(e){const t=P(e.transactions[0]?.callTrace??{});m("Extracted logs",t);const n=function(){const e=Object.values(p);return new Map(e.map(e=>{const{abi:t}=b[e];return[e,new r.Interface(t)]}))}();return t.map(e=>{const t=function(e,t){const n=Object.values(p);for(const s of n)try{const n=t.get(s),{abi:r,standard:a}=b[s];return{...n.parseLog(e),abi:r,standard:a}}catch(e){continue}return undefined}(e,n);if(!t)return m("Failed to parse log",e),undefined;const s=t.abi.find(e=>e.name===t.name)?.inputs;if(!s)return m("Failed to find inputs for event",t),undefined;if(!g.includes(t.name))return m("Ignoring unsupported event",t.name,t),undefined;m("Normalizing event args",t.name,t);const r=function(e,t){return e.reduce((e,n,s)=>{const r=t[s].name.replace("_",""),a=w(n);return e[r]=a,e},{})}(t.args,s);return{contractAddress:e.address,tokenStandard:t.standard,name:t.name,args:r,abi:t.abi}}).filter(e=>e!==undefined)}(t);m("Parsed events",a);const i=await async function(e,t){const{txParams:n}=e,s=n.from,r=function(e,t){const n=new Set,s=new Map,r=new Map,a=e.txParams.from,i=t.filter(e=>[e.args.from,e.args.to].includes(a));m("Filtered user events",i);for(const e of i){const t=E(e);m("Extracted token IDs",t);for(const i of t){const t={address:e.contractAddress,standard:e.tokenStandard,id:i},o=JSON.stringify(t);if(n.has(o)){m("Ignoring additional event with same contract and token ID",t);continue}n.add(o);const c=k(e.tokenStandard,a,i),u={from:a,to:e.contractAddress,data:c};T(e)||s.set(t,u),r.set(t,u)}}return{before:s,after:r}}(e,t);m("Generated balance transactions",[...r.after.values()]);const a=r.before.size+r.after.size+1;if(1===a)return[];const i=await _({request:e,before:[...r.before.values()],after:[...r.after.values()]});if(m("Balance simulation response",i),i.transactions.length!==a)throw new d.SimulationInvalidResponseError;let o=0;return[...r.after.keys()].map((e,t)=>{const n=I(!r.before.get(e)?"0x0":v(s,e,i.transactions[o++]),v(s,e,i.transactions[t+r.before.size+1]));return n?{...e,...n}:undefined}).filter(e=>e!==undefined)}(e,a),o=t.transactions?.[0]?.gasUsed;return{simulationData:{nativeBalanceChange:s,tokenBalanceChanges:i},gasUsed:o}}catch(t){m("Failed to get balance changes",t,e);let n=t;y.some(e=>n.message?.includes(e))&&(n=new d.SimulationRevertedError);const{code:s,message:r}=n;return{simulationData:{tokenBalanceChanges:[],error:{code:s,message:r}},gasUsed:undefined}}}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/balance-changes.cjs"}],[2758,{"../gas-flows/DefaultGasFeeFlow.cjs":2736,"../helpers/GasFeePoller.cjs":2744,"../hooks/CollectPublishHook.cjs":2751,"../hooks/SequentialPublishBatchHook.cjs":2753,"../index.cjs":2754,"../logger.cjs":2755,"../types.cjs":2756,"./eip7702.cjs":2759,"./feature-flags.cjs":2761,"./gas.cjs":2765,"./validation.cjs":2775,"@metamask/controller-utils":1301,"@metamask/rpc-errors":2384,"@metamask/utils":2799,uuid:5366},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isAtomicBatchSupported=n.addTransactionBatch=n.ERROR_MESSAGE_NO_UPGRADE_CONTRACT=void 0;const s=e("@metamask/controller-utils"),r=e("@metamask/rpc-errors"),a=e("@metamask/utils"),i=e("uuid"),o=e("./eip7702.cjs"),c=e("./feature-flags.cjs"),u=e("./gas.cjs"),l=e("./validation.cjs"),d=e("../index.cjs"),f=e("../gas-flows/DefaultGasFeeFlow.cjs"),h=e("../helpers/GasFeePoller.cjs"),p=e("../hooks/CollectPublishHook.cjs"),m=e("../hooks/SequentialPublishBatchHook.cjs"),g=e("../logger.cjs"),b=e("../types.cjs"),y=(0,a.createModuleLogger)(g.projectLogger,"batch");function w(){const e=(0,i.v4)(),t=new Uint8Array((0,i.parse)(e));return(0,a.bytesToHex)(t)}async function T(e,t,n,r,a,i){const{assetsFiatValues:o,existingTransaction:c,params:u,type:l}=t,{addTransaction:f,getTransaction:p,request:m,signTransaction:g,updateTransaction:b}=r,{from:w,networkClientId:T,origin:E}=m;if(c){const{id:t,onPublish:r}=c;let a=p(t);const o=a.txParams.nonce;let{signedTransaction:l}=c;const d=o?parseInt(o,16):undefined,f=i>0&&d!==undefined?d+i:undefined;if(b({transactionId:t},t=>{t.batchId=e,f&&(t.txParams.nonce=(0,s.toHex)(f))}),f){y("Re-signing existing transaction",{currentNonce:d,newNonce:f});const e=p(t),n=await g(e);if(!n)throw new Error("Failed to resign transaction");l=n,a=p(t),y("New signature",l)}return n(a,l).then(r).catch(()=>{}),y("Processed existing transaction with hook",{id:t,params:u}),{id:t,params:u}}const S={...a,txParams:{...u,from:w,gas:a?.gas??u.gas}};a&&(0,h.updateTransactionGasEstimates)({txMeta:S,userFeeLevel:d.GasFeeEstimateLevel.Medium});const{transactionMeta:v}=await f(S.txParams,{assetsFiatValues:o,batchId:e,disableGasBuffer:!0,networkClientId:T,origin:E,publishHook:n,requireApproval:!1,type:l}),{id:k,txParams:P}=v,I={data:P.data,gas:P.gas,maxFeePerGas:P.maxFeePerGas,maxPriorityFeePerGas:P.maxPriorityFeePerGas,to:P.to,value:P.value};return y("Processed new transaction with hook",{id:k,params:I,type:l}),{id:k,params:I,type:l}}n.ERROR_MESSAGE_NO_UPGRADE_CONTRACT="Upgrade contract address not found",n.addTransactionBatch=async function(e){const{getInternalAccounts:t,messenger:a,request:i}=e,h=(0,c.getBatchSizeLimit)(a);if((0,l.validateBatchRequest)({internalAccounts:t(),request:i,sizeLimit:h}),y("Adding",i),!i.disable7702)try{return await async function(e){const{addTransaction:t,getChainId:s,getTransaction:a,messenger:i,publicKeyEIP7702:u,request:l}=e,{batchId:f,from:h,networkClientId:p,origin:m,requireApproval:g,securityAlertId:T,transactions:E,validateSecurity:S}=l,v=s(p),k=e.getEthQuery(p),P=(0,o.doesChainSupportEIP7702)(v,i);if(!P)throw y("Chain does not support EIP-7702",v),r.rpcErrors.internal("Chain does not support EIP-7702");if(!u)throw r.rpcErrors.internal(o.ERROR_MESSGE_PUBLIC_KEY);const{delegationAddress:I,isSupported:_}=await(0,o.isAccountUpgradedToEIP7702)(h,v,u,i,k);if(y("Account",{delegationAddress:I,isSupported:_}),!_&&I)throw y("Account upgraded to unsupported contract",h,I),r.rpcErrors.internal("Account upgraded to unsupported contract");const x=await Promise.all(E.map(e=>async function(e,t,n){const{from:s}=e,{params:r,type:a}=t,{type:i}=await(0,d.determineTransactionType)({from:s,...r},n),o=a??i;return{...r,type:o}}(l,e,k))),j=E.find(e=>e.existingTransaction),A=j?a(j.existingTransaction?.id):undefined,C=(0,o.generateEIP7702BatchTransaction)(h,x),R={from:h,...C},O=A?.txParams?.nonce;O&&(R.nonce=O);if(!_){const e=(0,c.getEIP7702UpgradeContractAddress)(v,i,u);if(!e)throw r.rpcErrors.internal(n.ERROR_MESSAGE_NO_UPGRADE_CONTRACT);R.type=b.TransactionEnvelopeType.setCode,R.authorizationList=[{address:e}]}if(S){const e={method:"eth_sendTransaction",params:[{...R,authorizationList:undefined,type:b.TransactionEnvelopeType.feeMarket}],delegationMock:R.authorizationList?.[0]?.address,origin:m};y("Security request",e),S(e,v).catch(e=>{y("Security validation failed",e)})}y("Adding batch transaction",R,p);const M=f??w(),B=T?{securityAlertId:T}:undefined,{result:N}=await t(R,{batchId:M,isGasFeeIncluded:l.isGasFeeIncluded,nestedTransactions:x,networkClientId:p,origin:m,requireApproval:g,securityAlertResponse:B,type:b.TransactionType.batch}),F=await N;return j?.existingTransaction?.onPublish?.({transactionHash:F}),{batchId:M}}(e)}catch(e){if(!(e instanceof r.JsonRpcError&&"Chain does not support EIP-7702"===e.message))throw e}return await async function(e){const{messenger:t,publishBatchHook:n,request:a,update:i}=e,{from:o,networkClientId:c,origin:l,requireApproval:h,transactions:g}=a;let b,E=!1;y("Adding transaction batch using hook",a);const S=new m.SequentialPublishBatchHook({publishTransaction:e.publishTransaction,getTransaction:e.getTransaction,getEthQuery:e.getEthQuery,getPendingTransactionTracker:e.getPendingTransactionTracker});let{disable7702:v,disableSequential:k}=a;const{disableHook:P,useHook:I}=a;I&&(v=!0,k=!0);let _,x=null;!P&&n?x=n:k||(x=S.getHook(),E=!0);if(!x)throw y("No supported batch methods found",{disable7702:v,disableHook:P,disableSequential:k}),r.rpcErrors.internal("Can't process batch");const j=w(),A=g.map(e=>({...e,origin:l})),C=A.length,R=new p.CollectPublishHook(C);try{h&&(_=await async function({batchId:e,request:t}){const{messenger:n,request:s,isSimulationEnabled:r,getChainId:a,getEthQuery:i,getGasFeeEstimates:o,getSimulationConfig:c,update:l}=t,{from:h,origin:p,networkClientId:m,transactions:g}=s,b=i(m);if(!r())throw new Error("Cannot create transaction batch as simulation not supported");y("Preparing approval data for batch");const w=a(m),{gasLimit:T}=await(0,u.simulateGasBatch)({chainId:w,from:h,getSimulationConfig:c,transactions:g}),E=(P={chainId:w,from:h,gas:T,id:e,networkClientId:m,origin:p,transactions:g},{...P,status:d.TransactionStatus.unapproved}),S=new f.DefaultGasFeeFlow,v=await o({networkClientId:m}),k=await S.getGasFees({ethQuery:b,gasFeeControllerData:v,messenger:n,transactionMeta:{...E,txParams:{from:h,gas:T},time:Date.now()}});var P;return E.gasFeeEstimates=k.estimates,y("Saving transaction batch metadata",E),function(e,t){t(t=>{t.transactionBatches=[...t.transactionBatches,e]})}(E,l),E}({batchId:j,request:e}),b=(await async function(e,t){const n=String(e.id),{origin:r}=e,a=s.ApprovalType.TransactionBatch,i={txBatchId:n};return y("Requesting approval for transaction batch",n),await t.call("ApprovalController:addRequest",{id:n,origin:r||s.ORIGIN_METAMASK,requestData:i,expectsResult:!0,type:a},!0)}(_,t)).resultCallbacks);const n=R.getHook(),r=[];let a=0;for(const t of A){const s=await T(j,t,n,e,_,a);r.push(s),a+=1}const{signedTransactions:i}=await R.ready(),l={from:o,networkClientId:c,transactions:r.map((e,t)=>({...e,signedTx:i[t]}))};y("Calling publish batch hook",l);let p=await x(l);if(y("Publish batch hook result",p),!p&&!E&&!k){y("Fallback to sequential publish batch hook due to empty results");const e=S.getHook();p=await e(l)}if(!p?.results?.length)throw new Error("Publish batch hook did not return a result");const m=p.results.map(({transactionHash:e})=>e);return R.success(m),b?.success(),y("Completed batch transaction with hook",m),{batchId:j}}catch(e){throw y("Publish batch hook failed",e),R.error(e),b?.error(e),e}finally{y("Cleaning up publish batch hook",j),function(e,t){e(e=>{e.transactionBatches=e.transactionBatches.filter(e=>e.id!==t)})}(i,j)}}(e)},n.isAtomicBatchSupported=async function(e){const{address:t,chainIds:n,getEthQuery:s,messenger:a,publicKeyEIP7702:i}=e;if(!i)throw r.rpcErrors.internal(o.ERROR_MESSGE_PUBLIC_KEY);const u=(0,c.getEIP7702SupportedChains)(a).filter(e=>!n||n.includes(e)),l=(await Promise.all(u.map(async e=>{try{const n=s(e),{isSupported:r,delegationAddress:u}=await(0,o.isAccountUpgradedToEIP7702)(t,e,i,a,n);return{chainId:e,delegationAddress:u,isSupported:r,upgradeContractAddress:(0,c.getEIP7702UpgradeContractAddress)(e,a,i)}}catch(t){return y("Error checking atomic batch support",e,t),undefined}}))).filter(e=>Boolean(e));return y("Atomic batch supported results",l),l}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/batch.cjs"}],[2759,{"../constants.cjs":2734,"../logger.cjs":2755,"./feature-flags.cjs":2761,"@ethersproject/abi":631,"@ethersproject/contracts":654,"@metamask/controller-utils":1301,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.signAuthorizationList=n.generateEIP7702BatchTransaction=n.isAccountUpgradedToEIP7702=n.getDelegationAddress=n.doesChainSupportEIP7702=n.ERROR_MESSGE_PUBLIC_KEY=n.CALLS_SIGNATURE=n.BATCH_FUNCTION_NAME=n.DELEGATION_PREFIX=void 0;const s=e("@ethersproject/abi"),r=e("@ethersproject/contracts"),a=e("@metamask/controller-utils"),i=e("@metamask/utils"),o=e("./feature-flags.cjs"),c=e("../constants.cjs"),u=e("../logger.cjs");n.DELEGATION_PREFIX="0xef0100",n.BATCH_FUNCTION_NAME="execute",n.CALLS_SIGNATURE="(address,uint256,bytes)[]",n.ERROR_MESSGE_PUBLIC_KEY="EIP-7702 public key not specified";const l=(0,i.createModuleLogger)(u.projectLogger,"eip-7702");async function d(e,t){const s=await(0,a.query)(t,"eth_getCode",[e]),r=(0,i.add0x)(s?.toLowerCase?.()??"");return 48===s?.length&&r.startsWith(n.DELEGATION_PREFIX)?(0,i.add0x)(r.slice(n.DELEGATION_PREFIX.length)):undefined}async function f(e,t,n,s){const r=function(e,t,n){const{chainId:s,nonce:r}=e,{txParams:i,chainId:o}=t,{nonce:c}=i,u=s??o;let d=r;d===undefined&&(d=(0,a.toHex)(parseInt(c,16)+1+n));const f={...e,chainId:u,nonce:d};return l("Prepared authorization",f),f}(e,t,s),{txParams:o}=t,{from:c}=o,{address:u,chainId:d,nonce:f}=r,h=parseInt(d,16),p=parseInt(f,16),m=await n.call("KeyringController:signEip7702Authorization",{chainId:h,contractAddress:u,from:c,nonce:p}),g=m.slice(0,66),b=(0,i.add0x)(m.slice(66,130)),y=parseInt(m.slice(130,132),16),w={address:u,chainId:d,nonce:f,r:g,s:b,yParity:(0,a.toHex)(y-27==0?0:1)};return l("Signed authorization",w),w}n.doesChainSupportEIP7702=function(e,t){return(0,o.getEIP7702SupportedChains)(t).some(t=>t.toLowerCase()===e.toLowerCase())},n.getDelegationAddress=d,n.isAccountUpgradedToEIP7702=async function(e,t,n,s,r){const a=(0,o.getEIP7702ContractAddresses)(t,s,n),i=await d(e,r),c=Boolean(i&&a.some(e=>e.toLowerCase()===i.toLowerCase()));return{delegationAddress:i,isSupported:c}},n.generateEIP7702BatchTransaction=function(e,t){const a=r.Contract.getInterface(c.ABI_IERC7821),i=t.map(e=>{const{data:t,to:n,value:s}=e;return[n??"0x0000000000000000000000000000000000000000",s??"0x0",t??"0x"]}),o="0x01".padEnd(66,"0"),u=s.defaultAbiCoder.encode([n.CALLS_SIGNATURE],[i]),d=a.encodeFunctionData(n.BATCH_FUNCTION_NAME,[o,u]);return l("Transaction data",d),{data:d,to:e}},n.signAuthorizationList=async function({authorizationList:e,messenger:t,transactionMeta:n}){if(!e)return undefined;const s=[];let r=0;for(const a of e){const e=await f(a,n,t,r);s.push(e),r+=1}return s}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/eip7702.cjs"}],[2760,{"../types.cjs":2756,"@metamask/rpc-errors":2384},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.validateConfirmedExternalTransaction=void 0;const s=e("@metamask/rpc-errors"),r=e("../types.cjs");n.validateConfirmedExternalTransaction=function(e,t,n){if(!e||!e.txParams)throw s.rpcErrors.invalidParams('"transactionMeta" or "transactionMeta.txParams" is missing');if(e.status!==r.TransactionStatus.confirmed)throw s.rpcErrors.invalidParams('External transaction status should be "confirmed"');const a=e.txParams.nonce;if(n&&n.length>0){if(n.find(e=>e.txParams?.nonce===a))throw s.rpcErrors.invalidParams("External transaction nonce should not be in pending txs")}if(t&&t.length>0){if(t.find(e=>e.txParams?.nonce===a))throw s.rpcErrors.invalidParams("External transaction nonce should not be in confirmed txs")}}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/external-transactions.cjs"}],[2761,{"../logger.cjs":2755,"./signature.cjs":2771,"./utils.cjs":2774,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getIncomingTransactionsPollingInterval=n.getGasEstimateBuffer=n.getGasEstimateFallback=n.getGasFeeRandomisation=n.getAcceleratedPollingParams=n.getBatchSizeLimit=n.getEIP7702UpgradeContractAddress=n.getEIP7702ContractAddresses=n.getEIP7702SupportedChains=n.FeatureFlag=void 0;const s=e("@metamask/utils"),r=e("./signature.cjs"),a=e("./utils.cjs"),i=e("../logger.cjs");var o;!function(e){e.EIP7702="confirmations_eip_7702",e.GasBuffer="confirmations_gas_buffer",e.IncomingTransactions="confirmations_incoming_transactions",e.Transactions="confirmations_transactions"}(o||(n.FeatureFlag=o={}));const c=(0,s.createModuleLogger)(i.projectLogger,"feature-flags");function u(e,t,n){const s=l(t);return(s?.[o.EIP7702]?.contracts?.[e.toLowerCase()]??[]).filter(t=>(0,r.isValidSignature)([t.address,(0,a.padHexToEvenLength)(e)],t.signature,n)).map(e=>e.address)}function l(e){const t=e.call("RemoteFeatureFlagController:getState").remoteFeatureFlags;return c("Retrieved feature flags",t),t}n.getEIP7702SupportedChains=function(e){const t=l(e);return t?.[o.EIP7702]?.supportedChains??[]},n.getEIP7702ContractAddresses=u,n.getEIP7702UpgradeContractAddress=function(e,t,n){return u(e,t,n)?.[0]},n.getBatchSizeLimit=function(e){const t=l(e);return t?.[o.Transactions]?.batchSizeLimit??10},n.getAcceleratedPollingParams=function(e,t){const n=l(t),s=n?.[o.Transactions]?.acceleratedPolling;return{countMax:s?.perChainConfig?.[e]?.countMax||s?.defaultCountMax||10,intervalMs:s?.perChainConfig?.[e]?.intervalMs||s?.defaultIntervalMs||3e3}},n.getGasFeeRandomisation=function(e){const t=l(e),n=t?.[o.Transactions]?.gasFeeRandomisation||{};return{randomisedGasFeeDigits:n.randomisedGasFeeDigits||{},preservedNumberOfDigits:n.preservedNumberOfDigits}},n.getGasEstimateFallback=function(e,t){const n=l(t),s=n?.[o.Transactions]?.gasEstimateFallback,r=s?.perChainConfig?.[e],a=r?.percentage??s?.default?.percentage??35;return{fixed:r?.fixed??s?.default?.fixed,percentage:a}},n.getGasEstimateBuffer=function({chainId:e,isCustomRPC:t,isUpgradeWithDataToSelf:n,messenger:s}){const r=l(s),a=r?.[o.GasBuffer],i=a?.perChainConfig?.[e],c=t?undefined:i?.included,u=t?undefined:a?.included;return(n?i?.eip7702:undefined)??c??i?.base??u??a?.default??1},n.getIncomingTransactionsPollingInterval=function(e){const t=l(e);return t?.[o.IncomingTransactions]?.pollingIntervalMs??24e4}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/feature-flags.cjs"}],[2762,{"../api/simulation-api.cjs":2733,"../logger.cjs":2755,"./batch.cjs":2758,"./eip7702.cjs":2759,"./feature-flags.cjs":2761,"@metamask/rpc-errors":2384,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getGasFeeTokens=void 0;const s=e("@metamask/rpc-errors"),r=e("@metamask/utils"),a=e("./batch.cjs"),i=e("./eip7702.cjs"),o=e("./feature-flags.cjs"),c=e("../api/simulation-api.cjs"),u=e("../logger.cjs"),l=(0,r.createModuleLogger)(u.projectLogger,"gas-fee-tokens");n.getGasFeeTokens=async function({chainId:e,isEIP7702GasFeeTokensEnabled:t,messenger:n,publicKeyEIP7702:r,transactionMeta:u,getSimulationConfig:d}){const{delegationAddress:f,txParams:h}=u,{authorizationList:p}=h,m=h.data,g=h.from,b=h.to,y=h.value;l("Request",{chainId:e,txParams:h});const w=await t(u)&&(0,i.doesChainSupportEIP7702)(e,n);let T=p?.map(e=>({address:e.address,from:g}));!w||f||T||(T=function({chainId:e,from:t,messenger:n,publicKeyEIP7702:r}){if(!r)throw s.rpcErrors.internal(i.ERROR_MESSGE_PUBLIC_KEY);const c=(0,o.getEIP7702UpgradeContractAddress)(e,n,r);if(!c)throw s.rpcErrors.internal(a.ERROR_MESSAGE_NO_UPGRADE_CONTRACT);return[{address:c,from:t}]}({chainId:e,from:g,messenger:n,publicKeyEIP7702:r}));try{const t=await(0,c.simulateTransactions)(e,{getSimulationConfig:d,transactions:[{authorizationList:T,data:m,from:g,to:b,value:y}],suggestFees:{withTransfer:!0,withFeeTransfer:!0,with7702:w}});l("Response",t);const n=function(e){const t=e.transactions?.[0]?.fees?.[0],n=e.sponsorship?.isSponsored??!1;return{gasFeeTokens:(t?.tokenFees??[]).map(e=>({amount:e.balanceNeededToken,balance:e.currentBalanceToken,decimals:e.token.decimals,fee:e.serviceFee,gas:t.gas,gasTransfer:e.transferEstimate,maxFeePerGas:t.maxFeePerGas,maxPriorityFeePerGas:t.maxPriorityFeePerGas,rateWei:e.rateWei,recipient:e.feeRecipient,symbol:e.token.symbol,tokenAddress:e.token.address})),isGasFeeSponsored:n}}(t);return l("Gas fee tokens",n),n}catch(e){return l("Failed to gas fee tokens",e),{gasFeeTokens:[],isGasFeeSponsored:!1}}}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/gas-fee-tokens.cjs"}],[2763,{"../logger.cjs":2755,"../types.cjs":2756,"./gas-flow.cjs":2764,"./swaps.cjs":2772,"@metamask/controller-utils":1301,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.gweiDecimalToWeiDecimal=n.gweiDecimalToWeiHex=n.updateGasFees=void 0;const s=e("@metamask/controller-utils"),r=e("@metamask/utils"),a=e("./gas-flow.cjs"),i=e("./swaps.cjs"),o=e("../logger.cjs"),c=e("../types.cjs"),u=(0,r.createModuleLogger)(o.projectLogger,"gas-fees");function l(e){return(0,s.toHex)((0,s.gweiDecToWEIBN)(e))}n.updateGasFees=async function(e){const{txMeta:t}=e,n={...t.txParams},o=i.SWAP_TRANSACTION_TYPES.includes(t.type)?undefined:e.getSavedGasFees(t.chainId),d=await async function(e){const{eip1559:t,ethQuery:n,gasFeeFlows:i,getGasFeeEstimates:o,messenger:l,txMeta:d}=e,{networkClientId:f}=d;if(!t&&d.txParams.gasPrice||t&&d.txParams.maxFeePerGas&&d.txParams.maxPriorityFeePerGas)return{};const h=(0,a.getGasFeeFlow)(d,i,l);try{const e=await o({networkClientId:f}),t=await h.getGasFees({ethQuery:n,gasFeeControllerData:e,messenger:l,transactionMeta:d}),s=t.estimates?.type;switch(s){case c.GasFeeEstimateType.FeeMarket:return t.estimates.medium;case c.GasFeeEstimateType.Legacy:return{gasPrice:t.estimates.medium};case c.GasFeeEstimateType.GasPrice:return{gasPrice:t.estimates.gasPrice};default:throw new Error(`Unsupported gas fee estimate type returned from flow: ${s}`)}}catch(e){u("Failed to get suggested gas fees",e)}const p=await(0,s.query)(n,"gasPrice");return{gasPrice:p?(0,r.add0x)(p.toString(16)):undefined}}(e);u("Suggested gas fees",d);const f={...e,initialParams:n,savedGasFees:o,suggestedGasFees:d};t.txParams.maxFeePerGas=function(e){const{savedGasFees:t,eip1559:n,initialParams:s,suggestedGasFees:r}=e;if(!n)return undefined;if(t){const e=l(t.maxBaseFee);return u("Using maxFeePerGas from savedGasFees",e),e}if(s.maxFeePerGas)return u("Using maxFeePerGas from request",s.maxFeePerGas),s.maxFeePerGas;if(s.gasPrice&&!s.maxPriorityFeePerGas)return u("Setting maxFeePerGas to gasPrice from request",s.gasPrice),s.gasPrice;if(r.maxFeePerGas)return u("Using suggested maxFeePerGas",r.maxFeePerGas),r.maxFeePerGas;if(r.gasPrice)return u("Setting maxFeePerGas to suggested gasPrice",r.gasPrice),r.gasPrice;return u("maxFeePerGas not set"),undefined}(f),t.txParams.maxPriorityFeePerGas=function(e){const{eip1559:t,initialParams:n,savedGasFees:s,suggestedGasFees:r,txMeta:a}=e;if(!t)return undefined;if(s){const e=l(s.priorityFee);return u("Using maxPriorityFeePerGas from savedGasFees.priorityFee",e),e}if(n.maxPriorityFeePerGas)return u("Using maxPriorityFeePerGas from request",n.maxPriorityFeePerGas),n.maxPriorityFeePerGas;if(n.gasPrice&&!n.maxFeePerGas)return u("Setting maxPriorityFeePerGas to gasPrice from request",n.gasPrice),n.gasPrice;if(r.maxPriorityFeePerGas)return u("Using suggested maxPriorityFeePerGas",r.maxPriorityFeePerGas),r.maxPriorityFeePerGas;if(a.txParams.maxFeePerGas)return u("Setting maxPriorityFeePerGas to maxFeePerGas",a.txParams.maxFeePerGas),a.txParams.maxFeePerGas;return u("maxPriorityFeePerGas not set"),undefined}(f),t.txParams.gasPrice=function(e){const{eip1559:t,initialParams:n,suggestedGasFees:s}=e;if(t)return undefined;if(n.gasPrice)return u("Using gasPrice from request",n.gasPrice),n.gasPrice;if(s.maxFeePerGas)return u("Using suggested maxFeePerGas",s.maxFeePerGas),s.maxFeePerGas;if(s.gasPrice)return u("Using suggested gasPrice",s.gasPrice),s.gasPrice;return u("gasPrice not set"),undefined}(f),t.userFeeLevel=function(e){const{initialParams:t,savedGasFees:n,suggestedGasFees:r,txMeta:a}=e;if(n)return c.UserFeeLevel.CUSTOM;if(!t.maxFeePerGas&&!t.maxPriorityFeePerGas&&t.gasPrice)return a.origin===s.ORIGIN_METAMASK?c.UserFeeLevel.CUSTOM:c.UserFeeLevel.DAPP_SUGGESTED;if(!t.maxFeePerGas&&!t.maxPriorityFeePerGas&&r.maxFeePerGas&&r.maxPriorityFeePerGas)return c.UserFeeLevel.MEDIUM;if(!t.maxFeePerGas&&!t.maxPriorityFeePerGas&&r.gasPrice)return c.UserFeeLevel.MEDIUM;if(a.origin===s.ORIGIN_METAMASK)return c.UserFeeLevel.MEDIUM;return c.UserFeeLevel.DAPP_SUGGESTED}(f),u("Updated gas fee properties",{maxFeePerGas:t.txParams.maxFeePerGas,maxPriorityFeePerGas:t.txParams.maxPriorityFeePerGas,gasPrice:t.txParams.gasPrice}),(t.txParams.maxFeePerGas||t.txParams.maxPriorityFeePerGas)&&delete t.txParams.gasPrice,t.txParams.gasPrice&&(delete t.txParams.maxFeePerGas,delete t.txParams.maxPriorityFeePerGas),function(e){e.defaultGasEstimates||(e.defaultGasEstimates={});e.defaultGasEstimates.maxFeePerGas=e.txParams.maxFeePerGas,e.defaultGasEstimates.maxPriorityFeePerGas=e.txParams.maxPriorityFeePerGas,e.defaultGasEstimates.gasPrice=e.txParams.gasPrice,e.defaultGasEstimates.estimateType=e.userFeeLevel}(t)},n.gweiDecimalToWeiHex=l,n.gweiDecimalToWeiDecimal=function(e){return(1e9*Number(e)).toString().split(".")[0]}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/gas-fees.cjs"}],[2764,{"../types.cjs":2756,"@metamask/controller-utils":1301},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.mergeGasFeeEstimates=n.getGasFeeFlow=void 0;const s=e("@metamask/controller-utils"),r=e("../types.cjs");function a(e,t){return(0,s.weiHexToGweiDec)(e[t])}n.getGasFeeFlow=function(e,t,n){return t.find(t=>t.matchesTransaction({transactionMeta:e,messenger:n}))},n.mergeGasFeeEstimates=function({gasFeeControllerEstimates:e,transactionGasFeeEstimates:t}){const n=t.type;return n===r.GasFeeEstimateType.FeeMarket?Object.values(r.GasFeeEstimateLevel).reduce((n,r)=>{return{...n,[r]:(a=e?.[r],i=t[r],{...a,suggestedMaxFeePerGas:(0,s.weiHexToGweiDec)(i.maxFeePerGas),suggestedMaxPriorityFeePerGas:(0,s.weiHexToGweiDec)(i.maxPriorityFeePerGas)})};var a,i},{...e}):n===r.GasFeeEstimateType.Legacy?Object.values(r.GasFeeEstimateLevel).reduce((e,n)=>({...e,[n]:a(t,n)}),{}):n===r.GasFeeEstimateType.GasPrice?{gasPrice:(i=t,(0,s.weiHexToGweiDec)(i.gasPrice))}:e;var i}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/gas-flow.cjs"}],[2765,{"../api/simulation-api.cjs":2733,"../logger.cjs":2755,"../types.cjs":2756,"./eip7702.cjs":2759,"./feature-flags.cjs":2761,"@metamask/controller-utils":1301,"@metamask/utils":2799,"bn.js":3699},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.simulateGasBatch=n.addGasBuffer=n.estimateGas=n.updateGas=n.DUMMY_AUTHORIZATION_SIGNATURE=n.INTRINSIC_GAS=n.MAX_GAS_BLOCK_PERCENT=n.DEFAULT_GAS_MULTIPLIER=n.FIXED_GAS=n.log=void 0;const s=e("@metamask/controller-utils"),r=e("@metamask/utils"),a=e("bn.js"),i=e("./eip7702.cjs"),o=e("./feature-flags.cjs"),c=e("../api/simulation-api.cjs"),u=e("../logger.cjs"),l=e("../types.cjs");async function d({chainId:e,ethQuery:t,ignoreDelegationSignatures:a,isSimulationEnabled:i,getSimulationConfig:c,messenger:u,txParams:d}){const f={...d},{authorizationList:m,data:g,from:b,value:y,to:w}=f;if(a&&!i)throw new Error("Gas estimation with ignored delegation signatures is not supported as simulation disabled");const{gasLimit:T,number:E}=await async function(e){return await(0,s.query)(e,"getBlockByNumber",["latest",!1])}(t),S=(0,s.hexToBN)(T),{percentage:v,fixed:k}=(0,o.getGasEstimateFallback)(e,u),P=k?(0,s.toHex)(k):(0,s.BNToHex)((0,s.fractionBN)(S,v,100));(0,n.log)("Estimation fallback values",P),f.data=g?(0,r.add0x)(g):g,f.value=y||"0x0",f.authorizationList=function(e,t){return e?.map(e=>({...e,chainId:e.chainId??t,nonce:e.nonce??"0x1",r:e.r??n.DUMMY_AUTHORIZATION_SIGNATURE,s:e.s??n.DUMMY_AUTHORIZATION_SIGNATURE,yParity:e.yParity??"0x1"}))}(f.authorizationList,e),delete f.gasPrice,delete f.maxFeePerGas,delete f.maxPriorityFeePerGas;let I,_=P;const x=d.type===l.TransactionEnvelopeType.setCode&&Boolean(m?.length)&&Boolean(g)&&"0x"!==g&&b?.toLowerCase()===w?.toLowerCase();try{_=i&&x?await async function(e,t,r,a){const i=await(0,s.query)(t,"estimateGas",[{...e,data:"0x"}]);(0,n.log)("Upgrade only gas",i);const o=e.authorizationList?.[0].address;let c;try{c=await h({chainId:r,delegationAddress:o,getSimulationConfig:a,transaction:e})}catch(e){(0,n.log)("Error while simulating data portion of upgrade",e)}if(c===undefined){try{c=await p(t,{...e,authorizationList:undefined,type:undefined},o)}catch(e){throw(0,n.log)("Error while estimating data portion of upgrade",e),e}(0,n.log)("Success estimating data portion of upgrade",c)}(0,n.log)("Execute gas",c);const u=(0,s.BNToHex)((0,s.hexToBN)(i).add((0,s.hexToBN)(c)).subn(n.INTRINSIC_GAS));return(0,n.log)("Total type 4 gas",u),u}(f,t,e,c):a&&i?await h({chainId:e,getSimulationConfig:c,transaction:f}):await p(t,f)}catch(e){I={reason:e.message,errorKey:e.errorKey,debug:{blockNumber:E,blockGasLimit:T}},(0,n.log)("Estimation failed",{...I,fallback:P})}return{blockGasLimit:T,estimatedGas:_,isUpgradeWithDataToSelf:x,simulationFails:I}}function f(e,t,a){const i=(0,s.hexToBN)(e),o=(0,s.fractionBN)((0,s.hexToBN)(t),n.MAX_GAS_BLOCK_PERCENT,100),c=(0,s.fractionBN)(i,100*a,100);if(i.gt(o)){const t=(0,r.add0x)(e);return(0,n.log)("Using estimated value",t),t}if(c.lt(o)){const e=(0,r.add0x)((0,s.BNToHex)(c));return(0,n.log)("Using padded estimate",e,a),e}const u=(0,r.add0x)((0,s.BNToHex)(o));return(0,n.log)("Using 90% of block gas limit",u),u}async function h({chainId:e,delegationAddress:t,getSimulationConfig:n,transaction:s}){const a=await(0,c.simulateTransactions)(e,{getSimulationConfig:n,transactions:[{to:s.to,from:s.from,data:s.data,value:s.value}],overrides:{[s.from]:{code:t&&i.DELEGATION_PREFIX+(0,r.remove0x)(t)}}}),o=a?.transactions?.[0].gasLimit;if(!o)throw new Error("No simulated gas returned");return o}function p(e,t,n){const{from:a}=t,o=[t];return n&&(o.push("latest"),o.push({[a]:{code:i.DELEGATION_PREFIX+(0,r.remove0x)(n)}})),(0,s.query)(e,"estimateGas",o)}n.log=(0,r.createModuleLogger)(u.projectLogger,"gas"),n.FIXED_GAS="0x5208",n.DEFAULT_GAS_MULTIPLIER=1.5,n.MAX_GAS_BLOCK_PERCENT=90,n.INTRINSIC_GAS=21e3,n.DUMMY_AUTHORIZATION_SIGNATURE="0x1111111111111111111111111111111111111111111111111111111111111111",n.updateGas=async function(e){const{txMeta:t}=e,r={...t.txParams},[a,i,c]=await async function(e){const{chainId:t,isCustomNetwork:r,isSimulationEnabled:a,getSimulationConfig:i,messenger:c,txMeta:u}=e,{disableGasBuffer:h}=u;if(u.txParams.gas)return(0,n.log)("Using value from request",u.txParams.gas),[u.txParams.gas,undefined,u.txParams.gas];if(await async function({ethQuery:e,txMeta:t,isCustomNetwork:n}){const{txParams:{to:r,data:a,type:i}}=t;if(n||!r||a||i===l.TransactionEnvelopeType.setCode)return!1;const o=await async function(e,t){return await(0,s.query)(e,"getCode",[t])}(e,r);return!o||"0x"===o}(e))return(0,n.log)("Using fixed value",n.FIXED_GAS),[n.FIXED_GAS,undefined,n.FIXED_GAS];const{blockGasLimit:p,estimatedGas:m,isUpgradeWithDataToSelf:g,simulationFails:b}=await d({chainId:t,ethQuery:e.ethQuery,isSimulationEnabled:a,getSimulationConfig:i,messenger:c,txParams:u.txParams});(0,n.log)("Original estimated gas",m),b&&(0,n.log)("Using original fallback estimate as simulation failed");h&&(0,n.log)("Gas buffer disabled");if(b||h)return[m,b,m];const y=(0,o.getGasEstimateBuffer)({chainId:t,isCustomRPC:r,isUpgradeWithDataToSelf:g,messenger:c});(0,n.log)("Buffer",y);const w=f(m,p,y);return(0,n.log)("Buffered gas",w),[w,b,m]}(e);t.txParams.gas=a,t.simulationFails=i,t.gasLimitNoBuffer=c,r.gas||(t.originalGasEstimate=t.txParams.gas),t.defaultGasEstimates||(t.defaultGasEstimates={}),t.defaultGasEstimates.gas=t.txParams.gas},n.estimateGas=d,n.addGasBuffer=f,n.simulateGasBatch=async function({chainId:e,from:t,getSimulationConfig:r,transactions:i}){try{const n=await(0,c.simulateTransactions)(e,{getSimulationConfig:r,transactions:i.map(e=>({...e.params,from:t}))});if(!n?.transactions||n.transactions.length!==i.length)throw new Error("Simulation response does not match transaction count");const o=n.transactions.reduce((e,t)=>{const n=t?.gasLimit;if(!n)throw new Error("No simulated gas returned for one of the transactions");return e.add((0,s.hexToBN)(n))},new a.BN(0));return{gasLimit:(0,s.BNToHex)(o)}}catch(e){throw(0,n.log)("Error while simulating gas batch",e),new Error("Cannot estimate transaction batch total gas as simulation failed")}}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/gas.cjs"}],[2766,{"fast-json-patch":4107,lodash:4534},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.updateTransactionHistory=n.addInitialHistorySnapshot=n.DISPLAYED_TRANSACTION_HISTORY_PATHS=n.MAX_TRANSACTION_HISTORY_LENGTH=void 0;const r=s(e("fast-json-patch")),a=e("lodash");function i(e,t,n){const s=r.default.compare(e,t);return s[0]&&(n&&(s[0].note=n),s[0].timestamp=Date.now()),s}function o(e){return(0,a.cloneDeep)(e).reduce((e,t)=>r.default.applyPatch(e,t).newDocument)}function c(e){const t={...e};return delete t.history,(0,a.cloneDeep)(t)}n.MAX_TRANSACTION_HISTORY_LENGTH=100,n.DISPLAYED_TRANSACTION_HISTORY_PATHS=["/status","/txParams/gasPrice","/txParams/gas","/estimatedBaseFee","/blockTimestamp"],n.addInitialHistorySnapshot=function(e){const t=c(e);return(0,a.merge)({},e,{history:[t]})},n.updateTransactionHistory=function(e,t){if(!e.history)return e;const s=c(e),r=i(o(e.history),s,t);if(0===r.length)return e;let u=[...e.history,r];return u.length>n.MAX_TRANSACTION_HISTORY_LENGTH&&(u=function(e){const t=e[0],s=e.slice(1),r=s.findIndex(e=>!e.some(({path:e})=>n.DISPLAYED_TRANSACTION_HISTORY_PATHS.includes(e)));if(-1===r)return e;const a=r===s.length-1?r-1:r+1,c=Math.min(r,a),u=s[c],l=s[c+1],d=o([t,...s.slice(0,c)]),f=o([d,u,l]),h=i(d,f,`${String(u[0].note)}, ${String(l[0].note)}`);return s.splice(c,2,h),[t,...s]}(u)),(0,a.merge)({},e,{history:u})}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/history.cjs"}],[2767,{"../logger.cjs":2755,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getTransactionLayer1GasFee=n.updateTransactionLayer1GasFee=void 0;const s=e("@metamask/utils"),r=e("../logger.cjs"),a=(0,s.createModuleLogger)(r.projectLogger,"layer-1-gas-fee-flow");async function i({layer1GasFeeFlows:e,messenger:t,provider:n,transactionMeta:s}){const r=function(e,t,n){return t.find(t=>t.matchesTransaction({transactionMeta:e,messenger:n}))}(s,e,t);if(!r)return undefined;a("Found layer 1 gas fee flow",r.constructor.name,s.id);try{const{layer1Fee:e}=await r.getLayer1Fee({provider:n,transactionMeta:s});return e}catch(e){return a("Failed to get layer 1 gas fee",s.id,e),undefined}}n.updateTransactionLayer1GasFee=async function(e){const t=await i(e);if(!t)return;const{transactionMeta:n}=e;n.layer1GasFee=t,a("Updated layer 1 gas fee",t,n.id)},n.getTransactionLayer1GasFee=i}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/layer1-gas-fee-flow.cjs"}],[2768,{"../logger.cjs":2755,"@metamask/controller-utils":1301},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getAndFormatTransactionsForNonceTracker=n.getNextNonce=void 0;const s=e("@metamask/controller-utils"),r=e("../logger.cjs"),a=(0,r.createModuleLogger)(r.projectLogger,"nonce");n.getNextNonce=async function(e,t){const{customNonceValue:n,isExternalSign:r,txParams:{from:i,nonce:o}}=e;if(r)return[undefined,undefined];const c=n?(0,s.toHex)(n):undefined;if(c)return a("Using custom nonce",c),[c,undefined];if(o)return a("Using existing nonce",o),[o,undefined];const u=await t(i),l=(0,s.toHex)(u.nextNonce),d=u.releaseLock.bind(u);return a("Using nonce from nonce tracker",l,u.nonceDetails),[l,d]},n.getAndFormatTransactionsForNonceTracker=function(e,t,n,s){return s.filter(({chainId:s,isTransfer:r,isUserOperation:a,status:i,txParams:{from:o}})=>!r&&!a&&s===e&&n.includes(i)&&o.toLowerCase()===t.toLowerCase()).map(({status:e,txParams:{from:t,gas:n,value:s,nonce:r}})=>({status:e,history:[{}],txParams:{from:t??"",gas:n??"",value:s??"",nonce:r??""}}))}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/nonce.cjs"}],[2769,{"@ethereumjs/common":574,"@ethereumjs/tx":591,"@metamask/utils":2799,lodash:4534},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.serializeTransaction=n.prepareTransaction=n.HARDFORK=void 0;const s=e("@ethereumjs/common"),r=e("@ethereumjs/tx"),a=e("@metamask/utils"),i=e("lodash");function o(e){const t={chainId:parseInt(e,16),defaultHardfork:n.HARDFORK};return s.Common.custom(t,{eips:[7702]})}function c(e){return e?"0x0"===e?"0x":e.replace?.(/^0x(00)+/u,"0x")??e:e}n.HARDFORK=s.Hardfork.Prague,n.prepareTransaction=function(e,t){const n=function(e){const t=(0,i.cloneDeep)(e);return function(e){if(!e)return;for(const t of e)t.nonce=c(t.nonce),t.r=c(t.r),t.s=c(t.s),t.yParity=c(t.yParity)}(t.authorizationList),t}(t);return r.TransactionFactory.fromTxData(n,{freeze:!1,common:o(e)})},n.serializeTransaction=function(e){return(0,a.bytesToHex)(e.serialize())}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/prepare.cjs"}],[2770,{"@metamask/controller-utils":1301,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getTransactionParamsWithIncreasedGasFee=void 0;const s=e("@metamask/controller-utils"),r=e("@metamask/utils");function a(e,t){const n=(0,s.convertHexToDecimal)(e),a=parseInt(""+n*t,10);return(0,r.add0x)(a.toString(16))}n.getTransactionParamsWithIncreasedGasFee=function(e,t,n){const s=function(e,t,n){if(n&&"gasPrice"in n)return n.gasPrice;const s=e.gasPrice;if(!s||"0x0"===s)return undefined;return a(s,t)}(e,t,n),r=function(e,t,n){if(n&&"maxFeePerGas"in n&&"maxPriorityFeePerGas"in n)return n;const s=e.maxFeePerGas,r=e.maxPriorityFeePerGas;if(!s||!r||"0x0"===s||"0x0"===r)return undefined;const i=a(s,t),o=a(r,t);return{maxFeePerGas:i,maxPriorityFeePerGas:o}}(e,t,n);if(r){const t={...e,...r};return delete t.gasPrice,t}if(s){const t={...e,gasPrice:s};return delete t.maxFeePerGas,delete t.maxPriorityFeePerGas,t}throw new Error("Cannot increase gas fee as no current values and no new values were provided")}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/retry.cjs"}],[2771,{"@ethersproject/wallet":727,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isValidSignature=void 0;const s=e("@ethersproject/wallet"),r=e("@metamask/utils");n.isValidSignature=function(e,t,n){try{const a=(0,r.add0x)(e.map(r.remove0x).join("")),i=(0,r.hexToBytes)(a);return(0,s.verifyMessage)(i,t).toLowerCase()===n.toLowerCase()}catch{return!1}}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/signature.cjs"}],[2772,{"../constants.cjs":2734,"../logger.cjs":2755,"../types.cjs":2756,"./utils.cjs":2774,"@metamask/controller-utils":1301,lodash:4534},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.updatePostTransactionBalance=n.updateSwapsTransaction=n.SWAP_TRANSACTION_TYPES=n.SWAPS_CHAINID_DEFAULT_TOKEN_MAP=n.DEFAULT_TOKEN_ADDRESS=n.UPDATE_POST_TX_BALANCE_ATTEMPTS=n.UPDATE_POST_TX_BALANCE_TIMEOUT=void 0;const s=e("@metamask/controller-utils"),r=e("lodash"),a=e("./utils.cjs"),i=e("../constants.cjs"),o=e("../logger.cjs"),c=e("../types.cjs"),u=(0,o.createModuleLogger)(o.projectLogger,"swaps");n.UPDATE_POST_TX_BALANCE_TIMEOUT=5e3,n.UPDATE_POST_TX_BALANCE_ATTEMPTS=6;const l="0x539";n.DEFAULT_TOKEN_ADDRESS="0x0000000000000000000000000000000000000000";const d={name:"Ether",address:n.DEFAULT_TOKEN_ADDRESS,decimals:18},f={name:"Binance Coin",address:n.DEFAULT_TOKEN_ADDRESS,decimals:18},h={name:"Matic",address:n.DEFAULT_TOKEN_ADDRESS,decimals:18},p={name:"Avalanche",address:n.DEFAULT_TOKEN_ADDRESS,decimals:18},m={name:"Test Ether",address:n.DEFAULT_TOKEN_ADDRESS,decimals:18},g={name:"Ether",address:n.DEFAULT_TOKEN_ADDRESS,decimals:18},b={...d},y={...d},w={...d},T={name:"Sei",address:n.DEFAULT_TOKEN_ADDRESS,decimals:18};function E(e,t){return!(!e||!t)&&e===n.SWAPS_CHAINID_DEFAULT_TOKEN_MAP[t]?.address}function S(e){return new Promise(t=>setTimeout(t,e))}n.SWAPS_CHAINID_DEFAULT_TOKEN_MAP={[i.CHAIN_IDS.MAINNET]:d,[l]:m,[i.CHAIN_IDS.BSC]:f,[i.CHAIN_IDS.POLYGON]:h,[i.CHAIN_IDS.GOERLI]:g,[i.CHAIN_IDS.AVALANCHE]:p,[i.CHAIN_IDS.OPTIMISM]:y,[i.CHAIN_IDS.ARBITRUM]:b,[i.CHAIN_IDS.ZKSYNC_ERA]:w,[i.CHAIN_IDS.SEI]:T},n.SWAP_TRANSACTION_TYPES=[c.TransactionType.swap,c.TransactionType.swapAndSend,c.TransactionType.swapApproval],n.updateSwapsTransaction=function(e,t,s,{isSwapsDisabled:i,cancelTransaction:o,messenger:u}){if(i||!n.SWAP_TRANSACTION_TYPES.includes(t))return e;if(t===c.TransactionType.swap&&!1===s?.hasApproveTx&&e.simulationFails)throw o(e.id),new Error("Simulation failed");const l=s?.meta;if(!l)return e;let d=e;return t===c.TransactionType.swapApproval&&(d=function(e,{type:t,sourceTokenSymbol:n}){(0,a.validateIfTransactionUnapproved)(e,"updateSwapApprovalTransaction");let s={type:t,sourceTokenSymbol:n};return s=(0,r.pickBy)({type:t,sourceTokenSymbol:n}),(0,r.merge)({},e,s)}(e,l),u.publish("TransactionController:transactionNewSwapApproval",{transactionMeta:d})),t===c.TransactionType.swapAndSend&&(d=function(e,{approvalTxId:t,destinationTokenAddress:n,destinationTokenAmount:s,destinationTokenDecimals:i,destinationTokenSymbol:o,estimatedBaseFee:c,sourceTokenAddress:u,sourceTokenAmount:l,sourceTokenDecimals:d,sourceTokenSymbol:f,swapAndSendRecipient:h,swapMetaData:p,swapTokenValue:m,type:g}){(0,a.validateIfTransactionUnapproved)(e,"updateSwapTransaction");let b={approvalTxId:t,destinationTokenAddress:n,destinationTokenAmount:s,destinationTokenDecimals:i,destinationTokenSymbol:o,estimatedBaseFee:c,sourceTokenAddress:u,sourceTokenAmount:l,sourceTokenDecimals:d,sourceTokenSymbol:f,swapAndSendRecipient:h,swapMetaData:p,swapTokenValue:m,type:g};return b=(0,r.pickBy)(b),(0,r.merge)({},e,b)}(e,l),u.publish("TransactionController:transactionNewSwapAndSend",{transactionMeta:d})),t===c.TransactionType.swap&&(d=function(e,{sourceTokenSymbol:t,destinationTokenSymbol:n,type:s,destinationTokenDecimals:i,destinationTokenAddress:o,swapMetaData:c,swapTokenValue:u,estimatedBaseFee:l,approvalTxId:d}){(0,a.validateIfTransactionUnapproved)(e,"updateSwapTransaction");let f={sourceTokenSymbol:t,destinationTokenSymbol:n,type:s,destinationTokenDecimals:i,destinationTokenAddress:o,swapMetaData:c,swapTokenValue:u,estimatedBaseFee:l,approvalTxId:d};return f=(0,r.pickBy)(f),(0,r.merge)({},e,f)}(e,l),u.publish("TransactionController:transactionNewSwap",{transactionMeta:d})),d},n.updatePostTransactionBalance=async function(e,{ethQuery:t,getTransaction:r,updateTransaction:a}){u("Updating post transaction balance",e.id);const i=e.id;let o,c;for(let a=0;a<n.UPDATE_POST_TX_BALANCE_ATTEMPTS;a++){u("Querying balance",{attempt:a});const l=await(0,s.query)(t,"getBalance",[e.txParams.from]);o={...r(i)??{}},c=o.approvalTxId?r(o.approvalTxId):undefined,o.postTxBalance=l.toString(16);const d=E(e.destinationTokenAddress,e.chainId);if(!d||e.preTxBalance!==o.postTxBalance){u("Finishing post balance update",{isDefaultTokenAddress:d,preTxBalance:e.preTxBalance,postTxBalance:o.postTxBalance});break}u("Waiting for balance to update",{delay:n.UPDATE_POST_TX_BALANCE_TIMEOUT}),await S(n.UPDATE_POST_TX_BALANCE_TIMEOUT)}return a(o,"TransactionController#updatePostTransactionBalance - Add post transaction balance"),u("Completed post balance update",o?.postTxBalance),{updatedTransactionMeta:o,approvalTransactionMeta:c}}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/swaps.cjs"}],[2773,{"../types.cjs":2756,"./eip7702.cjs":2759,"@ethersproject/abi":631,"@metamask/controller-utils":1301,"@metamask/metamask-eth-abis":2064},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.determineTransactionType=n.ESTIMATE_GAS_ERROR=void 0;const s=e("@ethersproject/abi"),r=e("@metamask/controller-utils"),a=e("@metamask/metamask-eth-abis"),i=e("./eip7702.cjs"),o=e("../types.cjs");n.ESTIMATE_GAS_ERROR="eth_estimateGas rpc method error";const c=new s.Interface(a.abiERC20),u=new s.Interface(a.abiERC721),l=new s.Interface(a.abiERC1155),d=new s.Interface(a.abiFiatTokenV2);n.determineTransactionType=async function(e,t){const{data:n,to:s}=e;if(n&&!s)return{type:o.TransactionType.deployContract,getCodeResponse:undefined};let a,f=Boolean(n?.length);if(t){const e=await async function(e,t){let n;try{n=await(0,r.query)(e,"getCode",[t])}catch(e){n=null}const s=!!n&&("0x"!==n&&"0x0"!==n&&!n.startsWith(i.DELEGATION_PREFIX));return{contractCode:n,isContractAddress:s}}(t,s);a=e.contractCode,f=e.isContractAddress}if(!f)return{type:o.TransactionType.simpleSend,getCodeResponse:a};const h=0!==Number(e.value??"0"),p={type:o.TransactionType.contractInteraction,getCodeResponse:a};if(!n||h)return p;const m=function(e){if(!e||e.length<10)return undefined;const t=e.substring(0,10).toLowerCase();for(const e of[c,u,l,d])try{return e.getFunction(t).name}catch{}return undefined}(n);if(!m)return p;const g=[o.TransactionType.tokenMethodApprove,o.TransactionType.tokenMethodSetApprovalForAll,o.TransactionType.tokenMethodTransfer,o.TransactionType.tokenMethodTransferFrom,o.TransactionType.tokenMethodSafeTransferFrom,o.TransactionType.tokenMethodIncreaseAllowance].find(e=>e.toLowerCase()===m.toLowerCase());return g?{type:g,getCodeResponse:a}:p}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/transaction-type.cjs"}],[2774,{"../types.cjs":2756,"@metamask/utils":2799,"bn.js":3699},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.setEnvelopeType=n.getPercentageChange=n.padHexToEvenLength=n.normalizeGasFeeValues=n.normalizeTxError=n.validateIfTransactionUnapproved=n.validateGasValues=n.isEIP1559Transaction=n.normalizeTransactionParams=n.ESTIMATE_GAS_ERROR=void 0;const r=e("@metamask/utils"),a=s(e("bn.js")),i=e("../types.cjs");n.ESTIMATE_GAS_ERROR="eth_estimateGas rpc method error";const o={accessList:e=>e,authorizationList:e=>e,data:e=>(0,r.add0x)(u(e)),from:e=>(0,r.add0x)(e).toLowerCase(),gas:e=>(0,r.add0x)(e),gasLimit:e=>(0,r.add0x)(e),gasPrice:e=>(0,r.add0x)(e),nonce:e=>(0,r.add0x)(e),to:e=>(0,r.add0x)(e).toLowerCase(),value:e=>(0,r.add0x)(e),maxFeePerGas:e=>(0,r.add0x)(e),maxPriorityFeePerGas:e=>(0,r.add0x)(e),estimatedBaseFee:e=>(0,r.add0x)(e),type:e=>(0,r.add0x)(e)};n.normalizeTransactionParams=function(e){const t={from:""};for(const n of(0,r.getKnownPropertyNames)(o))e[n]&&(t[n]=o[n](e[n]));return t.value||(t.value="0x0"),t.gasLimit&&!t.gas&&(t.gas=t.gasLimit),t},n.isEIP1559Transaction=function(e){const t=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);return t(e,"maxFeePerGas")&&t(e,"maxPriorityFeePerGas")};function c(e){try{return JSON.parse(JSON.stringify(e)),!0}catch{return!1}}function u(e){const t=e.toLowerCase().startsWith("0x")?e.slice(0,2):"",n=t?e.slice(2):e;return t+(n.length%2==0?n:`0${n}`)}n.validateGasValues=e=>{Object.keys(e).forEach(t=>{const n=e[t];if("string"!=typeof n||!(0,r.isStrictHexString)(n))throw new TypeError(`expected hex string for ${t} but received: ${n}`)})},n.validateIfTransactionUnapproved=function(e,t){if(e?.status!==i.TransactionStatus.unapproved)throw new Error(`TransactionsController: Can only call ${t} on an unapproved transaction.\n      Current tx status: ${e?.status}`)},n.normalizeTxError=function(e){return{name:e.name,message:e.message,stack:e.stack,code:e.code,rpc:c(e.value)?e.value:undefined}},n.normalizeGasFeeValues=function(e){const t=e=>"string"==typeof e?(0,r.add0x)(e):e;return"gasPrice"in e?{gasPrice:t(e.gasPrice)}:{maxFeePerGas:t(e.maxFeePerGas),maxPriorityFeePerGas:t(e.maxPriorityFeePerGas)}},n.padHexToEvenLength=u,n.getPercentageChange=function(e,t){const n=new a.default(10).pow(new a.default(18)),s=e.mul(n),r=t.mul(n),i=r.sub(s);return i.isZero()?0:s.isZero()&&!r.isZero()?100:i.muln(100).div(s).abs().toNumber()},n.setEnvelopeType=function(e,t){e.accessList?e.type=i.TransactionEnvelopeType.accessList:e.authorizationList?e.type=i.TransactionEnvelopeType.setCode:e.type=t?i.TransactionEnvelopeType.feeMarket:i.TransactionEnvelopeType.legacy}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/utils.cjs"}],[2775,{"../types.cjs":2756,"./utils.cjs":2774,"@ethersproject/abi":631,"@metamask/controller-utils":1301,"@metamask/metamask-eth-abis":2064,"@metamask/rpc-errors":2384,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.validateBatchRequest=n.validateParamTo=n.validateTxParams=n.validateTransactionOrigin=n.ErrorCode=void 0;const s=e("@ethersproject/abi"),r=e("@metamask/controller-utils"),a=e("@metamask/metamask-eth-abis"),i=e("@metamask/rpc-errors"),o=e("@metamask/utils"),c=e("./utils.cjs"),u=e("../types.cjs");var l;!function(e){e[e.DuplicateBundleId=5720]="DuplicateBundleId",e[e.BundleTooLarge=5740]="BundleTooLarge",e[e.RejectedUpgrade=5750]="RejectedUpgrade"}(l||(n.ErrorCode=l={}));const d=[u.TransactionEnvelopeType.feeMarket,u.TransactionEnvelopeType.setCode];function f(e,t){const n=e.type;switch(t){case"authorizationList":if(n&&n!==u.TransactionEnvelopeType.setCode)throw i.rpcErrors.invalidParams(`Invalid transaction envelope type: specified type "${n}" but including authorizationList requires type: "${u.TransactionEnvelopeType.setCode}"`);break;case"maxFeePerGas":case"maxPriorityFeePerGas":if(n&&!d.includes(n))throw i.rpcErrors.invalidParams(`Invalid transaction envelope type: specified type "${n}" but including maxFeePerGas and maxPriorityFeePerGas requires type: "${d.join(", ")}"`);break;default:if(n&&d.includes(n))throw i.rpcErrors.invalidParams(`Invalid transaction envelope type: specified type "${n}" but included a gasPrice instead of maxFeePerGas and maxPriorityFeePerGas`)}}function h(e,t,n){if(void 0!==e[n])throw i.rpcErrors.invalidParams(`Invalid transaction params: specified ${t} but also included ${n}, these cannot be mixed`)}function p(e,t){const n=e[t];if("string"!=typeof n||!(0,o.isStrictHexString)(n))throw i.rpcErrors.invalidParams(`Invalid transaction params: ${String(t)} is not a valid hexadecimal string. got: (${String(n)})`)}function m(e){p(e,"address"),function(e,t,n){const s=(0,o.remove0x)(e).length/2;if(s!==t)throw i.rpcErrors.invalidParams(`Invalid transaction params: ${n} must be ${t} bytes. got: ${s} bytes`)}(e.address,20,"address");for(const t of["chainId","nonce","r","s"])e[t]&&p(e,t);const{yParity:t}=e;if(t&&!["0x0","0x1"].includes(t))throw i.rpcErrors.invalidParams(`Invalid transaction params: yParity must be '0x0' or '0x1'. got: ${t}`)}n.validateTransactionOrigin=async function({data:e,from:t,internalAccounts:n,origin:s,permittedAddresses:a,txParams:o,type:c}){if(!s||s===r.ORIGIN_METAMASK)return;const{authorizationList:l,to:d,type:f}=o;if(a&&!a.includes(t))throw i.providerErrors.unauthorized({data:{origin:s}});if(c===u.TransactionType.batch)return;if(l||f===u.TransactionEnvelopeType.setCode)throw i.rpcErrors.invalidParams("External EIP-7702 transactions are not supported");if(Boolean(e&&"0x"!==e)&&n?.some(e=>e.toLowerCase()===d?.toLowerCase()))throw i.rpcErrors.invalidParams("External transactions to internal accounts cannot include data")},n.validateTxParams=function(e,t=!0,n){!function(e){if(e&&!Object.values(u.TransactionEnvelopeType).includes(e))throw i.rpcErrors.invalidParams(`Invalid transaction envelope type: "${e}". Must be one of: ${Object.values(u.TransactionEnvelopeType).join(", ")}`)}(e.type),function(e,t){if((0,c.isEIP1559Transaction)(e)&&!t)throw i.rpcErrors.invalidParams("Invalid transaction params: params specify an EIP-1559 transaction but the current network does not support EIP-1559")}(e,t),function(e){if(!e||"string"!=typeof e)throw i.rpcErrors.invalidParams(`Invalid "from" address ${e}: not a string.`);if(!(0,r.isValidHexAddress)(e))throw i.rpcErrors.invalidParams('Invalid "from" address.')}(e.from),function(e){if("0x"===e.to||e.to===undefined){if(!e.data)throw i.rpcErrors.invalidParams('Invalid "to" address.');delete e.to}else if(e.to!==undefined&&!(0,r.isValidHexAddress)(e.to))throw i.rpcErrors.invalidParams('Invalid "to" address.')}(e),function(e){if(e!==undefined){if(e.includes("-"))throw i.rpcErrors.invalidParams(`Invalid transaction value "${e}": not a positive number.`);if(e.includes("."))throw i.rpcErrors.invalidParams(`Invalid transaction value "${e}": number must be in wei.`);const t=parseInt(e,10);if(!(Number.isFinite(t)&&!Number.isNaN(t)&&!isNaN(Number(e))&&Number.isSafeInteger(t)))throw i.rpcErrors.invalidParams(`Invalid transaction value ${e}: number must be a valid number.`)}}(e.value),function(e){if(e){const t=new s.Interface(a.abiERC20);try{t.parseTransaction({data:e})}catch(e){if(e.message.match(/BUFFER_OVERRUN/u))throw i.rpcErrors.invalidParams("Invalid transaction params: data out-of-bounds, BUFFER_OVERRUN.")}}}(e.data),function(e,t){if(e&&t&&e.toLowerCase?.()!==t.toLowerCase())throw i.rpcErrors.invalidParams(`Invalid transaction params: chainId must match the network client, got: ${e}, expected: ${t}`)}(e.chainId,n),function(e){e.gasPrice&&(f(e,"gasPrice"),h(e,"gasPrice","maxFeePerGas"),h(e,"gasPrice","maxPriorityFeePerGas"),p(e,"gasPrice"));e.maxFeePerGas&&(f(e,"maxFeePerGas"),h(e,"maxFeePerGas","gasPrice"),p(e,"maxFeePerGas"));e.maxPriorityFeePerGas&&(f(e,"maxPriorityFeePerGas"),h(e,"maxPriorityFeePerGas","gasPrice"),p(e,"maxPriorityFeePerGas"));e.gasLimit&&p(e,"gasLimit");e.gas&&p(e,"gas")}(e),function(e){const{authorizationList:t}=e;if(!t)return;if(f(e,"authorizationList"),!Array.isArray(t))throw i.rpcErrors.invalidParams("Invalid transaction params: authorizationList must be an array");for(const e of t)m(e)}(e)},n.validateParamTo=function(e){if(!e||"string"!=typeof e)throw i.rpcErrors.invalidParams('Invalid "to" address')},n.validateBatchRequest=function({internalAccounts:e,request:t,sizeLimit:n}){const{origin:s}=t,a=s&&s!==r.ORIGIN_METAMASK,o=e.map(e=>e.toLowerCase());if(a&&t.transactions.some(e=>{const t=e.params.to?.toLowerCase(),n=e.params.data,s=o.includes(t),r=Boolean(n&&"0x"!==n);return s&&r}))throw i.rpcErrors.invalidParams("External calls to internal accounts cannot include data");if(a&&t.transactions.length>n)throw new i.JsonRpcError(l.BundleTooLarge,`Batch size cannot exceed ${n}. got: ${t.transactions.length}`)}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/validation.cjs"}],[2789,{"./errors.cjs":2797,"@metamask/superstruct":2705},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.assertExhaustive=n.assertStruct=n.assert=n.AssertionError=void 0;const s=e("@metamask/superstruct"),r=e("./errors.cjs");function a(e,t){return n=e,Boolean("string"==typeof n?.prototype?.constructor?.name)?new e({message:t}):e({message:t});var n}class i extends Error{constructor(e){super(e.message),this.code="ERR_ASSERTION"}}n.AssertionError=i,n.assert=function(e,t="Assertion failed.",n=i){if(!e){if(t instanceof Error)throw t;throw a(n,t)}},n.assertStruct=function(e,t,n="Assertion failed",o=i){try{(0,s.assert)(e,t)}catch(e){throw a(o,`${n}: ${function(e){return(0,r.getErrorMessage)(e).replace(/\.$/u,"")}(e)}.`)}},n.assertExhaustive=function(e){throw new Error("Invalid branch reached. Should be detected during compilation.")}}}},{package:"@metamask/utils",file:"node_modules/@metamask/utils/dist/assert.cjs"}],[2790,{"./assert.cjs":2789,"@metamask/superstruct":2705},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.base64=void 0;const s=e("@metamask/superstruct"),r=e("./assert.cjs");n.base64=(e,t={})=>{const n=t.paddingRequired??!1,a=t.characterSet??"base64";let i,o;return"base64"===a?i=String.raw`[A-Za-z0-9+\/]`:((0,r.assert)("base64url"===a),i=String.raw`[-_A-Za-z0-9]`),o=n?new RegExp(`^(?:${i}{4})*(?:${i}{3}=|${i}{2}==)?$`,"u"):new RegExp(`^(?:${i}{4})*(?:${i}{2,3}|${i}{3}=|${i}{2}==)?$`,"u"),(0,s.pattern)(e,o)}}}},{package:"@metamask/utils",file:"node_modules/@metamask/utils/dist/base64.cjs"}],[2791,{"./assert.cjs":2789,"./hex.cjs":2798,"@scure/base":2876,buffer:3760},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){Object.defineProperty(n,"__esModule",{value:!0}),n.areUint8ArraysEqual=n.createDataView=n.concatBytes=n.valueToBytes=n.base64ToBytes=n.stringToBytes=n.numberToBytes=n.signedBigIntToBytes=n.bigIntToBytes=n.hexToBytes=n.bytesToBase64=n.bytesToString=n.bytesToNumber=n.bytesToSignedBigInt=n.bytesToBigInt=n.bytesToHex=n.assertIsBytes=n.isBytes=void 0;const s=e("@scure/base"),r=e("./assert.cjs"),a=e("./hex.cjs");const i=function(){const e=[];return()=>{if(0===e.length)for(let t=0;t<256;t++)e.push(t.toString(16).padStart(2,"0"));return e}}();function o(e){return e instanceof Uint8Array}function c(e){(0,r.assert)(o(e),"Value must be a Uint8Array.")}function u(e){if(c(e),0===e.length)return"0x";const t=i(),n=new Array(e.length);for(let s=0;s<e.length;s++)n[s]=t[e[s]];return(0,a.add0x)(n.join(""))}function l(e){c(e);const t=u(e);return BigInt(t)}function d(e){if("0x"===e?.toLowerCase?.())return new Uint8Array;(0,a.assertIsHexString)(e);const t=(0,a.remove0x)(e).toLowerCase(),n=t.length%2==0?t:`0${t}`,s=new Uint8Array(n.length/2);for(let e=0;e<s.length;e++){const t=n.charCodeAt(2*e),r=n.charCodeAt(2*e+1),a=t-(t<58?48:87),i=r-(r<58?48:87);s[e]=16*a+i}return s}function f(e){(0,r.assert)("bigint"==typeof e,"Value must be a bigint."),(0,r.assert)(e>=BigInt(0),"Value must be a non-negative bigint.");return d(e.toString(16))}function h(e){(0,r.assert)("number"==typeof e,"Value must be a number."),(0,r.assert)(e>=0,"Value must be a non-negative number."),(0,r.assert)(Number.isSafeInteger(e),"Value is not a safe integer. Use `bigIntToBytes` instead.");return d(e.toString(16))}function p(e){return(0,r.assert)("string"==typeof e,"Value must be a string."),(new TextEncoder).encode(e)}function m(e){if("bigint"==typeof e)return f(e);if("number"==typeof e)return h(e);if("string"==typeof e)return e.startsWith("0x")?d(e):p(e);if(o(e))return e;throw new TypeError(`Unsupported value type: "${typeof e}".`)}n.isBytes=o,n.assertIsBytes=c,n.bytesToHex=u,n.bytesToBigInt=l,n.bytesToSignedBigInt=function(e){c(e);let t=BigInt(0);for(const n of e)t=(t<<BigInt(8))+BigInt(n);return BigInt.asIntN(8*e.length,t)},n.bytesToNumber=function(e){c(e);const t=l(e);return(0,r.assert)(t<=BigInt(Number.MAX_SAFE_INTEGER),"Number is not a safe integer. Use `bytesToBigInt` instead."),Number(t)},n.bytesToString=function(e){return c(e),(new TextDecoder).decode(e)},n.bytesToBase64=function(e){return c(e),s.base64.encode(e)},n.hexToBytes=d,n.bigIntToBytes=f,n.signedBigIntToBytes=function(e,t){(0,r.assert)("bigint"==typeof e,"Value must be a bigint."),(0,r.assert)("number"==typeof t,"Byte length must be a number."),(0,r.assert)(t>0,"Byte length must be greater than 0."),(0,r.assert)(function(e,t){(0,r.assert)(t>0);const n=e>>BigInt(31);return!((~e&n)+(e&~n)>>BigInt(8*t-1))}(e,t),"Byte length is too small to represent the given value.");let n=e;const s=new Uint8Array(t);for(let e=0;e<s.length;e++)s[e]=Number(BigInt.asUintN(8,n)),n>>=BigInt(8);return s.reverse()},n.numberToBytes=h,n.stringToBytes=p,n.base64ToBytes=function(e){return(0,r.assert)("string"==typeof e,"Value must be a string."),s.base64.decode(e)},n.valueToBytes=m,n.concatBytes=function(e){const t=new Array(e.length);let n=0;for(let s=0;s<e.length;s++){const r=m(e[s]);t[s]=r,n+=r.length}const s=new Uint8Array(n);for(let e=0,n=0;e<t.length;e++)s.set(t[e],n),n+=t[e].length;return s},n.createDataView=function(e){if(void 0!==t&&e instanceof t){const t=e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);return new DataView(t)}return new DataView(e.buffer,e.byteOffset,e.byteLength)},n.areUint8ArraysEqual=function(e,t){let n=e.byteLength^t.byteLength;const s=Math.max(e.byteLength,t.byteLength);for(let r=0;r<s;r++){n|=(e[r]??0)^(t[r]??0)}return 0===n}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/utils",file:"node_modules/@metamask/utils/dist/bytes.cjs"}],[2792,{"./superstruct.cjs":2807},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.toCaipAssetId=n.toCaipAssetType=n.toCaipAccountId=n.toCaipChainId=n.parseCaipAssetId=n.parseCaipAssetType=n.parseCaipAccountId=n.parseCaipChainId=n.isCaipAssetId=n.isCaipAssetType=n.isCaipTokenId=n.isCaipAssetReference=n.isCaipAssetNamespace=n.isCaipAccountAddress=n.isCaipAccountId=n.isCaipReference=n.isCaipNamespace=n.isCaipChainId=n.KnownCaipNamespace=n.CaipAssetTypeOrIdStruct=n.CaipAssetIdStruct=n.CaipAssetTypeStruct=n.CaipTokenIdStruct=n.CaipAssetReferenceStruct=n.CaipAssetNamespaceStruct=n.CaipAccountAddressStruct=n.CaipAccountIdStruct=n.CaipReferenceStruct=n.CaipNamespaceStruct=n.CaipChainIdStruct=n.CAIP_ASSET_ID_REGEX=n.CAIP_ASSET_TYPE_REGEX=n.CAIP_TOKEN_ID_REGEX=n.CAIP_ASSET_REFERENCE_REGEX=n.CAIP_ASSET_NAMESPACE_REGEX=n.CAIP_ACCOUNT_ADDRESS_REGEX=n.CAIP_ACCOUNT_ID_REGEX=n.CAIP_REFERENCE_REGEX=n.CAIP_NAMESPACE_REGEX=n.CAIP_CHAIN_ID_REGEX=void 0;const s=e("./superstruct.cjs");n.CAIP_CHAIN_ID_REGEX=/^(?<namespace>[-a-z0-9]{3,8}):(?<reference>[-_a-zA-Z0-9]{1,32})$/u,n.CAIP_NAMESPACE_REGEX=/^[-a-z0-9]{3,8}$/u,n.CAIP_REFERENCE_REGEX=/^[-_a-zA-Z0-9]{1,32}$/u,n.CAIP_ACCOUNT_ID_REGEX=/^(?<chainId>(?<namespace>[-a-z0-9]{3,8}):(?<reference>[-_a-zA-Z0-9]{1,32})):(?<accountAddress>[-.%a-zA-Z0-9]{1,128})$/u,n.CAIP_ACCOUNT_ADDRESS_REGEX=/^[-.%a-zA-Z0-9]{1,128}$/u,n.CAIP_ASSET_NAMESPACE_REGEX=/^[-a-z0-9]{3,8}$/u,n.CAIP_ASSET_REFERENCE_REGEX=/^[-.%a-zA-Z0-9]{1,128}$/u,n.CAIP_TOKEN_ID_REGEX=/^[-.%a-zA-Z0-9]{1,78}$/u,n.CAIP_ASSET_TYPE_REGEX=/^(?<chainId>(?<namespace>[-a-z0-9]{3,8}):(?<reference>[-_a-zA-Z0-9]{1,32}))\/(?<assetNamespace>[-a-z0-9]{3,8}):(?<assetReference>[-.%a-zA-Z0-9]{1,128})$/u,n.CAIP_ASSET_ID_REGEX=/^(?<chainId>(?<namespace>[-a-z0-9]{3,8}):(?<reference>[-_a-zA-Z0-9]{1,32}))\/(?<assetNamespace>[-a-z0-9]{3,8}):(?<assetReference>[-.%a-zA-Z0-9]{1,128})\/(?<tokenId>[-.%a-zA-Z0-9]{1,78})$/u;function r(e){return"string"==typeof e&&n.CAIP_NAMESPACE_REGEX.test(e)}function a(e){return"string"==typeof e&&n.CAIP_REFERENCE_REGEX.test(e)}function i(e){return"string"==typeof e&&n.CAIP_ACCOUNT_ADDRESS_REGEX.test(e)}function o(e){return"string"==typeof e&&n.CAIP_ASSET_NAMESPACE_REGEX.test(e)}function c(e){return"string"==typeof e&&n.CAIP_ASSET_REFERENCE_REGEX.test(e)}function u(e){return"string"==typeof e&&n.CAIP_TOKEN_ID_REGEX.test(e)}n.CaipChainIdStruct=(0,s.definePattern)("CaipChainId",n.CAIP_CHAIN_ID_REGEX),n.CaipNamespaceStruct=(0,s.definePattern)("CaipNamespace",n.CAIP_NAMESPACE_REGEX),n.CaipReferenceStruct=(0,s.definePattern)("CaipReference",n.CAIP_REFERENCE_REGEX),n.CaipAccountIdStruct=(0,s.definePattern)("CaipAccountId",n.CAIP_ACCOUNT_ID_REGEX),n.CaipAccountAddressStruct=(0,s.definePattern)("CaipAccountAddress",n.CAIP_ACCOUNT_ADDRESS_REGEX),n.CaipAssetNamespaceStruct=(0,s.definePattern)("CaipAssetNamespace",n.CAIP_ASSET_NAMESPACE_REGEX),n.CaipAssetReferenceStruct=(0,s.definePattern)("CaipAssetReference",n.CAIP_ASSET_REFERENCE_REGEX),n.CaipTokenIdStruct=(0,s.definePattern)("CaipTokenId",n.CAIP_TOKEN_ID_REGEX),n.CaipAssetTypeStruct=(0,s.definePattern)("CaipAssetType",n.CAIP_ASSET_TYPE_REGEX),n.CaipAssetIdStruct=(0,s.definePattern)("CaipAssetId",n.CAIP_ASSET_ID_REGEX),n.CaipAssetTypeOrIdStruct=(0,s.definePattern)("CaipAssetTypeOrId",/^(?<chainId>(?<namespace>[-a-z0-9]{3,8}):(?<reference>[-_a-zA-Z0-9]{1,32}))\/(?<assetNamespace>[-a-z0-9]{3,8}):(?<assetReference>[-.%a-zA-Z0-9]{1,128})(\/(?<tokenId>[-.%a-zA-Z0-9]{1,78}))?$/u),function(e){e.Bip122="bip122",e.Solana="solana",e.Tron="tron",e.Eip155="eip155",e.Wallet="wallet"}(n.KnownCaipNamespace||(n.KnownCaipNamespace={})),n.isCaipChainId=function(e){return"string"==typeof e&&n.CAIP_CHAIN_ID_REGEX.test(e)},n.isCaipNamespace=r,n.isCaipReference=a,n.isCaipAccountId=function(e){return"string"==typeof e&&n.CAIP_ACCOUNT_ID_REGEX.test(e)},n.isCaipAccountAddress=i,n.isCaipAssetNamespace=o,n.isCaipAssetReference=c,n.isCaipTokenId=u,n.isCaipAssetType=function(e){return"string"==typeof e&&n.CAIP_ASSET_TYPE_REGEX.test(e)},n.isCaipAssetId=function(e){return"string"==typeof e&&n.CAIP_ASSET_ID_REGEX.test(e)},n.parseCaipChainId=function(e){const t=n.CAIP_CHAIN_ID_REGEX.exec(e);if(!t?.groups)throw new Error("Invalid CAIP chain ID.");return{namespace:t.groups.namespace,reference:t.groups.reference}},n.parseCaipAccountId=function(e){const t=n.CAIP_ACCOUNT_ID_REGEX.exec(e);if(!t?.groups)throw new Error("Invalid CAIP account ID.");return{address:t.groups.accountAddress,chainId:t.groups.chainId,chain:{namespace:t.groups.namespace,reference:t.groups.reference}}},n.parseCaipAssetType=function(e){const t=n.CAIP_ASSET_TYPE_REGEX.exec(e);if(!t?.groups)throw new Error("Invalid CAIP asset type.");return{assetNamespace:t.groups.assetNamespace,assetReference:t.groups.assetReference,chainId:t.groups.chainId,chain:{namespace:t.groups.namespace,reference:t.groups.reference}}},n.parseCaipAssetId=function(e){const t=n.CAIP_ASSET_ID_REGEX.exec(e);if(!t?.groups)throw new Error("Invalid CAIP asset ID.");return{assetNamespace:t.groups.assetNamespace,assetReference:t.groups.assetReference,tokenId:t.groups.tokenId,chainId:t.groups.chainId,chain:{namespace:t.groups.namespace,reference:t.groups.reference}}},n.toCaipChainId=function(e,t){if(!r(e))throw new Error(`Invalid "namespace", must match: ${n.CAIP_NAMESPACE_REGEX.toString()}`);if(!a(t))throw new Error(`Invalid "reference", must match: ${n.CAIP_REFERENCE_REGEX.toString()}`);return`${e}:${t}`},n.toCaipAccountId=function(e,t,s){if(!r(e))throw new Error(`Invalid "namespace", must match: ${n.CAIP_NAMESPACE_REGEX.toString()}`);if(!a(t))throw new Error(`Invalid "reference", must match: ${n.CAIP_REFERENCE_REGEX.toString()}`);if(!i(s))throw new Error(`Invalid "accountAddress", must match: ${n.CAIP_ACCOUNT_ADDRESS_REGEX.toString()}`);return`${e}:${t}:${s}`},n.toCaipAssetType=function(e,t,s,i){if(!r(e))throw new Error(`Invalid "namespace", must match: ${n.CAIP_NAMESPACE_REGEX.toString()}`);if(!a(t))throw new Error(`Invalid "reference", must match: ${n.CAIP_REFERENCE_REGEX.toString()}`);if(!o(s))throw new Error(`Invalid "assetNamespace", must match: ${n.CAIP_ASSET_NAMESPACE_REGEX.toString()}`);if(!c(i))throw new Error(`Invalid "assetReference", must match: ${n.CAIP_ASSET_REFERENCE_REGEX.toString()}`);return`${e}:${t}/${s}:${i}`},n.toCaipAssetId=function(e,t,s,i,l){if(!r(e))throw new Error(`Invalid "namespace", must match: ${n.CAIP_NAMESPACE_REGEX.toString()}`);if(!a(t))throw new Error(`Invalid "reference", must match: ${n.CAIP_REFERENCE_REGEX.toString()}`);if(!o(s))throw new Error(`Invalid "assetNamespace", must match: ${n.CAIP_ASSET_NAMESPACE_REGEX.toString()}`);if(!c(i))throw new Error(`Invalid "assetReference", must match: ${n.CAIP_ASSET_REFERENCE_REGEX.toString()}`);if(!u(l))throw new Error(`Invalid "tokenId", must match: ${n.CAIP_TOKEN_ID_REGEX.toString()}`);return`${e}:${t}/${s}:${i}/${l}`}}}},{package:"@metamask/utils",file:"node_modules/@metamask/utils/dist/caip-types.cjs"}],[2793,{"./base64.cjs":2790,"@metamask/superstruct":2705},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ChecksumStruct=void 0;const s=e("@metamask/superstruct"),r=e("./base64.cjs");n.ChecksumStruct=(0,s.size)((0,r.base64)((0,s.string)(),{paddingRequired:!0}),44,44)}}},{package:"@metamask/utils",file:"node_modules/@metamask/utils/dist/checksum.cjs"}],[2794,{"./assert.cjs":2789,"./bytes.cjs":2791,"./hex.cjs":2798,"@metamask/superstruct":2705},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createHex=n.createBytes=n.createBigInt=n.createNumber=void 0;const s=e("@metamask/superstruct"),r=e("./assert.cjs"),a=e("./bytes.cjs"),i=e("./hex.cjs"),o=(0,s.union)([(0,s.number)(),(0,s.bigint)(),(0,s.string)(),i.StrictHexStruct]),c=(0,s.coerce)((0,s.number)(),o,Number),u=(0,s.coerce)((0,s.bigint)(),o,BigInt),l=((0,s.union)([i.StrictHexStruct,(0,s.instance)(Uint8Array)]),(0,s.coerce)((0,s.instance)(Uint8Array),(0,s.union)([i.StrictHexStruct]),a.hexToBytes)),d=(0,s.coerce)(i.StrictHexStruct,(0,s.instance)(Uint8Array),a.bytesToHex);n.createNumber=function(e){try{const t=(0,s.create)(e,c);return(0,r.assert)(Number.isFinite(t),`Expected a number-like value, got "${e}".`),t}catch(t){if(t instanceof s.StructError)throw new Error(`Expected a number-like value, got "${e}".`);throw t}},n.createBigInt=function(e){try{return(0,s.create)(e,u)}catch(e){if(e instanceof s.StructError)throw new Error(`Expected a number-like value, got "${String(e.value)}".`);throw e}},n.createBytes=function(e){if("string"==typeof e&&"0x"===e.toLowerCase())return new Uint8Array;try{return(0,s.create)(e,l)}catch(e){if(e instanceof s.StructError)throw new Error(`Expected a bytes-like value, got "${String(e.value)}".`);throw e}},n.createHex=function(e){if(e instanceof Uint8Array&&0===e.length||"string"==typeof e&&"0x"===e.toLowerCase())return"0x";try{return(0,s.create)(e,d)}catch(e){if(e instanceof s.StructError)throw new Error(`Expected a bytes-like value, got "${String(e.value)}".`);throw e}}}}},{package:"@metamask/utils",file:"node_modules/@metamask/utils/dist/coercers.cjs"}],[2795,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,a=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)},i=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n};Object.defineProperty(n,"__esModule",{value:!0}),n.FrozenSet=n.FrozenMap=void 0;class o{get size(){return a(this,s,"f").size}[(s=new WeakMap,Symbol.iterator)](){return a(this,s,"f")[Symbol.iterator]()}constructor(e){s.set(this,void 0),i(this,s,new Map(e),"f"),Object.freeze(this)}entries(){return a(this,s,"f").entries()}forEach(e,t){return a(this,s,"f").forEach((n,s,r)=>e.call(t,n,s,this))}get(e){return a(this,s,"f").get(e)}has(e){return a(this,s,"f").has(e)}keys(){return a(this,s,"f").keys()}values(){return a(this,s,"f").values()}toString(){return`FrozenMap(${this.size}) {${this.size>0?` ${[...this.entries()].map(([e,t])=>`${String(e)} => ${String(t)}`).join(", ")} `:""}}`}}n.FrozenMap=o;class c{get size(){return a(this,r,"f").size}[(r=new WeakMap,Symbol.iterator)](){return a(this,r,"f")[Symbol.iterator]()}constructor(e){r.set(this,void 0),i(this,r,new Set(e),"f"),Object.freeze(this)}entries(){return a(this,r,"f").entries()}forEach(e,t){return a(this,r,"f").forEach((n,s,r)=>e.call(t,n,s,this))}has(e){return a(this,r,"f").has(e)}keys(){return a(this,r,"f").keys()}values(){return a(this,r,"f").values()}toString(){return`FrozenSet(${this.size}) {${this.size>0?` ${[...this.values()].map(e=>String(e)).join(", ")} `:""}}`}}n.FrozenSet=c,Object.freeze(o),Object.freeze(o.prototype),Object.freeze(c),Object.freeze(c.prototype)}}},{package:"@metamask/utils",file:"node_modules/@metamask/utils/dist/collections.cjs"}],[2796,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0})}}},{package:"@metamask/utils",file:"node_modules/@metamask/utils/dist/encryption-types.cjs"}],[2797,{"./misc.cjs":2803,"pony-cause":4766},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.wrapError=n.getErrorMessage=n.isErrorWithStack=n.isErrorWithMessage=n.isErrorWithCode=void 0;const s=e("pony-cause"),r=e("./misc.cjs");function a(e){return"object"==typeof e&&null!==e&&"code"in e}function i(e){return"object"==typeof e&&null!==e&&"message"in e}n.isErrorWithCode=a,n.isErrorWithMessage=i,n.isErrorWithStack=function(e){return"object"==typeof e&&null!==e&&"stack"in e},n.getErrorMessage=function(e){return i(e)&&"string"==typeof e.message?e.message:(0,r.isNullOrUndefined)(e)?"":String(e)},n.wrapError=function(e,t){if((n=e)instanceof Error||(0,r.isObject)(n)&&"Error"===n.constructor.name){let n;return n=2===Error.length?new Error(t,{cause:e}):new s.ErrorWithCause(t,{cause:e}),a(e)&&(n.code=e.code),n}var n;return t.length>0?new Error(`${String(e)}: ${t}`):new Error(String(e))}}}},{package:"@metamask/utils",file:"node_modules/@metamask/utils/dist/errors.cjs"}],[2798,{"./assert.cjs":2789,"@metamask/superstruct":2705,"@noble/hashes/sha3":2853,lodash:4534},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.remove0x=n.add0x=n.isValidHexAddress=n.isValidHexAddressUnmemoized=n.isValidChecksumAddress=n.isValidChecksumAddressUnmemoized=n.getChecksumAddress=n.getChecksumAddressUnmemoized=n.assertIsStrictHexString=n.assertIsHexString=n.isHexChecksumAddress=n.isHexAddress=n.isStrictHexString=n.isHexString=n.HexChecksumAddressStruct=n.HexAddressStruct=n.StrictHexStruct=n.HexStruct=void 0;const s=e("@metamask/superstruct"),r=e("@noble/hashes/sha3"),a=e("lodash"),i=e("./assert.cjs"),o=/^(?:0x)?[0-9a-f]+$/iu,c=/^0x[0-9a-f]+$/iu,u=/^0x[0-9a-f]{40}$/u,l=/^0x[0-9a-fA-F]{40}$/u;n.HexStruct=(0,s.pattern)((0,s.string)(),o),n.StrictHexStruct=(0,s.pattern)((0,s.string)(),c),n.HexAddressStruct=(0,s.pattern)((0,s.string)(),u),n.HexChecksumAddressStruct=(0,s.pattern)((0,s.string)(),l);const d=e=>"string"==typeof e;function f(e){return d(e)&&o.test(e)}function h(e){return d(e)&&c.test(e)}function p(e){return d(e)&&u.test(e)}function m(e){return d(e)&&l.test(e)}function g(e){(0,i.assert)(m(e),"Invalid hex address.");const t=w(e).toLowerCase(),n=(0,r.keccak_256)(t),{length:s}=t,a=new Array(s);for(let e=0;e<s;e++){const s=1&e,r=n[e>>1],i=0===s?r>>4:15&r;a[e]=i>=8?t[e].toUpperCase():t[e]}return`0x${a.join("")}`}function b(e){return!!m(e)&&(0,n.getChecksumAddress)(e)===e}function y(e){return p(e)||(0,n.isValidChecksumAddress)(e)}function w(e){return e.startsWith("0x")||e.startsWith("0X")?e.substring(2):e}n.isHexString=f,n.isStrictHexString=h,n.isHexAddress=p,n.isHexChecksumAddress=m,n.assertIsHexString=function(e){(0,i.assert)(f(e),"Value must be a hexadecimal string.")},n.assertIsStrictHexString=function(e){(0,i.assert)(h(e),'Value must be a hexadecimal string, starting with "0x".')},n.getChecksumAddressUnmemoized=g,n.getChecksumAddress=(0,a.memoize)(g),n.isValidChecksumAddressUnmemoized=b,n.isValidChecksumAddress=(0,a.memoize)(b),n.isValidHexAddressUnmemoized=y,n.isValidHexAddress=(0,a.memoize)(y),n.add0x=function(e){return e.startsWith("0x")?e:e.startsWith("0X")?`0x${e.substring(2)}`:`0x${e}`},n.remove0x=w}}},{package:"@metamask/utils",file:"node_modules/@metamask/utils/dist/hex.cjs"}],[2799,{"./assert.cjs":2789,"./base64.cjs":2790,"./bytes.cjs":2791,"./caip-types.cjs":2792,"./checksum.cjs":2793,"./coercers.cjs":2794,"./collections.cjs":2795,"./encryption-types.cjs":2796,"./errors.cjs":2797,"./hex.cjs":2798,"./json.cjs":2800,"./keyring.cjs":2801,"./logging.cjs":2802,"./misc.cjs":2803,"./number.cjs":2804,"./opaque.cjs":2805,"./promise.cjs":2806,"./superstruct.cjs":2807,"./time.cjs":2808,"./transaction-types.cjs":2809,"./unitsConversion.cjs":2810,"./versions.cjs":2811},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){s===undefined&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.unitMap=n.getValueOfUnit=n.numberToString=n.fromWei=n.toWei=n.remove0x=n.add0x=n.isValidChecksumAddress=n.getChecksumAddress=n.isValidHexAddress=n.assertIsStrictHexString=n.assertIsHexString=n.isHexChecksumAddress=n.isHexAddress=n.isStrictHexString=n.isHexString=n.HexChecksumAddressStruct=n.HexAddressStruct=n.StrictHexStruct=n.HexStruct=void 0,r(e("./assert.cjs"),n),r(e("./base64.cjs"),n),r(e("./bytes.cjs"),n),r(e("./caip-types.cjs"),n),r(e("./checksum.cjs"),n),r(e("./coercers.cjs"),n),r(e("./collections.cjs"),n),r(e("./encryption-types.cjs"),n),r(e("./errors.cjs"),n);var a=e("./hex.cjs");Object.defineProperty(n,"HexStruct",{enumerable:!0,get:function(){return a.HexStruct}}),Object.defineProperty(n,"StrictHexStruct",{enumerable:!0,get:function(){return a.StrictHexStruct}}),Object.defineProperty(n,"HexAddressStruct",{enumerable:!0,get:function(){return a.HexAddressStruct}}),Object.defineProperty(n,"HexChecksumAddressStruct",{enumerable:!0,get:function(){return a.HexChecksumAddressStruct}}),Object.defineProperty(n,"isHexString",{enumerable:!0,get:function(){return a.isHexString}}),Object.defineProperty(n,"isStrictHexString",{enumerable:!0,get:function(){return a.isStrictHexString}}),Object.defineProperty(n,"isHexAddress",{enumerable:!0,get:function(){return a.isHexAddress}}),Object.defineProperty(n,"isHexChecksumAddress",{enumerable:!0,get:function(){return a.isHexChecksumAddress}}),Object.defineProperty(n,"assertIsHexString",{enumerable:!0,get:function(){return a.assertIsHexString}}),Object.defineProperty(n,"assertIsStrictHexString",{enumerable:!0,get:function(){return a.assertIsStrictHexString}}),Object.defineProperty(n,"isValidHexAddress",{enumerable:!0,get:function(){return a.isValidHexAddress}}),Object.defineProperty(n,"getChecksumAddress",{enumerable:!0,get:function(){return a.getChecksumAddress}}),Object.defineProperty(n,"isValidChecksumAddress",{enumerable:!0,get:function(){return a.isValidChecksumAddress}}),Object.defineProperty(n,"add0x",{enumerable:!0,get:function(){return a.add0x}}),Object.defineProperty(n,"remove0x",{enumerable:!0,get:function(){return a.remove0x}}),r(e("./json.cjs"),n),r(e("./keyring.cjs"),n),r(e("./logging.cjs"),n),r(e("./misc.cjs"),n),r(e("./number.cjs"),n),r(e("./opaque.cjs"),n),r(e("./promise.cjs"),n),r(e("./superstruct.cjs"),n),r(e("./time.cjs"),n),r(e("./transaction-types.cjs"),n),r(e("./versions.cjs"),n);var i=e("./unitsConversion.cjs");Object.defineProperty(n,"toWei",{enumerable:!0,get:function(){return i.toWei}}),Object.defineProperty(n,"fromWei",{enumerable:!0,get:function(){return i.fromWei}}),Object.defineProperty(n,"numberToString",{enumerable:!0,get:function(){return i.numberToString}}),Object.defineProperty(n,"getValueOfUnit",{enumerable:!0,get:function(){return i.getValueOfUnit}}),Object.defineProperty(n,"unitMap",{enumerable:!0,get:function(){return i.unitMap}})}}},{package:"@metamask/utils",file:"node_modules/@metamask/utils/dist/index.cjs"}],[2800,{"./assert.cjs":2789,"./misc.cjs":2803,"@metamask/superstruct":2705},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getJsonRpcIdValidator=n.assertIsJsonRpcError=n.isJsonRpcError=n.assertIsJsonRpcFailure=n.isJsonRpcFailure=n.assertIsJsonRpcSuccess=n.isJsonRpcSuccess=n.assertIsJsonRpcResponse=n.isJsonRpcResponse=n.assertIsPendingJsonRpcResponse=n.isPendingJsonRpcResponse=n.JsonRpcResponseStruct=n.JsonRpcFailureStruct=n.JsonRpcSuccessStruct=n.PendingJsonRpcResponseStruct=n.assertIsJsonRpcRequest=n.isJsonRpcRequest=n.assertIsJsonRpcNotification=n.isJsonRpcNotification=n.JsonRpcNotificationStruct=n.JsonRpcRequestStruct=n.JsonRpcParamsStruct=n.JsonRpcErrorStruct=n.JsonRpcIdStruct=n.JsonRpcVersionStruct=n.jsonrpc2=n.getJsonSize=n.getSafeJson=n.isValidJson=n.JsonStruct=n.UnsafeJsonStruct=n.exactOptional=n.object=void 0;const s=e("@metamask/superstruct"),r=e("./assert.cjs"),a=e("./misc.cjs");function i({path:e,branch:t}){const n=e[e.length-1];return(0,a.hasProperty)(t[t.length-2],n)}function o(e){return new s.Struct({...e,type:`optional ${e.type}`,validator:(t,n)=>!i(n)||e.validator(t,n),refiner:(t,n)=>!i(n)||e.refiner(t,n)})}function c(e){if(null===e||"boolean"==typeof e||"string"==typeof e)return!0;if("number"==typeof e&&Number.isFinite(e))return!0;if("object"==typeof e){let t=!0;if(Array.isArray(e)){for(let n=0;n<e.length;n++)if(!c(e[n])){t=!1;break}return t}const n=Object.entries(e);for(let e=0;e<n.length;e++)if("string"!=typeof n[e][0]||!c(n[e][1])){t=!1;break}return t}return!1}function u(e){return(0,s.create)(e,n.JsonStruct)}n.object=e=>(0,s.object)(e),n.exactOptional=o,n.UnsafeJsonStruct=(0,s.define)("JSON",e=>c(e)),n.JsonStruct=(0,s.coerce)(n.UnsafeJsonStruct,(0,s.refine)((0,s.any)(),"JSON",e=>(0,s.is)(e,n.UnsafeJsonStruct)),e=>JSON.parse(JSON.stringify(e,(e,t)=>"__proto__"===e||"constructor"===e?undefined:t))),n.isValidJson=function(e){try{return u(e),!0}catch{return!1}},n.getSafeJson=u,n.getJsonSize=function(e){(0,r.assertStruct)(e,n.JsonStruct,"Invalid JSON value");const t=JSON.stringify(e);return(new TextEncoder).encode(t).byteLength},n.jsonrpc2="2.0",n.JsonRpcVersionStruct=(0,s.literal)(n.jsonrpc2),n.JsonRpcIdStruct=(0,s.nullable)((0,s.union)([(0,s.number)(),(0,s.string)()])),n.JsonRpcErrorStruct=(0,n.object)({code:(0,s.integer)(),message:(0,s.string)(),data:o(n.JsonStruct),stack:o((0,s.string)())}),n.JsonRpcParamsStruct=(0,s.union)([(0,s.record)((0,s.string)(),n.JsonStruct),(0,s.array)(n.JsonStruct)]),n.JsonRpcRequestStruct=(0,n.object)({id:n.JsonRpcIdStruct,jsonrpc:n.JsonRpcVersionStruct,method:(0,s.string)(),params:o(n.JsonRpcParamsStruct)}),n.JsonRpcNotificationStruct=(0,n.object)({jsonrpc:n.JsonRpcVersionStruct,method:(0,s.string)(),params:o(n.JsonRpcParamsStruct)}),n.isJsonRpcNotification=function(e){return(0,s.is)(e,n.JsonRpcNotificationStruct)},n.assertIsJsonRpcNotification=function(e,t){(0,r.assertStruct)(e,n.JsonRpcNotificationStruct,"Invalid JSON-RPC notification",t)},n.isJsonRpcRequest=function(e){return(0,s.is)(e,n.JsonRpcRequestStruct)},n.assertIsJsonRpcRequest=function(e,t){(0,r.assertStruct)(e,n.JsonRpcRequestStruct,"Invalid JSON-RPC request",t)},n.PendingJsonRpcResponseStruct=(0,s.object)({id:n.JsonRpcIdStruct,jsonrpc:n.JsonRpcVersionStruct,result:(0,s.optional)((0,s.unknown)()),error:(0,s.optional)(n.JsonRpcErrorStruct)}),n.JsonRpcSuccessStruct=(0,n.object)({id:n.JsonRpcIdStruct,jsonrpc:n.JsonRpcVersionStruct,result:n.JsonStruct}),n.JsonRpcFailureStruct=(0,n.object)({id:n.JsonRpcIdStruct,jsonrpc:n.JsonRpcVersionStruct,error:n.JsonRpcErrorStruct}),n.JsonRpcResponseStruct=(0,s.union)([n.JsonRpcSuccessStruct,n.JsonRpcFailureStruct]),n.isPendingJsonRpcResponse=function(e){return(0,s.is)(e,n.PendingJsonRpcResponseStruct)},n.assertIsPendingJsonRpcResponse=function(e,t){(0,r.assertStruct)(e,n.PendingJsonRpcResponseStruct,"Invalid pending JSON-RPC response",t)},n.isJsonRpcResponse=function(e){return(0,s.is)(e,n.JsonRpcResponseStruct)},n.assertIsJsonRpcResponse=function(e,t){(0,r.assertStruct)(e,n.JsonRpcResponseStruct,"Invalid JSON-RPC response",t)},n.isJsonRpcSuccess=function(e){return(0,s.is)(e,n.JsonRpcSuccessStruct)},n.assertIsJsonRpcSuccess=function(e,t){(0,r.assertStruct)(e,n.JsonRpcSuccessStruct,"Invalid JSON-RPC success response",t)},n.isJsonRpcFailure=function(e){return(0,s.is)(e,n.JsonRpcFailureStruct)},n.assertIsJsonRpcFailure=function(e,t){(0,r.assertStruct)(e,n.JsonRpcFailureStruct,"Invalid JSON-RPC failure response",t)},n.isJsonRpcError=function(e){return(0,s.is)(e,n.JsonRpcErrorStruct)},n.assertIsJsonRpcError=function(e,t){(0,r.assertStruct)(e,n.JsonRpcErrorStruct,"Invalid JSON-RPC error",t)},n.getJsonRpcIdValidator=function(e){const{permitEmptyString:t,permitFractions:n,permitNull:s}={permitEmptyString:!0,permitFractions:!1,permitNull:!0,...e};return e=>Boolean("number"==typeof e&&(n||Number.isInteger(e))||"string"==typeof e&&(t||e.length>0)||s&&null===e)}}}},{package:"@metamask/utils",file:"node_modules/@metamask/utils/dist/json.cjs"}],[2801,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0})}}},{package:"@metamask/utils",file:"node_modules/@metamask/utils/dist/keyring.cjs"}],[2802,{debug:3910},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.createModuleLogger=n.createProjectLogger=void 0;const r=(0,s(e("debug")).default)("metamask");n.createProjectLogger=function(e){return r.extend(e)},n.createModuleLogger=function(e,t){return e.extend(t)}}}},{package:"@metamask/utils",file:"node_modules/@metamask/utils/dist/logging.cjs"}],[2803,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.calculateNumberSize=n.calculateStringSize=n.isASCII=n.isPlainObject=n.ESCAPE_CHARACTERS_REGEXP=n.JsonSize=n.getKnownPropertyNames=n.hasProperty=n.isObject=n.isNullOrUndefined=n.isNonEmptyArray=void 0,n.isNonEmptyArray=function(e){return Array.isArray(e)&&e.length>0},n.isNullOrUndefined=function(e){return null===e||e===undefined},n.isObject=function(e){return Boolean(e)&&"object"==typeof e&&!Array.isArray(e)};function s(e){return e.charCodeAt(0)<=127}n.hasProperty=(e,t)=>Object.hasOwnProperty.call(e,t),n.getKnownPropertyNames=function(e){return Object.getOwnPropertyNames(e)},function(e){e[e.Null=4]="Null",e[e.Comma=1]="Comma",e[e.Wrapper=1]="Wrapper",e[e.True=4]="True",e[e.False=5]="False",e[e.Quote=1]="Quote",e[e.Colon=1]="Colon",e[e.Date=24]="Date"}(n.JsonSize||(n.JsonSize={})),n.ESCAPE_CHARACTERS_REGEXP=/"|\\|\n|\r|\t/gu,n.isPlainObject=function(e){if("object"!=typeof e||null===e)return!1;try{let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}catch(e){return!1}},n.isASCII=s,n.calculateStringSize=function(e){return e.split("").reduce((e,t)=>s(t)?e+1:e+2,0)+(e.match(n.ESCAPE_CHARACTERS_REGEXP)??[]).length},n.calculateNumberSize=function(e){return e.toString().length}}}},{package:"@metamask/utils",file:"node_modules/@metamask/utils/dist/misc.cjs"}],[2804,{"./assert.cjs":2789,"./hex.cjs":2798},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.hexToBigInt=n.hexToNumber=n.bigIntToHex=n.numberToHex=void 0;const s=e("./assert.cjs"),r=e("./hex.cjs");n.numberToHex=e=>((0,s.assert)("number"==typeof e,"Value must be a number."),(0,s.assert)(e>=0,"Value must be a non-negative number."),(0,s.assert)(Number.isSafeInteger(e),"Value is not a safe integer. Use `bigIntToHex` instead."),(0,r.add0x)(e.toString(16)));n.bigIntToHex=e=>((0,s.assert)("bigint"==typeof e,"Value must be a bigint."),(0,s.assert)(e>=0,"Value must be a non-negative bigint."),(0,r.add0x)(e.toString(16)));n.hexToNumber=e=>{(0,r.assertIsHexString)(e);const t=parseInt(e,16);return(0,s.assert)(Number.isSafeInteger(t),"Value is not a safe integer. Use `hexToBigInt` instead."),t};n.hexToBigInt=e=>((0,r.assertIsHexString)(e),BigInt((0,r.add0x)(e)))}}},{package:"@metamask/utils",file:"node_modules/@metamask/utils/dist/number.cjs"}],[2805,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0})}}},{package:"@metamask/utils",file:"node_modules/@metamask/utils/dist/opaque.cjs"}],[2806,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createDeferredPromise=void 0,n.createDeferredPromise=function({suppressUnhandledRejection:e=!1}={}){let t,n;const s=new Promise((e,s)=>{t=e,n=s});return e&&s.catch(e=>{}),{promise:s,resolve:t,reject:n}}}}},{package:"@metamask/utils",file:"node_modules/@metamask/utils/dist/promise.cjs"}],[2807,{"@metamask/superstruct":2705},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.definePattern=void 0;const s=e("@metamask/superstruct");n.definePattern=function(e,t){return(0,s.define)(e,e=>"string"==typeof e&&t.test(e))}}}},{package:"@metamask/utils",file:"node_modules/@metamask/utils/dist/superstruct.cjs"}],[2808,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.timeSince=n.inMilliseconds=n.Duration=void 0,function(e){e[e.Millisecond=1]="Millisecond",e[e.Second=1e3]="Second",e[e.Minute=6e4]="Minute",e[e.Hour=36e5]="Hour",e[e.Day=864e5]="Day",e[e.Week=6048e5]="Week",e[e.Year=31536e6]="Year"}(n.Duration||(n.Duration={}));const s=(e,t)=>{if(!(e=>Number.isInteger(e)&&e>=0)(e))throw new Error(`"${t}" must be a non-negative integer. Received: "${e}".`)};n.inMilliseconds=function(e,t){return s(e,"count"),e*t},n.timeSince=function(e){return s(e,"timestamp"),Date.now()-e}}}},{package:"@metamask/utils",file:"node_modules/@metamask/utils/dist/time.cjs"}],[2809,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0})}}},{package:"@metamask/utils",file:"node_modules/@metamask/utils/dist/transaction-types.cjs"}],[2810,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.toWei=n.fromWei=n.numberToString=n.getValueOfUnit=n.unitMap=n.numericToBigInt=void 0;const s=BigInt(0),r=BigInt(-1);function a(e){if("string"==typeof e)return BigInt(e);if("number"==typeof e)return BigInt(e);if("bigint"==typeof e)return e;throw new Error(`Cannot convert ${typeof e} to BigInt`)}n.numericToBigInt=a,n.unitMap={noether:"0",wei:"1",kwei:"1000",Kwei:"1000",babbage:"1000",femtoether:"1000",mwei:"1000000",Mwei:"1000000",lovelace:"1000000",picoether:"1000000",gwei:"1000000000",Gwei:"1000000000",shannon:"1000000000",nanoether:"1000000000",nano:"1000000000",szabo:"1000000000000",microether:"1000000000000",micro:"1000000000000",finney:"1000000000000000",milliether:"1000000000000000",milli:"1000000000000000",ether:"1000000000000000000",kether:"1000000000000000000000",grand:"1000000000000000000000",mether:"1000000000000000000000000",gether:"1000000000000000000000000000",tether:"1000000000000000000000000000000"};const i=Object.fromEntries(Object.entries(n.unitMap).map(([e,t])=>[e,BigInt(t)])),o=Object.fromEntries(Object.entries(n.unitMap).map(([e,t])=>[e,t.length-1||1])),c=/^-?[0-9.]+$/u,u=/^([0-9]*[1-9]|0)(0*)/u,l=/\B(?=(\d{3})+(?!\d))/gu;function d(e){if("string"==typeof e){if(!c.test(e))throw new Error(`while converting number to string, invalid number value '${e}', should be a number matching (^-?[0-9.]+).`);return e}if("number"==typeof e)return String(e);if("bigint"==typeof e)return e.toString();throw new Error(`while converting number to string, invalid number value '${String(e)}' type ${typeof e}.`)}n.getValueOfUnit=function(e="ether"){const t=e.toLowerCase(),s=i[t];if(s===undefined)throw new Error(`The unit provided ${e} doesn't exist, please use the one of the following units ${JSON.stringify(n.unitMap,null,2)}`);return s},n.numberToString=d,n.fromWei=function(e,t,c){let d=a(e);const f=d<s,h=t.toLowerCase(),p=i[h],m=o[h],g=c??{};if(p===undefined)throw new Error(`The unit provided ${t} doesn't exist, please use the one of the following units ${JSON.stringify(n.unitMap,null,2)}`);if(p===s)return f?"-0":"0";f&&(d*=r);let b=(d%p).toString();if(b=b.padStart(m,"0"),!g.pad){const e=b.match(u);b=e?.[1]??"0"}let y=(d/p).toString();g.commify&&(y=y.replace(l,","));let w=`${y}${"0"===b?"":`.${b}`}`;return f&&(w=`-${w}`),w},n.toWei=function(e,t){const a=t.toLowerCase(),c=i[a],u=o[a];if(c===undefined)throw new Error(`The unit provided ${t} doesn't exist, please use the one of the following units ${JSON.stringify(n.unitMap,null,2)}`);if(c===s)return s;if("bigint"==typeof e&&"wei"===a)return e;if("bigint"==typeof e)return e*c;let l=d(e);const f=l.startsWith("-");if(f&&(l=l.substring(1)),"."===l)throw new Error(`While converting number ${e} to wei, invalid value`);const h=l.split(".");if(h.length>2)throw new Error(`While converting number ${e} to wei,  too many decimal points`);let p=h[0],m=h[1];if(p||(p="0"),m||(m="0"),m.length>u)throw new Error(`While converting number ${e} to wei, too many decimal places`);m=m.padEnd(u,"0");let g=BigInt(p)*c+BigInt(m);return f&&(g*=r),g}}}},{package:"@metamask/utils",file:"node_modules/@metamask/utils/dist/unitsConversion.cjs"}],[2811,{"./assert.cjs":2789,"@metamask/superstruct":2705,semver:5252},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.satisfiesVersionRange=n.gtRange=n.gtVersion=n.assertIsSemVerRange=n.assertIsSemVerVersion=n.isValidSemVerRange=n.isValidSemVerVersion=n.VersionRangeStruct=n.VersionStruct=void 0;const s=e("@metamask/superstruct"),r=e("semver"),a=e("./assert.cjs");n.VersionStruct=(0,s.refine)((0,s.string)(),"Version",e=>null!==(0,r.valid)(e)||`Expected SemVer version, got "${e}"`),n.VersionRangeStruct=(0,s.refine)((0,s.string)(),"Version range",e=>null!==(0,r.validRange)(e)||`Expected SemVer range, got "${e}"`),n.isValidSemVerVersion=function(e){return(0,s.is)(e,n.VersionStruct)},n.isValidSemVerRange=function(e){return(0,s.is)(e,n.VersionRangeStruct)},n.assertIsSemVerVersion=function(e){(0,a.assertStruct)(e,n.VersionStruct)},n.assertIsSemVerRange=function(e){(0,a.assertStruct)(e,n.VersionRangeStruct)},n.gtVersion=function(e,t){return(0,r.gt)(e,t)},n.gtRange=function(e,t){return(0,r.gtr)(e,t)},n.satisfiesVersionRange=function(e,t){return(0,r.satisfies)(e,t,{includePrerelease:!0})}}}},{package:"@metamask/utils",file:"node_modules/@metamask/utils/dist/versions.cjs"}],[2813,{"./utils":2823,assert:3756,buffer:3760},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const r=s(e("assert")),a=e("./utils");let i=[];var o;!function(e){e.STANDARD="standard",e.URI="uri",e.MINIMAL="minimal"}(o||(o={}));const c=e=>"ableacidalsoapexaquaarchatomauntawayaxisbackbaldbarnbeltbetabiasbluebodybragbrewbulbbuzzcalmcashcatschefcityclawcodecolacookcostcruxcurlcuspcyandarkdatadaysdelidicedietdoordowndrawdropdrumdulldutyeacheasyechoedgeepicevenexamexiteyesfactfairfernfigsfilmfishfizzflapflewfluxfoxyfreefrogfuelfundgalagamegeargemsgiftgirlglowgoodgraygrimgurugushgyrohalfhanghardhawkheathelphighhillholyhopehornhutsicedideaidleinchinkyintoirisironitemjadejazzjoinjoltjowljudojugsjumpjunkjurykeepkenokeptkeyskickkilnkingkitekiwiknoblamblavalazyleaflegsliarlimplionlistlogoloudloveluaulucklungmainmanymathmazememomenumeowmildmintmissmonknailnavyneednewsnextnoonnotenumbobeyoboeomitonyxopenovalowlspaidpartpeckplaypluspoempoolposepuffpumapurrquadquizraceramprealredorichroadrockroofrubyruinrunsrustsafesagascarsetssilkskewslotsoapsolosongstubsurfswantacotasktaxitenttiedtimetinytoiltombtoystriptunatwinuglyundouniturgeuservastveryvetovialvibeviewvisavoidvowswallwandwarmwaspwavewaxywebswhatwhenwhizwolfworkyankyawnyellyogayurtzapszerozestzinczonezoom".slice(4*e,4*e+4),u=e=>`${e}${a.getCRCHex(t.from(e,"hex"))}`,l=(e,n)=>{const s=u(e);return t.from(s,"hex").reduce((e,t)=>[...e,c(t)],[]).join(n)},d=e=>{const n=u(e);return t.from(n,"hex").reduce((e,t)=>e+(e=>{const t=c(e);return`${t[0]}${t[3]}`})(t),"")},f=(e,n,s)=>{const o=(4==s?e.split(n):a.partition(e,2)).map(e=>((e,n)=>{r.default(e.length===n,"Invalid Bytewords: word.length does not match wordLength provided");const s=26;if(0===i.length){i=[...new Array(676)].map(()=>-1);for(let e=0;e<256;e++){const t=c(e);let n=t[0].charCodeAt(0)-"a".charCodeAt(0),r=t[3].charCodeAt(0)-"a".charCodeAt(0);i[r*s+n]=e}}let a=e[0].toLowerCase().charCodeAt(0)-"a".charCodeAt(0),o=e[4==n?3:1].toLowerCase().charCodeAt(0)-"a".charCodeAt(0);r.default(0<=a&&a<s&&0<=o&&o<s,"Invalid Bytewords: invalid word");let u=i[o*s+a];if(r.default(-1!==u,"Invalid Bytewords: value not in lookup table"),4==n){const t=c(u);let n=e[1].toLowerCase(),s=e[2].toLowerCase();r.default(n===t[1]&&s===t[2],"Invalid Bytewords: invalid middle letters of word")}return t.from([u]).toString("hex")})(e,s)).join("");r.default(o.length>=5,"Invalid Bytewords: invalid decoded string length");const[u,l]=a.split(t.from(o,"hex"),4),d=a.getCRCHex(u);return r.default(d===l.toString("hex"),"Invalid Checksum"),u.toString("hex")};n.default={decode:(e,t=o.MINIMAL)=>{switch(t){case o.STANDARD:return f(e," ",4);case o.URI:return f(e,"-",4);case o.MINIMAL:return f(e,"",2);default:throw new Error(`Invalid style ${t}`)}},encode:(e,t=o.MINIMAL)=>{switch(t){case o.STANDARD:return l(e," ");case o.URI:return l(e,"-");case o.MINIMAL:return d(e);default:throw new Error(`Invalid style ${t}`)}},STYLES:o}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@ngraveio/bc-ur",file:"node_modules/@ngraveio/bc-ur/dist/bytewords.js"}],[2814,{buffer:3760,"cbor-sync":3780},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){Object.defineProperty(n,"__esModule",{value:!0}),n.cborDecode=n.cborEncode=void 0;const s=e("cbor-sync");n.cborEncode=e=>s.encode(e);n.cborDecode=e=>s.decode(t.isBuffer(e)?e:t.from(e,"hex"))}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@ngraveio/bc-ur",file:"node_modules/@ngraveio/bc-ur/dist/cbor.js"}],[2815,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.InvalidChecksumError=n.InvalidSequenceComponentError=n.InvalidTypeError=n.InvalidPathLengthError=n.InvalidSchemeError=void 0;class s extends Error{constructor(){super("Invalid Scheme"),this.name="InvalidSchemeError"}}n.InvalidSchemeError=s;class r extends Error{constructor(){super("Invalid Path"),this.name="InvalidPathLengthError"}}n.InvalidPathLengthError=r;class a extends Error{constructor(){super("Invalid Type"),this.name="InvalidTypeError"}}n.InvalidTypeError=a;class i extends Error{constructor(){super("Invalid Sequence Component"),this.name="InvalidSequenceComponentError"}}n.InvalidSequenceComponentError=i;class o extends Error{constructor(){super("Invalid Checksum"),this.name="InvalidChecksumError"}}n.InvalidChecksumError=o}}},{package:"@ngraveio/bc-ur",file:"node_modules/@ngraveio/bc-ur/dist/errors.js"}],[2816,{"./errors":2815,"./fountainUtils":2818,"./utils":2823,buffer:3760},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){Object.defineProperty(n,"__esModule",{value:!0}),n.FountainDecoderPart=void 0;const s=e("./utils"),r=e("./fountainUtils"),a=e("./errors");class i{constructor(e,t){this._indexes=e,this._fragment=t}get indexes(){return this._indexes}get fragment(){return this._fragment}static fromEncoderPart(e){const t=r.chooseFragments(e.seqNum,e.seqLength,e.checksum),n=e.fragment;return new i(t,n)}isSimple(){return 1===this.indexes.length}}n.FountainDecoderPart=i;class o{constructor(){this.result=undefined,this.expectedMessageLength=0,this.expectedChecksum=0,this.expectedFragmentLength=0,this.processedPartsCount=0,this.expectedPartIndexes=[],this.lastPartIndexes=[],this.queuedParts=[],this.receivedPartIndexes=[],this.mixedParts=[],this.simpleParts=[]}validatePart(e){if(0===this.expectedPartIndexes.length)[...new Array(e.seqLength)].forEach((e,t)=>this.expectedPartIndexes.push(t)),this.expectedMessageLength=e.messageLength,this.expectedChecksum=e.checksum,this.expectedFragmentLength=e.fragment.length;else{if(this.expectedPartIndexes.length!==e.seqLength)return!1;if(this.expectedMessageLength!==e.messageLength)return!1;if(this.expectedChecksum!==e.checksum)return!1;if(this.expectedFragmentLength!==e.fragment.length)return!1}return!0}reducePartByPart(e,t){if(s.arrayContains(e.indexes,t.indexes)){const n=s.setDifference(e.indexes,t.indexes),r=s.bufferXOR(e.fragment,t.fragment);return new i(n,r)}return e}reduceMixedBy(e){const t=[];this.mixedParts.map(({value:t})=>this.reducePartByPart(t,e)).forEach(e=>{e.isSimple()?this.queuedParts.push(e):t.push({key:e.indexes,value:e})}),this.mixedParts=t}processSimplePart(e){const t=e.indexes[0];if(!this.receivedPartIndexes.includes(t))if(this.simpleParts.push({key:e.indexes,value:e}),this.receivedPartIndexes.push(t),s.arraysEqual(this.receivedPartIndexes,this.expectedPartIndexes)){const e=this.simpleParts.map(({value:e})=>e).sort((e,t)=>e.indexes[0]-t.indexes[0]),t=o.joinFragments(e.map(e=>e.fragment),this.expectedMessageLength);s.getCRC(t)===this.expectedChecksum?this.result=t:this.error=new a.InvalidChecksumError}else this.reduceMixedBy(e)}processMixedPart(e){if(this.mixedParts.some(({key:t})=>s.arraysEqual(t,e.indexes)))return;let t=this.simpleParts.reduce((e,{value:t})=>this.reducePartByPart(e,t),e);t=this.mixedParts.reduce((e,{value:t})=>this.reducePartByPart(e,t),t),t.isSimple()?this.queuedParts.push(t):(this.reduceMixedBy(t),this.mixedParts.push({key:t.indexes,value:t}))}processQueuedItem(){if(0===this.queuedParts.length)return;const e=this.queuedParts.shift();e.isSimple()?this.processSimplePart(e):this.processMixedPart(e)}receivePart(e){if(this.isComplete())return!1;if(!this.validatePart(e))return!1;const t=i.fromEncoderPart(e);for(this.lastPartIndexes=t.indexes,this.queuedParts.push(t);!this.isComplete()&&this.queuedParts.length>0;)this.processQueuedItem();return this.processedPartsCount+=1,!0}isComplete(){return Boolean(this.result!==undefined&&this.result.length>0)}isSuccess(){return Boolean(this.error===undefined&&this.isComplete())}resultMessage(){return this.isSuccess()?this.result:t.from([])}isFailure(){return this.error!==undefined}resultError(){return this.error?this.error.message:""}expectedPartCount(){return this.expectedPartIndexes.length}getExpectedPartIndexes(){return[...this.expectedPartIndexes]}getReceivedPartIndexes(){return[...this.receivedPartIndexes]}getLastPartIndexes(){return[...this.lastPartIndexes]}estimatedPercentComplete(){if(this.isComplete())return 1;const e=this.expectedPartCount();return 0===e?0:Math.min(.99,this.processedPartsCount/(1.75*e))}getProgress(){if(this.isComplete())return 1;const e=this.expectedPartCount();return 0===e?0:this.receivedPartIndexes.length/e}}n.default=o,o.joinFragments=(e,n)=>t.concat(e).slice(0,n)}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@ngraveio/bc-ur",file:"node_modules/@ngraveio/bc-ur/dist/fountainDecoder.js"}],[2817,{"./cbor":2814,"./fountainUtils":2818,"./utils":2823,assert:3756,buffer:3760},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.FountainEncoderPart=void 0;const r=s(e("assert")),a=e("./utils"),i=e("./fountainUtils"),o=e("./cbor");class c{constructor(e,t,n,s,r){this._seqNum=e,this._seqLength=t,this._messageLength=n,this._checksum=s,this._fragment=r}get messageLength(){return this._messageLength}get fragment(){return this._fragment}get seqNum(){return this._seqNum}get seqLength(){return this._seqLength}get checksum(){return this._checksum}cbor(){const e=o.cborEncode([this._seqNum,this._seqLength,this._messageLength,this._checksum,this._fragment]);return t.from(e)}description(){return`seqNum:${this._seqNum}, seqLen:${this._seqLength}, messageLen:${this._messageLength}, checksum:${this._checksum}, data:${this._fragment.toString("hex")}`}static fromCBOR(e){const[n,s,a,i,u]=o.cborDecode(e);return r.default("number"==typeof n),r.default("number"==typeof s),r.default("number"==typeof a),r.default("number"==typeof i),r.default(t.isBuffer(u)&&u.length>0),new c(n,s,a,i,t.from(u))}}n.FountainEncoderPart=c;class u{constructor(e,t=100,n=0,s=10){const r=u.findNominalFragmentLength(e.length,s,t);this._messageLength=e.length,this._fragments=u.partitionMessage(e,r),this.fragmentLength=r,this.seqNum=a.toUint32(n),this.checksum=a.getCRC(e)}get fragmentsLength(){return this._fragments.length}get fragments(){return this._fragments}get messageLength(){return this._messageLength}isComplete(){return this.seqNum>=this._fragments.length}isSinglePart(){return 1===this._fragments.length}seqLength(){return this._fragments.length}mix(e){return e.reduce((e,t)=>a.bufferXOR(this._fragments[t],e),t.alloc(this.fragmentLength,0))}nextPart(){this.seqNum=a.toUint32(this.seqNum+1);const e=i.chooseFragments(this.seqNum,this._fragments.length,this.checksum),t=this.mix(e);return new c(this.seqNum,this._fragments.length,this._messageLength,this.checksum,t)}static findNominalFragmentLength(e,t,n){r.default(e>0),r.default(t>0),r.default(n>=t);const s=Math.ceil(e/t);let a=0;for(let t=1;t<=s&&(a=Math.ceil(e/t),!(a<=n));t++);return a}static partitionMessage(e,n){let s,r=t.from(e),i=[];for(;r.length>0;)[s,r]=a.split(r,-n),s=t.alloc(n,0).fill(s,0,s.length),i.push(s);return i}}n.default=u}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@ngraveio/bc-ur",file:"node_modules/@ngraveio/bc-ur/dist/fountainEncoder.js"}],[2818,{"./utils":2823,"./xoshiro":2824,"@keystonehq/alias-sampling":760,buffer:3760},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.chooseFragments=n.shuffle=n.chooseDegree=void 0;const r=e("./utils"),a=s(e("./xoshiro")),i=s(e("@keystonehq/alias-sampling"));n.chooseDegree=(e,t)=>{const n=[...new Array(e)].map((e,t)=>1/(t+1));return i.default(n,undefined,t.nextDouble).next()+1};n.shuffle=(e,t)=>{let n=[...e],s=[];for(;n.length>0;){let e=t.nextInt(0,n.length-1),r=n[e];n.splice(e,1),s.push(r)}return s};n.chooseFragments=(e,s,i)=>{if(e<=s)return[e-1];{const o=t.concat([r.intToBytes(e),r.intToBytes(i)]),c=new a.default(o),u=n.chooseDegree(s,c),l=[...new Array(s)].map((e,t)=>t);return n.shuffle(l,c).slice(0,u)}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@ngraveio/bc-ur",file:"node_modules/@ngraveio/bc-ur/dist/fountainUtils.js"}],[2819,{"./ur":2820,"./urDecoder":2821,"./urEncoder":2822},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.URDecoder=n.UREncoder=n.UR=void 0;const r=s(e("./ur"));n.UR=r.default;const a=s(e("./urEncoder"));n.UREncoder=a.default;const i=s(e("./urDecoder"));n.URDecoder=i.default}}},{package:"@ngraveio/bc-ur",file:"node_modules/@ngraveio/bc-ur/dist/index.js"}],[2820,{"./cbor":2814,"./errors":2815,"./utils":2823,buffer:3760},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){Object.defineProperty(n,"__esModule",{value:!0});const s=e("./errors"),r=e("./utils"),a=e("./cbor");class i{constructor(e,t="bytes"){if(this._cborPayload=e,this._type=t,!r.isURType(this._type))throw new s.InvalidTypeError}static fromBuffer(e){return new i(a.cborEncode(e))}static from(e,n){return i.fromBuffer(t.from(e,n))}decodeCBOR(){return a.cborDecode(this._cborPayload)}get type(){return this._type}get cbor(){return this._cborPayload}equals(e){return this.type===e.type&&this.cbor.equals(e.cbor)}}n.default=i}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@ngraveio/bc-ur",file:"node_modules/@ngraveio/bc-ur/dist/ur.js"}],[2821,{"./bytewords":2813,"./errors":2815,"./fountainDecoder":2816,"./fountainEncoder":2817,"./ur":2820,"./utils":2823,assert:3756,buffer:3760},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const r=s(e("./fountainDecoder")),a=s(e("./bytewords")),i=s(e("assert")),o=e("./utils"),c=e("./errors"),u=s(e("./ur")),l=e("./fountainEncoder");class d{constructor(e=new r.default,t="bytes"){this.fountainDecoder=e,this.type=t,i.default(o.isURType(t),"Invalid UR type"),this.expected_type=""}static decodeBody(e,n){const s=a.default.decode(n,a.default.STYLES.MINIMAL);return new u.default(t.from(s,"hex"),e)}validatePart(e){return this.expected_type?this.expected_type===e:!!o.isURType(e)&&(this.expected_type=e,!0)}static decode(e){const[t,n]=this.parse(e);if(0===n.length)throw new c.InvalidPathLengthError;const s=n[0];return d.decodeBody(t,s)}static parse(e){const t=e.toLowerCase();if("ur:"!==t.slice(0,3))throw new c.InvalidSchemeError;const n=t.slice(3).split("/"),s=n[0];if(n.length<2)throw new c.InvalidPathLengthError;if(!o.isURType(s))throw new c.InvalidTypeError;return[s,n.slice(1)]}static parseSequenceComponent(e){const t=e.split("-");if(2!==t.length)throw new c.InvalidSequenceComponentError;const n=o.toUint32(Number(t[0])),s=Number(t[1]);if(n<1||s<1)throw new c.InvalidSequenceComponentError;return[n,s]}receivePart(e){if(this.result!==undefined)return!1;const[t,n]=d.parse(e);if(!this.validatePart(t))return!1;if(1===n.length)return this.result=d.decodeBody(t,n[0]),!0;if(2!==n.length)throw new c.InvalidPathLengthError;const[s,r]=n,[i,o]=d.parseSequenceComponent(s),f=a.default.decode(r,a.default.STYLES.MINIMAL),h=l.FountainEncoderPart.fromCBOR(f);return i===h.seqNum&&o===h.seqLength&&(!!this.fountainDecoder.receivePart(h)&&(this.fountainDecoder.isSuccess()?this.result=new u.default(this.fountainDecoder.resultMessage(),t):this.fountainDecoder.isFailure()&&(this.error=new c.InvalidSchemeError),!0))}resultUR(){return this.result?this.result:new u.default(t.from([]))}isComplete(){return this.result&&this.result.cbor.length>0}isSuccess(){return!this.error&&this.isComplete()}isError(){return this.error!==undefined}resultError(){return this.error?this.error.message:""}expectedPartCount(){return this.fountainDecoder.expectedPartCount()}expectedPartIndexes(){return this.fountainDecoder.getExpectedPartIndexes()}receivedPartIndexes(){return this.fountainDecoder.getReceivedPartIndexes()}lastPartIndexes(){return this.fountainDecoder.getLastPartIndexes()}estimatedPercentComplete(){return this.fountainDecoder.estimatedPercentComplete()}getProgress(){return this.fountainDecoder.getProgress()}}n.default=d}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@ngraveio/bc-ur",file:"node_modules/@ngraveio/bc-ur/dist/urDecoder.js"}],[2822,{"./bytewords":2813,"./fountainEncoder":2817},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const r=s(e("./fountainEncoder")),a=s(e("./bytewords"));class i{constructor(e,t,n,s){this.ur=e,this.fountainEncoder=new r.default(e.cbor,t,n,s)}get fragmentsLength(){return this.fountainEncoder.fragmentsLength}get fragments(){return this.fountainEncoder.fragments}get messageLength(){return this.fountainEncoder.messageLength}get cbor(){return this.ur.cbor}encodeWhole(){return[...new Array(this.fragmentsLength)].map(()=>this.nextPart())}nextPart(){const e=this.fountainEncoder.nextPart();return this.fountainEncoder.isSinglePart()?i.encodeSinglePart(this.ur):i.encodePart(this.ur.type,e)}static encodeUri(e,t){return[e,t.join("/")].join(":")}static encodeUR(e){return i.encodeUri("ur",e)}static encodePart(e,t){const n=`${t.seqNum}-${t.seqLength}`,s=a.default.encode(t.cbor().toString("hex"),a.default.STYLES.MINIMAL);return i.encodeUR([e,n,s])}static encodeSinglePart(e){const t=a.default.encode(e.cbor.toString("hex"),a.default.STYLES.MINIMAL);return i.encodeUR([e.type,t])}}n.default=i}}},{package:"@ngraveio/bc-ur",file:"node_modules/@ngraveio/bc-ur/dist/urEncoder.js"}],[2823,{buffer:3760,crc:3856,"sha.js":5274},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.bufferXOR=n.setDifference=n.arrayContains=n.arraysEqual=n.hasPrefix=n.isURType=n.intToBytes=n.toUint32=n.getCRCHex=n.getCRC=n.split=n.partition=n.sha256Hash=void 0;const r=s(e("sha.js")),a=e("crc");n.sha256Hash=e=>r.default("sha256").update(e).digest();n.partition=(e,t)=>e.match(new RegExp(".{1,"+t+"}","g"))||[e];n.split=(e,t)=>[e.slice(0,-t),e.slice(-t)];n.getCRC=e=>a.crc32(e);n.getCRCHex=e=>a.crc32(e).toString(16).padStart(8,"0");n.toUint32=e=>e>>>0;n.intToBytes=e=>{const n=new ArrayBuffer(4);return new DataView(n).setUint32(0,e,!1),t.from(n)};n.isURType=e=>e.split("").every((t,n)=>{let s=e.charCodeAt(n);return"a".charCodeAt(0)<=s&&s<="z".charCodeAt(0)||("0".charCodeAt(0)<=s&&s<="9".charCodeAt(0)||s==="-".charCodeAt(0))});n.hasPrefix=(e,t)=>0===e.indexOf(t);n.arraysEqual=(e,t)=>e.length===t.length&&e.every(e=>t.includes(e));n.arrayContains=(e,t)=>t.every(t=>e.includes(t));n.setDifference=(e,t)=>e.filter(e=>t.indexOf(e)<0);n.bufferXOR=(e,n)=>{const s=Math.max(e.length,n.length),r=t.allocUnsafe(s);for(let t=0;t<s;++t)r[t]=e[t]^n[t];return r}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@ngraveio/bc-ur",file:"node_modules/@ngraveio/bc-ur/dist/utils.js"}],[2824,{"./utils":2823,"bignumber.js":2825,jsbi:4364},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const r=e("./utils"),a=s(e("bignumber.js")),i=s(e("jsbi")),o=(e,t)=>i.default.bitwiseXor(i.default.asUintN(64,i.default.leftShift(e,i.default.BigInt(t))),i.default.BigInt(i.default.asUintN(64,i.default.signedRightShift(e,i.default.subtract(i.default.BigInt(64),i.default.BigInt(t))))));n.default=class{constructor(e){this.next=()=>new a.default(this.roll().toString()),this.nextDouble=()=>new a.default(this.roll().toString()).div(0x10000000000000000),this.nextInt=(e,t)=>Math.floor(this.nextDouble().toNumber()*(t-e+1)+e),this.nextByte=()=>this.nextInt(0,255),this.nextData=e=>[...new Array(e)].map(()=>this.nextByte());const t=r.sha256Hash(e);this.s=[i.default.BigInt(0),i.default.BigInt(0),i.default.BigInt(0),i.default.BigInt(0)],this.setS(t)}setS(e){for(let t=0;t<4;t++){let n=8*t,s=i.default.BigInt(0);for(let t=0;t<8;t++)s=i.default.asUintN(64,i.default.leftShift(s,i.default.BigInt(8))),s=i.default.asUintN(64,i.default.bitwiseOr(s,i.default.BigInt(e[n+t])));this.s[t]=i.default.asUintN(64,s)}}roll(){const e=i.default.asUintN(64,i.default.multiply(o(i.default.asUintN(64,i.default.multiply(this.s[1],i.default.BigInt(5))),7),i.default.BigInt(9))),t=i.default.asUintN(64,i.default.leftShift(this.s[1],i.default.BigInt(17)));return this.s[2]=i.default.asUintN(64,i.default.bitwiseXor(this.s[2],i.default.BigInt(this.s[0]))),this.s[3]=i.default.asUintN(64,i.default.bitwiseXor(this.s[3],i.default.BigInt(this.s[1]))),this.s[1]=i.default.asUintN(64,i.default.bitwiseXor(this.s[1],i.default.BigInt(this.s[2]))),this.s[0]=i.default.asUintN(64,i.default.bitwiseXor(this.s[0],i.default.BigInt(this.s[3]))),this.s[2]=i.default.asUintN(64,i.default.bitwiseXor(this.s[2],i.default.BigInt(t))),this.s[3]=i.default.asUintN(64,o(this.s[3],45)),e}}}}},{package:"@ngraveio/bc-ur",file:"node_modules/@ngraveio/bc-ur/dist/xoshiro.js"}],[2825,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){!function(e){var n,s=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,r=Math.ceil,a=Math.floor,i="[BigNumber Error] ",o=i+"Number primitive has more than 15 significant digits: ",c=1e14,u=14,l=9007199254740991,d=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],f=1e7,h=1e9;function p(e){var t=0|e;return e>0||e===t?t:t-1}function m(e){for(var t,n,s=1,r=e.length,a=e[0]+"";s<r;){for(t=e[s++]+"",n=u-t.length;n--;t="0"+t);a+=t}for(r=a.length;48===a.charCodeAt(--r););return a.slice(0,r+1||1)}function g(e,t){var n,s,r=e.c,a=t.c,i=e.s,o=t.s,c=e.e,u=t.e;if(!i||!o)return null;if(n=r&&!r[0],s=a&&!a[0],n||s)return n?s?0:-o:i;if(i!=o)return i;if(n=i<0,s=c==u,!r||!a)return s?0:!r^n?1:-1;if(!s)return c>u^n?1:-1;for(o=(c=r.length)<(u=a.length)?c:u,i=0;i<o;i++)if(r[i]!=a[i])return r[i]>a[i]^n?1:-1;return c==u?0:c>u^n?1:-1}function b(e,t,n,s){if(e<t||e>n||e!==a(e))throw Error(i+(s||"Argument")+("number"==typeof e?e<t||e>n?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function y(e){var t=e.c.length-1;return p(e.e/u)==t&&e.c[t]%2!=0}function w(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function T(e,t,n){var s,r;if(t<0){for(r=n+".";++t;r+=n);e=r+e}else if(++t>(s=e.length)){for(r=n,t-=s;--t;r+=n);e+=r}else t<s&&(e=e.slice(0,t)+"."+e.slice(t));return e}n=function e(t){var n,E,S,v,k,P,I,_,x,j,A=K.prototype={constructor:K,toString:null,valueOf:null},C=new K(1),R=20,O=4,M=-7,B=21,N=-1e7,F=1e7,L=!1,D=1,G=0,U={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},H="0123456789abcdefghijklmnopqrstuvwxyz",$=!0;function K(e,t){var n,r,i,c,d,f,h,p,m=this;if(!(m instanceof K))return new K(e,t);if(null==t){if(e&&!0===e._isBigNumber)return m.s=e.s,void(!e.c||e.e>F?m.c=m.e=null:e.e<N?m.c=[m.e=0]:(m.e=e.e,m.c=e.c.slice()));if((f="number"==typeof e)&&0*e==0){if(m.s=1/e<0?(e=-e,-1):1,e===~~e){for(c=0,d=e;d>=10;d/=10,c++);return void(c>F?m.c=m.e=null:(m.e=c,m.c=[e]))}p=String(e)}else{if(!s.test(p=String(e)))return S(m,p,f);m.s=45==p.charCodeAt(0)?(p=p.slice(1),-1):1}(c=p.indexOf("."))>-1&&(p=p.replace(".","")),(d=p.search(/e/i))>0?(c<0&&(c=d),c+=+p.slice(d+1),p=p.substring(0,d)):c<0&&(c=p.length)}else{if(b(t,2,H.length,"Base"),10==t&&$)return z(m=new K(e),R+m.e+1,O);if(p=String(e),f="number"==typeof e){if(0*e!=0)return S(m,p,f,t);if(m.s=1/e<0?(p=p.slice(1),-1):1,K.DEBUG&&p.replace(/^0\.0*|\./,"").length>15)throw Error(o+e)}else m.s=45===p.charCodeAt(0)?(p=p.slice(1),-1):1;for(n=H.slice(0,t),c=d=0,h=p.length;d<h;d++)if(n.indexOf(r=p.charAt(d))<0){if("."==r){if(d>c){c=h;continue}}else if(!i&&(p==p.toUpperCase()&&(p=p.toLowerCase())||p==p.toLowerCase()&&(p=p.toUpperCase()))){i=!0,d=-1,c=0;continue}return S(m,String(e),f,t)}f=!1,(c=(p=E(p,t,10,m.s)).indexOf("."))>-1?p=p.replace(".",""):c=p.length}for(d=0;48===p.charCodeAt(d);d++);for(h=p.length;48===p.charCodeAt(--h););if(p=p.slice(d,++h)){if(h-=d,f&&K.DEBUG&&h>15&&(e>l||e!==a(e)))throw Error(o+m.s*e);if((c=c-d-1)>F)m.c=m.e=null;else if(c<N)m.c=[m.e=0];else{if(m.e=c,m.c=[],d=(c+1)%u,c<0&&(d+=u),d<h){for(d&&m.c.push(+p.slice(0,d)),h-=u;d<h;)m.c.push(+p.slice(d,d+=u));d=u-(p=p.slice(d)).length}else d-=h;for(;d--;p+="0");m.c.push(+p)}}else m.c=[m.e=0]}function q(e,t,n,s){var r,a,i,o,c;if(null==n?n=O:b(n,0,8),!e.c)return e.toString();if(r=e.c[0],i=e.e,null==t)c=m(e.c),c=1==s||2==s&&(i<=M||i>=B)?w(c,i):T(c,i,"0");else if(a=(e=z(new K(e),t,n)).e,o=(c=m(e.c)).length,1==s||2==s&&(t<=a||a<=M)){for(;o<t;c+="0",o++);c=w(c,a)}else if(t-=i,c=T(c,a,"0"),a+1>o){if(--t>0)for(c+=".";t--;c+="0");}else if((t+=a-o)>0)for(a+1==o&&(c+=".");t--;c+="0");return e.s<0&&r?"-"+c:c}function W(e,t){for(var n,s,r=1,a=new K(e[0]);r<e.length;r++)(!(s=new K(e[r])).s||(n=g(a,s))===t||0===n&&a.s===t)&&(a=s);return a}function V(e,t,n){for(var s=1,r=t.length;!t[--r];t.pop());for(r=t[0];r>=10;r/=10,s++);return(n=s+n*u-1)>F?e.c=e.e=null:n<N?e.c=[e.e=0]:(e.e=n,e.c=t),e}function z(e,t,n,s){var i,o,l,f,h,p,m,g=e.c,b=d;if(g){e:{for(i=1,f=g[0];f>=10;f/=10,i++);if((o=t-i)<0)o+=u,l=t,h=g[p=0],m=a(h/b[i-l-1]%10);else if((p=r((o+1)/u))>=g.length){if(!s)break e;for(;g.length<=p;g.push(0));h=m=0,i=1,l=(o%=u)-u+1}else{for(h=f=g[p],i=1;f>=10;f/=10,i++);m=(l=(o%=u)-u+i)<0?0:a(h/b[i-l-1]%10)}if(s=s||t<0||null!=g[p+1]||(l<0?h:h%b[i-l-1]),s=n<4?(m||s)&&(0==n||n==(e.s<0?3:2)):m>5||5==m&&(4==n||s||6==n&&(o>0?l>0?h/b[i-l]:0:g[p-1])%10&1||n==(e.s<0?8:7)),t<1||!g[0])return g.length=0,s?(t-=e.e+1,g[0]=b[(u-t%u)%u],e.e=-t||0):g[0]=e.e=0,e;if(0==o?(g.length=p,f=1,p--):(g.length=p+1,f=b[u-o],g[p]=l>0?a(h/b[i-l]%b[l])*f:0),s)for(;;){if(0==p){for(o=1,l=g[0];l>=10;l/=10,o++);for(l=g[0]+=f,f=1;l>=10;l/=10,f++);o!=f&&(e.e++,g[0]==c&&(g[0]=1));break}if(g[p]+=f,g[p]!=c)break;g[p--]=0,f=1}for(o=g.length;0===g[--o];g.pop());}e.e>F?e.c=e.e=null:e.e<N&&(e.c=[e.e=0])}return e}function J(e){var t,n=e.e;return null===n?e.toString():(t=m(e.c),t=n<=M||n>=B?w(t,n):T(t,n,"0"),e.s<0?"-"+t:t)}return K.clone=e,K.ROUND_UP=0,K.ROUND_DOWN=1,K.ROUND_CEIL=2,K.ROUND_FLOOR=3,K.ROUND_HALF_UP=4,K.ROUND_HALF_DOWN=5,K.ROUND_HALF_EVEN=6,K.ROUND_HALF_CEIL=7,K.ROUND_HALF_FLOOR=8,K.EUCLID=9,K.config=K.set=function(e){var t,n;if(null!=e){if("object"!=typeof e)throw Error(i+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(b(n=e[t],0,h,t),R=n),e.hasOwnProperty(t="ROUNDING_MODE")&&(b(n=e[t],0,8,t),O=n),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((n=e[t])&&n.pop?(b(n[0],-h,0,t),b(n[1],0,h,t),M=n[0],B=n[1]):(b(n,-h,h,t),M=-(B=n<0?-n:n))),e.hasOwnProperty(t="RANGE"))if((n=e[t])&&n.pop)b(n[0],-h,-1,t),b(n[1],1,h,t),N=n[0],F=n[1];else{if(b(n,-h,h,t),!n)throw Error(i+t+" cannot be zero: "+n);N=-(F=n<0?-n:n)}if(e.hasOwnProperty(t="CRYPTO")){if((n=e[t])!==!!n)throw Error(i+t+" not true or false: "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw L=!n,Error(i+"crypto unavailable");L=n}else L=n}if(e.hasOwnProperty(t="MODULO_MODE")&&(b(n=e[t],0,9,t),D=n),e.hasOwnProperty(t="POW_PRECISION")&&(b(n=e[t],0,h,t),G=n),e.hasOwnProperty(t="FORMAT")){if("object"!=typeof(n=e[t]))throw Error(i+t+" not an object: "+n);U=n}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(n=e[t])||/^.?$|[+\-.\s]|(.).*\1/.test(n))throw Error(i+t+" invalid: "+n);$="0123456789"==n.slice(0,10),H=n}}return{DECIMAL_PLACES:R,ROUNDING_MODE:O,EXPONENTIAL_AT:[M,B],RANGE:[N,F],CRYPTO:L,MODULO_MODE:D,POW_PRECISION:G,FORMAT:U,ALPHABET:H}},K.isBigNumber=function(e){if(!e||!0!==e._isBigNumber)return!1;if(!K.DEBUG)return!0;var t,n,s=e.c,r=e.e,o=e.s;e:if("[object Array]"=={}.toString.call(s)){if((1===o||-1===o)&&r>=-h&&r<=h&&r===a(r)){if(0===s[0]){if(0===r&&1===s.length)return!0;break e}if((t=(r+1)%u)<1&&(t+=u),String(s[0]).length==t){for(t=0;t<s.length;t++)if((n=s[t])<0||n>=c||n!==a(n))break e;if(0!==n)return!0}}}else if(null===s&&null===r&&(null===o||1===o||-1===o))return!0;throw Error(i+"Invalid BigNumber: "+e)},K.maximum=K.max=function(){return W(arguments,-1)},K.minimum=K.min=function(){return W(arguments,1)},K.random=(v=9007199254740992,k=Math.random()*v&2097151?function(){return a(Math.random()*v)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(e){var t,n,s,o,c,l=0,f=[],p=new K(C);if(null==e?e=R:b(e,0,h),o=r(e/u),L)if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(o*=2));l<o;)(c=131072*t[l]+(t[l+1]>>>11))>=9e15?(n=crypto.getRandomValues(new Uint32Array(2)),t[l]=n[0],t[l+1]=n[1]):(f.push(c%1e14),l+=2);l=o/2}else{if(!crypto.randomBytes)throw L=!1,Error(i+"crypto unavailable");for(t=crypto.randomBytes(o*=7);l<o;)(c=281474976710656*(31&t[l])+1099511627776*t[l+1]+4294967296*t[l+2]+16777216*t[l+3]+(t[l+4]<<16)+(t[l+5]<<8)+t[l+6])>=9e15?crypto.randomBytes(7).copy(t,l):(f.push(c%1e14),l+=7);l=o/7}if(!L)for(;l<o;)(c=k())<9e15&&(f[l++]=c%1e14);for(o=f[--l],e%=u,o&&e&&(c=d[u-e],f[l]=a(o/c)*c);0===f[l];f.pop(),l--);if(l<0)f=[s=0];else{for(s=-1;0===f[0];f.splice(0,1),s-=u);for(l=1,c=f[0];c>=10;c/=10,l++);l<u&&(s-=u-l)}return p.e=s,p.c=f,p}),K.sum=function(){for(var e=1,t=arguments,n=new K(t[0]);e<t.length;)n=n.plus(t[e++]);return n},E=function(){var e="0123456789";function t(e,t,n,s){for(var r,a,i=[0],o=0,c=e.length;o<c;){for(a=i.length;a--;i[a]*=t);for(i[0]+=s.indexOf(e.charAt(o++)),r=0;r<i.length;r++)i[r]>n-1&&(null==i[r+1]&&(i[r+1]=0),i[r+1]+=i[r]/n|0,i[r]%=n)}return i.reverse()}return function(s,r,a,i,o){var c,u,l,d,f,h,p,g,b=s.indexOf("."),y=R,w=O;for(b>=0&&(d=G,G=0,s=s.replace(".",""),h=(g=new K(r)).pow(s.length-b),G=d,g.c=t(T(m(h.c),h.e,"0"),10,a,e),g.e=g.c.length),l=d=(p=t(s,r,a,o?(c=H,e):(c=e,H))).length;0==p[--d];p.pop());if(!p[0])return c.charAt(0);if(b<0?--l:(h.c=p,h.e=l,h.s=i,p=(h=n(h,g,y,w,a)).c,f=h.r,l=h.e),b=p[u=l+y+1],d=a/2,f=f||u<0||null!=p[u+1],f=w<4?(null!=b||f)&&(0==w||w==(h.s<0?3:2)):b>d||b==d&&(4==w||f||6==w&&1&p[u-1]||w==(h.s<0?8:7)),u<1||!p[0])s=f?T(c.charAt(1),-y,c.charAt(0)):c.charAt(0);else{if(p.length=u,f)for(--a;++p[--u]>a;)p[u]=0,u||(++l,p=[1].concat(p));for(d=p.length;!p[--d];);for(b=0,s="";b<=d;s+=c.charAt(p[b++]));s=T(s,l,c.charAt(0))}return s}}(),n=function(){function e(e,t,n){var s,r,a,i,o=0,c=e.length,u=t%f,l=t/f|0;for(e=e.slice();c--;)o=((r=u*(a=e[c]%f)+(s=l*a+(i=e[c]/f|0)*u)%f*f+o)/n|0)+(s/f|0)+l*i,e[c]=r%n;return o&&(e=[o].concat(e)),e}function t(e,t,n,s){var r,a;if(n!=s)a=n>s?1:-1;else for(r=a=0;r<n;r++)if(e[r]!=t[r]){a=e[r]>t[r]?1:-1;break}return a}function n(e,t,n,s){for(var r=0;n--;)e[n]-=r,r=e[n]<t[n]?1:0,e[n]=r*s+e[n]-t[n];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(s,r,i,o,l){var d,f,h,m,g,b,y,w,T,E,S,v,k,P,I,_,x,j=s.s==r.s?1:-1,A=s.c,C=r.c;if(!(A&&A[0]&&C&&C[0]))return new K(s.s&&r.s&&(A?!C||A[0]!=C[0]:C)?A&&0==A[0]||!C?0*j:j/0:NaN);for(T=(w=new K(j)).c=[],j=i+(f=s.e-r.e)+1,l||(l=c,f=p(s.e/u)-p(r.e/u),j=j/u|0),h=0;C[h]==(A[h]||0);h++);if(C[h]>(A[h]||0)&&f--,j<0)T.push(1),m=!0;else{for(P=A.length,_=C.length,h=0,j+=2,(g=a(l/(C[0]+1)))>1&&(C=e(C,g,l),A=e(A,g,l),_=C.length,P=A.length),k=_,S=(E=A.slice(0,_)).length;S<_;E[S++]=0);x=C.slice(),x=[0].concat(x),I=C[0],C[1]>=l/2&&I++;do{if(g=0,(d=t(C,E,_,S))<0){if(v=E[0],_!=S&&(v=v*l+(E[1]||0)),(g=a(v/I))>1)for(g>=l&&(g=l-1),y=(b=e(C,g,l)).length,S=E.length;1==t(b,E,y,S);)g--,n(b,_<y?x:C,y,l),y=b.length,d=1;else 0==g&&(d=g=1),y=(b=C.slice()).length;if(y<S&&(b=[0].concat(b)),n(E,b,S,l),S=E.length,-1==d)for(;t(C,E,_,S)<1;)g++,n(E,_<S?x:C,S,l),S=E.length}else 0===d&&(g++,E=[0]);T[h++]=g,E[0]?E[S++]=A[k]||0:(E=[A[k]],S=1)}while((k++<P||null!=E[0])&&j--);m=null!=E[0],T[0]||T.splice(0,1)}if(l==c){for(h=1,j=T[0];j>=10;j/=10,h++);z(w,i+(w.e=h+f*u-1)+1,o,m)}else w.e=f,w.r=+m;return w}}(),P=/^(-?)0([xbo])(?=\w[\w.]*$)/i,I=/^([^.]+)\.$/,_=/^\.([^.]+)$/,x=/^-?(Infinity|NaN)$/,j=/^\s*\+(?=[\w.])|^\s+|\s+$/g,S=function(e,t,n,s){var r,a=n?t:t.replace(j,"");if(x.test(a))e.s=isNaN(a)?null:a<0?-1:1;else{if(!n&&(a=a.replace(P,function(e,t,n){return r="x"==(n=n.toLowerCase())?16:"b"==n?2:8,s&&s!=r?e:t}),s&&(r=s,a=a.replace(I,"$1").replace(_,"0.$1")),t!=a))return new K(a,r);if(K.DEBUG)throw Error(i+"Not a"+(s?" base "+s:"")+" number: "+t);e.s=null}e.c=e.e=null},A.absoluteValue=A.abs=function(){var e=new K(this);return e.s<0&&(e.s=1),e},A.comparedTo=function(e,t){return g(this,new K(e,t))},A.decimalPlaces=A.dp=function(e,t){var n,s,r,a=this;if(null!=e)return b(e,0,h),null==t?t=O:b(t,0,8),z(new K(a),e+a.e+1,t);if(!(n=a.c))return null;if(s=((r=n.length-1)-p(this.e/u))*u,r=n[r])for(;r%10==0;r/=10,s--);return s<0&&(s=0),s},A.dividedBy=A.div=function(e,t){return n(this,new K(e,t),R,O)},A.dividedToIntegerBy=A.idiv=function(e,t){return n(this,new K(e,t),0,1)},A.exponentiatedBy=A.pow=function(e,t){var n,s,o,c,l,d,f,h,p=this;if((e=new K(e)).c&&!e.isInteger())throw Error(i+"Exponent not an integer: "+J(e));if(null!=t&&(t=new K(t)),l=e.e>14,!p.c||!p.c[0]||1==p.c[0]&&!p.e&&1==p.c.length||!e.c||!e.c[0])return h=new K(Math.pow(+J(p),l?e.s*(2-y(e)):+J(e))),t?h.mod(t):h;if(d=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new K(NaN);(s=!d&&p.isInteger()&&t.isInteger())&&(p=p.mod(t))}else{if(e.e>9&&(p.e>0||p.e<-1||(0==p.e?p.c[0]>1||l&&p.c[1]>=24e7:p.c[0]<8e13||l&&p.c[0]<=9999975e7)))return c=p.s<0&&y(e)?-0:0,p.e>-1&&(c=1/c),new K(d?1/c:c);G&&(c=r(G/u+2))}for(l?(n=new K(.5),d&&(e.s=1),f=y(e)):f=(o=Math.abs(+J(e)))%2,h=new K(C);;){if(f){if(!(h=h.times(p)).c)break;c?h.c.length>c&&(h.c.length=c):s&&(h=h.mod(t))}if(o){if(0===(o=a(o/2)))break;f=o%2}else if(z(e=e.times(n),e.e+1,1),e.e>14)f=y(e);else{if(0===(o=+J(e)))break;f=o%2}p=p.times(p),c?p.c&&p.c.length>c&&(p.c.length=c):s&&(p=p.mod(t))}return s?h:(d&&(h=C.div(h)),t?h.mod(t):c?z(h,G,O,undefined):h)},A.integerValue=function(e){var t=new K(this);return null==e?e=O:b(e,0,8),z(t,t.e+1,e)},A.isEqualTo=A.eq=function(e,t){return 0===g(this,new K(e,t))},A.isFinite=function(){return!!this.c},A.isGreaterThan=A.gt=function(e,t){return g(this,new K(e,t))>0},A.isGreaterThanOrEqualTo=A.gte=function(e,t){return 1===(t=g(this,new K(e,t)))||0===t},A.isInteger=function(){return!!this.c&&p(this.e/u)>this.c.length-2},A.isLessThan=A.lt=function(e,t){return g(this,new K(e,t))<0},A.isLessThanOrEqualTo=A.lte=function(e,t){return-1===(t=g(this,new K(e,t)))||0===t},A.isNaN=function(){return!this.s},A.isNegative=function(){return this.s<0},A.isPositive=function(){return this.s>0},A.isZero=function(){return!!this.c&&0==this.c[0]},A.minus=function(e,t){var n,s,r,a,i=this,o=i.s;if(t=(e=new K(e,t)).s,!o||!t)return new K(NaN);if(o!=t)return e.s=-t,i.plus(e);var l=i.e/u,d=e.e/u,f=i.c,h=e.c;if(!l||!d){if(!f||!h)return f?(e.s=-t,e):new K(h?i:NaN);if(!f[0]||!h[0])return h[0]?(e.s=-t,e):new K(f[0]?i:3==O?-0:0)}if(l=p(l),d=p(d),f=f.slice(),o=l-d){for((a=o<0)?(o=-o,r=f):(d=l,r=h),r.reverse(),t=o;t--;r.push(0));r.reverse()}else for(s=(a=(o=f.length)<(t=h.length))?o:t,o=t=0;t<s;t++)if(f[t]!=h[t]){a=f[t]<h[t];break}if(a&&(r=f,f=h,h=r,e.s=-e.s),(t=(s=h.length)-(n=f.length))>0)for(;t--;f[n++]=0);for(t=c-1;s>o;){if(f[--s]<h[s]){for(n=s;n&&!f[--n];f[n]=t);--f[n],f[s]+=c}f[s]-=h[s]}for(;0==f[0];f.splice(0,1),--d);return f[0]?V(e,f,d):(e.s=3==O?-1:1,e.c=[e.e=0],e)},A.modulo=A.mod=function(e,t){var s,r,a=this;return e=new K(e,t),!a.c||!e.s||e.c&&!e.c[0]?new K(NaN):!e.c||a.c&&!a.c[0]?new K(a):(9==D?(r=e.s,e.s=1,s=n(a,e,0,3),e.s=r,s.s*=r):s=n(a,e,0,D),(e=a.minus(s.times(e))).c[0]||1!=D||(e.s=a.s),e)},A.multipliedBy=A.times=function(e,t){var n,s,r,a,i,o,l,d,h,m,g,b,y,w,T,E=this,S=E.c,v=(e=new K(e,t)).c;if(!(S&&v&&S[0]&&v[0]))return!E.s||!e.s||S&&!S[0]&&!v||v&&!v[0]&&!S?e.c=e.e=e.s=null:(e.s*=E.s,S&&v?(e.c=[0],e.e=0):e.c=e.e=null),e;for(s=p(E.e/u)+p(e.e/u),e.s*=E.s,(l=S.length)<(m=v.length)&&(y=S,S=v,v=y,r=l,l=m,m=r),r=l+m,y=[];r--;y.push(0));for(w=c,T=f,r=m;--r>=0;){for(n=0,g=v[r]%T,b=v[r]/T|0,a=r+(i=l);a>r;)n=((d=g*(d=S[--i]%T)+(o=b*d+(h=S[i]/T|0)*g)%T*T+y[a]+n)/w|0)+(o/T|0)+b*h,y[a--]=d%w;y[a]=n}return n?++s:y.splice(0,1),V(e,y,s)},A.negated=function(){var e=new K(this);return e.s=-e.s||null,e},A.plus=function(e,t){var n,s=this,r=s.s;if(t=(e=new K(e,t)).s,!r||!t)return new K(NaN);if(r!=t)return e.s=-t,s.minus(e);var a=s.e/u,i=e.e/u,o=s.c,l=e.c;if(!a||!i){if(!o||!l)return new K(r/0);if(!o[0]||!l[0])return l[0]?e:new K(o[0]?s:0*r)}if(a=p(a),i=p(i),o=o.slice(),r=a-i){for(r>0?(i=a,n=l):(r=-r,n=o),n.reverse();r--;n.push(0));n.reverse()}for((r=o.length)-(t=l.length)<0&&(n=l,l=o,o=n,t=r),r=0;t;)r=(o[--t]=o[t]+l[t]+r)/c|0,o[t]=c===o[t]?0:o[t]%c;return r&&(o=[r].concat(o),++i),V(e,o,i)},A.precision=A.sd=function(e,t){var n,s,r,a=this;if(null!=e&&e!==!!e)return b(e,1,h),null==t?t=O:b(t,0,8),z(new K(a),e,t);if(!(n=a.c))return null;if(s=(r=n.length-1)*u+1,r=n[r]){for(;r%10==0;r/=10,s--);for(r=n[0];r>=10;r/=10,s++);}return e&&a.e+1>s&&(s=a.e+1),s},A.shiftedBy=function(e){return b(e,-9007199254740991,l),this.times("1e"+e)},A.squareRoot=A.sqrt=function(){var e,t,s,r,a,i=this,o=i.c,c=i.s,u=i.e,l=R+4,d=new K("0.5");if(1!==c||!o||!o[0])return new K(!c||c<0&&(!o||o[0])?NaN:o?i:1/0);if(0==(c=Math.sqrt(+J(i)))||c==1/0?(((t=m(o)).length+u)%2==0&&(t+="0"),c=Math.sqrt(+t),u=p((u+1)/2)-(u<0||u%2),s=new K(t=c==1/0?"5e"+u:(t=c.toExponential()).slice(0,t.indexOf("e")+1)+u)):s=new K(c+""),s.c[0])for((c=(u=s.e)+l)<3&&(c=0);;)if(a=s,s=d.times(a.plus(n(i,a,l,1))),m(a.c).slice(0,c)===(t=m(s.c)).slice(0,c)){if(s.e<u&&--c,"9999"!=(t=t.slice(c-3,c+1))&&(r||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(z(s,s.e+R+2,1),e=!s.times(s).eq(i));break}if(!r&&(z(a,a.e+R+2,0),a.times(a).eq(i))){s=a;break}l+=4,c+=4,r=1}return z(s,s.e+R+1,O,e)},A.toExponential=function(e,t){return null!=e&&(b(e,0,h),e++),q(this,e,t,1)},A.toFixed=function(e,t){return null!=e&&(b(e,0,h),e=e+this.e+1),q(this,e,t)},A.toFormat=function(e,t,n){var s,r=this;if(null==n)null!=e&&t&&"object"==typeof t?(n=t,t=null):e&&"object"==typeof e?(n=e,e=t=null):n=U;else if("object"!=typeof n)throw Error(i+"Argument not an object: "+n);if(s=r.toFixed(e,t),r.c){var a,o=s.split("."),c=+n.groupSize,u=+n.secondaryGroupSize,l=n.groupSeparator||"",d=o[0],f=o[1],h=r.s<0,p=h?d.slice(1):d,m=p.length;if(u&&(a=c,c=u,u=a,m-=a),c>0&&m>0){for(a=m%c||c,d=p.substr(0,a);a<m;a+=c)d+=l+p.substr(a,c);u>0&&(d+=l+p.slice(a)),h&&(d="-"+d)}s=f?d+(n.decimalSeparator||"")+((u=+n.fractionGroupSize)?f.replace(new RegExp("\\d{"+u+"}\\B","g"),"$&"+(n.fractionGroupSeparator||"")):f):d}return(n.prefix||"")+s+(n.suffix||"")},A.toFraction=function(e){var t,s,r,a,o,c,l,f,h,p,g,b,y=this,w=y.c;if(null!=e&&(!(l=new K(e)).isInteger()&&(l.c||1!==l.s)||l.lt(C)))throw Error(i+"Argument "+(l.isInteger()?"out of range: ":"not an integer: ")+J(l));if(!w)return new K(y);for(t=new K(C),h=s=new K(C),r=f=new K(C),b=m(w),o=t.e=b.length-y.e-1,t.c[0]=d[(c=o%u)<0?u+c:c],e=!e||l.comparedTo(t)>0?o>0?t:h:l,c=F,F=1/0,l=new K(b),f.c[0]=0;p=n(l,t,0,1),1!=(a=s.plus(p.times(r))).comparedTo(e);)s=r,r=a,h=f.plus(p.times(a=h)),f=a,t=l.minus(p.times(a=t)),l=a;return a=n(e.minus(s),r,0,1),f=f.plus(a.times(h)),s=s.plus(a.times(r)),f.s=h.s=y.s,g=n(h,r,o*=2,O).minus(y).abs().comparedTo(n(f,s,o,O).minus(y).abs())<1?[h,r]:[f,s],F=c,g},A.toNumber=function(){return+J(this)},A.toPrecision=function(e,t){return null!=e&&b(e,1,h),q(this,e,t,2)},A.toString=function(e){var t,n=this,s=n.s,r=n.e;return null===r?s?(t="Infinity",s<0&&(t="-"+t)):t="NaN":(null==e?t=r<=M||r>=B?w(m(n.c),r):T(m(n.c),r,"0"):10===e&&$?t=T(m((n=z(new K(n),R+r+1,O)).c),n.e,"0"):(b(e,2,H.length,"Base"),t=E(T(m(n.c),r,"0"),10,e,s,!0)),s<0&&n.c[0]&&(t="-"+t)),t},A.valueOf=A.toJSON=function(){return J(this)},A._isBigNumber=!0,null!=t&&K.set(t),K}(),n.default=n.BigNumber=n,"function"==typeof define&&define.amd?define(function(){return n}):void 0!==t&&t.exports?t.exports=n:(e||(e="undefined"!=typeof self&&self?self:window),e.BigNumber=n)}(this)}}},{package:"@ngraveio/bc-ur>bignumber.js",file:"node_modules/@ngraveio/bc-ur/node_modules/bignumber.js/bignumber.js"}],[2826,{"./utils.js":2829},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.polyval=n.ghash=void 0,n._toGHASHKey=u;const s=e("./utils.js"),r=16,a=new Uint8Array(16),i=(0,s.u32)(a),o=(e,t,n,s)=>({s3:n<<31|s>>>1,s2:t<<31|n>>>1,s1:e<<31|t>>>1,s0:e>>>1^225<<24&-(1&(1&s))}),c=e=>(e>>>0&255)<<24|(e>>>8&255)<<16|(e>>>16&255)<<8|e>>>24&255;function u(e){e.reverse();const t=1&e[15];let n=0;for(let t=0;t<e.length;t++){const s=e[t];e[t]=s>>>1|n,n=(1&s)<<7}return e[0]^=225&-t,e}class l{constructor(e,t){this.blockLen=r,this.outputLen=r,this.s0=0,this.s1=0,this.s2=0,this.s3=0,this.finished=!1,e=(0,s.toBytes)(e),(0,s.abytes)(e,16);const n=(0,s.createView)(e);let a=n.getUint32(0,!1),i=n.getUint32(4,!1),u=n.getUint32(8,!1),l=n.getUint32(12,!1);const d=[];for(let e=0;e<128;e++)d.push({s0:c(a),s1:c(i),s2:c(u),s3:c(l)}),({s0:a,s1:i,s2:u,s3:l}=o(a,i,u,l));const f=(h=t||1024)>65536?8:h>1024?4:2;var h;if(![1,2,4,8].includes(f))throw new Error("ghash: invalid window size, expected 2, 4 or 8");this.W=f;const p=128/f,m=this.windowSize=2**f,g=[];for(let e=0;e<p;e++)for(let t=0;t<m;t++){let n=0,s=0,r=0,a=0;for(let i=0;i<f;i++){if(!(t>>>f-i-1&1))continue;const{s0:o,s1:c,s2:u,s3:l}=d[f*e+i];n^=o,s^=c,r^=u,a^=l}g.push({s0:n,s1:s,s2:r,s3:a})}this.t=g}_updateBlock(e,t,n,s){e^=this.s0,t^=this.s1,n^=this.s2,s^=this.s3;const{W:r,t:a,windowSize:i}=this;let o=0,c=0,u=0,l=0;const d=(1<<r)-1;let f=0;for(const h of[e,t,n,s])for(let e=0;e<4;e++){const t=h>>>8*e&255;for(let e=8/r-1;e>=0;e--){const n=t>>>r*e&d,{s0:s,s1:h,s2:p,s3:m}=a[f*i+n];o^=s,c^=h,u^=p,l^=m,f+=1}}this.s0=o,this.s1=c,this.s2=u,this.s3=l}update(e){(0,s.aexists)(this),e=(0,s.toBytes)(e),(0,s.abytes)(e);const t=(0,s.u32)(e),n=Math.floor(e.length/r),o=e.length%r;for(let e=0;e<n;e++)this._updateBlock(t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]);return o&&(a.set(e.subarray(n*r)),this._updateBlock(i[0],i[1],i[2],i[3]),(0,s.clean)(i)),this}destroy(){const{t:e}=this;for(const t of e)t.s0=0,t.s1=0,t.s2=0,t.s3=0}digestInto(e){(0,s.aexists)(this),(0,s.aoutput)(e,this),this.finished=!0;const{s0:t,s1:n,s2:r,s3:a}=this,i=(0,s.u32)(e);return i[0]=t,i[1]=n,i[2]=r,i[3]=a,e}digest(){const e=new Uint8Array(r);return this.digestInto(e),this.destroy(),e}}class d extends l{constructor(e,t){e=(0,s.toBytes)(e),(0,s.abytes)(e);const n=u((0,s.copyBytes)(e));super(n,t),(0,s.clean)(n)}update(e){e=(0,s.toBytes)(e),(0,s.aexists)(this);const t=(0,s.u32)(e),n=e.length%r,o=Math.floor(e.length/r);for(let e=0;e<o;e++)this._updateBlock(c(t[4*e+3]),c(t[4*e+2]),c(t[4*e+1]),c(t[4*e+0]));return n&&(a.set(e.subarray(o*r)),this._updateBlock(c(i[3]),c(i[2]),c(i[1]),c(i[0])),(0,s.clean)(i)),this}digestInto(e){(0,s.aexists)(this),(0,s.aoutput)(e,this),this.finished=!0;const{s0:t,s1:n,s2:r,s3:a}=this,i=(0,s.u32)(e);return i[0]=t,i[1]=n,i[2]=r,i[3]=a,e.reverse()}}function f(e){const t=(t,n)=>e(n,t.length).update((0,s.toBytes)(t)).digest(),n=e(new Uint8Array(16),0);return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=(t,n)=>e(t,n),t}n.ghash=f((e,t)=>new l(e,t)),n.polyval=f((e,t)=>new d(e,t))}}},{package:"@noble/ciphers",file:"node_modules/@noble/ciphers/_polyval.js"}],[2827,{"./_polyval.js":2826,"./utils.js":2829},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.unsafe=n.aeskwp=n.aeskw=n.siv=n.gcmsiv=n.gcm=n.cfb=n.cbc=n.ecb=n.ctr=void 0;const s=e("./_polyval.js"),r=e("./utils.js"),a=16,i=new Uint8Array(a);function o(e){return e<<1^283&-(e>>7)}function c(e,t){let n=0;for(;t>0;t>>=1)n^=e&-(1&t),e=o(e);return n}const u=(()=>{const e=new Uint8Array(256);for(let t=0,n=1;t<256;t++,n^=o(n))e[t]=n;const t=new Uint8Array(256);t[0]=99;for(let n=0;n<255;n++){let s=e[255-n];s|=s<<8,t[e[n]]=255&(s^s>>4^s>>5^s>>6^s>>7^99)}return(0,r.clean)(e),t})(),l=u.map((e,t)=>u.indexOf(t)),d=e=>e<<24|e>>>8,f=e=>e<<8|e>>>24,h=e=>e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255;function p(e,t){if(256!==e.length)throw new Error("Wrong sbox length");const n=new Uint32Array(256).map((n,s)=>t(e[s])),s=n.map(f),r=s.map(f),a=r.map(f),i=new Uint32Array(65536),o=new Uint32Array(65536),c=new Uint16Array(65536);for(let t=0;t<256;t++)for(let u=0;u<256;u++){const l=256*t+u;i[l]=n[t]^s[u],o[l]=r[t]^a[u],c[l]=e[t]<<8|e[u]}return{sbox:e,sbox2:c,T0:n,T1:s,T2:r,T3:a,T01:i,T23:o}}const m=p(u,e=>c(e,3)<<24|e<<16|e<<8|c(e,2)),g=p(l,e=>c(e,11)<<24|c(e,13)<<16|c(e,9)<<8|c(e,14)),b=(()=>{const e=new Uint8Array(16);for(let t=0,n=1;t<16;t++,n=o(n))e[t]=n;return e})();function y(e){(0,r.abytes)(e);const t=e.length;if(![16,24,32].includes(t))throw new Error("aes: invalid key size, should be 16, 24 or 32, got "+t);const{sbox2:n}=m,s=[];(0,r.isAligned32)(e)||s.push(e=(0,r.copyBytes)(e));const a=(0,r.u32)(e),i=a.length,o=e=>E(n,e,e,e,e),c=new Uint32Array(t+28);c.set(a);for(let e=i;e<c.length;e++){let t=c[e-1];e%i===0?t=o(d(t))^b[e/i-1]:i>6&&e%i===4&&(t=o(t)),c[e]=c[e-i]^t}return(0,r.clean)(...s),c}function w(e){const t=y(e),n=t.slice(),s=t.length,{sbox2:a}=m,{T0:i,T1:o,T2:c,T3:u}=g;for(let e=0;e<s;e+=4)for(let r=0;r<4;r++)n[e+r]=t[s-e-4+r];(0,r.clean)(t);for(let e=4;e<s-4;e++){const t=n[e],s=E(a,t,t,t,t);n[e]=i[255&s]^o[s>>>8&255]^c[s>>>16&255]^u[s>>>24]}return n}function T(e,t,n,s,r,a){return e[n<<8&65280|s>>>8&255]^t[r>>>8&65280|a>>>24&255]}function E(e,t,n,s,r){return e[255&t|65280&n]|e[s>>>16&255|r>>>16&65280]<<16}function S(e,t,n,s,r){const{sbox2:a,T01:i,T23:o}=m;let c=0;t^=e[c++],n^=e[c++],s^=e[c++],r^=e[c++];const u=e.length/4-2;for(let a=0;a<u;a++){const a=e[c++]^T(i,o,t,n,s,r),u=e[c++]^T(i,o,n,s,r,t),l=e[c++]^T(i,o,s,r,t,n),d=e[c++]^T(i,o,r,t,n,s);t=a,n=u,s=l,r=d}return{s0:e[c++]^E(a,t,n,s,r),s1:e[c++]^E(a,n,s,r,t),s2:e[c++]^E(a,s,r,t,n),s3:e[c++]^E(a,r,t,n,s)}}function v(e,t,n,s,r){const{sbox2:a,T01:i,T23:o}=g;let c=0;t^=e[c++],n^=e[c++],s^=e[c++],r^=e[c++];const u=e.length/4-2;for(let a=0;a<u;a++){const a=e[c++]^T(i,o,t,r,s,n),u=e[c++]^T(i,o,n,t,r,s),l=e[c++]^T(i,o,s,n,t,r),d=e[c++]^T(i,o,r,s,n,t);t=a,n=u,s=l,r=d}return{s0:e[c++]^E(a,t,r,s,n),s1:e[c++]^E(a,n,t,r,s),s2:e[c++]^E(a,s,n,t,r),s3:e[c++]^E(a,r,s,n,t)}}function k(e,t,n,s){(0,r.abytes)(t,a),(0,r.abytes)(n);const i=n.length;s=(0,r.getOutput)(i,s),(0,r.complexOverlapBytes)(n,s);const o=t,c=(0,r.u32)(o);let{s0:u,s1:l,s2:d,s3:f}=S(e,c[0],c[1],c[2],c[3]);const h=(0,r.u32)(n),p=(0,r.u32)(s);for(let t=0;t+4<=h.length;t+=4){p[t+0]=h[t+0]^u,p[t+1]=h[t+1]^l,p[t+2]=h[t+2]^d,p[t+3]=h[t+3]^f;let n=1;for(let e=o.length-1;e>=0;e--)n=n+(255&o[e])|0,o[e]=255&n,n>>>=8;({s0:u,s1:l,s2:d,s3:f}=S(e,c[0],c[1],c[2],c[3]))}const m=a*Math.floor(h.length/4);if(m<i){const e=new Uint32Array([u,l,d,f]),t=(0,r.u8)(e);for(let e=m,r=0;e<i;e++,r++)s[e]=n[e]^t[r];(0,r.clean)(e)}return s}function P(e,t,n,s,i){(0,r.abytes)(n,a),(0,r.abytes)(s),i=(0,r.getOutput)(s.length,i);const o=n,c=(0,r.u32)(o),u=(0,r.createView)(o),l=(0,r.u32)(s),d=(0,r.u32)(i),f=t?0:12,h=s.length;let p=u.getUint32(f,t),{s0:m,s1:g,s2:b,s3:y}=S(e,c[0],c[1],c[2],c[3]);for(let n=0;n+4<=l.length;n+=4)d[n+0]=l[n+0]^m,d[n+1]=l[n+1]^g,d[n+2]=l[n+2]^b,d[n+3]=l[n+3]^y,p=p+1>>>0,u.setUint32(f,p,t),({s0:m,s1:g,s2:b,s3:y}=S(e,c[0],c[1],c[2],c[3]));const w=a*Math.floor(l.length/4);if(w<h){const e=new Uint32Array([m,g,b,y]),t=(0,r.u8)(e);for(let e=w,n=0;e<h;e++,n++)i[e]=s[e]^t[n];(0,r.clean)(e)}return i}function I(e){if((0,r.abytes)(e),e.length%a!==0)throw new Error("aes-(cbc/ecb).decrypt ciphertext should consist of blocks with size 16")}function _(e,t,n){(0,r.abytes)(e);let s=e.length;const i=s%a;if(!t&&0!==i)throw new Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");(0,r.isAligned32)(e)||(e=(0,r.copyBytes)(e));const o=(0,r.u32)(e);if(t){let e=a-i;e||(e=a),s+=e}n=(0,r.getOutput)(s,n),(0,r.complexOverlapBytes)(e,n);return{b:o,o:(0,r.u32)(n),out:n}}function x(e,t){if(!t)return e;const n=e.length;if(!n)throw new Error("aes/pcks5: empty ciphertext not allowed");const s=e[n-1];if(s<=0||s>16)throw new Error("aes/pcks5: wrong padding");const r=e.subarray(0,-s);for(let t=0;t<s;t++)if(e[n-t-1]!==s)throw new Error("aes/pcks5: wrong padding");return r}function j(e){const t=new Uint8Array(16),n=(0,r.u32)(t);t.set(e);const s=a-e.length;for(let e=a-s;e<a;e++)t[e]=s;return n}function A(e,t,n,s,a){const i=a?a.length:0,o=e.create(n,s.length+i);a&&o.update(a);const c=(0,r.u64Lengths)(8*s.length,8*i,t);o.update(s),o.update(c);const u=o.digest();return(0,r.clean)(c),u}n.ctr=(0,r.wrapCipher)({blockSize:16,nonceLength:16},function(e,t){function n(n,s){if((0,r.abytes)(n),s!==undefined&&((0,r.abytes)(s),!(0,r.isAligned32)(s)))throw new Error("unaligned destination");const a=y(e),i=(0,r.copyBytes)(t),o=[a,i];(0,r.isAligned32)(n)||o.push(n=(0,r.copyBytes)(n));const c=k(a,i,n,s);return(0,r.clean)(...o),c}return{encrypt:(e,t)=>n(e,t),decrypt:(e,t)=>n(e,t)}}),n.ecb=(0,r.wrapCipher)({blockSize:16},function(e,t={}){const n=!t.disablePadding;return{encrypt(t,s){const{b:a,o:i,out:o}=_(t,n,s),c=y(e);let u=0;for(;u+4<=a.length;){const{s0:e,s1:t,s2:n,s3:s}=S(c,a[u+0],a[u+1],a[u+2],a[u+3]);i[u++]=e,i[u++]=t,i[u++]=n,i[u++]=s}if(n){const e=j(t.subarray(4*u)),{s0:n,s1:s,s2:r,s3:a}=S(c,e[0],e[1],e[2],e[3]);i[u++]=n,i[u++]=s,i[u++]=r,i[u++]=a}return(0,r.clean)(c),o},decrypt(t,s){I(t);const a=w(e);s=(0,r.getOutput)(t.length,s);const i=[a];(0,r.isAligned32)(t)||i.push(t=(0,r.copyBytes)(t)),(0,r.complexOverlapBytes)(t,s);const o=(0,r.u32)(t),c=(0,r.u32)(s);for(let e=0;e+4<=o.length;){const{s0:t,s1:n,s2:s,s3:r}=v(a,o[e+0],o[e+1],o[e+2],o[e+3]);c[e++]=t,c[e++]=n,c[e++]=s,c[e++]=r}return(0,r.clean)(...i),x(s,n)}}}),n.cbc=(0,r.wrapCipher)({blockSize:16,nonceLength:16},function(e,t,n={}){const s=!n.disablePadding;return{encrypt(n,a){const i=y(e),{b:o,o:c,out:u}=_(n,s,a);let l=t;const d=[i];(0,r.isAligned32)(l)||d.push(l=(0,r.copyBytes)(l));const f=(0,r.u32)(l);let h=f[0],p=f[1],m=f[2],g=f[3],b=0;for(;b+4<=o.length;)h^=o[b+0],p^=o[b+1],m^=o[b+2],g^=o[b+3],({s0:h,s1:p,s2:m,s3:g}=S(i,h,p,m,g)),c[b++]=h,c[b++]=p,c[b++]=m,c[b++]=g;if(s){const e=j(n.subarray(4*b));h^=e[0],p^=e[1],m^=e[2],g^=e[3],({s0:h,s1:p,s2:m,s3:g}=S(i,h,p,m,g)),c[b++]=h,c[b++]=p,c[b++]=m,c[b++]=g}return(0,r.clean)(...d),u},decrypt(n,a){I(n);const i=w(e);let o=t;const c=[i];(0,r.isAligned32)(o)||c.push(o=(0,r.copyBytes)(o));const u=(0,r.u32)(o);a=(0,r.getOutput)(n.length,a),(0,r.isAligned32)(n)||c.push(n=(0,r.copyBytes)(n)),(0,r.complexOverlapBytes)(n,a);const l=(0,r.u32)(n),d=(0,r.u32)(a);let f=u[0],h=u[1],p=u[2],m=u[3];for(let e=0;e+4<=l.length;){const t=f,n=h,s=p,r=m;f=l[e+0],h=l[e+1],p=l[e+2],m=l[e+3];const{s0:a,s1:o,s2:c,s3:u}=v(i,f,h,p,m);d[e++]=a^t,d[e++]=o^n,d[e++]=c^s,d[e++]=u^r}return(0,r.clean)(...c),x(a,s)}}}),n.cfb=(0,r.wrapCipher)({blockSize:16,nonceLength:16},function(e,t){function n(n,s,i){(0,r.abytes)(n);const o=n.length;if(i=(0,r.getOutput)(o,i),(0,r.overlapBytes)(n,i))throw new Error("overlapping src and dst not supported.");const c=y(e);let u=t;const l=[c];(0,r.isAligned32)(u)||l.push(u=(0,r.copyBytes)(u)),(0,r.isAligned32)(n)||l.push(n=(0,r.copyBytes)(n));const d=(0,r.u32)(n),f=(0,r.u32)(i),h=s?f:d,p=(0,r.u32)(u);let m=p[0],g=p[1],b=p[2],w=p[3];for(let e=0;e+4<=d.length;){const{s0:t,s1:n,s2:s,s3:r}=S(c,m,g,b,w);f[e+0]=d[e+0]^t,f[e+1]=d[e+1]^n,f[e+2]=d[e+2]^s,f[e+3]=d[e+3]^r,m=h[e++],g=h[e++],b=h[e++],w=h[e++]}const T=a*Math.floor(d.length/4);if(T<o){({s0:m,s1:g,s2:b,s3:w}=S(c,m,g,b,w));const e=(0,r.u8)(new Uint32Array([m,g,b,w]));for(let t=T,s=0;t<o;t++,s++)i[t]=n[t]^e[s];(0,r.clean)(e)}return(0,r.clean)(...l),i}return{encrypt:(e,t)=>n(e,!0,t),decrypt:(e,t)=>n(e,!1,t)}}),n.gcm=(0,r.wrapCipher)({blockSize:16,nonceLength:12,tagLength:16,varSizeNonce:!0},function(e,t,n){if(t.length<8)throw new Error("aes/gcm: invalid nonce length");function a(e,t,r){const a=A(s.ghash,!1,e,r,n);for(let e=0;e<t.length;e++)a[e]^=t[e];return a}function o(){const n=y(e),a=i.slice(),o=i.slice();if(P(n,!1,o,o,a),12===t.length)o.set(t);else{const e=i.slice(),n=(0,r.createView)(e);(0,r.setBigUint64)(n,8,BigInt(8*t.length),!1);const c=s.ghash.create(a).update(t).update(e);c.digestInto(o),c.destroy()}return{xk:n,authKey:a,counter:o,tagMask:P(n,!1,o,i)}}return{encrypt(e){const{xk:t,authKey:n,counter:s,tagMask:i}=o(),c=new Uint8Array(e.length+16),u=[t,n,s,i];(0,r.isAligned32)(e)||u.push(e=(0,r.copyBytes)(e)),P(t,!1,s,e,c.subarray(0,e.length));const l=a(n,i,c.subarray(0,c.length-16));return u.push(l),c.set(l,e.length),(0,r.clean)(...u),c},decrypt(e){const{xk:t,authKey:n,counter:s,tagMask:i}=o(),c=[t,n,i,s];(0,r.isAligned32)(e)||c.push(e=(0,r.copyBytes)(e));const u=e.subarray(0,-16),l=e.subarray(-16),d=a(n,i,u);if(c.push(d),!(0,r.equalBytes)(d,l))throw new Error("aes/gcm: invalid ghash tag");const f=P(t,!1,s,u);return(0,r.clean)(...c),f}}});const C=(e,t,n)=>s=>{if(!Number.isSafeInteger(s)||t>s||s>n){throw new Error(e+": expected value in range "+("["+t+".."+n+"]")+", got "+s)}};function R(e){return e instanceof Uint32Array||ArrayBuffer.isView(e)&&"Uint32Array"===e.constructor.name}function O(e,t){if((0,r.abytes)(t,16),!R(e))throw new Error("_encryptBlock accepts result of expandKeyLE");const n=(0,r.u32)(t);let{s0:s,s1:a,s2:i,s3:o}=S(e,n[0],n[1],n[2],n[3]);return n[0]=s,n[1]=a,n[2]=i,n[3]=o,t}function M(e,t){if((0,r.abytes)(t,16),!R(e))throw new Error("_decryptBlock accepts result of expandKeyLE");const n=(0,r.u32)(t);let{s0:s,s1:a,s2:i,s3:o}=v(e,n[0],n[1],n[2],n[3]);return n[0]=s,n[1]=a,n[2]=i,n[3]=o,t}n.gcmsiv=(0,r.wrapCipher)({blockSize:16,nonceLength:12,tagLength:16,varSizeNonce:!0},function(e,t,n){const a=C("AAD",0,2**36),i=C("plaintext",0,2**36),o=C("nonce",12,12),c=C("ciphertext",16,2**36+16);function u(){const n=y(e),s=new Uint8Array(e.length),a=new Uint8Array(16),i=[n,s];let o=t;(0,r.isAligned32)(o)||i.push(o=(0,r.copyBytes)(o));const c=(0,r.u32)(o);let u=0,l=c[0],d=c[1],f=c[2],h=0;for(const e of[a,s].map(r.u32)){const t=(0,r.u32)(e);for(let e=0;e<t.length;e+=2){const{s0:s,s1:r}=S(n,u,l,d,f);t[e+0]=s,t[e+1]=r,u=++h}}const p={authKey:a,encKey:y(s)};return(0,r.clean)(...i),p}function l(e,a,i){const o=A(s.polyval,!0,a,i,n);for(let e=0;e<12;e++)o[e]^=t[e];o[15]&=127;const c=(0,r.u32)(o);let u=c[0],l=c[1],d=c[2],f=c[3];return({s0:u,s1:l,s2:d,s3:f}=S(e,u,l,d,f)),c[0]=u,c[1]=l,c[2]=d,c[3]=f,o}function d(e,t,n){let s=(0,r.copyBytes)(t);s[15]|=128;const a=P(e,!0,s,n);return(0,r.clean)(s),a}return(0,r.abytes)(e,16,24,32),o(t.length),n!==undefined&&a(n.length),{encrypt(e){i(e.length);const{encKey:t,authKey:n}=u(),s=l(t,n,e),a=[t,n,s];(0,r.isAligned32)(e)||a.push(e=(0,r.copyBytes)(e));const o=new Uint8Array(e.length+16);return o.set(s,e.length),o.set(d(t,s,e)),(0,r.clean)(...a),o},decrypt(e){c(e.length);const t=e.subarray(-16),{encKey:n,authKey:s}=u(),a=[n,s];(0,r.isAligned32)(e)||a.push(e=(0,r.copyBytes)(e));const i=d(n,t,e.subarray(0,-16)),o=l(n,s,i);if(a.push(o),!(0,r.equalBytes)(t,o))throw(0,r.clean)(...a),new Error("invalid polyval tag");return(0,r.clean)(...a),i}}}),n.siv=n.gcmsiv;const B={encrypt(e,t){if(t.length>=2**32)throw new Error("plaintext should be less than 4gb");const n=y(e);if(16===t.length)O(n,t);else{const e=(0,r.u32)(t);let s=e[0],a=e[1];for(let t=0,r=1;t<6;t++)for(let t=2;t<e.length;t+=2,r++){const{s0:i,s1:o,s2:c,s3:u}=S(n,s,a,e[t],e[t+1]);s=i,a=o^h(r),e[t]=c,e[t+1]=u}e[0]=s,e[1]=a}n.fill(0)},decrypt(e,t){if(t.length-8>=2**32)throw new Error("ciphertext should be less than 4gb");const n=w(e),s=t.length/8-1;if(1===s)M(n,t);else{const e=(0,r.u32)(t);let a=e[0],i=e[1];for(let t=0,r=6*s;t<6;t++)for(let t=2*s;t>=1;t-=2,r--){i^=h(r);const{s0:s,s1:o,s2:c,s3:u}=v(n,a,i,e[t],e[t+1]);a=s,i=o,e[t]=c,e[t+1]=u}e[0]=a,e[1]=i}n.fill(0)}},N=new Uint8Array(8).fill(166);n.aeskw=(0,r.wrapCipher)({blockSize:8},e=>({encrypt(t){if(!t.length||t.length%8!=0)throw new Error("invalid plaintext length");if(8===t.length)throw new Error("8-byte keys not allowed in AESKW, use AESKWP instead");const n=(0,r.concatBytes)(N,t);return B.encrypt(e,n),n},decrypt(t){if(t.length%8!=0||t.length<24)throw new Error("invalid ciphertext length");const n=(0,r.copyBytes)(t);if(B.decrypt(e,n),!(0,r.equalBytes)(n.subarray(0,8),N))throw new Error("integrity check failed");return n.subarray(0,8).fill(0),n.subarray(8)}}));const F=2790873510;n.aeskwp=(0,r.wrapCipher)({blockSize:8},e=>({encrypt(t){if(!t.length)throw new Error("invalid plaintext length");const n=8*Math.ceil(t.length/8),s=new Uint8Array(8+n);s.set(t,8);const a=(0,r.u32)(s);return a[0]=F,a[1]=h(t.length),B.encrypt(e,s),s},decrypt(t){if(t.length<16)throw new Error("invalid ciphertext length");const n=(0,r.copyBytes)(t),s=(0,r.u32)(n);B.decrypt(e,n);const a=h(s[1])>>>0,i=8*Math.ceil(a/8);if(s[0]!==F||n.length-8!==i)throw new Error("integrity check failed");for(let e=a;e<i;e++)if(0!==n[8+e])throw new Error("integrity check failed");return n.subarray(0,8).fill(0),n.subarray(8,8+a)}})),n.unsafe={expandKeyLE:y,expandKeyDecLE:w,encrypt:S,decrypt:v,encryptBlock:O,decryptBlock:M,ctrCounter:k,ctr32:P}}}},{package:"@noble/ciphers",file:"node_modules/@noble/ciphers/aes.js"}],[2828,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.crypto=void 0,n.crypto="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:undefined}}},{package:"@noble/ciphers",file:"node_modules/@noble/ciphers/crypto.js"}],[2829,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){function s(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function r(e){if("boolean"!=typeof e)throw new Error(`boolean expected, not ${e}`)}function a(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function i(e,...t){if(!s(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function o(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}
/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */
Object.defineProperty(n,"__esModule",{value:!0}),n.wrapCipher=n.Hash=n.nextTick=n.isLE=void 0,n.isBytes=s,n.abool=r,n.anumber=a,n.abytes=i,n.ahash=function(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.createHasher");a(e.outputLen),a(e.blockLen)},n.aexists=function(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")},n.aoutput=function(e,t){i(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)},n.u8=function(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)},n.u32=function(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))},n.clean=function(...e){for(let t=0;t<e.length;t++)e[t].fill(0)},n.createView=o,n.bytesToHex=l,n.hexToBytes=h,n.hexToNumber=p,n.bytesToNumberBE=function(e){return p(l(e))},n.numberToBytesBE=function(e,t){return h(e.toString(16).padStart(2*t,"0"))},n.utf8ToBytes=m,n.bytesToUtf8=function(e){return(new TextDecoder).decode(e)},n.toBytes=function(e){if("string"==typeof e)e=m(e);else{if(!s(e))throw new Error("Uint8Array expected, got "+typeof e);e=w(e)}return e},n.overlapBytes=g,n.complexOverlapBytes=function(e,t){if(g(e,t)&&e.byteOffset<t.byteOffset)throw new Error("complex overlap of input and output is not supported")},n.concatBytes=function(...e){let t=0;for(let n=0;n<e.length;n++){const s=e[n];i(s),t+=s.length}const n=new Uint8Array(t);for(let t=0,s=0;t<e.length;t++){const r=e[t];n.set(r,s),s+=r.length}return n},n.checkOpts=function(e,t){if(null==t||"object"!=typeof t)throw new Error("options must be defined");return Object.assign(e,t)},n.equalBytes=function(e,t){if(e.length!==t.length)return!1;let n=0;for(let s=0;s<e.length;s++)n|=e[s]^t[s];return 0===n},n.getOutput=function(e,t,n=!0){if(t===undefined)return new Uint8Array(e);if(t.length!==e)throw new Error("invalid output length, expected "+e+", got: "+t.length);if(n&&!y(t))throw new Error("invalid output, must be aligned");return t},n.setBigUint64=b,n.u64Lengths=function(e,t,n){r(n);const s=new Uint8Array(16),a=o(s);return b(a,0,BigInt(t),n),b(a,8,BigInt(e),n),s},n.isAligned32=y,n.copyBytes=w,n.isLE=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0];const c=(()=>"function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex)(),u=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function l(e){if(i(e),c)return e.toHex();let t="";for(let n=0;n<e.length;n++)t+=u[e[n]];return t}const d={_0:48,_9:57,A:65,F:70,a:97,f:102};function f(e){return e>=d._0&&e<=d._9?e-d._0:e>=d.A&&e<=d.F?e-(d.A-10):e>=d.a&&e<=d.f?e-(d.a-10):void 0}function h(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);if(c)return Uint8Array.fromHex(e);const t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const s=new Uint8Array(n);for(let t=0,r=0;t<n;t++,r+=2){const n=f(e.charCodeAt(r)),a=f(e.charCodeAt(r+1));if(n===undefined||a===undefined){const t=e[r]+e[r+1];throw new Error('hex string expected, got non-hex character "'+t+'" at index '+r)}s[t]=16*n+a}return s}function p(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return BigInt(""===e?"0":"0x"+e)}function m(e){if("string"!=typeof e)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(e))}function g(e,t){return e.buffer===t.buffer&&e.byteOffset<t.byteOffset+t.byteLength&&t.byteOffset<e.byteOffset+e.byteLength}n.nextTick=async()=>{};n.Hash=class{};function b(e,t,n,s){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,s);const r=BigInt(32),a=BigInt(4294967295),i=Number(n>>r&a),o=Number(n&a),c=s?4:0,u=s?0:4;e.setUint32(t+c,i,s),e.setUint32(t+u,o,s)}function y(e){return e.byteOffset%4==0}function w(e){return Uint8Array.from(e)}n.wrapCipher=(e,t)=>{function s(s,...r){if(i(s),!n.isLE)throw new Error("Non little-endian hardware is not yet supported");if(e.nonceLength!==undefined){const t=r[0];if(!t)throw new Error("nonce / iv required");e.varSizeNonce?i(t):i(t,e.nonceLength)}const a=e.tagLength;a&&r[1]!==undefined&&i(r[1]);const o=t(s,...r),c=(e,t)=>{if(t!==undefined){if(2!==e)throw new Error("cipher output not supported");i(t)}};let u=!1;return{encrypt(e,t){if(u)throw new Error("cannot encrypt() twice with same key + nonce");return u=!0,i(e),c(o.encrypt.length,t),o.encrypt(e,t)},decrypt(e,t){if(i(e),a&&e.length<a)throw new Error("invalid ciphertext length: smaller than tagLength="+a);return c(o.decrypt.length,t),o.decrypt(e,t)}}}return Object.assign(s,e),s}}}},{package:"@noble/ciphers",file:"node_modules/@noble/ciphers/utils.js"}],[2830,{"./utils.js":2829,"@noble/ciphers/crypto":2828},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.gcm=n.ctr=n.cbc=n.utils=void 0,n.randomBytes=a,n.getWebcryptoSubtle=i,n.managedNonce=function(e){const{nonceLength:t}=e;return(0,r.anumber)(t),(n,...s)=>({encrypt(i,...o){const c=a(t),u=e(n,c,...s).encrypt(i,...o),l=(0,r.concatBytes)(c,u);return u.fill(0),l},decrypt(r,...a){const i=r.subarray(0,t),o=r.subarray(t);return e(n,i,...s).decrypt(o,...a)}})};const s=e("@noble/ciphers/crypto"),r=e("./utils.js");function a(e=32){if(s.crypto&&"function"==typeof s.crypto.getRandomValues)return s.crypto.getRandomValues(new Uint8Array(e));if(s.crypto&&"function"==typeof s.crypto.randomBytes)return Uint8Array.from(s.crypto.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}function i(){if(s.crypto&&"object"==typeof s.crypto.subtle&&null!=s.crypto.subtle)return s.crypto.subtle;throw new Error("crypto.subtle must be defined")}n.utils={async encrypt(e,t,n,s){const r=i(),a=await r.importKey("raw",e,t,!0,["encrypt"]),o=await r.encrypt(n,a,s);return new Uint8Array(o)},async decrypt(e,t,n,s){const r=i(),a=await r.importKey("raw",e,t,!0,["decrypt"]),o=await r.decrypt(n,a,s);return new Uint8Array(o)}};const o="AES-CBC",c="AES-CTR",u="AES-GCM";function l(e){return(t,s,a)=>{(0,r.abytes)(t),(0,r.abytes)(s);const i={name:e,length:8*t.length},l=function(e,t,n){if(e===o)return{name:o,iv:t};if(e===c)return{name:c,counter:t,length:64};if(e===u)return n?{name:u,iv:t,additionalData:n}:{name:u,iv:t};throw new Error("unknown aes block mode")}(e,s,a);let d=!1;return{encrypt(e){if((0,r.abytes)(e),d)throw new Error("Cannot encrypt() twice with same key / nonce");return d=!0,n.utils.encrypt(t,i,l,e)},decrypt:e=>((0,r.abytes)(e),n.utils.decrypt(t,i,l,e))}}}n.cbc=l(o),n.ctr=l(c),n.gcm=(()=>l(u))()}}},{package:"@noble/ciphers",file:"node_modules/@noble/ciphers/webcrypto.js"}],[2831,{"./abstract/weierstrass.js":2838},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getHash=function(e){return{hash:e}},n.createCurve=function(e,t){const n=t=>(0,s.weierstrass)({...e,hash:t});return{...n(t),create:n}};
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const s=e("./abstract/weierstrass.js")}}},{package:"@noble/curves",file:"node_modules/@noble/curves/_shortw_utils.js"}],[2832,{"../utils.js":2841,"./modular.js":2835},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.wNAF=void 0,n.negateCt=o,n.normalizeZ=function(e,t){const n=(0,r.FpInvertBatch)(e.Fp,t.map(e=>e.Z));return t.map((t,s)=>e.fromAffine(t.toAffine(n[s])))},n.mulEndoUnsafe=function(e,t,n,s){let r=t,o=e.ZERO,c=e.ZERO;for(;n>a||s>a;)n&i&&(o=o.add(r)),s&i&&(c=c.add(r)),r=r.double(),n>>=i,s>>=i;return{p1:o,p2:c}},n.pippenger=function(e,t,n,r){d(n,e),f(r,t);const a=n.length,i=r.length;if(a!==i)throw new Error("arrays of points and scalars must have equal length");const o=e.ZERO,c=(0,s.bitLen)(BigInt(a));let u=1;c>12?u=c-3:c>4?u=c-2:c>0&&(u=2);const l=(0,s.bitMask)(u),h=new Array(Number(l)+1).fill(o),p=Math.floor((t.BITS-1)/u)*u;let m=o;for(let e=p;e>=0;e-=u){h.fill(o);for(let t=0;t<i;t++){const s=r[t],a=Number(s>>BigInt(e)&l);h[a]=h[a].add(n[t])}let t=o;for(let e=h.length-1,n=o;e>0;e--)n=n.add(h[e]),t=t.add(n);if(m=m.add(t),0!==e)for(let e=0;e<u;e++)m=m.double()}return m},n.precomputeMSMUnsafe=function(e,t,n,r){c(r,t.BITS),d(n,e);const a=e.ZERO,i=2**r-1,o=Math.ceil(t.BITS/r),u=(0,s.bitMask)(r),l=n.map(e=>{const t=[];for(let n=0,s=e;n<i;n++)t.push(s),s=s.add(e);return t});return e=>{if(f(e,t),e.length>n.length)throw new Error("array of scalars must be smaller than array of points");let s=a;for(let t=0;t<o;t++){if(s!==a)for(let e=0;e<r;e++)s=s.double();const n=BigInt(o*r-(t+1)*r);for(let t=0;t<e.length;t++){const r=e[t],a=Number(r>>n&u);a&&(s=s.add(l[t][a-1]))}}return s}},n.validateBasic=function(e){return(0,r.validateField)(e.Fp),(0,s.validateObject)(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,r.nLength)(e.n,e.nBitLength),...e,p:e.Fp.ORDER})},n._createCurveFields=function(e,t,n={},s){s===undefined&&(s="edwards"===e);if(!t||"object"!=typeof t)throw new Error(`expected valid ${e} CURVE object`);for(const e of["p","n","h"]){const n=t[e];if(!("bigint"==typeof n&&n>a))throw new Error(`CURVE.${e} must be positive bigint`)}const r=b(t.p,n.Fp,s),i=b(t.n,n.Fn,s),o=["Gx","Gy","a","weierstrass"===e?"b":"d"];for(const e of o)if(!r.isValid(t[e]))throw new Error(`CURVE.${e} must be valid field element of CURVE.Fp`);return{CURVE:t=Object.freeze(Object.assign({},t)),Fp:r,Fn:i}};
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const s=e("../utils.js"),r=e("./modular.js"),a=BigInt(0),i=BigInt(1);function o(e,t){const n=t.negate();return e?n:t}function c(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function u(e,t){c(e,t);const n=2**e;return{windows:Math.ceil(t/e)+1,windowSize:2**(e-1),mask:(0,s.bitMask)(e),maxNumber:n,shiftBy:BigInt(e)}}function l(e,t,n){const{windowSize:s,mask:r,maxNumber:a,shiftBy:o}=n;let c=Number(e&r),u=e>>o;c>s&&(c-=a,u+=i);const l=t*s;return{nextN:u,offset:l+Math.abs(c)-1,isZero:0===c,isNeg:c<0,isNegF:t%2!=0,offsetF:l}}function d(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((e,n)=>{if(!(e instanceof t))throw new Error("invalid point at index "+n)})}function f(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((e,n)=>{if(!t.isValid(e))throw new Error("invalid scalar at index "+n)})}const h=new WeakMap,p=new WeakMap;function m(e){return p.get(e)||1}function g(e){if(e!==a)throw new Error("invalid wNAF")}function b(e,t,n){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return(0,r.validateField)(t),t}return(0,r.Field)(e,{isLE:n})}n.wNAF=class{constructor(e,t){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=t}_unsafeLadder(e,t,n=this.ZERO){let s=e;for(;t>a;)t&i&&(n=n.add(s)),s=s.double(),t>>=i;return n}precomputeWindow(e,t){const{windows:n,windowSize:s}=u(t,this.bits),r=[];let a=e,i=a;for(let e=0;e<n;e++){i=a,r.push(i);for(let e=1;e<s;e++)i=i.add(a),r.push(i);a=i.double()}return r}wNAF(e,t,n){if(!this.Fn.isValid(n))throw new Error("invalid scalar");let s=this.ZERO,r=this.BASE;const a=u(e,this.bits);for(let e=0;e<a.windows;e++){const{nextN:i,offset:c,isZero:u,isNeg:d,isNegF:f,offsetF:h}=l(n,e,a);n=i,u?r=r.add(o(f,t[h])):s=s.add(o(d,t[c]))}return g(n),{p:s,f:r}}wNAFUnsafe(e,t,n,s=this.ZERO){const r=u(e,this.bits);for(let e=0;e<r.windows&&n!==a;e++){const{nextN:a,offset:i,isZero:o,isNeg:c}=l(n,e,r);if(n=a,!o){const e=t[i];s=s.add(c?e.negate():e)}}return g(n),s}getPrecomputes(e,t,n){let s=h.get(t);return s||(s=this.precomputeWindow(t,e),1!==e&&("function"==typeof n&&(s=n(s)),h.set(t,s))),s}cached(e,t,n){const s=m(e);return this.wNAF(s,this.getPrecomputes(s,e,n),t)}unsafe(e,t,n,s){const r=m(e);return 1===r?this._unsafeLadder(e,t,s):this.wNAFUnsafe(r,this.getPrecomputes(r,e,n),t,s)}createCache(e,t){c(t,this.bits),p.set(e,t),h.delete(e)}hasCache(e){return 1!==m(e)}}}}},{package:"@noble/curves",file:"node_modules/@noble/curves/abstract/curve.js"}],[2833,{"../utils.js":2841,"./curve.js":2832,"./modular.js":2835},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.PrimeEdwardsPoint=void 0,n.edwards=l,n.eddsa=d,n.twistedEdwards=function(e){const{CURVE:t,curveOpts:n,hash:s,eddsaOpts:r}=function(e){const t={a:e.a,d:e.d,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},n=e.Fp,s=(0,a.Field)(t.n,e.nBitLength,!0),r={Fp:n,Fn:s,uvRatio:e.uvRatio},i={randomBytes:e.randomBytes,adjustScalarBytes:e.adjustScalarBytes,domain:e.domain,prehash:e.prehash,mapToCurve:e.mapToCurve};return{CURVE:t,curveOpts:r,hash:e.hash,eddsaOpts:i}}(e),i=d(l(t,n),s,r);return function(e,t){const n=t.Point,s=Object.assign({},t,{ExtendedPoint:n,CURVE:e,nBitLength:n.Fn.BITS,nByteLength:n.Fn.BYTES});return s}(e,i)};
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const s=e("../utils.js"),r=e("./curve.js"),a=e("./modular.js"),i=BigInt(0),o=BigInt(1),c=BigInt(2),u=BigInt(8);function l(e,t={}){const n=(0,r._createCurveFields)("edwards",e,t,t.FpFnLE),{Fp:a,Fn:l}=n;let d=n.CURVE;const{h:f}=d;(0,s._validateObject)(t,{},{uvRatio:"function"});const h=c<<BigInt(8*l.BYTES)-o,p=e=>a.create(e),m=t.uvRatio||((e,t)=>{try{return{isValid:!0,value:a.sqrt(a.div(e,t))}}catch(e){return{isValid:!1,value:i}}});if(!function(e,t,n,s){const r=e.sqr(n),a=e.sqr(s),i=e.add(e.mul(t.a,r),a),o=e.add(e.ONE,e.mul(t.d,e.mul(r,a)));return e.eql(i,o)}(a,d,d.Gx,d.Gy))throw new Error("bad curve params: generator point");function g(e,t,n=!1){const r=n?o:i;return(0,s.aInRange)("coordinate "+e,t,r,h),t}function b(e){if(!(e instanceof T))throw new Error("ExtendedPoint expected")}const y=(0,s.memoized)((e,t)=>{const{X:n,Y:s,Z:r}=e,c=e.is0();null==t&&(t=c?u:a.inv(r));const l=p(n*t),d=p(s*t),f=a.mul(r,t);if(c)return{x:i,y:o};if(f!==o)throw new Error("invZ was invalid");return{x:l,y:d}}),w=(0,s.memoized)(e=>{const{a:t,d:n}=d;if(e.is0())throw new Error("bad point: ZERO");const{X:s,Y:r,Z:a,T:i}=e,o=p(s*s),c=p(r*r),u=p(a*a),l=p(u*u),f=p(o*t);if(p(u*p(f+c))!==p(l+p(n*p(o*c))))throw new Error("bad point: equation left != right (1)");if(p(s*r)!==p(a*i))throw new Error("bad point: equation left != right (2)");return!0});class T{constructor(e,t,n,s){this.X=g("x",e),this.Y=g("y",t),this.Z=g("z",n,!0),this.T=g("t",s),Object.freeze(this)}static CURVE(){return d}static fromAffine(e){if(e instanceof T)throw new Error("extended point not allowed");const{x:t,y:n}=e||{};return g("x",t),g("y",n),new T(t,n,o,p(t*n))}static fromBytes(e,t=!1){const n=a.BYTES,{a:r,d:c}=d;e=(0,s.copyBytes)((0,s._abytes2)(e,n,"point")),(0,s._abool2)(t,"zip215");const u=(0,s.copyBytes)(e),l=e[n-1];u[n-1]=-129&l;const f=(0,s.bytesToNumberLE)(u),g=t?h:a.ORDER;(0,s.aInRange)("point.y",f,i,g);const b=p(f*f),y=p(b-o),w=p(c*b-r);let{isValid:E,value:S}=m(y,w);if(!E)throw new Error("bad point: invalid y coordinate");const v=(S&o)===o,k=!!(128&l);if(!t&&S===i&&k)throw new Error("bad point: x=0 and x_0=1");return k!==v&&(S=p(-S)),T.fromAffine({x:S,y:f})}static fromHex(e,t=!1){return T.fromBytes((0,s.ensureBytes)("point",e),t)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(e=8,t=!0){return E.createCache(this,e),t||this.multiply(c),this}assertValidity(){w(this)}equals(e){b(e);const{X:t,Y:n,Z:s}=this,{X:r,Y:a,Z:i}=e,o=p(t*i),c=p(r*s),u=p(n*i),l=p(a*s);return o===c&&u===l}is0(){return this.equals(T.ZERO)}negate(){return new T(p(-this.X),this.Y,this.Z,p(-this.T))}double(){const{a:e}=d,{X:t,Y:n,Z:s}=this,r=p(t*t),a=p(n*n),i=p(c*p(s*s)),o=p(e*r),u=t+n,l=p(p(u*u)-r-a),f=o+a,h=f-i,m=o-a,g=p(l*h),b=p(f*m),y=p(l*m),w=p(h*f);return new T(g,b,w,y)}add(e){b(e);const{a:t,d:n}=d,{X:s,Y:r,Z:a,T:i}=this,{X:o,Y:c,Z:u,T:l}=e,f=p(s*o),h=p(r*c),m=p(i*n*l),g=p(a*u),y=p((s+r)*(o+c)-f-h),w=g-m,E=g+m,S=p(h-t*f),v=p(y*w),k=p(E*S),P=p(y*S),I=p(w*E);return new T(v,k,I,P)}subtract(e){return this.add(e.negate())}multiply(e){if(!l.isValidNot0(e))throw new Error("invalid scalar: expected 1 <= sc < curve.n");const{p:t,f:n}=E.cached(this,e,e=>(0,r.normalizeZ)(T,e));return(0,r.normalizeZ)(T,[t,n])[0]}multiplyUnsafe(e,t=T.ZERO){if(!l.isValid(e))throw new Error("invalid scalar: expected 0 <= sc < curve.n");return e===i?T.ZERO:this.is0()||e===o?this:E.unsafe(this,e,e=>(0,r.normalizeZ)(T,e),t)}isSmallOrder(){return this.multiplyUnsafe(f).is0()}isTorsionFree(){return E.unsafe(this,d.n).is0()}toAffine(e){return y(this,e)}clearCofactor(){return f===o?this:this.multiplyUnsafe(f)}toBytes(){const{x:e,y:t}=this.toAffine(),n=a.toBytes(t);return n[n.length-1]|=e&o?128:0,n}toHex(){return(0,s.bytesToHex)(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get ex(){return this.X}get ey(){return this.Y}get ez(){return this.Z}get et(){return this.T}static normalizeZ(e){return(0,r.normalizeZ)(T,e)}static msm(e,t){return(0,r.pippenger)(T,l,e,t)}_setWindowSize(e){this.precompute(e)}toRawBytes(){return this.toBytes()}}T.BASE=new T(d.Gx,d.Gy,o,p(d.Gx*d.Gy)),T.ZERO=new T(i,o,o,i),T.Fp=a,T.Fn=l;const E=new r.wNAF(T,l.BITS);return T.BASE.precompute(8),T}function d(e,t,n={}){if("function"!=typeof t)throw new Error('"hash" function param is required');(0,s._validateObject)(n,{},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});const{prehash:r}=n,{BASE:a,Fp:i,Fn:c}=e,u=n.randomBytes||s.randomBytes,l=n.adjustScalarBytes||(e=>e),d=n.domain||((e,t,n)=>{if((0,s._abool2)(n,"phflag"),t.length||n)throw new Error("Contexts/pre-hash are not supported");return e});function f(e){return c.create((0,s.bytesToNumberLE)(e))}function h(e){const{head:n,prefix:r,scalar:i}=function(e){const n=y.secretKey;e=(0,s.ensureBytes)("private key",e,n);const r=(0,s.ensureBytes)("hashed private key",t(e),2*n),a=l(r.slice(0,n));return{head:a,prefix:r.slice(n,2*n),scalar:f(a)}}(e),o=a.multiply(i),c=o.toBytes();return{head:n,prefix:r,scalar:i,point:o,pointBytes:c}}function p(e){return h(e).pointBytes}function m(e=Uint8Array.of(),...n){const a=(0,s.concatBytes)(...n);return f(t(d(a,(0,s.ensureBytes)("context",e),!!r)))}const g={zip215:!0};const b=i.BYTES,y={secretKey:b,publicKey:b,signature:2*b,seed:b};function w(e=u(y.seed)){return(0,s._abytes2)(e,y.seed,"seed")}const T={getExtendedPublicKey:h,randomSecretKey:w,isValidSecretKey:function(e){return(0,s.isBytes)(e)&&e.length===c.BYTES},isValidPublicKey:function(t,n){try{return!!e.fromBytes(t,n)}catch(e){return!1}},toMontgomery(t){const{y:n}=e.fromBytes(t),s=y.publicKey,r=32===s;if(!r&&57!==s)throw new Error("only defined for 25519 and 448");const a=r?i.div(o+n,o-n):i.div(n-o,n+o);return i.toBytes(a)},toMontgomerySecret(e){const n=y.secretKey;(0,s._abytes2)(e,n);const r=t(e.subarray(0,n));return l(r).subarray(0,n)},randomPrivateKey:w,precompute:(t=8,n=e.BASE)=>n.precompute(t,!1)};return Object.freeze({keygen:function(e){const t=T.randomSecretKey(e);return{secretKey:t,publicKey:p(t)}},getPublicKey:p,sign:function(e,t,n={}){e=(0,s.ensureBytes)("message",e),r&&(e=r(e));const{prefix:i,scalar:o,pointBytes:u}=h(t),l=m(n.context,i,e),d=a.multiply(l).toBytes(),f=m(n.context,d,u,e),p=c.create(l+f*o);if(!c.isValid(p))throw new Error("sign failed: invalid s");const g=(0,s.concatBytes)(d,c.toBytes(p));return(0,s._abytes2)(g,y.signature,"result")},verify:function(t,n,i,o=g){const{context:c,zip215:u}=o,l=y.signature;t=(0,s.ensureBytes)("signature",t,l),n=(0,s.ensureBytes)("message",n),i=(0,s.ensureBytes)("publicKey",i,y.publicKey),u!==undefined&&(0,s._abool2)(u,"zip215"),r&&(n=r(n));const d=l/2,f=t.subarray(0,d),h=(0,s.bytesToNumberLE)(t.subarray(d,l));let p,b,w;try{p=e.fromBytes(i,u),b=e.fromBytes(f,u),w=a.multiplyUnsafe(h)}catch(e){return!1}if(!u&&p.isSmallOrder())return!1;const T=m(c,b.toBytes(),p.toBytes(),n);return b.add(p.multiplyUnsafe(T)).subtract(w).clearCofactor().is0()},utils:T,Point:e,lengths:y})}n.PrimeEdwardsPoint=class{constructor(e){this.ep=e}static fromBytes(e){(0,s.notImplemented)()}static fromHex(e){(0,s.notImplemented)()}get x(){return this.toAffine().x}get y(){return this.toAffine().y}clearCofactor(){return this}assertValidity(){this.ep.assertValidity()}toAffine(e){return this.ep.toAffine(e)}toHex(){return(0,s.bytesToHex)(this.toBytes())}toString(){return this.toHex()}isTorsionFree(){return!0}isSmallOrder(){return!1}add(e){return this.assertSame(e),this.init(this.ep.add(e.ep))}subtract(e){return this.assertSame(e),this.init(this.ep.subtract(e.ep))}multiply(e){return this.init(this.ep.multiply(e))}multiplyUnsafe(e){return this.init(this.ep.multiplyUnsafe(e))}double(){return this.init(this.ep.double())}negate(){return this.init(this.ep.negate())}precompute(e,t){return this.init(this.ep.precompute(e,t))}toRawBytes(){return this.toBytes()}}}}},{package:"@noble/curves",file:"node_modules/@noble/curves/abstract/edwards.js"}],[2834,{"../utils.js":2841,"./modular.js":2835},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n._DST_scalar=void 0,n.expand_message_xmd=l,n.expand_message_xof=d,n.hash_to_field=f,n.isogenyMap=function(e,t){const n=t.map(e=>Array.from(e).reverse());return(t,s)=>{const[a,i,o,c]=n.map(n=>n.reduce((n,s)=>e.add(e.mul(n,t),s))),[u,l]=(0,r.FpInvertBatch)(e,[i,c],!0);return t=e.mul(a,u),s=e.mul(s,e.mul(o,l)),{x:t,y:s}}},n.createHasher=function(e,t,s){if("function"!=typeof t)throw new Error("mapToCurve() must be defined");function r(n){return e.fromAffine(t(n))}function a(t){const n=t.clearCofactor();return n.equals(e.ZERO)?e.ZERO:(n.assertValidity(),n)}return{defaults:s,hashToCurve(e,t){const n=f(e,2,Object.assign({},s,t)),i=r(n[0]),o=r(n[1]);return a(i.add(o))},encodeToCurve(e,t){const n=s.encodeDST?{DST:s.encodeDST}:{};return a(r(f(e,1,Object.assign({},s,n,t))[0]))},mapToCurve(e){if(!Array.isArray(e))throw new Error("expected array of bigints");for(const t of e)if("bigint"!=typeof t)throw new Error("expected array of bigints");return a(r(e))},hashToScalar(t,r){const a=e.Fn.ORDER;return f(t,1,Object.assign({},s,{p:a,m:1,DST:n._DST_scalar},r))[0][0]}}};const s=e("../utils.js"),r=e("./modular.js"),a=s.bytesToNumberBE;function i(e,t){if(c(e),c(t),e<0||e>=1<<8*t)throw new Error("invalid I2OSP input: "+e);const n=Array.from({length:t}).fill(0);for(let s=t-1;s>=0;s--)n[s]=255&e,e>>>=8;return new Uint8Array(n)}function o(e,t){const n=new Uint8Array(e.length);for(let s=0;s<e.length;s++)n[s]=e[s]^t[s];return n}function c(e){if(!Number.isSafeInteger(e))throw new Error("number expected")}function u(e){if(!(0,s.isBytes)(e)&&"string"!=typeof e)throw new Error("DST must be Uint8Array or string");return"string"==typeof e?(0,s.utf8ToBytes)(e):e}function l(e,t,n,r){(0,s.abytes)(e),c(n),(t=u(t)).length>255&&(t=r((0,s.concatBytes)((0,s.utf8ToBytes)("H2C-OVERSIZE-DST-"),t)));const{outputLen:a,blockLen:l}=r,d=Math.ceil(n/a);if(n>65535||d>255)throw new Error("expand_message_xmd: invalid lenInBytes");const f=(0,s.concatBytes)(t,i(t.length,1)),h=i(0,l),p=i(n,2),m=new Array(d),g=r((0,s.concatBytes)(h,e,p,i(0,1),f));m[0]=r((0,s.concatBytes)(g,i(1,1),f));for(let e=1;e<=d;e++){const t=[o(g,m[e-1]),i(e+1,1),f];m[e]=r((0,s.concatBytes)(...t))}return(0,s.concatBytes)(...m).slice(0,n)}function d(e,t,n,r,a){if((0,s.abytes)(e),c(n),(t=u(t)).length>255){const e=Math.ceil(2*r/8);t=a.create({dkLen:e}).update((0,s.utf8ToBytes)("H2C-OVERSIZE-DST-")).update(t).digest()}if(n>65535||t.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return a.create({dkLen:n}).update(e).update(i(n,2)).update(t).update(i(t.length,1)).digest()}function f(e,t,n){(0,s._validateObject)(n,{p:"bigint",m:"number",k:"number",hash:"function"});const{p:i,k:o,m:u,hash:f,expand:h,DST:p}=n;if(!(0,s.isHash)(n.hash))throw new Error("expected valid hash");(0,s.abytes)(e),c(t);const m=i.toString(2).length,g=Math.ceil((m+o)/8),b=t*u*g;let y;if("xmd"===h)y=l(e,p,b,f);else if("xof"===h)y=d(e,p,b,o,f);else{if("_internal_pass"!==h)throw new Error('expand must be "xmd" or "xof"');y=e}const w=new Array(t);for(let e=0;e<t;e++){const t=new Array(u);for(let n=0;n<u;n++){const s=g*(n+e*u),o=y.subarray(s,s+g);t[n]=(0,r.mod)(a(o),i)}w[e]=t}return w}n._DST_scalar=(0,s.utf8ToBytes)("HashToScalar-")}}},{package:"@noble/curves",file:"node_modules/@noble/curves/abstract/hash-to-curve.js"}],[2835,{"../utils.js":2841},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isNegativeLE=void 0,n.mod=p,n.pow=function(e,t,n){return S(I(n),e,t)},n.pow2=function(e,t,n){let s=e;for(;t-- >r;)s*=s,s%=n;return s},n.invert=m,n.tonelliShanks=w,n.FpSqrt=T,n.validateField=function(e){const t=E.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"});return(0,s._validateObject)(e,t),e},n.FpPow=S,n.FpInvertBatch=v,n.FpDiv=function(e,t,n){return e.mul(t,"bigint"==typeof n?m(n,e.ORDER):e.inv(n))},n.FpLegendre=k,n.FpIsSquare=function(e,t){return 1===k(e,t)},n.nLength=P,n.Field=I,n.FpSqrtOdd=function(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");const n=e.sqrt(t);return e.isOdd(n)?n:e.neg(n)},n.FpSqrtEven=function(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");const n=e.sqrt(t);return e.isOdd(n)?e.neg(n):n},n.hashToPrivateScalar=function(e,t,n=!1){const r=(e=(0,s.ensureBytes)("privateHash",e)).length,i=P(t).nByteLength+8;if(i<24||r<i||r>1024)throw new Error("hashToPrivateScalar: expected "+i+"-1024 bytes of input, got "+r);return p(n?(0,s.bytesToNumberLE)(e):(0,s.bytesToNumberBE)(e),t-a)+a},n.getFieldBytesLength=_,n.getMinHashLength=x,n.mapHashToField=function(e,t,n=!1){const r=e.length,i=_(t),o=x(t);if(r<16||r<o||r>1024)throw new Error("expected "+o+"-1024 bytes of input, got "+r);const c=p(n?(0,s.bytesToNumberLE)(e):(0,s.bytesToNumberBE)(e),t-a)+a;return n?(0,s.numberToBytesLE)(c,i):(0,s.numberToBytesBE)(c,i)};
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const s=e("../utils.js"),r=BigInt(0),a=BigInt(1),i=BigInt(2),o=BigInt(3),c=BigInt(4),u=BigInt(5),l=BigInt(7),d=BigInt(8),f=BigInt(9),h=BigInt(16);function p(e,t){const n=e%t;return n>=r?n:t+n}function m(e,t){if(e===r)throw new Error("invert: expected non-zero number");if(t<=r)throw new Error("invert: expected positive modulus, got "+t);let n=p(e,t),s=t,i=r,o=a,c=a,u=r;for(;n!==r;){const e=s/n,t=s%n,r=i-c*e,a=o-u*e;s=n,n=t,i=c,o=u,c=r,u=a}if(s!==a)throw new Error("invert: does not exist");return p(i,t)}function g(e,t,n){if(!e.eql(e.sqr(t),n))throw new Error("Cannot find square root")}function b(e,t){const n=(e.ORDER+a)/c,s=e.pow(t,n);return g(e,s,t),s}function y(e,t){const n=(e.ORDER-u)/d,s=e.mul(t,i),r=e.pow(s,n),a=e.mul(t,r),o=e.mul(e.mul(a,i),r),c=e.mul(a,e.sub(o,e.ONE));return g(e,c,t),c}function w(e){if(e<o)throw new Error("sqrt is not defined for small field");let t=e-a,n=0;for(;t%i===r;)t/=i,n++;let s=i;const c=I(e);for(;1===k(c,s);)if(s++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(1===n)return b;let u=c.pow(s,t);const l=(t+a)/i;return function(e,s){if(e.is0(s))return s;if(1!==k(e,s))throw new Error("Cannot find square root");let r=n,i=e.mul(e.ONE,u),o=e.pow(s,t),c=e.pow(s,l);for(;!e.eql(o,e.ONE);){if(e.is0(o))return e.ZERO;let t=1,n=e.sqr(o);for(;!e.eql(n,e.ONE);)if(t++,n=e.sqr(n),t===r)throw new Error("Cannot find square root");const s=a<<BigInt(r-t-1),u=e.pow(i,s);r=t,i=e.sqr(u),o=e.mul(o,i),c=e.mul(c,u)}return c}}function T(e){return e%c===o?b:e%d===u?y:e%h===f?function(e){const t=I(e),n=w(e),s=n(t,t.neg(t.ONE)),r=n(t,s),a=n(t,t.neg(s)),i=(e+l)/h;return(e,t)=>{let n=e.pow(t,i),o=e.mul(n,s);const c=e.mul(n,r),u=e.mul(n,a),l=e.eql(e.sqr(o),t),d=e.eql(e.sqr(c),t);n=e.cmov(n,o,l),o=e.cmov(u,c,d);const f=e.eql(e.sqr(o),t),h=e.cmov(n,o,f);return g(e,h,t),h}}(e):w(e)}n.isNegativeLE=(e,t)=>(p(e,t)&a)===a;const E=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function S(e,t,n){if(n<r)throw new Error("invalid exponent, negatives unsupported");if(n===r)return e.ONE;if(n===a)return t;let s=e.ONE,i=t;for(;n>r;)n&a&&(s=e.mul(s,i)),i=e.sqr(i),n>>=a;return s}function v(e,t,n=!1){const s=new Array(t.length).fill(n?e.ZERO:undefined),r=t.reduce((t,n,r)=>e.is0(n)?t:(s[r]=t,e.mul(t,n)),e.ONE),a=e.inv(r);return t.reduceRight((t,n,r)=>e.is0(n)?t:(s[r]=e.mul(t,s[r]),e.mul(t,n)),a),s}function k(e,t){const n=(e.ORDER-a)/i,s=e.pow(t,n),r=e.eql(s,e.ONE),o=e.eql(s,e.ZERO),c=e.eql(s,e.neg(e.ONE));if(!r&&!o&&!c)throw new Error("invalid Legendre symbol result");return r?1:o?0:-1}function P(e,t){t!==undefined&&(0,s.anumber)(t);const n=t!==undefined?t:e.toString(2).length;return{nBitLength:n,nByteLength:Math.ceil(n/8)}}function I(e,t,n=!1,i={}){if(e<=r)throw new Error("invalid field: expected ORDER > 0, got "+e);let o=undefined,c=undefined,u=!1,l=undefined;if("object"==typeof t&&null!=t){if(i.sqrt||n)throw new Error("cannot specify opts in two arguments");const e=t;e.BITS&&(o=e.BITS),e.sqrt&&(c=e.sqrt),"boolean"==typeof e.isLE&&(n=e.isLE),"boolean"==typeof e.modFromBytes&&(u=e.modFromBytes),l=e.allowedLengths}else"number"==typeof t&&(o=t),i.sqrt&&(c=i.sqrt);const{nBitLength:d,nByteLength:f}=P(e,o);if(f>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let h;const g=Object.freeze({ORDER:e,isLE:n,BITS:d,BYTES:f,MASK:(0,s.bitMask)(d),ZERO:r,ONE:a,allowedLengths:l,create:t=>p(t,e),isValid:t=>{if("bigint"!=typeof t)throw new Error("invalid field element: expected bigint, got "+typeof t);return r<=t&&t<e},is0:e=>e===r,isValidNot0:e=>!g.is0(e)&&g.isValid(e),isOdd:e=>(e&a)===a,neg:t=>p(-t,e),eql:(e,t)=>e===t,sqr:t=>p(t*t,e),add:(t,n)=>p(t+n,e),sub:(t,n)=>p(t-n,e),mul:(t,n)=>p(t*n,e),pow:(e,t)=>S(g,e,t),div:(t,n)=>p(t*m(n,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>m(t,e),sqrt:c||(t=>(h||(h=T(e)),h(g,t))),toBytes:e=>n?(0,s.numberToBytesLE)(e,f):(0,s.numberToBytesBE)(e,f),fromBytes:(t,r=!0)=>{if(l){if(!l.includes(t.length)||t.length>f)throw new Error("Field.fromBytes: expected "+l+" bytes, got "+t.length);const e=new Uint8Array(f);e.set(t,n?0:e.length-t.length),t=e}if(t.length!==f)throw new Error("Field.fromBytes: expected "+f+" bytes, got "+t.length);let a=n?(0,s.bytesToNumberLE)(t):(0,s.bytesToNumberBE)(t);if(u&&(a=p(a,e)),!r&&!g.isValid(a))throw new Error("invalid field element: outside of range 0..ORDER");return a},invertBatch:e=>v(g,e),cmov:(e,t,n)=>n?t:e});return Object.freeze(g)}function _(e){if("bigint"!=typeof e)throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function x(e){const t=_(e);return t+Math.ceil(t/2)}}}},{package:"@noble/curves",file:"node_modules/@noble/curves/abstract/modular.js"}],[2836,{"../utils.js":2841,"./modular.js":2835},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.montgomery=function(e){const t=(h=e,(0,s._validateObject)(h,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...h})),{P:n,type:c,adjustScalarBytes:u,powPminus2:l,randomBytes:d}=t,f="x25519"===c;var h;if(!f&&"x448"!==c)throw new Error("invalid type");const p=d||s.randomBytes,m=f?255:448,g=f?32:56,b=f?BigInt(9):BigInt(5),y=f?BigInt(121665):BigInt(39081),w=f?o**BigInt(254):o**BigInt(447),T=f?BigInt(8)*o**BigInt(251)-i:BigInt(4)*o**BigInt(445)-i,E=w+T+i,S=e=>(0,r.mod)(e,n),v=k(b);function k(e){return(0,s.numberToBytesLE)(S(e),g)}function P(e,t){const r=function(e,t){(0,s.aInRange)("u",e,a,n),(0,s.aInRange)("scalar",t,w,E);const r=t,o=e;let c=i,u=a,d=e,f=i,h=a;for(let e=BigInt(m-1);e>=a;e--){const t=r>>e&i;h^=t,({x_2:c,x_3:d}=_(h,c,d)),({x_2:u,x_3:f}=_(h,u,f)),h=t;const n=c+u,s=S(n*n),a=c-u,l=S(a*a),p=s-l,m=d+f,g=S((d-f)*n),b=S(m*a),w=g+b,T=g-b;d=S(w*w),f=S(o*S(T*T)),c=S(s*l),u=S(p*(s+S(y*p)))}({x_2:c,x_3:d}=_(h,c,d)),({x_2:u,x_3:f}=_(h,u,f));const p=l(u);return S(c*p)}(function(e){const t=(0,s.ensureBytes)("u coordinate",e,g);return f&&(t[31]&=127),S((0,s.bytesToNumberLE)(t))}(t),function(e){return(0,s.bytesToNumberLE)(u((0,s.ensureBytes)("scalar",e,g)))}(e));if(r===a)throw new Error("invalid private or public key received");return k(r)}function I(e){return P(e,v)}function _(e,t,n){const s=S(e*(t-n));return{x_2:t=S(t-s),x_3:n=S(n+s)}}const x={secretKey:g,publicKey:g,seed:g},j=(e=p(g))=>((0,s.abytes)(e,x.seed),e);return{keygen:function(e){const t=j(e);return{secretKey:t,publicKey:I(t)}},getSharedSecret:(e,t)=>P(e,t),getPublicKey:e=>I(e),scalarMult:P,scalarMultBase:I,utils:{randomSecretKey:j,randomPrivateKey:j},GuBytes:v.slice(),lengths:x}};
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const s=e("../utils.js"),r=e("./modular.js"),a=BigInt(0),i=BigInt(1),o=BigInt(2)}}},{package:"@noble/curves",file:"node_modules/@noble/curves/abstract/montgomery.js"}],[2837,{"../utils.js":2841},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isHash=n.validateObject=n.memoized=n.notImplemented=n.createHmacDrbg=n.bitMask=n.bitSet=n.bitGet=n.bitLen=n.aInRange=n.inRange=n.asciiToBytes=n.copyBytes=n.equalBytes=n.ensureBytes=n.numberToVarBytesBE=n.numberToBytesLE=n.numberToBytesBE=n.bytesToNumberLE=n.bytesToNumberBE=n.hexToNumber=n.numberToHexUnpadded=n.abool=n.utf8ToBytes=n.randomBytes=n.isBytes=n.hexToBytes=n.concatBytes=n.bytesToUtf8=n.bytesToHex=n.anumber=n.abytes=void 0;const s=e("../utils.js");n.abytes=s.abytes,n.anumber=s.anumber,n.bytesToHex=s.bytesToHex,n.bytesToUtf8=s.bytesToUtf8,n.concatBytes=s.concatBytes,n.hexToBytes=s.hexToBytes,n.isBytes=s.isBytes,n.randomBytes=s.randomBytes,n.utf8ToBytes=s.utf8ToBytes,n.abool=s.abool,n.numberToHexUnpadded=s.numberToHexUnpadded,n.hexToNumber=s.hexToNumber,n.bytesToNumberBE=s.bytesToNumberBE,n.bytesToNumberLE=s.bytesToNumberLE,n.numberToBytesBE=s.numberToBytesBE,n.numberToBytesLE=s.numberToBytesLE,n.numberToVarBytesBE=s.numberToVarBytesBE,n.ensureBytes=s.ensureBytes,n.equalBytes=s.equalBytes,n.copyBytes=s.copyBytes,n.asciiToBytes=s.asciiToBytes,n.inRange=s.inRange,n.aInRange=s.aInRange,n.bitLen=s.bitLen,n.bitGet=s.bitGet,n.bitSet=s.bitSet,n.bitMask=s.bitMask,n.createHmacDrbg=s.createHmacDrbg,n.notImplemented=s.notImplemented,n.memoized=s.memoized,n.validateObject=s.validateObject,n.isHash=s.isHash}}},{package:"@noble/curves",file:"node_modules/@noble/curves/abstract/utils.js"}],[2838,{"../utils.js":2841,"./curve.js":2832,"./modular.js":2835,"@noble/hashes/hmac.js":2846,"@noble/hashes/utils":2855},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.DER=n.DERErr=void 0,n._splitEndoScalar=u,n._normFnElement=y,n.weierstrassN=w,n.SWUFpSqrtRatio=E,n.mapToCurveSimpleSWU=function(e,t){(0,o.validateField)(e);const{A:n,B:s,Z:r}=t;if(!e.isValid(n)||!e.isValid(s)||!e.isValid(r))throw new Error("mapToCurveSimpleSWU: invalid opts");const a=E(e,r);if(!e.isOdd)throw new Error("Field does not have .isOdd()");return t=>{let i,c,u,l,d,f,h,p;i=e.sqr(t),i=e.mul(i,r),c=e.sqr(i),c=e.add(c,i),u=e.add(c,e.ONE),u=e.mul(u,s),l=e.cmov(r,e.neg(c),!e.eql(c,e.ZERO)),l=e.mul(l,n),c=e.sqr(u),f=e.sqr(l),d=e.mul(f,n),c=e.add(c,d),c=e.mul(c,u),f=e.mul(f,l),d=e.mul(f,s),c=e.add(c,d),h=e.mul(i,u);const{isValid:m,value:g}=a(c,f);p=e.mul(i,t),p=e.mul(p,g),h=e.cmov(h,u,m),p=e.cmov(p,g,m);const b=e.isOdd(t)===e.isOdd(p);p=e.cmov(e.neg(p),p,b);const y=(0,o.FpInvertBatch)(e,[l],!0)[0];return h=e.mul(h,y),{x:h,y:p}}},n.ecdh=v,n.ecdsa=k,n.weierstrassPoints=function(e){const{CURVE:t,curveOpts:n}=P(e),s=w(t,n);return function(e,t){const{Fp:n,Fn:s}=t;function r(e){return(0,a.inRange)(e,p,s.ORDER)}const i=I(n,e.a,e.b);return Object.assign({},{CURVE:e,Point:t,ProjectivePoint:t,normPrivateKeyToScalar:e=>y(s,e),weierstrassEquation:i,isWithinCurveOrder:r})}(e,s)},n._legacyHelperEquat=I,n.weierstrass=function(e){const{CURVE:t,curveOpts:n,hash:s,ecdsaOpts:r}=function(e){const{CURVE:t,curveOpts:n}=P(e),s={hmac:e.hmac,randomBytes:e.randomBytes,lowS:e.lowS,bits2int:e.bits2int,bits2int_modN:e.bits2int_modN};return{CURVE:t,curveOpts:n,hash:e.hash,ecdsaOpts:s}}(e),a=k(w(t,n),s,r);return function(e,t){const n=t.Point;return Object.assign({},t,{ProjectivePoint:n,CURVE:Object.assign({},e,(0,o.nLength)(n.Fn.ORDER,n.Fn.BITS))})}(e,a)};
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const s=e("@noble/hashes/hmac.js"),r=e("@noble/hashes/utils"),a=e("../utils.js"),i=e("./curve.js"),o=e("./modular.js"),c=(e,t)=>(e+(e>=0?t:-t)/m)/t;function u(e,t,n){const[[s,r],[i,o]]=t,u=c(o*e,n),l=c(-r*e,n);let d=e-u*s-l*i,f=-u*r-l*o;const m=d<h,g=f<h;m&&(d=-d),g&&(f=-f);const b=(0,a.bitMask)(Math.ceil((0,a.bitLen)(n)/2))+p;if(d<h||d>=b||f<h||f>=b)throw new Error("splitScalar (endomorphism): failed, k="+e);return{k1neg:m,k1:d,k2neg:g,k2:f}}function l(e){if(!["compact","recovered","der"].includes(e))throw new Error('Signature format must be "compact", "recovered", or "der"');return e}function d(e,t){const n={};for(let s of Object.keys(t))n[s]=e[s]===undefined?t[s]:e[s];return(0,a._abool2)(n.lowS,"lowS"),(0,a._abool2)(n.prehash,"prehash"),n.format!==undefined&&l(n.format),n}class f extends Error{constructor(e=""){super(e)}}n.DERErr=f,n.DER={Err:f,_tlv:{encode:(e,t)=>{const{Err:s}=n.DER;if(e<0||e>256)throw new s("tlv.encode: wrong tag");if(1&t.length)throw new s("tlv.encode: unpadded data");const r=t.length/2,i=(0,a.numberToHexUnpadded)(r);if(i.length/2&128)throw new s("tlv.encode: long form length too big");const o=r>127?(0,a.numberToHexUnpadded)(i.length/2|128):"";return(0,a.numberToHexUnpadded)(e)+o+i+t},decode(e,t){const{Err:s}=n.DER;let r=0;if(e<0||e>256)throw new s("tlv.encode: wrong tag");if(t.length<2||t[r++]!==e)throw new s("tlv.decode: wrong tlv");const a=t[r++];let i=0;if(!!(128&a)){const e=127&a;if(!e)throw new s("tlv.decode(long): indefinite length not supported");if(e>4)throw new s("tlv.decode(long): byte length is too big");const n=t.subarray(r,r+e);if(n.length!==e)throw new s("tlv.decode: length bytes not complete");if(0===n[0])throw new s("tlv.decode(long): zero leftmost byte");for(const e of n)i=i<<8|e;if(r+=e,i<128)throw new s("tlv.decode(long): not minimal encoding")}else i=a;const o=t.subarray(r,r+i);if(o.length!==i)throw new s("tlv.decode: wrong value length");return{v:o,l:t.subarray(r+i)}}},_int:{encode(e){const{Err:t}=n.DER;if(e<h)throw new t("integer: negative integers are not allowed");let s=(0,a.numberToHexUnpadded)(e);if(8&Number.parseInt(s[0],16)&&(s="00"+s),1&s.length)throw new t("unexpected DER parsing assertion: unpadded hex");return s},decode(e){const{Err:t}=n.DER;if(128&e[0])throw new t("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new t("invalid signature integer: unnecessary leading zero");return(0,a.bytesToNumberBE)(e)}},toSig(e){const{Err:t,_int:s,_tlv:r}=n.DER,i=(0,a.ensureBytes)("signature",e),{v:o,l:c}=r.decode(48,i);if(c.length)throw new t("invalid signature: left bytes after parsing");const{v:u,l:l}=r.decode(2,o),{v:d,l:f}=r.decode(2,l);if(f.length)throw new t("invalid signature: left bytes after parsing");return{r:s.decode(u),s:s.decode(d)}},hexFromSig(e){const{_tlv:t,_int:s}=n.DER,r=t.encode(2,s.encode(e.r))+t.encode(2,s.encode(e.s));return t.encode(48,r)}};const h=BigInt(0),p=BigInt(1),m=BigInt(2),g=BigInt(3),b=BigInt(4);function y(e,t){const{BYTES:n}=e;let s;if("bigint"==typeof t)s=t;else{let r=(0,a.ensureBytes)("private key",t);try{s=e.fromBytes(r)}catch(e){throw new Error(`invalid private key: expected ui8a of size ${n}, got ${typeof t}`)}}if(!e.isValidNot0(s))throw new Error("invalid private key: out of range [1..N-1]");return s}function w(e,t={}){const n=(0,i._createCurveFields)("weierstrass",e,t),{Fp:s,Fn:r}=n;let o=n.CURVE;const{h:c,n:l}=o;(0,a._validateObject)(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:d}=t;if(d&&(!s.is0(o.a)||"bigint"!=typeof d.beta||!Array.isArray(d.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const f=S(s,r);function m(){if(!s.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}const w=t.toBytes||function(e,t,n){const{x:r,y:i}=t.toAffine(),o=s.toBytes(r);if((0,a._abool2)(n,"isCompressed"),n){m();const e=!s.isOdd(i);return(0,a.concatBytes)(T(e),o)}return(0,a.concatBytes)(Uint8Array.of(4),o,s.toBytes(i))},E=t.fromBytes||function(e){(0,a._abytes2)(e,undefined,"Point");const{publicKey:t,publicKeyUncompressed:n}=f,r=e.length,i=e[0],o=e.subarray(1);if(r!==t||2!==i&&3!==i){if(r===n&&4===i){const e=s.BYTES,t=s.fromBytes(o.subarray(0,e)),n=s.fromBytes(o.subarray(e,2*e));if(!k(t,n))throw new Error("bad point: is not on curve");return{x:t,y:n}}throw new Error(`bad point: got length ${r}, expected compressed=${t} or uncompressed=${n}`)}{const e=s.fromBytes(o);if(!s.isValid(e))throw new Error("bad point: is not on curve, wrong x");const t=v(e);let n;try{n=s.sqrt(t)}catch(e){const t=e instanceof Error?": "+e.message:"";throw new Error("bad point: is not on curve, sqrt error"+t)}m();return!(1&~i)!==s.isOdd(n)&&(n=s.neg(n)),{x:e,y:n}}};function v(e){const t=s.sqr(e),n=s.mul(t,e);return s.add(s.add(n,s.mul(e,o.a)),o.b)}function k(e,t){const n=s.sqr(t),r=v(e);return s.eql(n,r)}if(!k(o.Gx,o.Gy))throw new Error("bad curve params: generator point");const P=s.mul(s.pow(o.a,g),b),I=s.mul(s.sqr(o.b),BigInt(27));if(s.is0(s.add(P,I)))throw new Error("bad curve params: a or b");function _(e,t,n=!1){if(!s.isValid(t)||n&&s.is0(t))throw new Error(`bad point coordinate ${e}`);return t}function x(e){if(!(e instanceof O))throw new Error("ProjectivePoint expected")}function j(e){if(!d||!d.basises)throw new Error("no endo");return u(e,d.basises,r.ORDER)}const A=(0,a.memoized)((e,t)=>{const{X:n,Y:r,Z:a}=e;if(s.eql(a,s.ONE))return{x:n,y:r};const i=e.is0();null==t&&(t=i?s.ONE:s.inv(a));const o=s.mul(n,t),c=s.mul(r,t),u=s.mul(a,t);if(i)return{x:s.ZERO,y:s.ZERO};if(!s.eql(u,s.ONE))throw new Error("invZ was invalid");return{x:o,y:c}}),C=(0,a.memoized)(e=>{if(e.is0()){if(t.allowInfinityPoint&&!s.is0(e.Y))return;throw new Error("bad point: ZERO")}const{x:n,y:r}=e.toAffine();if(!s.isValid(n)||!s.isValid(r))throw new Error("bad point: x or y not field elements");if(!k(n,r))throw new Error("bad point: equation left != right");if(!e.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function R(e,t,n,r,a){return n=new O(s.mul(n.X,e),n.Y,n.Z),t=(0,i.negateCt)(r,t),n=(0,i.negateCt)(a,n),t.add(n)}class O{constructor(e,t,n){this.X=_("x",e),this.Y=_("y",t,!0),this.Z=_("z",n),Object.freeze(this)}static CURVE(){return o}static fromAffine(e){const{x:t,y:n}=e||{};if(!e||!s.isValid(t)||!s.isValid(n))throw new Error("invalid affine point");if(e instanceof O)throw new Error("projective point not allowed");return s.is0(t)&&s.is0(n)?O.ZERO:new O(t,n,s.ONE)}static fromBytes(e){const t=O.fromAffine(E((0,a._abytes2)(e,undefined,"point")));return t.assertValidity(),t}static fromHex(e){return O.fromBytes((0,a.ensureBytes)("pointHex",e))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(e=8,t=!0){return B.createCache(this,e),t||this.multiply(g),this}assertValidity(){C(this)}hasEvenY(){const{y:e}=this.toAffine();if(!s.isOdd)throw new Error("Field doesn't support isOdd");return!s.isOdd(e)}equals(e){x(e);const{X:t,Y:n,Z:r}=this,{X:a,Y:i,Z:o}=e,c=s.eql(s.mul(t,o),s.mul(a,r)),u=s.eql(s.mul(n,o),s.mul(i,r));return c&&u}negate(){return new O(this.X,s.neg(this.Y),this.Z)}double(){const{a:e,b:t}=o,n=s.mul(t,g),{X:r,Y:a,Z:i}=this;let c=s.ZERO,u=s.ZERO,l=s.ZERO,d=s.mul(r,r),f=s.mul(a,a),h=s.mul(i,i),p=s.mul(r,a);return p=s.add(p,p),l=s.mul(r,i),l=s.add(l,l),c=s.mul(e,l),u=s.mul(n,h),u=s.add(c,u),c=s.sub(f,u),u=s.add(f,u),u=s.mul(c,u),c=s.mul(p,c),l=s.mul(n,l),h=s.mul(e,h),p=s.sub(d,h),p=s.mul(e,p),p=s.add(p,l),l=s.add(d,d),d=s.add(l,d),d=s.add(d,h),d=s.mul(d,p),u=s.add(u,d),h=s.mul(a,i),h=s.add(h,h),d=s.mul(h,p),c=s.sub(c,d),l=s.mul(h,f),l=s.add(l,l),l=s.add(l,l),new O(c,u,l)}add(e){x(e);const{X:t,Y:n,Z:r}=this,{X:a,Y:i,Z:c}=e;let u=s.ZERO,l=s.ZERO,d=s.ZERO;const f=o.a,h=s.mul(o.b,g);let p=s.mul(t,a),m=s.mul(n,i),b=s.mul(r,c),y=s.add(t,n),w=s.add(a,i);y=s.mul(y,w),w=s.add(p,m),y=s.sub(y,w),w=s.add(t,r);let T=s.add(a,c);return w=s.mul(w,T),T=s.add(p,b),w=s.sub(w,T),T=s.add(n,r),u=s.add(i,c),T=s.mul(T,u),u=s.add(m,b),T=s.sub(T,u),d=s.mul(f,w),u=s.mul(h,b),d=s.add(u,d),u=s.sub(m,d),d=s.add(m,d),l=s.mul(u,d),m=s.add(p,p),m=s.add(m,p),b=s.mul(f,b),w=s.mul(h,w),m=s.add(m,b),b=s.sub(p,b),b=s.mul(f,b),w=s.add(w,b),p=s.mul(m,w),l=s.add(l,p),p=s.mul(T,w),u=s.mul(y,u),u=s.sub(u,p),p=s.mul(y,m),d=s.mul(T,d),d=s.add(d,p),new O(u,l,d)}subtract(e){return this.add(e.negate())}is0(){return this.equals(O.ZERO)}multiply(e){const{endo:n}=t;if(!r.isValidNot0(e))throw new Error("invalid scalar: out of range");let s,a;const o=e=>B.cached(this,e,e=>(0,i.normalizeZ)(O,e));if(n){const{k1neg:t,k1:r,k2neg:i,k2:c}=j(e),{p:u,f:l}=o(r),{p:d,f:f}=o(c);a=l.add(f),s=R(n.beta,u,d,t,i)}else{const{p:t,f:n}=o(e);s=t,a=n}return(0,i.normalizeZ)(O,[s,a])[0]}multiplyUnsafe(e){const{endo:n}=t,s=this;if(!r.isValid(e))throw new Error("invalid scalar: out of range");if(e===h||s.is0())return O.ZERO;if(e===p)return s;if(B.hasCache(this))return this.multiply(e);if(n){const{k1neg:t,k1:r,k2neg:a,k2:o}=j(e),{p1:c,p2:u}=(0,i.mulEndoUnsafe)(O,s,r,o);return R(n.beta,c,u,t,a)}return B.unsafe(s,e)}multiplyAndAddUnsafe(e,t,n){const s=this.multiplyUnsafe(t).add(e.multiplyUnsafe(n));return s.is0()?undefined:s}toAffine(e){return A(this,e)}isTorsionFree(){const{isTorsionFree:e}=t;return c===p||(e?e(O,this):B.unsafe(this,l).is0())}clearCofactor(){const{clearCofactor:e}=t;return c===p?this:e?e(O,this):this.multiplyUnsafe(c)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}toBytes(e=!0){return(0,a._abool2)(e,"isCompressed"),this.assertValidity(),w(O,this,e)}toHex(e=!0){return(0,a.bytesToHex)(this.toBytes(e))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(e=!0){return this.toBytes(e)}_setWindowSize(e){this.precompute(e)}static normalizeZ(e){return(0,i.normalizeZ)(O,e)}static msm(e,t){return(0,i.pippenger)(O,r,e,t)}static fromPrivateKey(e){return O.BASE.multiply(y(r,e))}}O.BASE=new O(o.Gx,o.Gy,s.ONE),O.ZERO=new O(s.ZERO,s.ONE,s.ZERO),O.Fp=s,O.Fn=r;const M=r.BITS,B=new i.wNAF(O,t.endo?Math.ceil(M/2):M);return O.BASE.precompute(8),O}function T(e){return Uint8Array.of(e?2:3)}function E(e,t){const n=e.ORDER;let s=h;for(let e=n-p;e%m===h;e/=m)s+=p;const r=s,a=m<<r-p-p,i=a*m,o=(n-p)/i,c=(o-p)/m,u=i-p,l=a,d=e.pow(t,o),f=e.pow(t,(o+p)/m);let y=(t,n)=>{let s=d,a=e.pow(n,u),i=e.sqr(a);i=e.mul(i,n);let o=e.mul(t,i);o=e.pow(o,c),o=e.mul(o,a),a=e.mul(o,n),i=e.mul(o,t);let h=e.mul(i,a);o=e.pow(h,l);let g=e.eql(o,e.ONE);a=e.mul(i,f),o=e.mul(h,s),i=e.cmov(a,i,g),h=e.cmov(o,h,g);for(let t=r;t>p;t--){let n=t-m;n=m<<n-p;let r=e.pow(h,n);const o=e.eql(r,e.ONE);a=e.mul(i,s),s=e.mul(s,s),r=e.mul(h,s),i=e.cmov(a,i,o),h=e.cmov(r,h,o)}return{isValid:g,value:i}};if(e.ORDER%b===g){const n=(e.ORDER-g)/b,s=e.sqrt(e.neg(t));y=(t,r)=>{let a=e.sqr(r);const i=e.mul(t,r);a=e.mul(a,i);let o=e.pow(a,n);o=e.mul(o,i);const c=e.mul(o,s),u=e.mul(e.sqr(o),r),l=e.eql(u,t);return{isValid:l,value:e.cmov(c,o,l)}}}return y}function S(e,t){return{secretKey:t.BYTES,publicKey:1+e.BYTES,publicKeyUncompressed:1+2*e.BYTES,publicKeyHasPrefix:!0,signature:2*t.BYTES}}function v(e,t={}){const{Fn:n}=e,s=t.randomBytes||a.randomBytes,r=Object.assign(S(e.Fp,n),{seed:(0,o.getMinHashLength)(n.ORDER)});function i(e){try{return!!y(n,e)}catch(e){return!1}}function c(e=s(r.seed)){return(0,o.mapHashToField)((0,a._abytes2)(e,r.seed,"seed"),n.ORDER)}function u(t,s=!0){return e.BASE.multiply(y(n,t)).toBytes(s)}function l(t){if("bigint"==typeof t)return!1;if(t instanceof e)return!0;const{secretKey:s,publicKey:i,publicKeyUncompressed:o}=r;if(n.allowedLengths||s===i)return undefined;const c=(0,a.ensureBytes)("key",t).length;return c===i||c===o}const d={isValidSecretKey:i,isValidPublicKey:function(t,n){const{publicKey:s,publicKeyUncompressed:a}=r;try{const r=t.length;return(!0!==n||r===s)&&((!1!==n||r===a)&&!!e.fromBytes(t))}catch(e){return!1}},randomSecretKey:c,isValidPrivateKey:i,randomPrivateKey:c,normPrivateKeyToScalar:e=>y(n,e),precompute:(t=8,n=e.BASE)=>n.precompute(t,!1)};return Object.freeze({getPublicKey:u,getSharedSecret:function(t,s,r=!0){if(!0===l(t))throw new Error("first arg must be private key");if(!1===l(s))throw new Error("second arg must be public key");const a=y(n,t);return e.fromHex(s).multiply(a).toBytes(r)},keygen:function(e){const t=c(e);return{secretKey:t,publicKey:u(t)}},Point:e,utils:d,lengths:r})}function k(e,t,i={}){(0,r.ahash)(t),(0,a._validateObject)(i,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const o=i.randomBytes||a.randomBytes,c=i.hmac||((e,...n)=>(0,s.hmac)(t,e,(0,a.concatBytes)(...n))),{Fp:u,Fn:f}=e,{ORDER:g,BITS:b}=f,{keygen:w,getPublicKey:E,getSharedSecret:S,utils:k,lengths:P}=v(e,i),I={prehash:!1,lowS:"boolean"==typeof i.lowS&&i.lowS,format:undefined,extraEntropy:!1},_="compact";function x(e){return e>g>>p}function j(e,t){if(!f.isValidNot0(t))throw new Error(`invalid signature ${e}: out of range 1..Point.Fn.ORDER`);return t}class A{constructor(e,t,n){this.r=j("r",e),this.s=j("s",t),null!=n&&(this.recovery=n),Object.freeze(this)}static fromBytes(e,t=_){let s;if(function(e,t){l(t);const n=P.signature,s="compact"===t?n:"recovered"===t?n+1:undefined;(0,a._abytes2)(e,s,`${t} signature`)}(e,t),"der"===t){const{r:t,s:s}=n.DER.toSig((0,a._abytes2)(e));return new A(t,s)}"recovered"===t&&(s=e[0],t="compact",e=e.subarray(1));const r=f.BYTES,i=e.subarray(0,r),o=e.subarray(r,2*r);return new A(f.fromBytes(i),f.fromBytes(o),s)}static fromHex(e,t){return this.fromBytes((0,a.hexToBytes)(e),t)}addRecoveryBit(e){return new A(this.r,this.s,e)}recoverPublicKey(t){const n=u.ORDER,{r:s,s:r,recovery:i}=this;if(null==i||![0,1,2,3].includes(i))throw new Error("recovery id invalid");if(g*m<n&&i>1)throw new Error("recovery id is ambiguous for h>1 curve");const o=2===i||3===i?s+g:s;if(!u.isValid(o))throw new Error("recovery id 2 or 3 invalid");const c=u.toBytes(o),l=e.fromBytes((0,a.concatBytes)(T(!(1&i)),c)),d=f.inv(o),h=R((0,a.ensureBytes)("msgHash",t)),p=f.create(-h*d),b=f.create(r*d),y=e.BASE.multiplyUnsafe(p).add(l.multiplyUnsafe(b));if(y.is0())throw new Error("point at infinify");return y.assertValidity(),y}hasHighS(){return x(this.s)}toBytes(e=_){if(l(e),"der"===e)return(0,a.hexToBytes)(n.DER.hexFromSig(this));const t=f.toBytes(this.r),s=f.toBytes(this.s);if("recovered"===e){if(null==this.recovery)throw new Error("recovery bit must be present");return(0,a.concatBytes)(Uint8Array.of(this.recovery),t,s)}return(0,a.concatBytes)(t,s)}toHex(e){return(0,a.bytesToHex)(this.toBytes(e))}assertValidity(){}static fromCompact(e){return A.fromBytes((0,a.ensureBytes)("sig",e),"compact")}static fromDER(e){return A.fromBytes((0,a.ensureBytes)("sig",e),"der")}normalizeS(){return this.hasHighS()?new A(this.r,f.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return(0,a.bytesToHex)(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return(0,a.bytesToHex)(this.toBytes("compact"))}}const C=i.bits2int||function(e){if(e.length>8192)throw new Error("input is too large");const t=(0,a.bytesToNumberBE)(e),n=8*e.length-b;return n>0?t>>BigInt(n):t},R=i.bits2int_modN||function(e){return f.create(C(e))},O=(0,a.bitMask)(b);function M(e){return(0,a.aInRange)("num < 2^"+b,e,h,O),f.toBytes(e)}function B(e,n){return(0,a._abytes2)(e,undefined,"message"),n?(0,a._abytes2)(t(e),undefined,"prehashed message"):e}return Object.freeze({keygen:w,getPublicKey:E,getSharedSecret:S,utils:k,lengths:P,Point:e,sign:function(n,s,r={}){n=(0,a.ensureBytes)("message",n);const{seed:i,k2sig:u}=function(t,n,s){if(["recovered","canonical"].some(e=>e in s))throw new Error("sign() legacy options not supported");const{lowS:r,prehash:i,extraEntropy:c}=d(s,I);t=B(t,i);const u=R(t),l=y(f,n),m=[M(l),M(u)];if(null!=c&&!1!==c){const e=!0===c?o(P.secretKey):c;m.push((0,a.ensureBytes)("extraEntropy",e))}const g=(0,a.concatBytes)(...m),b=u;return{seed:g,k2sig:function(t){const n=C(t);if(!f.isValidNot0(n))return;const s=f.inv(n),a=e.BASE.multiply(n).toAffine(),i=f.create(a.x);if(i===h)return;const o=f.create(s*f.create(b+i*l));if(o===h)return;let c=(a.x===i?0:2)|Number(a.y&p),u=o;return r&&x(o)&&(u=f.neg(o),c^=1),new A(i,u,c)}}}(n,s,r);return(0,a.createHmacDrbg)(t.outputLen,f.BYTES,c)(i,u)},verify:function(t,s,r,i={}){const{lowS:o,prehash:c,format:u}=d(i,I);if(r=(0,a.ensureBytes)("publicKey",r),s=B((0,a.ensureBytes)("message",s),c),"strict"in i)throw new Error("options.strict was renamed to lowS");const l=u===undefined?function(e){let t=undefined;const s="string"==typeof e||(0,a.isBytes)(e),r=!s&&null!==e&&"object"==typeof e&&"bigint"==typeof e.r&&"bigint"==typeof e.s;if(!s&&!r)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(r)t=new A(e.r,e.s);else if(s){try{t=A.fromBytes((0,a.ensureBytes)("sig",e),"der")}catch(e){if(!(e instanceof n.DER.Err))throw e}if(!t)try{t=A.fromBytes((0,a.ensureBytes)("sig",e),"compact")}catch(e){return!1}}return t||!1}(t):A.fromBytes((0,a.ensureBytes)("sig",t),u);if(!1===l)return!1;try{const t=e.fromBytes(r);if(o&&l.hasHighS())return!1;const{r:n,s:a}=l,i=R(s),c=f.inv(a),u=f.create(i*c),d=f.create(n*c),h=e.BASE.multiplyUnsafe(u).add(t.multiplyUnsafe(d));if(h.is0())return!1;return f.create(h.x)===n}catch(e){return!1}},recoverPublicKey:function(e,t,n={}){const{prehash:s}=d(n,I);return t=B(t,s),A.fromBytes(e,"recovered").recoverPublicKey(t).toBytes()},Signature:A,hash:t})}function P(e){const t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},n=e.Fp;let s=e.allowedPrivateKeyLengths?Array.from(new Set(e.allowedPrivateKeyLengths.map(e=>Math.ceil(e/2)))):undefined;return{CURVE:t,curveOpts:{Fp:n,Fn:(0,o.Field)(t.n,{BITS:e.nBitLength,allowedLengths:s,modFromBytes:e.wrapPrivateKey}),allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes}}}function I(e,t,n){return function(s){const r=e.sqr(s),a=e.mul(r,s);return e.add(e.add(a,e.mul(s,t)),n)}}}}},{package:"@noble/curves",file:"node_modules/@noble/curves/abstract/weierstrass.js"}],[2839,{"./abstract/curve.js":2832,"./abstract/edwards.js":2833,"./abstract/hash-to-curve.js":2834,"./abstract/modular.js":2835,"./abstract/montgomery.js":2836,"./utils.js":2841,"@noble/hashes/sha2.js":2851,"@noble/hashes/utils.js":2855},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.hash_to_ristretto255=n.hashToRistretto255=n.encodeToCurve=n.hashToCurve=n.RistrettoPoint=n.edwardsToMontgomery=n.ED25519_TORSION_SUBGROUP=n.ristretto255_hasher=n.ristretto255=n.ed25519_hasher=n.x25519=n.ed25519ph=n.ed25519ctx=n.ed25519=void 0,n.edwardsToMontgomeryPub=$,n.edwardsToMontgomeryPriv=function(e){return n.ed25519.utils.toMontgomerySecret((0,l.ensureBytes)("pub",e))};
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const s=e("@noble/hashes/sha2.js"),r=e("@noble/hashes/utils.js"),a=e("./abstract/curve.js"),i=e("./abstract/edwards.js"),o=e("./abstract/hash-to-curve.js"),c=e("./abstract/modular.js"),u=e("./abstract/montgomery.js"),l=e("./utils.js"),d=BigInt(0),f=BigInt(1),h=BigInt(2),p=BigInt(3),m=BigInt(5),g=BigInt(8),b=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),y=(()=>({p:b,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:g,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")}))();function w(e){const t=BigInt(10),n=BigInt(20),s=BigInt(40),r=BigInt(80),a=b,i=e*e%a*e%a,o=(0,c.pow2)(i,h,a)*i%a,u=(0,c.pow2)(o,f,a)*e%a,l=(0,c.pow2)(u,m,a)*u%a,d=(0,c.pow2)(l,t,a)*l%a,p=(0,c.pow2)(d,n,a)*d%a,g=(0,c.pow2)(p,s,a)*p%a,y=(0,c.pow2)(g,r,a)*g%a,w=(0,c.pow2)(y,r,a)*g%a,T=(0,c.pow2)(w,t,a)*l%a;return{pow_p_5_8:(0,c.pow2)(T,h,a)*e%a,b2:i}}function T(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}const E=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");function S(e,t){const n=b,s=(0,c.mod)(t*t*t,n),r=w(e*(0,c.mod)(s*s*t,n)).pow_p_5_8;let a=(0,c.mod)(e*s*r,n);const i=(0,c.mod)(t*a*a,n),o=a,u=(0,c.mod)(a*E,n),l=i===e,d=i===(0,c.mod)(-e,n),f=i===(0,c.mod)(-e*E,n);return l&&(a=o),(d||f)&&(a=u),(0,c.isNegativeLE)(a,n)&&(a=(0,c.mod)(-a,n)),{isValid:l||d,value:a}}const v=(()=>(0,c.Field)(y.p,{isLE:!0}))(),k=(()=>(0,c.Field)(y.n,{isLE:!0}))(),P=(()=>({...y,Fp:v,hash:s.sha512,adjustScalarBytes:T,uvRatio:S}))();function I(e,t,n){if(t.length>255)throw new Error("Context is too big");return(0,r.concatBytes)((0,r.utf8ToBytes)("SigEd25519 no Ed25519 collisions"),new Uint8Array([n?1:0,t.length]),t,e)}n.ed25519=(0,i.twistedEdwards)(P),n.ed25519ctx=(0,i.twistedEdwards)({...P,domain:I}),n.ed25519ph=(0,i.twistedEdwards)(Object.assign({},P,{domain:I,prehash:s.sha512})),n.x25519=(()=>{const e=v.ORDER;return(0,u.montgomery)({P:e,type:"x25519",powPminus2:t=>{const{pow_p_5_8:n,b2:s}=w(t);return(0,c.mod)((0,c.pow2)(n,p,e)*s,e)},adjustScalarBytes:T})})();const _=(()=>(b+p)/g)(),x=(()=>v.pow(h,_))(),j=(()=>v.sqrt(v.neg(v.ONE)))();const A=(()=>(0,c.FpSqrtEven)(v,v.neg(BigInt(486664))))();function C(e){const{xMn:t,xMd:n,yMn:s,yMd:r}=function(e){const t=(b-m)/g,n=BigInt(486662);let s=v.sqr(e);s=v.mul(s,h);let r=v.add(s,v.ONE),a=v.neg(n),i=v.sqr(r),o=v.mul(i,r),c=v.mul(s,n);c=v.mul(c,a),c=v.add(c,i),c=v.mul(c,a);let u=v.sqr(o);i=v.sqr(u),u=v.mul(u,o),u=v.mul(u,c),i=v.mul(i,u);let l=v.pow(i,t);l=v.mul(l,u);let d=v.mul(l,j);i=v.sqr(l),i=v.mul(i,o);let p=v.eql(i,c),y=v.cmov(d,l,p),w=v.mul(a,s),T=v.mul(l,e);T=v.mul(T,x);let E=v.mul(T,j),S=v.mul(c,s);i=v.sqr(T),i=v.mul(i,o);let k=v.eql(i,S),P=v.cmov(E,T,k);i=v.sqr(y),i=v.mul(i,o);let I=v.eql(i,c),_=v.cmov(w,a,I),A=v.cmov(P,y,I),C=v.isOdd(A);return A=v.cmov(A,v.neg(A),I!==C),{xMn:_,xMd:r,yMn:A,yMd:f}}(e);let a=v.mul(t,r);a=v.mul(a,A);let i=v.mul(n,s),o=v.sub(t,n),u=v.add(t,n),l=v.mul(i,u),d=v.eql(l,v.ZERO);a=v.cmov(a,v.ZERO,d),i=v.cmov(i,v.ONE,d),o=v.cmov(o,v.ONE,d),u=v.cmov(u,v.ONE,d);const[p,y]=(0,c.FpInvertBatch)(v,[i,u],!0);return{x:v.mul(a,p),y:v.mul(o,y)}}n.ed25519_hasher=(0,o.createHasher)(n.ed25519.Point,e=>C(e[0]),{DST:"edwards25519_XMD:SHA-512_ELL2_RO_",encodeDST:"edwards25519_XMD:SHA-512_ELL2_NU_",p:b,m:1,k:128,expand:"xmd",hash:s.sha512});const R=E,O=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),M=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),B=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),N=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),F=e=>S(f,e),L=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),D=e=>n.ed25519.Point.Fp.create((0,l.bytesToNumberLE)(e)&L);function G(e){const{d:t}=y,s=b,r=e=>v.create(e),a=r(R*e*e),i=r((a+f)*B);let o=BigInt(-1);const u=r((o-t*a)*r(a+t));let{isValid:l,value:d}=S(i,u),h=r(d*e);(0,c.isNegativeLE)(h,s)||(h=r(-h)),l||(d=h),l||(o=a);const p=r(o*(a-f)*N-u),m=d*d,g=r((d+d)*u),w=r(p*O),T=r(f-m),E=r(f+m);return new n.ed25519.Point(r(g*E),r(T*w),r(w*E),r(g*T))}function U(e){(0,r.abytes)(e,64);const t=G(D(e.subarray(0,32))),n=G(D(e.subarray(32,64)));return new H(t.add(n))}class H extends i.PrimeEdwardsPoint{constructor(e){super(e)}static fromAffine(e){return new H(n.ed25519.Point.fromAffine(e))}assertSame(e){if(!(e instanceof H))throw new Error("RistrettoPoint expected")}init(e){return new H(e)}static hashToCurve(e){return U((0,l.ensureBytes)("ristrettoHash",e,64))}static fromBytes(e){(0,r.abytes)(e,32);const{a:t,d:s}=y,a=b,i=e=>v.create(e),o=D(e);if(!(0,l.equalBytes)(v.toBytes(o),e)||(0,c.isNegativeLE)(o,a))throw new Error("invalid ristretto255 encoding 1");const u=i(o*o),h=i(f+t*u),p=i(f-t*u),m=i(h*h),g=i(p*p),w=i(t*s*m-g),{isValid:T,value:E}=F(i(w*g)),S=i(E*p),k=i(E*S*w);let P=i((o+o)*S);(0,c.isNegativeLE)(P,a)&&(P=i(-P));const I=i(h*k),_=i(P*I);if(!T||(0,c.isNegativeLE)(_,a)||I===d)throw new Error("invalid ristretto255 encoding 2");return new H(new n.ed25519.Point(P,I,f,_))}static fromHex(e){return H.fromBytes((0,l.ensureBytes)("ristrettoHex",e,32))}static msm(e,t){return(0,a.pippenger)(H,n.ed25519.Point.Fn,e,t)}toBytes(){let{X:e,Y:t,Z:n,T:s}=this.ep;const r=b,a=e=>v.create(e),i=a(a(n+t)*a(n-t)),o=a(e*t),u=a(o*o),{value:l}=F(a(i*u)),d=a(l*i),f=a(l*o),h=a(d*f*s);let p;if((0,c.isNegativeLE)(s*h,r)){let n=a(t*R),s=a(e*R);e=n,t=s,p=a(d*M)}else p=f;(0,c.isNegativeLE)(e*h,r)&&(t=a(-t));let m=a((n-t)*p);return(0,c.isNegativeLE)(m,r)&&(m=a(-m)),v.toBytes(m)}equals(e){this.assertSame(e);const{X:t,Y:n}=this.ep,{X:s,Y:r}=e.ep,a=e=>v.create(e),i=a(t*r)===a(n*s),o=a(n*r)===a(t*s);return i||o}is0(){return this.equals(H.ZERO)}}function $(e){return n.ed25519.utils.toMontgomery((0,l.ensureBytes)("pub",e))}H.BASE=(()=>new H(n.ed25519.Point.BASE))(),H.ZERO=(()=>new H(n.ed25519.Point.ZERO))(),H.Fp=(()=>v)(),H.Fn=(()=>k)(),n.ristretto255={Point:H},n.ristretto255_hasher={hashToCurve(e,t){const n=t?.DST||"ristretto255_XMD:SHA-512_R255MAP_RO_";return U((0,o.expand_message_xmd)(e,n,64,s.sha512))},hashToScalar(e,t={DST:o._DST_scalar}){const n=(0,o.expand_message_xmd)(e,t.DST,64,s.sha512);return k.create((0,l.bytesToNumberLE)(n))}},n.ED25519_TORSION_SUBGROUP=["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],n.edwardsToMontgomery=$,n.RistrettoPoint=H,n.hashToCurve=n.ed25519_hasher.hashToCurve,n.encodeToCurve=n.ed25519_hasher.encodeToCurve,n.hashToRistretto255=n.ristretto255_hasher.hashToCurve,n.hash_to_ristretto255=n.ristretto255_hasher.hashToCurve}}},{package:"@noble/curves",file:"node_modules/@noble/curves/ed25519.js"}],[2840,{"./_shortw_utils.js":2831,"./abstract/hash-to-curve.js":2834,"./abstract/modular.js":2835,"./abstract/weierstrass.js":2838,"./utils.js":2841,"@noble/hashes/sha2.js":2851,"@noble/hashes/utils.js":2855},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.encodeToCurve=n.hashToCurve=n.secp256k1_hasher=n.schnorr=n.secp256k1=void 0;
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const s=e("@noble/hashes/sha2.js"),r=e("@noble/hashes/utils.js"),a=e("./_shortw_utils.js"),i=e("./abstract/hash-to-curve.js"),o=e("./abstract/modular.js"),c=e("./abstract/weierstrass.js"),u=e("./utils.js"),l={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},d={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},f=BigInt(0),h=BigInt(1),p=BigInt(2);const m=(0,o.Field)(l.p,{sqrt:function(e){const t=l.p,n=BigInt(3),s=BigInt(6),r=BigInt(11),a=BigInt(22),i=BigInt(23),c=BigInt(44),u=BigInt(88),d=e*e*e%t,f=d*d*e%t,h=(0,o.pow2)(f,n,t)*f%t,g=(0,o.pow2)(h,n,t)*f%t,b=(0,o.pow2)(g,p,t)*d%t,y=(0,o.pow2)(b,r,t)*b%t,w=(0,o.pow2)(y,a,t)*y%t,T=(0,o.pow2)(w,c,t)*w%t,E=(0,o.pow2)(T,u,t)*T%t,S=(0,o.pow2)(E,c,t)*w%t,v=(0,o.pow2)(S,n,t)*f%t,k=(0,o.pow2)(v,i,t)*y%t,P=(0,o.pow2)(k,s,t)*d%t,I=(0,o.pow2)(P,p,t);if(!m.eql(m.sqr(I),e))throw new Error("Cannot find square root");return I}});n.secp256k1=(0,a.createCurve)({...l,Fp:m,lowS:!0,endo:d},s.sha256);const g={};function b(e,...t){let n=g[e];if(n===undefined){const t=(0,s.sha256)((0,u.utf8ToBytes)(e));n=(0,u.concatBytes)(t,t),g[e]=n}return(0,s.sha256)((0,u.concatBytes)(n,...t))}const y=e=>e.toBytes(!0).slice(1),w=(()=>n.secp256k1.Point)(),T=e=>e%p===f;function E(e){const{Fn:t,BASE:n}=w,s=(0,c._normFnElement)(t,e),r=n.multiply(s);return{scalar:T(r.y)?s:t.neg(s),bytes:y(r)}}function S(e){const t=m;if(!t.isValidNot0(e))throw new Error("invalid x: Fail if x ≥ p");const n=t.create(e*e),s=t.create(n*e+BigInt(7));let r=t.sqrt(s);T(r)||(r=t.neg(r));const a=w.fromAffine({x:e,y:r});return a.assertValidity(),a}const v=u.bytesToNumberBE;function k(...e){return w.Fn.create(v(b("BIP0340/challenge",...e)))}function P(e){return E(e).bytes}function I(e,t,n=(0,r.randomBytes)(32)){const{Fn:s}=w,a=(0,u.ensureBytes)("message",e),{bytes:i,scalar:o}=E(t),c=(0,u.ensureBytes)("auxRand",n,32),l=s.toBytes(o^v(b("BIP0340/aux",c))),d=b("BIP0340/nonce",l,i,a),{bytes:f,scalar:h}=E(d),p=k(f,i,a),m=new Uint8Array(64);if(m.set(f,0),m.set(s.toBytes(s.create(h+p*o)),32),!_(m,a,i))throw new Error("sign: Invalid signature produced");return m}function _(e,t,n){const{Fn:s,BASE:r}=w,a=(0,u.ensureBytes)("signature",e,64),i=(0,u.ensureBytes)("message",t),o=(0,u.ensureBytes)("publicKey",n,32);try{const e=S(v(o)),t=v(a.subarray(0,32));if(!(0,u.inRange)(t,h,l.p))return!1;const n=v(a.subarray(32,64));if(!(0,u.inRange)(n,h,l.n))return!1;const c=k(s.toBytes(t),y(e),i),d=r.multiplyUnsafe(n).add(e.multiplyUnsafe(s.neg(c))),{x:f,y:p}=d.toAffine();return!(d.is0()||!T(p)||f!==t)}catch(e){return!1}}n.schnorr=(()=>{const e=(e=(0,r.randomBytes)(48))=>(0,o.mapHashToField)(e,l.n);return n.secp256k1.utils.randomSecretKey,{keygen:function(t){const n=e(t);return{secretKey:n,publicKey:P(n)}},getPublicKey:P,sign:I,verify:_,Point:w,utils:{randomSecretKey:e,randomPrivateKey:e,taggedHash:b,lift_x:S,pointToBytes:y,numberToBytesBE:u.numberToBytesBE,bytesToNumberBE:u.bytesToNumberBE,mod:o.mod},lengths:{secretKey:32,publicKey:32,publicKeyHasPrefix:!1,signature:64,seed:48}}})();const x=(()=>(0,i.isogenyMap)(m,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(e=>e.map(e=>BigInt(e)))))(),j=(()=>(0,c.mapToCurveSimpleSWU)(m,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:m.create(BigInt("-11"))}))();n.secp256k1_hasher=(0,i.createHasher)(n.secp256k1.Point,e=>{const{x:t,y:n}=j(m.create(e[0]));return x(t,n)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:m.ORDER,m:1,k:128,expand:"xmd",hash:s.sha256}),n.hashToCurve=n.secp256k1_hasher.hashToCurve,n.encodeToCurve=n.secp256k1_hasher.encodeToCurve}}},{package:"@noble/curves",file:"node_modules/@noble/curves/secp256k1.js"}],[2841,{"@noble/hashes/utils.js":2855},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.notImplemented=n.bitMask=n.utf8ToBytes=n.randomBytes=n.isBytes=n.hexToBytes=n.concatBytes=n.bytesToUtf8=n.bytesToHex=n.anumber=n.abytes=void 0,n.abool=function(e,t){if("boolean"!=typeof t)throw new Error(e+" boolean expected, got "+t)},n._abool2=function(e,t=""){if("boolean"!=typeof e){throw new Error((t&&`"${t}"`)+"expected boolean, got type="+typeof e)}return e},n._abytes2=function(e,t,n=""){const r=(0,s.isBytes)(e),a=e?.length,i=t!==undefined;if(!r||i&&a!==t){throw new Error((n&&`"${n}" `)+"expected Uint8Array"+(i?` of length ${t}`:"")+", got "+(r?`length=${a}`:"type="+typeof e))}return e},n.numberToHexUnpadded=o,n.hexToNumber=c,n.bytesToNumberBE=function(e){return c((0,s.bytesToHex)(e))},n.bytesToNumberLE=function(e){return(0,s.abytes)(e),c((0,s.bytesToHex)(Uint8Array.from(e).reverse()))},n.numberToBytesBE=u,n.numberToBytesLE=function(e,t){return u(e,t).reverse()},n.numberToVarBytesBE=function(e){return(0,s.hexToBytes)(o(e))},n.ensureBytes=function(e,t,n){let r;if("string"==typeof t)try{r=(0,s.hexToBytes)(t)}catch(t){throw new Error(e+" must be hex string or Uint8Array, cause: "+t)}else{if(!(0,s.isBytes)(t))throw new Error(e+" must be hex string or Uint8Array");r=Uint8Array.from(t)}const a=r.length;if("number"==typeof n&&a!==n)throw new Error(e+" of length "+n+" expected, got "+a);return r},n.equalBytes=function(e,t){if(e.length!==t.length)return!1;let n=0;for(let s=0;s<e.length;s++)n|=e[s]^t[s];return 0===n},n.copyBytes=function(e){return Uint8Array.from(e)},n.asciiToBytes=function(e){return Uint8Array.from(e,(t,n)=>{const s=t.charCodeAt(0);if(1!==t.length||s>127)throw new Error(`string contains non-ASCII character "${e[n]}" with code ${s} at position ${n}`);return s})},n.inRange=d,n.aInRange=function(e,t,n,s){if(!d(t,n,s))throw new Error("expected valid "+e+": "+n+" <= n < "+s+", got "+t)},n.bitLen=function(e){let t;for(t=0;e>a;e>>=i,t+=1);return t},n.bitGet=function(e,t){return e>>BigInt(t)&i},n.bitSet=function(e,t,n){return e|(n?i:a)<<BigInt(t)},n.createHmacDrbg=function(e,t,n){if("number"!=typeof e||e<2)throw new Error("hashLen must be a number");if("number"!=typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!=typeof n)throw new Error("hmacFn must be a function");const r=e=>new Uint8Array(e),a=e=>Uint8Array.of(e);let i=r(e),o=r(e),c=0;const u=()=>{i.fill(1),o.fill(0),c=0},l=(...e)=>n(o,i,...e),d=(e=r(0))=>{o=l(a(0),e),i=l(),0!==e.length&&(o=l(a(1),e),i=l())},f=()=>{if(c++>=1e3)throw new Error("drbg: tried 1000 values");let e=0;const n=[];for(;e<t;){i=l();const t=i.slice();n.push(t),e+=i.length}return(0,s.concatBytes)(...n)};return(e,t)=>{u(),d(e);let n=undefined;for(;!(n=t(f()));)d();return u(),n}},n.validateObject=function(e,t,n={}){const s=(t,n,s)=>{const r=f[n];if("function"!=typeof r)throw new Error("invalid validator function");const a=e[t];if(!(s&&a===undefined||r(a,e)))throw new Error("param "+String(t)+" is invalid. Expected "+n+", got "+a)};for(const[e,n]of Object.entries(t))s(e,n,!1);for(const[e,t]of Object.entries(n))s(e,t,!0);return e},n.isHash=function(e){return"function"==typeof e&&Number.isSafeInteger(e.outputLen)},n._validateObject=function(e,t,n={}){if(!e||"object"!=typeof e)throw new Error("expected valid options object");function s(t,n,s){const r=e[t];if(s&&r===undefined)return;const a=typeof r;if(a!==n||null===r)throw new Error(`param "${t}" is invalid: expected ${n}, got ${a}`)}Object.entries(t).forEach(([e,t])=>s(e,t,!1)),Object.entries(n).forEach(([e,t])=>s(e,t,!0))},n.memoized=function(e){const t=new WeakMap;return(n,...s)=>{const r=t.get(n);if(r!==undefined)return r;const a=e(n,...s);return t.set(n,a),a}};
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const s=e("@noble/hashes/utils.js");var r=e("@noble/hashes/utils.js");Object.defineProperty(n,"abytes",{enumerable:!0,get:function(){return r.abytes}}),Object.defineProperty(n,"anumber",{enumerable:!0,get:function(){return r.anumber}}),Object.defineProperty(n,"bytesToHex",{enumerable:!0,get:function(){return r.bytesToHex}}),Object.defineProperty(n,"bytesToUtf8",{enumerable:!0,get:function(){return r.bytesToUtf8}}),Object.defineProperty(n,"concatBytes",{enumerable:!0,get:function(){return r.concatBytes}}),Object.defineProperty(n,"hexToBytes",{enumerable:!0,get:function(){return r.hexToBytes}}),Object.defineProperty(n,"isBytes",{enumerable:!0,get:function(){return r.isBytes}}),Object.defineProperty(n,"randomBytes",{enumerable:!0,get:function(){return r.randomBytes}}),Object.defineProperty(n,"utf8ToBytes",{enumerable:!0,get:function(){return r.utf8ToBytes}});const a=BigInt(0),i=BigInt(1);function o(e){const t=e.toString(16);return 1&t.length?"0"+t:t}function c(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return""===e?a:BigInt("0x"+e)}function u(e,t){return(0,s.hexToBytes)(e.toString(16).padStart(2*t,"0"))}const l=e=>"bigint"==typeof e&&a<=e;function d(e,t,n){return l(e)&&l(t)&&l(n)&&t<=e&&e<n}n.bitMask=e=>(i<<BigInt(e))-i;const f={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||(0,s.isBytes)(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};n.notImplemented=()=>{throw new Error("not implemented")}}}},{package:"@noble/curves",file:"node_modules/@noble/curves/utils.js"}],[2842,{"./utils.js":2855},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SHA512_IV=n.SHA384_IV=n.SHA224_IV=n.SHA256_IV=n.HashMD=void 0,n.setBigUint64=r,n.Chi=function(e,t,n){return e&t^~e&n},n.Maj=function(e,t,n){return e&t^e&n^t&n};const s=e("./utils.js");function r(e,t,n,s){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,s);const r=BigInt(32),a=BigInt(4294967295),i=Number(n>>r&a),o=Number(n&a),c=s?4:0,u=s?0:4;e.setUint32(t+c,i,s),e.setUint32(t+u,o,s)}class a extends s.Hash{constructor(e,t,n,r){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=r,this.buffer=new Uint8Array(e),this.view=(0,s.createView)(this.buffer)}update(e){(0,s.aexists)(this),e=(0,s.toBytes)(e),(0,s.abytes)(e);const{view:t,buffer:n,blockLen:r}=this,a=e.length;for(let i=0;i<a;){const o=Math.min(r-this.pos,a-i);if(o===r){const t=(0,s.createView)(e);for(;r<=a-i;i+=r)this.process(t,i);continue}n.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===r&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){(0,s.aexists)(this),(0,s.aoutput)(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:a,isLE:i}=this;let{pos:o}=this;t[o++]=128,(0,s.clean)(this.buffer.subarray(o)),this.padOffset>a-o&&(this.process(n,0),o=0);for(let e=o;e<a;e++)t[e]=0;r(n,a-8,BigInt(8*this.length),i),this.process(n,0);const c=(0,s.createView)(e),u=this.outputLen;if(u%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=u/4,d=this.get();if(l>d.length)throw new Error("_sha2: outputLen bigger than state");for(let e=0;e<l;e++)c.setUint32(4*e,d[e],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:s,finished:r,destroyed:a,pos:i}=this;return e.destroyed=a,e.finished=r,e.length=s,e.pos=i,s%t&&e.buffer.set(n),e}clone(){return this._cloneInto()}}n.HashMD=a,n.SHA256_IV=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),n.SHA224_IV=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]),n.SHA384_IV=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),n.SHA512_IV=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209])}}},{package:"@noble/hashes",file:"node_modules/@noble/hashes/_md.js"}],[2843,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.toBig=n.shrSL=n.shrSH=n.rotrSL=n.rotrSH=n.rotrBL=n.rotrBH=n.rotr32L=n.rotr32H=n.rotlSL=n.rotlSH=n.rotlBL=n.rotlBH=n.add5L=n.add5H=n.add4L=n.add4H=n.add3L=n.add3H=void 0,n.add=T,n.fromBig=a,n.split=i;const s=BigInt(2**32-1),r=BigInt(32);function a(e,t=!1){return t?{h:Number(e&s),l:Number(e>>r&s)}:{h:0|Number(e>>r&s),l:0|Number(e&s)}}function i(e,t=!1){const n=e.length;let s=new Uint32Array(n),r=new Uint32Array(n);for(let i=0;i<n;i++){const{h:n,l:o}=a(e[i],t);[s[i],r[i]]=[n,o]}return[s,r]}const o=(e,t)=>BigInt(e>>>0)<<r|BigInt(t>>>0);n.toBig=o;const c=(e,t,n)=>e>>>n;n.shrSH=c;const u=(e,t,n)=>e<<32-n|t>>>n;n.shrSL=u;const l=(e,t,n)=>e>>>n|t<<32-n;n.rotrSH=l;const d=(e,t,n)=>e<<32-n|t>>>n;n.rotrSL=d;const f=(e,t,n)=>e<<64-n|t>>>n-32;n.rotrBH=f;const h=(e,t,n)=>e>>>n-32|t<<64-n;n.rotrBL=h;const p=(e,t)=>t;n.rotr32H=p;const m=(e,t)=>e;n.rotr32L=m;const g=(e,t,n)=>e<<n|t>>>32-n;n.rotlSH=g;const b=(e,t,n)=>t<<n|e>>>32-n;n.rotlSL=b;const y=(e,t,n)=>t<<n-32|e>>>64-n;n.rotlBH=y;const w=(e,t,n)=>e<<n-32|t>>>64-n;function T(e,t,n,s){const r=(t>>>0)+(s>>>0);return{h:e+n+(r/2**32|0)|0,l:0|r}}n.rotlBL=w;const E=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0);n.add3L=E;const S=(e,t,n,s)=>t+n+s+(e/2**32|0)|0;n.add3H=S;const v=(e,t,n,s)=>(e>>>0)+(t>>>0)+(n>>>0)+(s>>>0);n.add4L=v;const k=(e,t,n,s,r)=>t+n+s+r+(e/2**32|0)|0;n.add4H=k;const P=(e,t,n,s,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(s>>>0)+(r>>>0);n.add5L=P;const I=(e,t,n,s,r,a)=>t+n+s+r+a+(e/2**32|0)|0;n.add5H=I;const _={fromBig:a,split:i,toBig:o,shrSH:c,shrSL:u,rotrSH:l,rotrSL:d,rotrBH:f,rotrBL:h,rotr32H:p,rotr32L:m,rotlSH:g,rotlSL:b,rotlBH:y,rotlBL:w,add:T,add3L:E,add3H:S,add4L:v,add4H:k,add5H:I,add5L:P};n.default=_}}},{package:"@noble/hashes",file:"node_modules/@noble/hashes/_u64.js"}],[2844,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.crypto=void 0,n.crypto="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:undefined}}},{package:"@noble/hashes",file:"node_modules/@noble/hashes/crypto.js"}],[2845,{"./hmac.js":2846,"./utils.js":2855},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.hkdf=void 0,n.extract=a,n.expand=c;const s=e("./hmac.js"),r=e("./utils.js");function a(e,t,n){return(0,r.ahash)(e),n===undefined&&(n=new Uint8Array(e.outputLen)),(0,s.hmac)(e,(0,r.toBytes)(n),(0,r.toBytes)(t))}const i=Uint8Array.from([0]),o=Uint8Array.of();function c(e,t,n,a=32){(0,r.ahash)(e),(0,r.anumber)(a);const c=e.outputLen;if(a>255*c)throw new Error("Length should be <= 255*HashLen");const u=Math.ceil(a/c);n===undefined&&(n=o);const l=new Uint8Array(u*c),d=s.hmac.create(e,t),f=d._cloneInto(),h=new Uint8Array(d.outputLen);for(let e=0;e<u;e++)i[0]=e+1,f.update(0===e?o:h).update(n).update(i).digestInto(h),l.set(h,c*e),d._cloneInto(f);return d.destroy(),f.destroy(),(0,r.clean)(h,i),l.slice(0,a)}n.hkdf=(e,t,n,s,r)=>c(e,a(e,t,n),s,r)}}},{package:"@noble/hashes",file:"node_modules/@noble/hashes/hkdf.js"}]],[],{});