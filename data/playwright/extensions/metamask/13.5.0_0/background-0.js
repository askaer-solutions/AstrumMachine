LavaPack.loadBundle([[10,{"../../../shared/constants/network":5433,"../../../shared/modules/selectors/networks":5547,"../controllers/account-tracker-controller":156,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.AccountTrackerControllerInit=void 0;var s,n=e("@metamask/utils"),i=e("../../../shared/modules/selectors/networks"),a=e("../../../shared/constants/network"),o=(s=e("../controllers/account-tracker-controller"))&&s.__esModule?s:{default:s};r.AccountTrackerControllerInit=({controllerMessenger:e,initMessenger:t})=>{const{provider:r,blockTracker:s}=t.call("NetworkController:getSelectedNetworkClient")??{};(0,n.assert)(r,"Provider is required to initialize AccountTrackerController."),(0,n.assert)(s,"Block tracker is required to initialize AccountTrackerController.");return{persistedStateKey:null,memStateKey:null,controller:new o.default({state:{accounts:{}},messenger:e,provider:r,blockTracker:s,getNetworkIdentifier:e=>{const r=t.call("NetworkController:getState"),s=e??(0,i.getProviderConfig)({metamask:r});return s.type===a.NETWORK_TYPES.RPC&&s.rpcUrl?s.rpcUrl:s.type},accountsApiChainIds:()=>{var e;const r=t.call("RemoteFeatureFlagController:getState"),s=null==r||null===(e=r.remoteFeatureFlags)||void 0===e?void 0:e.assetsAccountApiBalances;return Array.isArray(s)?s:[]}})}}}}},{package:"$root$",file:"app/scripts/controller-init/account-tracker-controller-init.ts"}],[100,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getSubjectMetadataControllerMessenger=function(e){return e.getRestricted({name:"SubjectMetadataController",allowedActions:["PermissionController:hasPermissions"],allowedEvents:[]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/subject-metadata-controller-messenger.ts"}],[101,{"./subscription-controller-messenger":102,"./subscription-service-messenger":103},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"getSubscriptionControllerInitMessenger",{enumerable:!0,get:function(){return s.getSubscriptionControllerInitMessenger}}),Object.defineProperty(r,"getSubscriptionControllerMessenger",{enumerable:!0,get:function(){return s.getSubscriptionControllerMessenger}}),Object.defineProperty(r,"getSubscriptionServiceMessenger",{enumerable:!0,get:function(){return n.getSubscriptionServiceMessenger}});var s=e("./subscription-controller-messenger"),n=e("./subscription-service-messenger")}}},{package:"$root$",file:"app/scripts/controller-init/messengers/subscription/index.ts"}],[102,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getSubscriptionControllerInitMessenger=function(e){return e.getRestricted({name:"SubscriptionControllerInit",allowedEvents:[],allowedActions:["AuthenticationController:getBearerToken"]})},r.getSubscriptionControllerMessenger=function(e){return e.getRestricted({name:"SubscriptionController",allowedEvents:["AuthenticationController:stateChange"],allowedActions:["AuthenticationController:getBearerToken","AuthenticationController:performSignOut"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/subscription/subscription-controller-messenger.ts"}],[103,{"../../../services/subscription/types":516},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getSubscriptionServiceMessenger=function(e){return e.getRestricted({name:s.SERVICE_NAME,allowedActions:["SubscriptionController:getPricing","SubscriptionController:getSubscriptions","SubscriptionController:startShieldSubscriptionWithCard","SubscriptionController:updatePaymentMethod","SubscriptionController:getCryptoApproveTransactionParams","SubscriptionController:getBillingPortalUrl"],allowedEvents:[]})};var s=e("../../../services/subscription/types")}}},{package:"$root$",file:"app/scripts/controller-init/messengers/subscription/subscription-service-messenger.ts"}],[104,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getSwapsControllerInitMessenger=function(e){return e.getRestricted({name:"SwapsControllerInit",allowedActions:["MetaMetricsController:trackEvent","NetworkController:getState"],allowedEvents:[]})},r.getSwapsControllerMessenger=function(e){return e.getRestricted({name:"SwapsController",allowedActions:["NetworkController:getNetworkClientById","NetworkController:getState","TokenRatesController:getState"],allowedEvents:[]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/swaps-controller-messenger.ts"}],[105,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getTokenBalancesControllerInitMessenger=function(e){return e.getRestricted({name:"TokenBalancesControllerInit",allowedActions:["PreferencesController:getState","RemoteFeatureFlagController:getState"],allowedEvents:[]})},r.getTokenBalancesControllerMessenger=function(e){return e.getRestricted({name:"TokenBalancesController",allowedActions:["NetworkController:getState","NetworkController:getNetworkClientById","TokensController:getState","PreferencesController:getState","AccountsController:getSelectedAccount","AccountsController:listAccounts","AccountTrackerController:getState","AccountTrackerController:updateNativeBalances","AccountTrackerController:updateStakedBalances"],allowedEvents:["PreferencesController:stateChange","TokensController:stateChange","NetworkController:stateChange","KeyringController:accountRemoved"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/token-balances-controller-messenger.ts"}],[106,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getTokenDetectionControllerInitMessenger=function(e){return e.getRestricted({name:"TokenDetectionControllerInit",allowedActions:["AssetsContractController:getBalancesInSingleCall","MetaMetricsController:trackEvent","PreferencesController:getState"],allowedEvents:[]})},r.getTokenDetectionControllerMessenger=function(e){return e.getRestricted({name:"TokenDetectionController",allowedActions:["AccountsController:getAccount","AccountsController:getSelectedAccount","KeyringController:getState","NetworkController:getNetworkClientById","NetworkController:getNetworkConfigurationByNetworkClientId","NetworkController:getState","PreferencesController:getState","TokenListController:getState","TokensController:getState","TokensController:addDetectedTokens","TokensController:addTokens","NetworkController:findNetworkClientIdByChainId"],allowedEvents:["AccountsController:selectedEvmAccountChange","KeyringController:lock","KeyringController:unlock","NetworkController:networkDidChange","PreferencesController:stateChange","TokenListController:stateChange","TransactionController:transactionConfirmed"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/token-detection-controller-messenger.ts"}],[107,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getTokenListControllerInitMessenger=function(e){return e.getRestricted({name:"TokenListControllerInit",allowedActions:["NetworkController:getNetworkClientById","NetworkController:getState","PreferencesController:getState"],allowedEvents:["PreferencesController:stateChange"]})},r.getTokenListControllerMessenger=function(e){return e.getRestricted({name:"TokenListController",allowedActions:["NetworkController:getNetworkClientById"],allowedEvents:["NetworkController:stateChange"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/token-list-controller-messenger.ts"}],[108,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getTokensControllerInitMessenger=function(e){return e.getRestricted({name:"TokensControllerInit",allowedActions:["NetworkController:getNetworkClientById","NetworkController:getSelectedNetworkClient","NetworkController:getState"],allowedEvents:[]})},r.getTokensControllerMessenger=function(e){return e.getRestricted({name:"TokensController",allowedActions:["AccountsController:getAccount","AccountsController:getSelectedAccount","AccountsController:listAccounts","ApprovalController:addRequest","NetworkController:getNetworkClientById"],allowedEvents:["AccountsController:selectedEvmAccountChange","KeyringController:accountRemoved","NetworkController:networkDidChange","NetworkController:stateChange","PreferencesController:stateChange","TokenListController:stateChange"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/tokens-controller-messenger.ts"}],[109,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getTransactionControllerInitMessenger=function(e){return e.getRestricted({name:"TransactionControllerInit",allowedEvents:["SmartTransactionsController:smartTransaction","TransactionController:transactionApproved","TransactionController:transactionConfirmed","TransactionController:transactionDropped","TransactionController:transactionFailed","TransactionController:transactionNewSwapApproval","TransactionController:transactionNewSwap","TransactionController:transactionRejected","TransactionController:transactionSubmitted","TransactionController:postTransactionBalanceUpdated","TransactionController:unapprovedTransactionAdded"],allowedActions:["ApprovalController:acceptRequest","ApprovalController:addRequest","ApprovalController:endFlow","ApprovalController:startFlow","ApprovalController:updateRequestState","AppStateController:getState","AuthenticationController:getBearerToken","DelegationController:signDelegation","InstitutionalSnapController:beforeCheckPendingTransactionHook","InstitutionalSnapController:publishHook","KeyringController:signEip7702Authorization","KeyringController:signTypedMessage","NetworkController:getEIP1559Compatibility","RemoteFeatureFlagController:getState","SwapsController:setApproveTxId","SwapsController:setTradeTxId","TransactionController:estimateGas","TransactionController:getState"]})},r.getTransactionControllerMessenger=function(e){return e.getRestricted({name:"TransactionController",allowedActions:["AccountsController:getSelectedAccount","AccountsController:getState","ApprovalController:addRequest","KeyringController:signEip7702Authorization","NetworkController:findNetworkClientIdByChainId","NetworkController:getNetworkClientById","RemoteFeatureFlagController:getState"],allowedEvents:["NetworkController:stateChange"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/transaction-controller-messenger.ts"}],[11,{"../../../../shared/constants/metametrics":5430,"../../../../shared/lib/trace":5517,"@metamask/account-tree-controller":1107},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.AccountTreeControllerInit=void 0;var s=e("@metamask/account-tree-controller"),n=e("../../../../shared/lib/trace"),i=e("../../../../shared/constants/metametrics");r.AccountTreeControllerInit=({controllerMessenger:e,persistedState:t,initMessenger:r})=>({controller:new s.AccountTreeController({messenger:e,state:t.AccountTreeController,config:{trace:n.trace,backupAndSync:{onBackupAndSyncEvent:e=>{r.call("MetaMetricsController:trackEvent",{category:i.MetaMetricsEventCategory.BackupAndSync,event:i.MetaMetricsEventName.ProfileActivityUpdated,properties:{event:e}})}}}})})}}},{package:"$root$",file:"app/scripts/controller-init/accounts/account-tree-controller-init.ts"}],[110,{"../../../shared/lib/sentry":5511,"../controllers/metametrics-controller":163,"../lib/segment":253},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.MetaMetricsControllerInit=void 0;var s,n=(s=e("../controllers/metametrics-controller"))&&s.__esModule?s:{default:s},i=e("../lib/segment"),a=e("../../../shared/lib/sentry");r.MetaMetricsControllerInit=({controllerMessenger:e,extension:t,persistedState:r})=>({controller:new n.default({state:r.MetaMetricsController,messenger:e,version:"13.5.0",environment:"production",segment:i.segment,extension:t,captureException:a.captureException})})}}},{package:"$root$",file:"app/scripts/controller-init/metametrics-controller-init.ts"}],[111,{"./multichain-account-service-init":112,"./multichain-assets-controller-init":113,"./multichain-balances-controller-init":114,"./multichain-network-controller-init":115,"./multichain-rates-assets-controller-init":117,"./multichain-transactions-controller-init":118},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"MultichainAccountServiceInit",{enumerable:!0,get:function(){return s.MultichainAccountServiceInit}}),Object.defineProperty(r,"MultichainAssetsControllerInit",{enumerable:!0,get:function(){return n.MultichainAssetsControllerInit}}),Object.defineProperty(r,"MultichainAssetsRatesControllerInit",{enumerable:!0,get:function(){return c.MultichainAssetsRatesControllerInit}}),Object.defineProperty(r,"MultichainBalancesControllerInit",{enumerable:!0,get:function(){return i.MultichainBalancesControllerInit}}),Object.defineProperty(r,"MultichainNetworkControllerInit",{enumerable:!0,get:function(){return o.MultichainNetworkControllerInit}}),Object.defineProperty(r,"MultichainTransactionsControllerInit",{enumerable:!0,get:function(){return a.MultichainTransactionsControllerInit}});var s=e("./multichain-account-service-init"),n=e("./multichain-assets-controller-init"),i=e("./multichain-balances-controller-init"),a=e("./multichain-transactions-controller-init"),o=e("./multichain-network-controller-init"),c=e("./multichain-rates-assets-controller-init")}}},{package:"$root$",file:"app/scripts/controller-init/multichain/index.ts"}],[1116,{"@metamask/base-controller":1222,"@metamask/controller-utils":1301},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var s,n,i=this&&this.__classPrivateFieldGet||function(e,t,r,s){if("a"===r&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?s:"a"===r?s.call(e):s?s.value:t.get(e)};Object.defineProperty(r,"__esModule",{value:!0}),r.AddressBookController=r.getDefaultAddressBookControllerState=r.controllerName=r.AddressType=void 0;const a=e("@metamask/base-controller"),o=e("@metamask/controller-utils");var c;!function(e){e.externallyOwnedAccounts="EXTERNALLY_OWNED_ACCOUNTS",e.contractAccounts="CONTRACT_ACCOUNTS",e.nonAccounts="NON_ACCOUNTS"}(c||(r.AddressType=c={})),r.controllerName="AddressBookController";const l={addressBook:{persist:!0,anonymous:!1}};r.getDefaultAddressBookControllerState=()=>({addressBook:{}});class u extends a.BaseController{constructor({messenger:e,state:t}){const a={...(0,r.getDefaultAddressBookControllerState)(),...t};super({messenger:e,metadata:l,name:r.controllerName,state:a}),s.add(this),i(this,s,"m",n).call(this)}list(){const{addressBook:e}=this.state;return Object.keys(e).reduce((t,r)=>{const s=r;return[...t,...Object.values(e[s])]},[])}clear(){this.update(e=>{e.addressBook={}})}delete(e,t){if(t=(0,o.toChecksumHexAddress)(t),!([e,t].every(e=>(0,o.isSafeDynamicKey)(e))&&(0,o.isValidHexAddress)(t)&&this.state.addressBook[e]&&this.state.addressBook[e][t]))return!1;const r={...this.state.addressBook[e][t]};return this.update(r=>{const s=r.addressBook[e];s?.[t]&&(delete s[t],0===Object.keys(s).length&&delete r.addressBook[e])}),"*"!==String(e)&&this.messagingSystem.publish("AddressBookController:contactDeleted",r),!0}set(e,t,r=(0,o.toHex)(1),s="",n){if(e=(0,o.toChecksumHexAddress)(e),!(0,o.isValidHexAddress)(e))return!1;const i={address:e,chainId:r,isEns:!1,memo:s,name:t,addressType:n,lastUpdatedAt:Date.now()},a=(0,o.normalizeEnsName)(t);return a&&(i.name=a,i.isEns=!0),this.update(t=>{t.addressBook={...this.state.addressBook,[r]:{...this.state.addressBook[r],[e]:i}}}),"*"!==String(r)&&this.messagingSystem.publish("AddressBookController:contactUpdated",i),!0}}r.AddressBookController=u,s=new WeakSet,n=function(){this.messagingSystem.registerActionHandler(`${r.controllerName}:list`,this.list.bind(this)),this.messagingSystem.registerActionHandler(`${r.controllerName}:set`,this.set.bind(this)),this.messagingSystem.registerActionHandler(`${r.controllerName}:delete`,this.delete.bind(this))},r.default=u}}},{package:"@metamask/address-book-controller",file:"node_modules/@metamask/address-book-controller/dist/AddressBookController.cjs"}],[1117,{"./AddressBookController.cjs":1116},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.AddressBookController=r.getDefaultAddressBookControllerState=void 0;var s=e("./AddressBookController.cjs");Object.defineProperty(r,"getDefaultAddressBookControllerState",{enumerable:!0,get:function(){return s.getDefaultAddressBookControllerState}}),Object.defineProperty(r,"AddressBookController",{enumerable:!0,get:function(){return s.AddressBookController}})}}},{package:"@metamask/address-book-controller",file:"node_modules/@metamask/address-book-controller/dist/index.cjs"}],[1118,{"@metamask/base-controller":1222},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var s,n,i=this&&this.__classPrivateFieldGet||function(e,t,r,s){if("a"===r&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?s:"a"===r?s.call(e):s?s.value:t.get(e)};Object.defineProperty(r,"__esModule",{value:!0}),r.AnnouncementController=void 0;const a=e("@metamask/base-controller"),o={announcements:{}},c={announcements:{persist:!0,anonymous:!0}};class l extends a.BaseController{constructor({messenger:e,state:t,allAnnouncements:r}){const a={...o,...t};super({messenger:e,metadata:c,name:"AnnouncementController",state:a}),s.add(this),i(this,s,"m",n).call(this,r)}resetViewed(){this.update(({announcements:e})=>{for(const t of Object.values(e))t.isShown=!1})}updateViewed(e){this.update(({announcements:t})=>{for(const r of Object.keys(e).map(Number))t[r].isShown=e[r]})}}r.AnnouncementController=l,s=new WeakSet,n=function(e){this.update(t=>{Object.values(e).forEach(e=>{t.announcements[e.id]=t.announcements[e.id]??{...e,isShown:!1}})})}}}},{package:"@metamask/announcement-controller",file:"node_modules/@metamask/announcement-controller/dist/AnnouncementController.cjs"}],[1119,{"./AnnouncementController.cjs":1118},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.AnnouncementController=void 0;var s=e("./AnnouncementController.cjs");Object.defineProperty(r,"AnnouncementController",{enumerable:!0,get:function(){return s.AnnouncementController}})}}},{package:"@metamask/announcement-controller",file:"node_modules/@metamask/announcement-controller/dist/index.cjs"}],[112,{"../../../../shared/lib/multichain-accounts/remote-feature-flag":5504,"../../lib/util":290,"@metamask/multichain-account-service":2068},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.MultichainAccountServiceInit=void 0;var s=e("@metamask/multichain-account-service"),n=e("../../lib/util"),i=e("../../../../shared/lib/multichain-accounts/remote-feature-flag");r.MultichainAccountServiceInit=({controllerMessenger:e,initMessenger:t})=>{const r=new s.MultichainAccountService({messenger:e}),a=t.call("PreferencesController:getState");return t.subscribe("PreferencesController:stateChange",(0,n.previousValueComparator)((e,s)=>{const{useExternalServices:n}=e,{useExternalServices:a}=s;if(n!==a){const{remoteFeatureFlags:e}=t.call("RemoteFeatureFlagController:getState"),s=null==e?void 0:e.enableMultichainAccountsState2;(0,i.isMultichainAccountsFeatureEnabled)(s,i.FEATURE_VERSION_2)&&r.setBasicFunctionality(a).catch(e=>{console.error("Failed to set basic functionality on MultichainAccountService:",e)})}return!0},a)),{memStateKey:null,persistedStateKey:null,controller:r}}}}},{package:"$root$",file:"app/scripts/controller-init/multichain/multichain-account-service-init.ts"}],[113,{"@metamask/assets-controllers":1157},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.MultichainAssetsControllerInit=void 0;var s=e("@metamask/assets-controllers");r.MultichainAssetsControllerInit=({controllerMessenger:e,persistedState:t})=>({controller:new s.MultichainAssetsController({messenger:e,state:t.MultichainAssetsController})})}}},{package:"$root$",file:"app/scripts/controller-init/multichain/multichain-assets-controller-init.ts"}],[114,{"@metamask/assets-controllers":1157},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.MultichainBalancesControllerInit=void 0;var s=e("@metamask/assets-controllers");r.MultichainBalancesControllerInit=({controllerMessenger:e,persistedState:t})=>({controller:new s.MultichainBalancesController({messenger:e,state:t.MultichainBalancesController})})}}},{package:"$root$",file:"app/scripts/controller-init/multichain/multichain-balances-controller-init.ts"}],[115,{"./multichain-network-service-init":116,"@metamask/multichain-network-controller":2095},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.MultichainNetworkControllerInit=void 0;var s=e("@metamask/multichain-network-controller"),n=e("./multichain-network-service-init");r.MultichainNetworkControllerInit=({controllerMessenger:e,persistedState:t})=>{const r=(0,n.MultichainNetworkServiceInit)();return{controller:new s.MultichainNetworkController({messenger:e,state:t.MultichainNetworkController,networkService:r})}}}}},{package:"$root$",file:"app/scripts/controller-init/multichain/multichain-network-controller-init.ts"}],[116,{"@metamask/multichain-network-controller":2095},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.MultichainNetworkServiceInit=void 0;var s=e("@metamask/multichain-network-controller");r.MultichainNetworkServiceInit=()=>new s.MultichainNetworkService({fetch:window.fetch.bind(window)})}}},{package:"$root$",file:"app/scripts/controller-init/multichain/multichain-network-service-init.ts"}],[117,{"@metamask/assets-controllers":1157},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.MultichainAssetsRatesControllerInit=void 0;var s=e("@metamask/assets-controllers");r.MultichainAssetsRatesControllerInit=({controllerMessenger:e,persistedState:t})=>({controller:new s.MultichainAssetsRatesController({messenger:e,state:t.MultichainAssetsRatesController,interval:18e4})})}}},{package:"$root$",file:"app/scripts/controller-init/multichain/multichain-rates-assets-controller-init.ts"}],[118,{"@metamask/multichain-transactions-controller":2100},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.MultichainTransactionsControllerInit=void 0;var s=e("@metamask/multichain-transactions-controller");r.MultichainTransactionsControllerInit=({controllerMessenger:e,persistedState:t})=>({controller:new s.MultichainTransactionsController({messenger:e,state:t.MultichainTransactionsController})})}}},{package:"$root$",file:"app/scripts/controller-init/multichain/multichain-transactions-controller-init.ts"}],[119,{"../../../shared/constants/network":5433,"../../../shared/constants/time":5449,"../../../shared/lib/network-utils":5508,"../../../shared/lib/sentry":5511,"../lib/network-controller/messenger-action-handlers":221,"@metamask/controller-utils":1301,"@metamask/network-controller":2168,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.NetworkControllerInit=r.ADDITIONAL_DEFAULT_NETWORKS=void 0;var s=e("@metamask/network-controller"),n=e("@metamask/controller-utils"),i=e("@metamask/utils"),a=e("../../../shared/constants/time"),o=e("../../../shared/lib/network-utils"),c=e("../lib/network-controller/messenger-action-handlers"),l=e("../../../shared/constants/network"),u=e("../../../shared/lib/sentry");const d=r.ADDITIONAL_DEFAULT_NETWORKS=[n.ChainId["megaeth-testnet"],n.ChainId["monad-testnet"]];r.NetworkControllerInit=({controllerMessenger:e,infuraProjectId:t,initMessenger:r,persistedState:p})=>{const h=function(e){let t=e;if(!t){t=(0,s.getDefaultNetworkControllerState)(d);const e=t.networkConfigurationsByChainId??{};let r;Object.values(e).forEach(e=>{const t=e.rpcEndpoints[0].networkClientId;(0,i.hasProperty)(n.BlockExplorerUrl,t)&&(e.blockExplorerUrls=[n.BlockExplorerUrl[t]]),e.defaultBlockExplorerUrlIndex=0}),e[l.CHAIN_IDS.MAINNET].rpcEndpoints[0].failoverUrls=(0,l.getFailoverUrlsForInfuraNetwork)("ethereum-mainnet"),e[l.CHAIN_IDS.LINEA_MAINNET].rpcEndpoints[0].failoverUrls=(0,l.getFailoverUrlsForInfuraNetwork)("linea-mainnet"),e[l.CHAIN_IDS.BASE].rpcEndpoints[0].failoverUrls=(0,l.getFailoverUrlsForInfuraNetwork)("base-mainnet"),e[l.CHAIN_IDS.MAINNET].name="Ethereum",e[l.CHAIN_IDS.LINEA_MAINNET].name="Linea",e[l.CHAIN_IDS.BASE].name="Base",r=e[l.CHAIN_IDS.MAINNET],t.selectedNetworkClientId=r.rpcEndpoints[r.defaultRpcEndpointIndex].networkClientId}return t.networkConfigurationsByChainId&&!Object.values(t.networkConfigurationsByChainId).flatMap(e=>e.rpcEndpoints.map(e=>e.networkClientId)).includes(t.selectedNetworkClientId)&&((0,u.captureException)(new Error(`NetworkController state is invalid: \`selectedNetworkClientId\` '${t.selectedNetworkClientId}' does not refer to an RPC endpoint within a network configuration`)),t.selectedNetworkClientId=t.networkConfigurationsByChainId[l.CHAIN_IDS.MAINNET].rpcEndpoints[0].networkClientId),t}(p.NetworkController),m=new s.NetworkController({messenger:e,state:h,infuraProjectId:t,getBlockTrackerOptions:()=>({pollingInterval:20*a.SECOND,retryTimeout:20*a.SECOND}),getRpcServiceOptions:e=>{const t={fetch:globalThis.fetch.bind(globalThis),btoa:globalThis.btoa.bind(globalThis)};return(0,o.getIsQuicknodeEndpointUrl)(e)?{...t,policyOptions:{maxRetries:4,maxConsecutiveFailures:70}}:{...t,policyOptions:{maxRetries:4,maxConsecutiveFailures:35}}},additionalDefaultNetworks:d});return r.subscribe("NetworkController:rpcEndpointUnavailable",async({chainId:e,endpointUrl:s,error:n})=>{(0,c.onRpcEndpointUnavailable)({chainId:e,endpointUrl:s,error:n,infuraProjectId:t,trackEvent:r.call.bind(r,"MetaMetricsController:trackEvent"),metaMetricsId:r.call("MetaMetricsController:getMetaMetricsId")})}),r.subscribe("NetworkController:rpcEndpointDegraded",async({chainId:e,endpointUrl:s,error:n})=>{(0,c.onRpcEndpointDegraded)({chainId:e,endpointUrl:s,error:n,infuraProjectId:t,trackEvent:r.call.bind(r,"MetaMetricsController:trackEvent"),metaMetricsId:r.call("MetaMetricsController:getMetaMetricsId")})}),m.initializeProvider(),{controller:m}}}}},{package:"$root$",file:"app/scripts/controller-init/network-controller-init.ts"}],[12,{"../../lib/snap-keyring/snap-keyring":260},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.SnapKeyringBuilderInit=void 0;var s=e("../../lib/snap-keyring/snap-keyring");r.SnapKeyringBuilderInit=({controllerMessenger:e,initMessenger:t,removeAccount:r})=>({persistedStateKey:null,memStateKey:null,controller:(0,s.snapKeyringBuilder)(e,{persistKeyringHelper:async()=>{await t.call("KeyringController:persistAllKeyrings"),await t.call("AccountsController:updateAccounts")},removeAccountHelper:async e=>{await r(e)},trackEvent:t.call.bind(t,"MetaMetricsController:trackEvent")})})}}},{package:"$root$",file:"app/scripts/controller-init/accounts/snap-keyring-builder-init.ts"}],[120,{"@metamask/notification-services-controller/notification-services":2211},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.NotificationServicesControllerInit=void 0;var s=e("@metamask/notification-services-controller/notification-services");r.NotificationServicesControllerInit=({controllerMessenger:e,persistedState:t})=>({controller:new s.Controller({messenger:e,state:t.NotificationServicesController,env:{featureAnnouncements:{platform:"extension",spaceId:"jdkgyfmyd9sw",accessToken:"mAYNB_k65snv4AXW4o8ksZN8BwWDQF9702HKV7yBDZI"}}})})}}},{package:"$root$",file:"app/scripts/controller-init/notifications/notification-services-controller-init.ts"}],[121,{"../../../../shared/modules/mv3.utils":5538,"../../controllers/push-notifications":177,"@metamask/notification-services-controller/push-services":2230,"@metamask/notification-services-controller/push-services/web":2238},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.NotificationServicesPushControllerInit=void 0;var s=e("@metamask/notification-services-controller/push-services"),n=e("@metamask/notification-services-controller/push-services/web"),i=e("../../../../shared/modules/mv3.utils"),a=e("../../controllers/push-notifications");r.NotificationServicesPushControllerInit=({controllerMessenger:e,persistedState:t})=>({controller:new s.Controller({messenger:e,state:{...s.defaultState,...t.NotificationServicesPushController},env:{apiKey:"AIzaSyAA6MJdRkQ00zNh_moTLwxCSxcg3vznbBM",authDomain:"notifications-faf39.firebaseapp.com",storageBucket:"notifications-faf39.appspot.com",projectId:"notifications-faf39",messagingSenderId:"824598429541",appId:"1:824598429541:web:3016d3c90f1f19a6beab8c",measurementId:"G-1FGDTTCWX5",vapidKey:"BBbjhCfHvwIqRsUrBvpfx0viLJIzWHp-beyw8-I124jeZlhNGDOegS_0_I029fFb2stzRuaNkCdTAf9F3I2m3wc"},config:{isPushFeatureEnabled:i.isManifestV3&&!0,platform:"extension",pushService:{createRegToken:n.createRegToken,deleteRegToken:n.deleteRegToken,subscribeToPushNotifications:(0,n.createSubscribeToPushNotifications)({messenger:e,onReceivedHandler:a.onPushNotificationReceived,onClickHandler:a.onPushNotificationClicked})}}})})}}},{package:"$root$",file:"app/scripts/controller-init/notifications/notification-services-push-controller-init.ts"}],[122,{"../controllers/onboarding":166},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.OnboardingControllerInit=void 0;var s,n=(s=e("../controllers/onboarding"))&&s.__esModule?s:{default:s};r.OnboardingControllerInit=({controllerMessenger:e,persistedState:t})=>({controller:new n.default({state:t.OnboardingController,messenger:e})})}}},{package:"$root$",file:"app/scripts/controller-init/onboarding-controller-init.ts"}],[123,{"../controllers/permissions":170,"../controllers/permissions/snaps/specifications":172,"@metamask/permission-controller":2260},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.PermissionControllerInit=void 0;var s=e("@metamask/permission-controller"),n=e("../controllers/permissions"),i=e("../controllers/permissions/snaps/specifications");r.PermissionControllerInit=({controllerMessenger:e,persistedState:t,initMessenger:r,getController:a})=>{const o=a("ApprovalController"),c=a("KeyringController");return{controller:new s.PermissionController({state:t.PermissionController,messenger:e,caveatSpecifications:(0,n.getCaveatSpecifications)({listAccounts:r.call.bind(r,"AccountsController:listAccounts"),findNetworkClientIdByChainId:r.call.bind(r,"NetworkController:findNetworkClientIdByChainId"),isNonEvmScopeSupported:r.call.bind(r,"MultichainRouter:isSupportedScope"),getNonEvmAccountAddresses:r.call.bind(r,"MultichainRouter:getSupportedAccounts")}),permissionSpecifications:{...(0,n.getPermissionSpecifications)(),...(0,i.getSnapPermissionSpecifications)(r,{addAndShowApprovalRequest:o.addAndShowApprovalRequest.bind(o),addNewKeyring:c.addNewKeyring.bind(c)})},unrestrictedMethods:n.unrestrictedMethods})}}}}},{package:"$root$",file:"app/scripts/controller-init/permission-controller-init.ts"}],[124,{"../../../shared/constants/permissions":5437,"@metamask/permission-log-controller":2269},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.PermissionLogControllerInit=void 0;var s=e("@metamask/permission-log-controller"),n=e("../../../shared/constants/permissions");r.PermissionLogControllerInit=({controllerMessenger:e,persistedState:t})=>({controller:new s.PermissionLogController({messenger:e,state:t.PermissionLogController,restrictedMethods:new Set(Object.keys(n.RestrictedMethods))})})}}},{package:"$root$",file:"app/scripts/controller-init/permission-log-controller-init.ts"}],[125,{"../controllers/preferences-controller":174},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.PreferencesControllerInit=void 0;var s=e("../controllers/preferences-controller");r.PreferencesControllerInit=({controllerMessenger:e,persistedState:t,initLangCode:r})=>({controller:new s.PreferencesController({state:{currentLocale:r??"",...t.PreferencesController},messenger:e})})}}},{package:"$root$",file:"app/scripts/controller-init/preferences-controller-init.ts"}],[126,{"@metamask/assets-controllers":1157},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.RatesControllerInit=void 0;var s=e("@metamask/assets-controllers");r.RatesControllerInit=({controllerMessenger:e,persistedState:t})=>({memStateKey:"MultichainRatesController",persistedStateKey:"MultichainRatesController",controller:new s.RatesController({state:t.MultichainRatesController,messenger:e,includeUsdRate:!0})})}}},{package:"$root$",file:"app/scripts/controller-init/rates-controller-init.ts"}],[127,{"../../../development/build/constants":519,"../lib/util":290,"@metamask/remote-feature-flag-controller":2377,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.RemoteFeatureFlagControllerInit=void 0,r.getConfigForRemoteFeatureFlagRequest=l;var s=e("@metamask/utils"),n=e("@metamask/remote-feature-flag-controller"),i=e("../../../development/build/constants"),a=e("../lib/util");const o={flask:n.DistributionType.Flask,main:n.DistributionType.Main,beta:n.DistributionType.Beta,experimental:n.DistributionType.Main},c={[i.ENVIRONMENT.DEVELOPMENT]:n.EnvironmentType.Development,[i.ENVIRONMENT.RELEASE_CANDIDATE]:n.EnvironmentType.ReleaseCandidate,[i.ENVIRONMENT.PRODUCTION]:n.EnvironmentType.Production};function l(){(0,s.assert)("main","METAMASK_BUILD_TYPE is not defined"),(0,s.assert)("production","METAMASK_ENVIRONMENT is not defined");return{distribution:o.main||n.DistributionType.Main,environment:c.production||n.EnvironmentType.Development}}r.RemoteFeatureFlagControllerInit=({controllerMessenger:e,initMessenger:t})=>{const r=t.call("PreferencesController:getState"),{distribution:s,environment:i}=l(),o=new n.RemoteFeatureFlagController({messenger:e,fetchInterval:9e5,disabled:!r.useExternalServices,getMetaMetricsId:()=>t.call("MetaMetricsController:getMetaMetricsId"),clientConfigApiService:new n.ClientConfigApiService({fetch:globalThis.fetch.bind(globalThis),config:{client:n.ClientType.Extension,distribution:s,environment:i}})});return t.subscribe("PreferencesController:stateChange",(0,a.previousValueComparator)((e,t)=>{const{useExternalServices:r}=e,{useExternalServices:s}=t;return s&&!r?(o.enable(),o.updateRemoteFeatureFlags().catch(e=>{console.error("Failed to update remote feature flags:",e)})):!s&&r&&o.disable(),!0},r)),{controller:o}}}}},{package:"$root$",file:"app/scripts/controller-init/remote-feature-flag-controller-init.ts"}],[128,{"./oauth-service-init":129,"./seedless-onboarding-controller-init":130},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"OAuthServiceInit",{enumerable:!0,get:function(){return s.OAuthServiceInit}}),Object.defineProperty(r,"SeedlessOnboardingControllerInit",{enumerable:!0,get:function(){return n.SeedlessOnboardingControllerInit}});var s=e("./oauth-service-init"),n=e("./seedless-onboarding-controller-init")}}},{package:"$root$",file:"app/scripts/controller-init/seedless-onboarding/index.ts"}],[129,{"../../services/oauth/oauth-service":511,"../../services/oauth/web-authenticator-factory":514},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.OAuthServiceInit=void 0;var s,n=(s=e("../../services/oauth/oauth-service"))&&s.__esModule?s:{default:s},i=e("../../services/oauth/web-authenticator-factory");r.OAuthServiceInit=e=>{const{controllerMessenger:t,getController:r}=e,s=r("MetaMetricsController");return{controller:new n.default({messenger:t,env:{googleClientId:"795351133007-6d0s31utj13knv440fgjo2ur93241gb6.apps.googleusercontent.com",appleClientId:"io.metamask.appleloginclient.prod"},webAuthenticator:(0,i.webAuthenticatorFactory)(),bufferedTrace:s.bufferedTrace.bind(s),bufferedEndTrace:s.bufferedEndTrace.bind(s)}),memStateKey:null,persistedStateKey:null}}}}},{package:"$root$",file:"app/scripts/controller-init/seedless-onboarding/oauth-service-init.ts"}],[13,{"../controllers/app-state-controller":159},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.AppStateControllerInit=void 0;var s=e("../controllers/app-state-controller");r.AppStateControllerInit=({controllerMessenger:e,persistedState:t,setLocked:r,extension:n})=>({controller:new s.AppStateController({messenger:e,state:t.AppStateController,onInactiveTimeout:()=>r(),extension:n})})}}},{package:"$root$",file:"app/scripts/controller-init/app-state-controller-init.ts"}],[130,{"../../lib/encryptor-factory":209,"../../services/oauth/config":508,"@metamask/seedless-onboarding-controller":2404},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.SeedlessOnboardingControllerInit=void 0;var s=e("@metamask/seedless-onboarding-controller"),n=e("../../lib/encryptor-factory"),i=e("../../services/oauth/config");r.SeedlessOnboardingControllerInit=e=>{const{initMessenger:t,controllerMessenger:r,persistedState:a}=e,o=(0,n.encryptorFactory)(6e5),c=(0,i.isDevOrTestBuild)()?s.Web3AuthNetwork.Devnet:s.Web3AuthNetwork.Mainnet;return{controller:new s.SeedlessOnboardingController({messenger:r,state:a.SeedlessOnboardingController,network:c,passwordOutdatedCacheTTL:15e3,refreshJWTToken:(...e)=>t.call("OAuthService:getNewRefreshToken",...e),revokeRefreshToken:(...e)=>t.call("OAuthService:revokeRefreshToken",...e),renewRefreshToken:(...e)=>t.call("OAuthService:renewRefreshToken",...e),encryptor:{decrypt:(e,t)=>o.decrypt(e,t),decryptWithDetail:(e,t)=>o.decryptWithDetail(e,t),decryptWithKey(e,t){let r;return r="string"==typeof t?JSON.parse(t):t,o.decryptWithKey(e,r)},encrypt:(e,t)=>o.encrypt(e,t),encryptWithDetail:(e,t)=>o.encryptWithDetail(e,t),importKey:e=>o.importKey(e)}})}}}}},{package:"$root$",file:"app/scripts/controller-init/seedless-onboarding/seedless-onboarding-controller-init.ts"}],[1306,{"./constants.cjs":1307,"./utils.cjs":1309,"@metamask/base-controller":1222,"@metamask/keyring-controller":2004,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var s,n,i=this&&this.__classPrivateFieldSet||function(e,t,r,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(e,r):n?n.value=r:t.set(e,r),r},a=this&&this.__classPrivateFieldGet||function(e,t,r,s){if("a"===r&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?s:"a"===r?s.call(e):s?s.value:t.get(e)};Object.defineProperty(r,"__esModule",{value:!0}),r.DelegationController=r.controllerName=void 0;const o=e("@metamask/base-controller"),c=e("@metamask/keyring-controller"),l=e("@metamask/utils"),u=e("./constants.cjs"),d=e("./utils.cjs");r.controllerName="DelegationController";const p={delegations:{persist:!0,anonymous:!1}};class h extends o.BaseController{constructor({messenger:e,state:t,hashDelegation:a,getDelegationEnvironment:o}){super({messenger:e,metadata:p,name:r.controllerName,state:{delegations:{},...t}}),s.set(this,void 0),n.set(this,void 0),i(this,s,a,"f"),i(this,n,o,"f")}async signDelegation(e){const{delegation:t,chainId:r}=e,{DelegationManager:s}=a(this,n,"f").call(this,r),i=(0,d.createTypedMessageParams)({chainId:(0,l.hexToNumber)(r),from:t.delegator,delegation:{...t,signature:"0x"},verifyingContract:s});return await this.messagingSystem.call("KeyringController:signTypedMessage",i,c.SignTypedDataVersion.V4)}store(e){const{entry:t}=e,r=a(this,s,"f").call(this,t.delegation);if(!(0,d.isHexEqual)(t.delegation.authority,u.ROOT_AUTHORITY)&&!this.state.delegations[t.delegation.authority])throw new Error("Invalid authority");this.update(e=>{e.delegations[r]=t})}list(e){const t=this.messagingSystem.call("AccountsController:getSelectedAccount").address;let r=Object.values(this.state.delegations);e?.from&&(r=r.filter(t=>(0,d.isHexEqual)(t.delegation.delegator,e.from))),(!e?.from||e?.from&&!(0,d.isHexEqual)(e.from,t))&&(r=r.filter(e=>(0,d.isHexEqual)(e.delegation.delegate,t)));const s=e?.chainId;s&&(r=r.filter(e=>(0,d.isHexEqual)(e.chainId,s)));const n=e?.tags;return n&&n.length>0&&(r=r.filter(e=>n.every(t=>e.tags.includes(t)))),r}retrieve(e){return this.state.delegations[e]??null}chain(e){const t=[],r=this.retrieve(e);if(!r)return null;t.push(r);for(let e=r.delegation.authority;e!==u.ROOT_AUTHORITY;){const r=this.retrieve(e);if(!r)throw new Error("Invalid delegation chain");t.push(r),e=r.delegation.authority}return t}delete(e){if(!this.retrieve(e))return 0;const t=Object.entries(this.state.delegations),r=[e],s=[];for(;r.length>0;){const e=r.pop();t.filter(([t,r])=>r.delegation.authority===e).forEach(([e])=>{r.push(e)}),s.push(e)}return this.update(e=>{s.forEach(t=>{delete e.delegations[t]})}),s.length}}r.DelegationController=h,s=new WeakMap,n=new WeakMap}}},{package:"@metamask/delegation-controller",file:"node_modules/@metamask/delegation-controller/dist/DelegationController.cjs"}],[1307,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.SIGNABLE_DELEGATION_TYPED_DATA=r.ROOT_AUTHORITY=void 0,r.ROOT_AUTHORITY="0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff";r.SIGNABLE_DELEGATION_TYPED_DATA={EIP712Domain:[{name:"name",type:"string"},{name:"version",type:"string"},{name:"chainId",type:"uint256"},{name:"verifyingContract",type:"address"}],Caveat:[{name:"enforcer",type:"address"},{name:"terms",type:"bytes"}],Delegation:[{name:"delegate",type:"address"},{name:"delegator",type:"address"},{name:"authority",type:"bytes32"},{name:"caveats",type:"Caveat[]"},{name:"salt",type:"uint256"}]}}}},{package:"@metamask/delegation-controller",file:"node_modules/@metamask/delegation-controller/dist/constants.cjs"}],[1308,{"./DelegationController.cjs":1306},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.DelegationController=void 0;var s=e("./DelegationController.cjs");Object.defineProperty(r,"DelegationController",{enumerable:!0,get:function(){return s.DelegationController}})}}},{package:"@metamask/delegation-controller",file:"node_modules/@metamask/delegation-controller/dist/index.cjs"}],[1309,{"./constants.cjs":1307,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createTypedMessageParams=r.toDelegationStruct=r.isHexEqual=void 0;const s=e("@metamask/utils"),n=e("./constants.cjs");r.isHexEqual=function(e,t){return e.toLowerCase()===t.toLowerCase()};r.toDelegationStruct=e=>{const t=e.caveats.map(e=>({enforcer:(0,s.getChecksumAddress)(e.enforcer),terms:e.terms,args:e.args})),r="0x"===e.salt?0n:BigInt(e.salt);return{delegate:(0,s.getChecksumAddress)(e.delegate),delegator:(0,s.getChecksumAddress)(e.delegator),authority:e.authority,caveats:t,salt:r,signature:e.signature}},r.createTypedMessageParams=function(e){const{chainId:t,from:s,delegation:i,verifyingContract:a}=e;return{data:{types:n.SIGNABLE_DELEGATION_TYPED_DATA,primaryType:"Delegation",domain:{chainId:t,name:"DelegationManager",version:"1",verifyingContract:a},message:(0,r.toDelegationStruct)(i)},from:s}}}}},{package:"@metamask/delegation-controller",file:"node_modules/@metamask/delegation-controller/dist/utils.cjs"}],[131,{"../lib/WeakRefObjectMap":190,"@metamask/selected-network-controller":2409},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.SelectedNetworkControllerInit=void 0;var s=e("@metamask/selected-network-controller"),n=e("../lib/WeakRefObjectMap");r.SelectedNetworkControllerInit=({controllerMessenger:e,persistedState:t})=>({controller:new s.SelectedNetworkController({state:t.SelectedNetworkController,messenger:e,domainProxyMap:new n.WeakRefObjectMap})})}}},{package:"$root$",file:"app/scripts/controller-init/selected-network-controller-init.ts"}],[1311,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var s={DelegationManager:"0xdb9B1e94B5b69Df7e401DDbedE43491141047dB3",EntryPoint:"0x0000000071727De22E5E9d8BAf0edAc6f37da032",SimpleFactory:"0x69Aa2f9fe1572F1B640E1bbc512f5c3a734fc77c",MultiSigDeleGatorImpl:"0x56a9EdB16a0105eb5a4C54f4C062e2868844f3A7",HybridDeleGatorImpl:"0x48dBe696A4D990079e039489bA2053B36E8FFEC4",EIP7702StatelessDeleGatorImpl:"0x63c0c19a282a1B52b07dD5a65b58948A07DAE32B",AllowedCalldataEnforcer:"0xc2b0d624c1c4319760C96503BA27C347F3260f55",AllowedMethodsEnforcer:"0x2c21fD0Cb9DC8445CB3fb0DC5E7Bb0Aca01842B5",AllowedTargetsEnforcer:"0x7F20f61b1f09b08D970938F6fa563634d65c4EeB",BlockNumberEnforcer:"0x5d9818dF0AE3f66e9c3D0c5029DAF99d1823ca6c",DeployedEnforcer:"0x24ff2AA430D53a8CD6788018E902E098083dcCd2",ERC20BalanceChangeEnforcer:"0xcdF6aB796408598Cea671d79506d7D48E97a5437",ERC20TransferAmountEnforcer:"0xf100b0819427117EcF76Ed94B358B1A5b5C6D2Fc",ERC20PeriodTransferEnforcer:"0x474e3Ae7E169e940607cC624Da8A15Eb120139aB",ERC20StreamingEnforcer:"0x56c97aE02f233B29fa03502Ecc0457266d9be00e",ERC721BalanceChangeEnforcer:"0x8aFdf96eDBbe7e1eD3f5Cd89C7E084841e12A09e",ERC721TransferEnforcer:"0x3790e6B7233f779b09DA74C72b6e94813925b9aF",ERC1155BalanceChangeEnforcer:"0x63c322732695cAFbbD488Fc6937A0A7B66fC001A",ExactCalldataBatchEnforcer:"0x982FD5C86BBF425d7d1451f974192d4525113DfD",ExactCalldataEnforcer:"0x99F2e9bF15ce5eC84685604836F71aB835DBBdED",ExactExecutionBatchEnforcer:"0x1e141e455d08721Dd5BCDA1BaA6Ea5633Afd5017",ExactExecutionEnforcer:"0x146713078D39eCC1F5338309c28405ccf85Abfbb",IdEnforcer:"0xC8B5D93463c893401094cc70e66A206fb5987997",LimitedCallsEnforcer:"0x04658B29F6b82ed55274221a06Fc97D318E25416",NativeBalanceChangeEnforcer:"0xbD7B277507723490Cd50b12EaaFe87C616be6880",ArgsEqualityCheckEnforcer:"0x44B8C6ae3C304213c3e298495e12497Ed3E56E41",NativeTokenPaymentEnforcer:"0x4803a326ddED6dDBc60e659e5ed12d85c7582811",NativeTokenTransferAmountEnforcer:"0xF71af580b9c3078fbc2BBF16FbB8EEd82b330320",NativeTokenStreamingEnforcer:"0xD10b97905a320b13a0608f7E9cC506b56747df19",NativeTokenPeriodTransferEnforcer:"0x9BC0FAf4Aca5AE429F4c06aEEaC517520CB16BD9",NonceEnforcer:"0xDE4f2FAC4B3D87A1d9953Ca5FC09FCa7F366254f",OwnershipTransferEnforcer:"0x7EEf9734E7092032B5C56310Eb9BbD1f4A524681",RedeemerEnforcer:"0xE144b0b2618071B4E56f746313528a669c7E65c5",SpecificActionERC20TransferBatchEnforcer:"0x00e0251aaA263dfE3B3541B758A82D1CBA1c3B6D",TimestampEnforcer:"0x1046bb45C8d673d4ea75321280DB34899413c069",ValueLteEnforcer:"0x92Bf12322527cAA612fd31a0e810472BBB106A8F",MultiTokenPeriodEnforcer:"0xFB2f1a9BD76d3701B730E5d69C3219D42D80eBb7"},n={DelegationManager:"0x56D56e07e3d6Ee5a24e30203A37a0a460f42D7A3",EntryPoint:"0x0000000071727De22E5E9d8BAf0edAc6f37da032",SimpleFactory:"0x6ff518884f21168c30c58CB21184D6AdBC18Ad90",MultiSigDeleGatorImpl:"0xd1f421EDbA5e3FA9efe3874827114b20C5BEC40C",HybridDeleGatorImpl:"0x941f3a016F8726d5643Ce62452d0D78492D42b42",AllowedCalldataEnforcer:"0xff71d60f3208469cBCE0859717B5198042DCB3F3",AllowedMethodsEnforcer:"0xe32C2561792e8446Abe73B9f557B881C13906186",AllowedTargetsEnforcer:"0x06aaE4c67EEA95277c46Bf79b1583d4a01772D22",BlockNumberEnforcer:"0x8E470D2Ae278457b42d2405E0B8Cd4BE21Ed9045",DeployedEnforcer:"0xf9088f013dBD9ebb7Cebd66fEB48253c6Ac5a820",ERC20BalanceGteEnforcer:"0xB7B6f32ec6343261D814e55Ed8C5925d91Cab861",ERC20TransferAmountEnforcer:"0x9A069b18032B31429A363AeCFb1B6A0564b44471",IdEnforcer:"0x91015c3b9D9523966eD2399885e5Df7A567f916c",LimitedCallsEnforcer:"0xe694bFfffEA3E85923b1210b37e6a0175e910863",NonceEnforcer:"0xE83BCFD8bBE672A96747e831050a91cf44F4F87A",TimestampEnforcer:"0x550FdD13eEBC1f22ea2a2480024BacBF0Ad7e5CE",ValueLteEnforcer:"0xBE32a6DB7471F63BB168C088c57Db01AfAe87967",NativeTokenTransferAmountEnforcer:"0x5eD3833d7B957A8DB8A461c3AF2d668Ec25382E0",NativeBalanceGteEnforcer:"0x376a98860E210DdEda3689fb39565592c563cB0A",ArgsEqualityCheckEnforcer:"0x7378dE585998d3E18Ce147867C335C25B3dB8Ee5",NativeTokenPaymentEnforcer:"0x87Fe18EbF99e42fcE8A03a25F1d20E119407f8e7",RedeemerEnforcer:"0x926672b130D1EF60A9d6b11D2048d121b30f40C1"},i={DelegationManager:"0xbe4138886cb096bdc1b930f2f0ca7892aa234d78",EntryPoint:"0x0000000071727De22E5E9d8BAf0edAc6f37da032",SimpleFactory:"0x6ff518884f21168c30c58CB21184D6AdBC18Ad90",MultiSigDeleGatorImpl:"0x11f555af5844d85bfcf5d61d2a22866527eb585a",HybridDeleGatorImpl:"0xd6edd1256deccb2b06bdecef92dc16bcf26e531b",AllowedCalldataEnforcer:"0x48db3835a873d64a4af2c09f014052407c003bd7",AllowedMethodsEnforcer:"0xfd731951bf1c52afccee3e6f14ab656475b76dd4",AllowedTargetsEnforcer:"0xbc8673c0afa52d86d991c06881e55b2966920564",BlockNumberEnforcer:"0xc15faffa0d879b9263c15a46ce31eacfa2e0e8ae",DeployedEnforcer:"0x5accb9559b56a6c1e3f90e342c85c42d93720d43",ERC20BalanceGteEnforcer:"0xb5d6b1ec6d868a3bae5b7f48178eaa2686a7a087",ERC20TransferAmountEnforcer:"0x92ac423b9c111962179a6242e1adb58d02c103be",IdEnforcer:"0x34152d9f3f8f74338d50703e780389e829b4abac",LimitedCallsEnforcer:"0x4b3adad4a328bee8ba17b86074d92fe7372180cd",NonceEnforcer:"0x2f32ff3fc3086d7f63f16fe8d0065390d460b40d",TimestampEnforcer:"0x78e05f779490c24bf3bfa135b4112e7003b321cd",ValueLteEnforcer:"0xfc20ede0a1132e839fbda9d7ed3904ff3c89540f"},a={mainnet:1,polygon:137,bsc:56,optimism:10,arbitrum:42161,linea:59144,base:8453,gnosis:100,sepolia:11155111,lineaSepolia:59141,baseSepolia:84532,megaEthTestnet:6342,chiado:10200,lineaGoerli:59140},o={"1.0.0":{[a.optimism]:i,[a.polygon]:i,[a.base]:i,[a.arbitrum]:i,[a.linea]:i,[a.sepolia]:{...i,HybridDeleGatorImpl:"0x5989F5D13DF8fc818EdA65e417AED90459fD67F7"},[a.lineaSepolia]:{...i,HybridDeleGatorImpl:"0x5989F5D13DF8fc818EdA65e417AED90459fD67F7"}},"1.1.0":{[a.arbitrum]:n,[a.base]:n,[a.linea]:n,[a.optimism]:n,[a.polygon]:n,[a.sepolia]:n,[a.lineaSepolia]:n,[a.baseSepolia]:{...n,SimpleFactory:"0xE8eA1DE8D6AfE400B7C8C1A81B7C29B7876b4d02"}},"1.3.0":{[a.mainnet]:s,[a.polygon]:s,[a.bsc]:s,[a.optimism]:s,[a.arbitrum]:s,[a.linea]:s,[a.base]:s,[a.gnosis]:s,[a.sepolia]:s,[a.lineaSepolia]:s,[a.baseSepolia]:s,[a.megaEthTestnet]:s,[a.chiado]:s}};r.CHAIN_ID=a,r.DELEGATOR_CONTRACTS=o}}},{package:"@metamask/delegation-deployments",file:"node_modules/@metamask/delegation-deployments/dist/index.js"}],[132,{"../../../../shared/modules/environment":5530,"@metamask/shield-controller":2413},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.ShieldControllerInit=void 0;var s=e("@metamask/shield-controller"),n=e("../../../../shared/modules/environment");r.ShieldControllerInit=e=>{const{controllerMessenger:t,initMessenger:r,persistedState:i}=e,a=new s.ShieldController({messenger:t,state:i.ShieldController,backend:new s.ShieldRemoteBackend({getAccessToken:()=>r.call("AuthenticationController:getBearerToken"),fetch:fetch,baseUrl:"https://shield-rule-engine.dev-api.cx.metamask.io"})});return(0,n.getIsMetaMaskShieldFeatureEnabled)()&&a.start(),{controller:a}}}}},{package:"$root$",file:"app/scripts/controller-init/shield/shield-controller-init.ts"}],[133,{"../../../../shared/constants/smartTransactions":5443,"../../../../shared/modules/selectors":5545,"@metamask/smart-transactions-controller":2426,"@metamask/smart-transactions-controller/dist/types":2427},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.SmartTransactionsControllerInit=void 0;var s,n=(s=e("@metamask/smart-transactions-controller"))&&s.__esModule?s:{default:s},i=e("@metamask/smart-transactions-controller/dist/types"),a=e("../../../../shared/constants/smartTransactions"),o=e("../../../../shared/modules/selectors");r.SmartTransactionsControllerInit=e=>{const{controllerMessenger:t,initMessenger:r,getController:s,persistedState:c,getStateUI:l,getGlobalNetworkClientId:u,getAccountType:d,getDeviceModel:p,getHardwareTypeForMetric:h,trace:m}=e,g=s("TransactionController");return{controller:new n.default({supportedChainIds:(0,a.getAllowedSmartTransactionsChainIds)(),clientId:i.ClientId.Extension,getNonceLock:(e,t)=>g.getNonceLock(e,t||u()),confirmExternalTransaction:(...e)=>g.confirmExternalTransaction(...e),trackMetaMetricsEvent:r.call.bind(r,"MetaMetricsController:trackEvent"),state:c.SmartTransactionsController,messenger:t,getTransactions:(...e)=>g.getTransactions(...e),updateTransaction:(...e)=>g.updateTransaction(...e),getFeatureFlags:()=>{const e=l();return(0,o.getFeatureFlagsByChainId)(e)},getMetaMetricsProps:async()=>{var e;const{metamask:t}=l(),{internalAccounts:r}=t,s=null==r?void 0:r.selectedAccount,n=s?null==r||null===(e=r.accounts)||void 0===e?void 0:e[s]:null,i=(null==n?void 0:n.address)??"";if(!i)return{accountHardwareType:undefined,accountType:undefined,deviceModel:undefined};return{accountHardwareType:await h(i),accountType:await d(i),deviceModel:await p(i)}},trace:m})}}}}},{package:"$root$",file:"app/scripts/controller-init/smart-transactions/smart-transactions-controller-init.ts"}],[134,{"@metamask/snaps-controllers":2443},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.CronjobControllerInit=void 0;var s=e("@metamask/snaps-controllers");r.CronjobControllerInit=({controllerMessenger:e,persistedState:t,getCronjobControllerStorageManager:r})=>({controller:new s.CronjobController({state:t.CronjobController,messenger:e,stateManager:r()}),persistedStateKey:null})}}},{package:"$root$",file:"app/scripts/controller-init/snaps/cronjob-controller-init.ts"}],[135,{"../../../../shared/modules/mv3.utils":5538,"@metamask/permission-controller":2260,"@metamask/snaps-controllers":2443,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.ExecutionServiceInit=void 0;var s=e("@metamask/snaps-controllers"),n=e("@metamask/utils"),i=e("@metamask/permission-controller"),a=e("../../../../shared/modules/mv3.utils");r.ExecutionServiceInit=({controllerMessenger:e,offscreenPromise:t,setupUntrustedCommunicationEip1193:r})=>{function o(e,t){r({connectionStream:t,sender:{snapId:e},subjectType:i.SubjectType.Snap})}if(a.isManifestV3&&"undefined"!=typeof chrome&&void 0!==chrome.offscreen)return{memStateKey:null,persistedStateKey:null,controller:new s.OffscreenExecutionService({messenger:e,setupSnapProvider:o,offscreenPromise:t})};const c="https://execution.metamask.io/iframe/10.2.1/index.html";return(0,n.assert)(c,"Missing iframe URL."),{memStateKey:null,persistedStateKey:null,controller:new s.IframeExecutionService({messenger:e,iframeUrl:new URL(c),setupSnapProvider:o})}}}}},{package:"$root$",file:"app/scripts/controller-init/snaps/execution-service-init.ts"}],[136,{"./cronjob-controller-init":134,"./execution-service-init":135,"./rate-limit-controller-init":137,"./snap-controller-init":138,"./snap-insights-controller-init":139,"./snap-interface-controller-init":140,"./snaps-name-provider-init":141,"./snaps-registry-init":142,"./websocket-service-init":143},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"CronjobControllerInit",{enumerable:!0,get:function(){return s.CronjobControllerInit}}),Object.defineProperty(r,"ExecutionServiceInit",{enumerable:!0,get:function(){return n.ExecutionServiceInit}}),Object.defineProperty(r,"RateLimitControllerInit",{enumerable:!0,get:function(){return i.RateLimitControllerInit}}),Object.defineProperty(r,"SnapControllerInit",{enumerable:!0,get:function(){return a.SnapControllerInit}}),Object.defineProperty(r,"SnapInsightsControllerInit",{enumerable:!0,get:function(){return o.SnapInsightsControllerInit}}),Object.defineProperty(r,"SnapInterfaceControllerInit",{enumerable:!0,get:function(){return c.SnapInterfaceControllerInit}}),Object.defineProperty(r,"SnapsNameProviderInit",{enumerable:!0,get:function(){return l.SnapsNameProviderInit}}),Object.defineProperty(r,"SnapsRegistryInit",{enumerable:!0,get:function(){return u.SnapsRegistryInit}}),Object.defineProperty(r,"WebSocketServiceInit",{enumerable:!0,get:function(){return d.WebSocketServiceInit}});var s=e("./cronjob-controller-init"),n=e("./execution-service-init"),i=e("./rate-limit-controller-init"),a=e("./snap-controller-init"),o=e("./snap-insights-controller-init"),c=e("./snap-interface-controller-init"),l=e("./snaps-name-provider-init"),u=e("./snaps-registry-init"),d=e("./websocket-service-init")}}},{package:"$root$",file:"app/scripts/controller-init/snaps/index.ts"}],[137,{"@metamask/notification-services-controller/notification-services":2211,"@metamask/rate-limit-controller":2374,loglevel:4542},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.RateLimitControllerInit=void 0;var s,n=e("@metamask/rate-limit-controller"),i=(s=e("loglevel"))&&s.__esModule?s:{default:s},a=e("@metamask/notification-services-controller/notification-services");r.RateLimitControllerInit=({controllerMessenger:e,initMessenger:t,persistedState:r,showNotification:s})=>({controller:new n.RateLimitController({state:r.RateLimitController,messenger:e,implementations:{showNativeNotification:{method:(e,r)=>{const n=t.call("SubjectMetadataController:getState").subjectMetadata[e];return s((null==n?void 0:n.name)??e,r).catch(e=>{i.default.error("Failed to create notification",e)}),null},rateLimitCount:2,rateLimitTimeout:3e5},showInAppNotification:{method:(e,r)=>{const{message:s,title:n,footerLink:i,interfaceId:o}=r,c={title:n,...i?{footerLink:i}:{},interfaceId:o},l={data:{message:s,origin:e,...o?{detailedView:c}:{}},type:a.TRIGGER_TYPES.SNAP,readDate:null};return t.call("NotificationServicesController:updateMetamaskNotificationsList",l),null},rateLimitCount:5,rateLimitTimeout:6e4}}}),memStateKey:null,persistedStateKey:null})}}},{package:"$root$",file:"app/scripts/controller-init/snaps/rate-limit-controller-init.ts"}],[138,{"../../../../shared/constants/keyring":5426,"../../../../shared/constants/snaps/permissions":5444,"../../lib/encryptor-factory":209,"../../lib/util":290,"@metamask/snaps-controllers":2443,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.SnapControllerInit=void 0;var s=e("@metamask/snaps-controllers"),n=e("@metamask/utils"),i=e("../../../../shared/constants/snaps/permissions"),a=e("../../lib/encryptor-factory"),o=e("../../../../shared/constants/keyring"),c=e("../../lib/util");r.SnapControllerInit=({initMessenger:e,controllerMessenger:t,persistedState:r,removeAllConnections:l,preinstalledSnaps:u})=>{const d=(0,c.getBooleanFlag)(!1),p=(0,c.getBooleanFlag)(!0),h=(0,c.getBooleanFlag)(!0);return{controller:new s.SnapController({dynamicPermissions:["endowment:caip25"],environmentEndowmentPermissions:Object.values(i.EndowmentPermissions),excludedPermissions:{...i.ExcludedSnapPermissions,...i.ExcludedSnapEndowments},closeAllConnections:l,state:r.SnapController,messenger:t,featureFlags:{allowLocalSnaps:d,requireAllowlist:p,rejectInvalidPlatformVersion:h,useCaip25Permission:!0},encryptor:(0,a.encryptorFactory)(6e5),getMnemonicSeed:async function(){const t=e.call("KeyringController:getKeyringsByType",o.KeyringType.hdKeyTree);if(!(t[0]&&(0,n.hasProperty)(t[0],"seed")&&t[0].seed instanceof Uint8Array))throw new Error("Primary keyring mnemonic unavailable.");return t[0].seed},preinstalledSnaps:u,getFeatureFlags:function(){return{disableSnaps:!1===e.call("PreferencesController:getState").useExternalServices}},trackEvent:e.call.bind(e,"MetaMetricsController:trackEvent")})}}}}},{package:"$root$",file:"app/scripts/controller-init/snaps/snap-controller-init.ts"}],[139,{"@metamask/snaps-controllers":2443},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.SnapInsightsControllerInit=void 0;var s=e("@metamask/snaps-controllers");r.SnapInsightsControllerInit=({controllerMessenger:e,persistedState:t})=>({controller:new s.SnapInsightsController({state:t.SnapInsightsController,messenger:e})})}}},{package:"$root$",file:"app/scripts/controller-init/snaps/snap-insights-controller-init.ts"}],[14,{"../init-utils":34,"@metamask/assets-controllers":1157},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.AssetsContractControllerInit=void 0;var s=e("@metamask/assets-controllers"),n=e("../init-utils");r.AssetsContractControllerInit=({controllerMessenger:e,initMessenger:t})=>({controller:new s.AssetsContractController({messenger:e,chainId:(0,n.getGlobalChainId)(t)}),memStateKey:null})}}},{package:"$root$",file:"app/scripts/controller-init/assets/assets-contract-controller-init.ts"}],[140,{"@metamask/snaps-controllers":2443},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.SnapInterfaceControllerInit=void 0;var s=e("@metamask/snaps-controllers");r.SnapInterfaceControllerInit=({controllerMessenger:e,persistedState:t})=>({controller:new s.SnapInterfaceController({state:t.SnapInterfaceController,messenger:e})})}}},{package:"$root$",file:"app/scripts/controller-init/snaps/snap-interface-controller-init.ts"}],[141,{"../../lib/SnapsNameProvider":189},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.SnapsNameProviderInit=void 0;var s=e("../../lib/SnapsNameProvider");r.SnapsNameProviderInit=({controllerMessenger:e})=>({persistedStateKey:null,memStateKey:null,controller:new s.SnapsNameProvider({messenger:e})})}}},{package:"$root$",file:"app/scripts/controller-init/snaps/snaps-name-provider-init.ts"}],[142,{"../../lib/util":290,"@metamask/snaps-controllers":2443},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.SnapsRegistryInit=void 0;var s=e("@metamask/snaps-controllers"),n=e("../../lib/util");r.SnapsRegistryInit=({controllerMessenger:e,persistedState:t})=>{const r=(0,n.getBooleanFlag)(!0);return{controller:new s.JsonSnapsRegistry({state:t.SnapsRegistry,messenger:e,refetchOnAllowlistMiss:r})}}}}},{package:"$root$",file:"app/scripts/controller-init/snaps/snaps-registry-init.ts"}],[143,{"@metamask/snaps-controllers":2443},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.WebSocketServiceInit=void 0;var s=e("@metamask/snaps-controllers");r.WebSocketServiceInit=({controllerMessenger:e})=>({memStateKey:null,persistedStateKey:null,controller:new s.WebSocketService({messenger:e})})}}},{package:"$root$",file:"app/scripts/controller-init/snaps/websocket-service-init.ts"}],[144,{"@metamask/permission-controller":2260},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.SubjectMetadataControllerInit=void 0;var s=e("@metamask/permission-controller");r.SubjectMetadataControllerInit=({controllerMessenger:e,persistedState:t})=>({controller:new s.SubjectMetadataController({state:t.SubjectMetadataController,messenger:e,subjectCacheLimit:100})})}}},{package:"$root$",file:"app/scripts/controller-init/subject-metadata-controller-init.ts"}],[145,{"./subscription-controller-init":146,"./subscription-service-init":147},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"SubscriptionControllerInit",{enumerable:!0,get:function(){return s.SubscriptionControllerInit}}),Object.defineProperty(r,"SubscriptionServiceInit",{enumerable:!0,get:function(){return n.SubscriptionServiceInit}});var s=e("./subscription-controller-init"),n=e("./subscription-service-init")}}},{package:"$root$",file:"app/scripts/controller-init/subscription/index.ts"}],[146,{"../../../../development/build/constants":519,"@metamask/subscription-controller":2702},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.SubscriptionControllerInit=void 0;var s=e("@metamask/subscription-controller"),n=e("../../../../development/build/constants");r.SubscriptionControllerInit=e=>{const{initMessenger:t,controllerMessenger:r,persistedState:i}=e,a=new s.SubscriptionService({env:"production"===n.ENVIRONMENT.DEVELOPMENT||"production"===n.ENVIRONMENT.TESTING?s.Env.DEV:s.Env.PRD,auth:{getAccessToken:()=>t.call("AuthenticationController:getBearerToken")}});return{controller:new s.SubscriptionController({messenger:r,state:i.SubscriptionController,subscriptionService:a})}}}}},{package:"$root$",file:"app/scripts/controller-init/subscription/subscription-controller-init.ts"}],[147,{"../../services/oauth/web-authenticator-factory":514,"../../services/subscription/subscription-service":515},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.SubscriptionServiceInit=void 0;var s=e("../../services/subscription/subscription-service"),n=e("../../services/oauth/web-authenticator-factory");r.SubscriptionServiceInit=e=>{const{controllerMessenger:t,platform:r}=e;return{controller:new s.SubscriptionService({messenger:t,platform:r,webAuthenticator:(0,n.webAuthenticatorFactory)()}),memStateKey:null,persistedStateKey:null}}}}},{package:"$root$",file:"app/scripts/controller-init/subscription/subscription-service-init.ts"}],[148,{"../controllers/swaps":178},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.SwapsControllerInit=void 0;var s,n=(s=e("../controllers/swaps"))&&s.__esModule?s:{default:s};r.SwapsControllerInit=({controllerMessenger:e,initMessenger:t,persistedState:r,getController:s})=>{const i=s("GasFeeController"),a=s("TransactionController");return{controller:new n.default({messenger:e,getBufferedGasLimit:async(e,r)=>{const s=t.call("NetworkController:getState"),{gas:n,simulationFails:i}=await a.estimateGasBuffered(e.txParams,r,s.selectedNetworkClientId);return{gasLimit:n,simulationFails:i}},getEIP1559GasFeeEstimates:(...e)=>i.fetchGasFeeEstimates(...e),getLayer1GasFee:(...e)=>a.getLayer1GasFee(...e),trackMetaMetricsEvent:t.call.bind(t,"MetaMetricsController:trackEvent")},r.SwapsController)}}}}},{package:"$root$",file:"app/scripts/controller-init/swaps-controller-init.ts"}],[149,{"@metamask/assets-controllers":1157},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.TokenBalancesControllerInit=void 0;var s=e("@metamask/assets-controllers");r.TokenBalancesControllerInit=({controllerMessenger:e,initMessenger:t,persistedState:r})=>{const{useMultiAccountBalanceChecker:n}=t.call("PreferencesController:getState");return{controller:new s.TokenBalancesController({messenger:e,state:r.TokenBalancesController,queryMultipleAccounts:n,interval:3e4,allowExternalServices:()=>t.call("PreferencesController:getState").useExternalServices,accountsApiChainIds:()=>{var e;const r=t.call("RemoteFeatureFlagController:getState"),s=null==r||null===(e=r.remoteFeatureFlags)||void 0===e?void 0:e.assetsAccountApiBalances;return Array.isArray(s)?s:[]}})}}}}},{package:"$root$",file:"app/scripts/controller-init/token-balances-controller-init.ts"}],[15,{"./assets-contract-controller-init":14,"./network-order-controller-init":17,"./nft-controller-init":18,"./nft-detection-controller-init":19,"./token-rates-controller-init":20},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"AssetsContractControllerInit",{enumerable:!0,get:function(){return a.AssetsContractControllerInit}}),Object.defineProperty(r,"NetworkOrderControllerInit",{enumerable:!0,get:function(){return o.NetworkOrderControllerInit}}),Object.defineProperty(r,"NftControllerInit",{enumerable:!0,get:function(){return n.NftControllerInit}}),Object.defineProperty(r,"NftDetectionControllerInit",{enumerable:!0,get:function(){return i.NftDetectionControllerInit}}),Object.defineProperty(r,"TokenRatesControllerInit",{enumerable:!0,get:function(){return s.TokenRatesControllerInit}});var s=e("./token-rates-controller-init"),n=e("./nft-controller-init"),i=e("./nft-detection-controller-init"),a=e("./assets-contract-controller-init"),o=e("./network-order-controller-init")}}},{package:"$root$",file:"app/scripts/controller-init/assets/index.ts"}],[150,{"@metamask/assets-controllers":1157},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.TokenDetectionControllerInit=void 0;var s=e("@metamask/assets-controllers");r.TokenDetectionControllerInit=({controllerMessenger:e,initMessenger:t})=>({memStateKey:null,persistedStateKey:null,controller:new s.TokenDetectionController({messenger:e,getBalancesInSingleCall:(...e)=>t.call("AssetsContractController:getBalancesInSingleCall",...e),trackMetaMetricsEvent:(...e)=>t.call("MetaMetricsController:trackEvent",...e),useAccountsAPI:!0,platform:"extension",useTokenDetection:()=>t.call("PreferencesController:getState").useTokenDetection,useExternalServices:()=>t.call("PreferencesController:getState").useExternalServices})})}}},{package:"$root$",file:"app/scripts/controller-init/token-detection-controller-init.ts"}],[151,{"../lib/util":290,"./init-utils":34,"@metamask/assets-controllers":1157},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.TokenListControllerInit=void 0;var s=e("@metamask/assets-controllers"),n=e("../lib/util"),i=e("./init-utils");r.TokenListControllerInit=({controllerMessenger:e,initMessenger:t,persistedState:r})=>{const a=t.call("PreferencesController:getState"),o=e=>{const{useTokenDetection:t,useTransactionSimulations:r,preferences:s}=e??{},{petnamesEnabled:n}=s??{};return t||n||r},c=new s.TokenListController({messenger:e,state:r.TokenListController,preventPollingOnNetworkRestart:!o(a),chainId:(0,i.getGlobalChainId)(t)});return t.subscribe("PreferencesController:stateChange",(0,n.previousValueComparator)((e,t)=>(((e,t)=>{const r=o(t),s=o(e);r!==s&&c.updatePreventPollingOnNetworkRestart(!s)})(t,e),!0),a)),{controller:c}}}}},{package:"$root$",file:"app/scripts/controller-init/token-list-controller-init.ts"}],[152,{"./init-utils":34,"@metamask/assets-controllers":1157,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.TokensControllerInit=void 0;var s=e("@metamask/assets-controllers"),n=e("@metamask/utils"),i=e("./init-utils");r.TokensControllerInit=({controllerMessenger:e,initMessenger:t,persistedState:r})=>{const{provider:a}=t.call("NetworkController:getSelectedNetworkClient")??{};(0,n.assert)(a,"Provider is required to initialize TokensController.");return{controller:new s.TokensController({messenger:e,state:r.TokensController,provider:a,chainId:(0,i.getGlobalChainId)(t)})}}}}},{package:"$root$",file:"app/scripts/controller-init/tokens-controller-init.ts"}],[153,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){}}},{package:"$root$",file:"app/scripts/controller-init/types.ts"}],[154,{"./messengers":63,"./types":153,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.initControllers=function({baseControllerMessenger:e,existingControllers:t=[],initFunctions:r,initRequest:s}){i("Initializing controllers",Object.keys(r).length);const a=t.reduce((e,t)=>(e[t.name]=t,e),{}),o={},c={};let l={};const u=e=>function(e,t){const r=e[t];if(!r)throw new Error(`Controller requested before it was initialized: ${t}`);return r}(a,e);for(const[t,d]of Object.entries(r)){const r=t,p=d,h=n.CONTROLLER_MESSENGERS[r],m=null==h?void 0:h.getMessenger,g=null==h?void 0:h.getInitMessenger,f={...s,controllerMessenger:null==m?void 0:m(e),getController:u,initMessenger:null==g?void 0:g(e)},y=p({...f,controllerMessenger:f.controllerMessenger}),{controller:w,persistedStateKey:v,memStateKey:S}=y,b=y.api??{},k=null===v?undefined:v??r,E=null===S?undefined:S??r;a[r]=w,l={...l,...b},k&&(o[k]=w),E&&(c[E]=w),i("Initialized controller",r,{api:Object.keys(b),persistedStateKey:k,memStateKey:E})}return{controllerApi:l,controllerMemState:c,controllerPersistedState:o,controllersByName:a}};var s=e("@metamask/utils"),n=(e("./types"),e("./messengers"));const i=(0,s.createProjectLogger)("controller-init")}}},{package:"$root$",file:"app/scripts/controller-init/utils.ts"}],[155,{"@metamask/base-controller":1222},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.AccountOrderController=void 0;var s=e("@metamask/base-controller");const n={pinnedAccountList:[],hiddenAccountList:[]},i={pinnedAccountList:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},hiddenAccountList:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0}};class a extends s.BaseController{constructor({messenger:e,state:t}){super({messenger:e,metadata:i,name:"AccountOrderController",state:{...n,...t}})}updateAccountsList(e){this.update(t=>(t.pinnedAccountList=e,t))}updateHiddenAccountsList(e){this.update(t=>(t.hiddenAccountList=e,t))}}r.AccountOrderController=a}}},{package:"$root$",file:"app/scripts/controllers/account-order.ts"}],[156,{"../../../shared/constants/accounts":5411,"../../../shared/constants/network":5433,"../constants/contracts":5,"../lib/batch-utils":193,"../lib/util":290,"@ethersproject/contracts":654,"@ethersproject/providers":692,"@metamask/base-controller":1222,"@metamask/controller-utils":1301,"@metamask/utils":2799,lodash:4534,loglevel:4542,"single-call-balance-checker-abi":5285,uuid:5366},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getDefaultAccountTrackerControllerState=r.default=void 0;var s=e("uuid"),n=y(e("loglevel")),i=e("@ethersproject/providers"),a=e("@ethersproject/contracts"),o=y(e("single-call-balance-checker-abi")),c=e("lodash"),l=e("@metamask/utils"),u=e("@metamask/base-controller"),d=e("@metamask/controller-utils"),p=e("../../../shared/constants/network"),h=e("../constants/contracts"),m=e("../../../shared/constants/accounts"),g=e("../lib/util"),f=e("../lib/batch-utils");function y(e){return e&&e.__esModule?e:{default:e}}function w(e,t,r){v(e,t),t.set(e,r)}function v(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function S(e,t){return e.get(k(e,t))}function b(e,t,r){return e.set(k(e,t),r),r}function k(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const E="AccountTrackerController",T={accounts:{includeInStateLogs:!1,persist:!0,anonymous:!1,usedInUi:!0},currentBlockGasLimit:{includeInStateLogs:!1,persist:!0,anonymous:!0,usedInUi:!0},accountsByChainId:{includeInStateLogs:!1,persist:!0,anonymous:!1,usedInUi:!0},currentBlockGasLimitByChainId:{includeInStateLogs:!1,persist:!0,anonymous:!0,usedInUi:!0}},C=()=>({accounts:{},currentBlockGasLimit:"",accountsByChainId:{},currentBlockGasLimitByChainId:{}});r.getDefaultAccountTrackerControllerState=C;var M=new WeakMap,A=new WeakMap,I=new WeakMap,_=new WeakMap,P=new WeakMap,N=new WeakMap,O=new WeakMap,j=new WeakMap,R=new WeakSet,D=new WeakMap;class L extends u.BaseController{constructor(e){var t,r;super({name:E,metadata:T,state:{accounts:{},currentBlockGasLimit:"",accountsByChainId:{},currentBlockGasLimitByChainId:{},...e.state},messenger:e.messenger}),v(t=this,r=R),r.add(t),w(this,M,new Map),w(this,A,{}),w(this,I,void 0),w(this,_,void 0),w(this,P,{}),w(this,N,void 0),w(this,O,void 0),w(this,j,void 0),w(this,D,async e=>{await k(R,this,H).call(this,undefined,e)}),b(I,this,e.provider),b(_,this,e.blockTracker),b(N,this,e.getNetworkIdentifier),b(j,this,e.accountsApiChainIds??(()=>[])),this.messagingSystem.subscribe("KeyringController:accountRemoved",e=>this.removeAccounts([e]));const s=this.messagingSystem.call("OnboardingController:getState");this.messagingSystem.subscribe("OnboardingController:stateChange",(0,g.previousValueComparator)((e,t)=>{const{completedOnboarding:r}=e,{completedOnboarding:s}=t;return!r&&s&&this.updateAccountsAllActiveNetworks(),!0},s)),b(O,this,this.messagingSystem.call("AccountsController:getSelectedAccount")),this.messagingSystem.subscribe("AccountsController:selectedEvmAccountChange",e=>{const{useMultiAccountBalanceChecker:t}=this.messagingSystem.call("PreferencesController:getState");S(O,this).id===e.id||t||(b(O,this,e),this.updateAccountsAllActiveNetworks())}),this._registerMessageHandlers()}resetState(){const{accounts:e,accountsByChainId:t,currentBlockGasLimit:r,currentBlockGasLimitByChainId:s}={accounts:{},currentBlockGasLimit:"",accountsByChainId:{},currentBlockGasLimitByChainId:{}};this.update(n=>{n.accounts=e,n.accountsByChainId=t,n.currentBlockGasLimit=r,n.currentBlockGasLimitByChainId=s})}start(){b(P,this,{[k(R,this,B).call(this)]:S(_,this).getCurrentBlock()}),S(_,this).once("latest",e=>{S(P,this)[k(R,this,B).call(this)]=e}),S(_,this).removeListener("latest",S(D,this)),S(_,this).addListener("latest",S(D,this)),this.updateAccounts()}stop(){S(_,this).removeListener("latest",S(D,this))}startPollingByNetworkClientId(e){const t=(0,s.v4)(),r=S(M,this).get(e);if(r)r.add(t);else{const r=new Set;r.add(t),S(M,this).set(e,r),k(R,this,F).call(this,e)}return t}stopAllPolling(){this.stop(),S(M,this).forEach((e,t)=>{e.forEach(e=>{this.stopPollingByPollingToken(e)})})}stopPollingByPollingToken(e){if(!e)throw new Error("pollingToken required");S(M,this).forEach((t,r)=>{t.has(e)&&(t.delete(e),0===t.size&&(S(M,this).delete(r),k(R,this,U).call(this,r)))})}syncWithAddresses(e){const{accounts:t}=this.state,r=Object.keys(t),s=[];e.forEach(e=>{r.includes(e)||s.push(e)});const n=[];r.forEach(t=>{e.includes(t)||n.push(t)}),this.addAccounts(s),this.removeAccounts(n)}addAccounts(e){const{accounts:t,accountsByChainId:r}=this.state,s=(0,c.cloneDeep)(t),n=(0,c.cloneDeep)(r);e.forEach(e=>{s[e]={}}),Object.keys(n).forEach(t=>{e.forEach(e=>{n[t][e]={}})}),this.update(e=>{e.accounts=s,e.accountsByChainId=n}),S(P,this)[k(R,this,B).call(this)]&&this.updateAccounts(),S(M,this).forEach((e,t)=>{const{chainId:r}=k(R,this,x).call(this,t);S(P,this)[r]&&this.updateAccounts(t)})}removeAccounts(e){const{accounts:t,accountsByChainId:r}=this.state,s=(0,c.cloneDeep)(t),n=(0,c.cloneDeep)(r);e.forEach(e=>{delete s[e]}),Object.keys(n).forEach(t=>{e.forEach(e=>{delete n[t][e]})}),this.update(e=>{e.accounts=s,e.accountsByChainId=n})}clearAccounts(){this.update(e=>{e.accounts={},e.accountsByChainId={[k(R,this,B).call(this)]:{}}})}async updateAccountsAllActiveNetworks(){const{completedOnboarding:e}=this.messagingSystem.call("OnboardingController:getState");if(!e)return;const{useMultiAccountBalanceChecker:t}=this.messagingSystem.call("PreferencesController:getState");let r=[];if(t){const{accounts:e}=this.state;r=Object.keys(e)}else{r=[this.messagingSystem.call("AccountsController:getSelectedAccount").address]}const{useExternalServices:s}=this.messagingSystem.call("PreferencesController:getState");if(S(j,this).call(this).length>0&&s&&t)try{if(await k(R,this,z).call(this,r))return void n.default.debug("Successfully updated all accounts via multiaccount API v4")}catch(e){n.default.warn("Multiaccount API failed, falling back to individual requests:",e)}await this.updateAccounts(),await Promise.all(Array.from(S(M,this)).map(([e])=>this.updateAccounts(e)))}async updateAccounts(e){const{completedOnboarding:t}=this.messagingSystem.call("OnboardingController:getState");if(!t)return;const{chainId:r,provider:s,identifier:i}=k(R,this,x).call(this,e),{useMultiAccountBalanceChecker:a,useExternalServices:o}=this.messagingSystem.call("PreferencesController:getState");let c=[];if(a){const{accounts:e}=this.state;c=Object.keys(e)}else{c=[this.messagingSystem.call("AccountsController:getSelectedAccount").address]}let l=!1;if(S(j,this).call(this).includes(r)&&o&&a)try{if(l=await k(R,this,V).call(this,c,r),l)return void n.default.debug(`Successfully updated balances via multiaccount API v4 for chain ${r}`)}catch(e){n.default.warn("Account API failed, falling back to RPC/balance checker:",e)}i!==p.LOCALHOST_RPC_URL&&"http://127.0.0.1:8545"!==i&&r in h.SINGLE_CALL_BALANCES_ADDRESSES?await k(R,this,K).call(this,c,h.SINGLE_CALL_BALANCES_ADDRESSES[r],s,r):await Promise.all(c.map(e=>k(R,this,G).call(this,e,s,r)))}async updateAccountByAddress({address:e,networkClientId:t}={}){const{completedOnboarding:r}=this.messagingSystem.call("OnboardingController:getState");if(!r)return;const s=e||this.messagingSystem.call("AccountsController:getSelectedAccount").address;if(!s)return;const{chainId:n,provider:i}=k(R,this,x).call(this,t);await k(R,this,G).call(this,s,i,n)}updateNativeBalances(e){this.update(t=>{e.forEach(({address:e,chainId:r,balance:s})=>{t.accountsByChainId[r]||(t.accountsByChainId[r]={}),t.accountsByChainId[r][e]||(t.accountsByChainId[r][e]={address:e,balance:"0x0"}),s&&(t.accountsByChainId[r][e].balance=(0,d.toHex)(s))})})}updateStakedBalances(e){this.update(t=>{e.forEach(({address:e,chainId:r,stakedBalance:s})=>{t.accountsByChainId[r]||(t.accountsByChainId[r]={}),t.accountsByChainId[r][e]||(t.accountsByChainId[r][e]={address:e,balance:"0x0"}),s&&(t.accountsByChainId[r][e].stakedBalance=(0,d.toHex)(s))})})}_registerMessageHandlers(){this.messagingSystem.registerActionHandler(`${E}:updateNativeBalances`,this.updateNativeBalances.bind(this)),this.messagingSystem.registerActionHandler(`${E}:updateStakedBalances`,this.updateStakedBalances.bind(this))}}function B(){const{selectedNetworkClientId:e}=this.messagingSystem.call("NetworkController:getState"),{configuration:{chainId:t}}=this.messagingSystem.call("NetworkController:getNetworkClientById",e);return t}function x(e){if(e){const{configuration:t,provider:r,blockTracker:s}=this.messagingSystem.call("NetworkController:getNetworkClientById",e);return{chainId:t.chainId,provider:r,blockTracker:s,identifier:S(N,this).call(this,t)}}return{chainId:k(R,this,B).call(this),provider:S(I,this),blockTracker:S(_,this),identifier:S(N,this).call(this)}}function F(e){if(S(A,this)[e])return;const{blockTracker:t}=k(R,this,x).call(this,e),r=t=>k(R,this,H).call(this,e,t);t.addListener("latest",r),S(A,this)[e]=r,this.updateAccounts(e)}function U(e){if(!S(A,this)[e])return;const{blockTracker:t}=k(R,this,x).call(this,e);t.removeListener("latest",S(A,this)[e]),delete S(A,this)[e]}function $(e){const{accounts:t,accountsByChainId:r}=this.state;if(r[e])return(0,c.cloneDeep)(r[e]);const s={};return Object.keys(t).forEach(e=>{s[e]={}}),s}async function H(e,t){const{chainId:r,provider:s}=k(R,this,x).call(this,e);S(P,this)[r]=t;const i=await s.request({method:"eth_getBlockByNumber",params:[t,!1]});if(!i)return;const a=i.gasLimit;this.update(e=>{r===k(R,this,B).call(this)&&(e.currentBlockGasLimit=a),e.currentBlockGasLimitByChainId[r]=a});try{await this.updateAccounts(e)}catch(e){n.default.error(e)}}async function G(e,t,r){const{useMultiAccountBalanceChecker:s}=this.messagingSystem.call("PreferencesController:getState");let n="0x0";try{n=await t.request({method:"eth_getBalance",params:[e,"latest"]})}catch(e){if(e&&"object"==typeof e&&(0,l.hasProperty)(e,"data")&&e.data&&(0,l.hasProperty)(e.data,"request")&&e.data.request&&(0,l.hasProperty)(e.data.request,"method")&&"eth_getBalance"!==e.data.request.method)throw e}const i={address:e,balance:n},a=k(R,this,$).call(this,r);if(!a[e])return;let o=a;s||(o={},Object.keys(a).forEach(t=>{e!==t&&(o[t]={address:t,balance:null})})),o[e]=i,this.update(e=>{r===k(R,this,B).call(this)&&(e.accounts=o),e.accountsByChainId[r]=o})}async function K(e,t,r,s){const c=await new a.Contract(t,o.default,new i.Web3Provider(r)),l=["0x0000000000000000000000000000000000000000"];try{const t=await c.balances(e,l),r=k(R,this,$).call(this,s),n={};Object.keys(r).forEach(t=>{e.includes(t)||(n[t]={address:t,balance:null})}),e.forEach((e,r)=>{const s=t[r]?t[r].toHexString():"0x0";n[e]={address:e,balance:s}}),this.update(e=>{s===k(R,this,B).call(this)&&(e.accounts=n),e.accountsByChainId[s]=n})}catch(t){n.default.warn("MetaMask - Account Tracker single call balance fetch failed",t),Promise.allSettled(e.map(e=>k(R,this,G).call(this,e,r,s)))}}async function q(e,t){try{const{useExternalServices:r}=this.messagingSystem.call("PreferencesController:getState");if(!r)return null;const s=t.filter(e=>S(j,this).call(this).includes(e)).map(e=>e);if(0===s.length)return null;return await(0,f.fetchAccountBalancesInBatches)({addresses:e,supportedChainIds:s,accountApiBaseUrl:m.ACCOUNTS_PROD_API_BASE_URL,batchSize:50,logger:{warn:e=>n.default.warn(e),debug:e=>n.default.debug(e)}})}catch(e){return n.default.warn("Failed to fetch balances from account API:",e),null}}async function W(e,t){try{const r=await k(R,this,q).call(this,e,[t]);return!(null==r||!r.balances)&&(this.update(s=>{const n=k(R,this,$).call(this,t),i={};Object.keys(n).forEach(t=>{e.includes(t)||(i[t]={address:t,balance:null})}),e.forEach(e=>{const s=(0,l.toCaipAccountId)("eip155",t,e);let a=null;for(const e in r.balances)if(Object.prototype.hasOwnProperty.call(r.balances,e)){const t=r.balances[e];if(t.accountAddress===s&&"native"===t.type&&"0x0000000000000000000000000000000000000000"===t.address){a=t;break}}if(a){const t=BigInt(Math.floor(parseFloat(a.balance)*Math.pow(10,a.decimals)));i[e]={address:e,balance:`0x${t.toString(16)}`}}else{const t=n[e];i[e]=t||{address:e,balance:null}}}),t===k(R,this,B).call(this)&&(s.accounts=i),s.accountsByChainId[t]=i}),!0)}catch(e){return n.default.warn("Failed to update accounts via multiaccount API:",e),!1}}async function V(e,t){return k(R,this,W).call(this,e,t)}async function z(e){try{const t=new Set;t.add(k(R,this,B).call(this)),S(M,this).forEach((e,r)=>{const{chainId:s}=k(R,this,x).call(this,r);t.add(s)});const r=Array.from(t);let s=!0;for(const t of r){await k(R,this,W).call(this,e,t)||(s=!1)}return s}catch(e){return n.default.warn("Failed to update accounts for all chains via multiaccount API:",e),!1}}r.default=L}}},{package:"$root$",file:"app/scripts/controllers/account-tracker-controller.ts"}],[157,{"../../../shared/constants/alerts":5413,"@metamask/base-controller":1222},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getDefaultAlertControllerState=r.AlertController=void 0;var s=e("@metamask/base-controller"),n=e("../../../shared/constants/alerts");function i(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function a(e,t,r){return e.set(o(e,t),r),r}function o(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const c=()=>({alertEnabledness:n.TOGGLEABLE_ALERT_TYPES.reduce((e,t)=>(e[t]=!0,e),{}),unconnectedAccountAlertShownOrigins:{},web3ShimUsageOrigins:{}});r.getDefaultAlertControllerState=c;const l={alertEnabledness:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},unconnectedAccountAlertShownOrigins:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!0},web3ShimUsageOrigins:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!0}};var u=new WeakMap,d=new WeakSet;class p extends s.BaseController{constructor(e){var t,r;super({messenger:e.messenger,metadata:l,name:"AlertController",state:{...c(),...e.state}}),i(t=this,r=d),r.add(t),function(e,t,r){i(e,t),t.set(e,r)}(this,u,void 0),a(u,this,this.messagingSystem.call("AccountsController:getSelectedAccount").address),this.messagingSystem.subscribe("AccountsController:selectedAccountChange",e=>{this.state.unconnectedAccountAlertShownOrigins&&function(e,t){return e.get(o(e,t))}(u,this)!==e.address&&(a(u,this,e.address),this.update(e=>{e.unconnectedAccountAlertShownOrigins={}}))})}setAlertEnabledness(e,t){this.update(r=>{r.alertEnabledness[e]=t})}setUnconnectedAccountAlertShown(e){this.update(t=>{t.unconnectedAccountAlertShownOrigins[e]=!0})}getWeb3ShimUsageState(e){var t;return null===(t=this.state.web3ShimUsageOrigins)||void 0===t?void 0:t[e]}setWeb3ShimUsageRecorded(e){o(d,this,h).call(this,e,n.Web3ShimUsageAlertStates.recorded)}setWeb3ShimUsageAlertDismissed(e){o(d,this,h).call(this,e,n.Web3ShimUsageAlertStates.dismissed)}}function h(e,t){this.update(r=>{r.web3ShimUsageOrigins&&(r.web3ShimUsageOrigins[e]=t)})}r.AlertController=p}}},{package:"$root$",file:"app/scripts/controllers/alert-controller.ts"}],[158,{"@metamask/base-controller":1222},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getDefaultAppMetadataControllerState=r.default=void 0;var s=e("@metamask/base-controller");function n(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function i(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const a=()=>({currentAppVersion:"",previousAppVersion:"",previousMigrationVersion:0,currentMigrationVersion:0});r.getDefaultAppMetadataControllerState=a;const o={currentAppVersion:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!1},previousAppVersion:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!1},previousMigrationVersion:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!1},currentMigrationVersion:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!1}};var c=new WeakSet;class l extends s.BaseController{constructor({state:e={},messenger:t,currentAppVersion:r="",currentMigrationVersion:s=0}){super({name:"AppMetadataController",metadata:o,state:{currentAppVersion:"",previousAppVersion:"",previousMigrationVersion:0,currentMigrationVersion:0,...e},messenger:t}),n(this,c),i(c,this,u).call(this,r),i(c,this,d).call(this,s)}}function u(e){const t=this.state.currentAppVersion;e!==t&&this.update(r=>{r.currentAppVersion=e,r.previousAppVersion=t})}function d(e){const t=this.state.currentMigrationVersion;e!==t&&this.update(r=>{r.previousMigrationVersion=t,r.currentMigrationVersion=e})}r.default=l}}},{package:"$root$",file:"app/scripts/controllers/app-metadata.ts"}],[159,{"../../../shared/constants/alarms":5412,"../../../shared/constants/app":5415,"../../../shared/constants/preferences":5438,"../../../shared/constants/time":5449,"../../../shared/modules/mv3.utils":5538,"../../../ui/helpers/utils/build-types":6670,"@metamask/base-controller":1222,"@metamask/controller-utils":1301,"@metamask/utils":2799,loglevel:4542,uuid:5366},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.AppStateController=void 0;var s,n=e("uuid"),i=(s=e("loglevel"))&&s.__esModule?s:{default:s},a=e("@metamask/controller-utils"),o=e("@metamask/base-controller"),c=e("@metamask/utils"),l=e("../../../shared/constants/time"),u=e("../../../shared/constants/alarms"),d=e("../../../shared/modules/mv3.utils"),p=e("../../../ui/helpers/utils/build-types"),h=e("../../../shared/constants/app"),m=e("../../../shared/constants/preferences");function g(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f(e,t,r){y(e,t),t.set(e,r)}function y(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function w(e,t){return e.get(S(e,t))}function v(e,t,r){return e.set(S(e,t),r),r}function S(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const b={activeQrCodeScanRequest:{includeInStateLogs:!1,persist:!1,anonymous:!0,usedInUi:!0},addressSecurityAlertResponses:{includeInStateLogs:!0,persist:!1,anonymous:!0,usedInUi:!0},browserEnvironment:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},connectedStatusPopoverHasBeenShown:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},currentExtensionPopupId:{includeInStateLogs:!0,persist:!1,anonymous:!0,usedInUi:!0},currentPopupId:{includeInStateLogs:!0,persist:!1,anonymous:!0,usedInUi:!0},defaultHomeActiveTabName:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},enableEnforcedSimulations:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},enableEnforcedSimulationsForTransactions:{includeInStateLogs:!0,persist:!1,anonymous:!0,usedInUi:!0},enforcedSimulationsSlippage:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},enforcedSimulationsSlippageForTransactions:{includeInStateLogs:!0,persist:!1,anonymous:!0,usedInUi:!0},fullScreenGasPollTokens:{includeInStateLogs:!0,persist:!1,anonymous:!0,usedInUi:!0},hadAdvancedGasFeesSetPriorToMigration92_3:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!1},isRampCardClosed:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},isUpdateAvailable:{includeInStateLogs:!0,persist:!1,anonymous:!0,usedInUi:!0},lastInteractedConfirmationInfo:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},lastUpdatedAt:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},lastViewedUserSurvey:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},networkConnectionBanner:{includeInStateLogs:!1,persist:!1,anonymous:!1,usedInUi:!0},newPrivacyPolicyToastClickedOrClosed:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},newPrivacyPolicyToastShownDate:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},nftsDetectionNoticeDismissed:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!1},nftsDropdownState:{includeInStateLogs:!0,persist:!1,anonymous:!0,usedInUi:!0},notificationGasPollTokens:{includeInStateLogs:!0,persist:!1,anonymous:!0,usedInUi:!0},onboardingDate:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},outdatedBrowserWarningLastShown:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},popupGasPollTokens:{includeInStateLogs:!0,persist:!1,anonymous:!0,usedInUi:!0},productTour:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},recoveryPhraseReminderHasBeenShown:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},recoveryPhraseReminderLastShown:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},showAccountBanner:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},showBetaHeader:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},showDownloadMobileAppSlide:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},showNetworkBanner:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},showPermissionsTour:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},showTestnetMessageInDropdown:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!1},signatureSecurityAlertResponses:{includeInStateLogs:!0,persist:!1,anonymous:!0,usedInUi:!0},slides:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},snapsInstallPrivacyWarningShown:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},surveyLinkLastClickedOrClosed:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},termsOfUseLastAgreed:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},throttledOrigins:{includeInStateLogs:!0,persist:!1,anonymous:!0,usedInUi:!0},timeoutMinutes:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!1},trezorModel:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!1},updateModalLastDismissedAt:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},hasShownMultichainAccountsIntroModal:{persist:!0,anonymous:!0,usedInUi:!0,includeInStateLogs:!0}};var k=new WeakMap,E=new WeakMap,T=new WeakMap,C=new WeakMap,M=new WeakMap,A=new WeakSet;class I extends o.BaseController{constructor({state:e={},messenger:t,onInactiveTimeout:r,extension:s}){super({name:"AppStateController",metadata:b,state:{activeQrCodeScanRequest:null,browserEnvironment:{},connectedStatusPopoverHasBeenShown:!0,defaultHomeActiveTabName:null,enableEnforcedSimulations:!0,enableEnforcedSimulationsForTransactions:{},enforcedSimulationsSlippage:10,enforcedSimulationsSlippageForTransactions:{},fullScreenGasPollTokens:[],hadAdvancedGasFeesSetPriorToMigration92_3:!1,isRampCardClosed:!1,isUpdateAvailable:!1,lastUpdatedAt:null,lastViewedUserSurvey:null,newPrivacyPolicyToastClickedOrClosed:null,newPrivacyPolicyToastShownDate:null,nftsDetectionNoticeDismissed:!1,notificationGasPollTokens:[],onboardingDate:null,outdatedBrowserWarningLastShown:null,popupGasPollTokens:[],productTour:"accountIcon",recoveryPhraseReminderHasBeenShown:!1,recoveryPhraseReminderLastShown:(new Date).getTime(),showAccountBanner:!0,showBetaHeader:(0,p.isBeta)(),showDownloadMobileAppSlide:!0,showNetworkBanner:!0,showPermissionsTour:!0,showTestnetMessageInDropdown:!0,slides:[],surveyLinkLastClickedOrClosed:null,throttledOrigins:{},timeoutMinutes:m.DEFAULT_AUTO_LOCK_TIME_LIMIT,trezorModel:null,updateModalLastDismissedAt:null,hasShownMultichainAccountsIntroModal:!1,addressSecurityAlertResponses:{},currentExtensionPopupId:0,nftsDropdownState:{},signatureSecurityAlertResponses:{},networkConnectionBanner:{status:"unknown"},...e,addressSecurityAlertResponses:{},currentExtensionPopupId:0,nftsDropdownState:{},signatureSecurityAlertResponses:{},networkConnectionBanner:{status:"unknown"}},messenger:t}),function(e,t){y(e,t),t.add(e)}(this,A),f(this,k,void 0),f(this,E,void 0),f(this,T,void 0),g(this,"waitingForUnlock",void 0),f(this,C,void 0),f(this,M,null),g(this,"getAddressSecurityAlertResponse",e=>{const t=this.state.addressSecurityAlertResponses[e.toLowerCase()];if(!t)return undefined;const r=Date.now(),s=15*l.MINUTE;if(r-t.timestamp>s)return this.update(t=>{delete t.addressSecurityAlertResponses[e.toLowerCase()]}),undefined;const{timestamp:n,...i}=t;return i}),g(this,"addAddressSecurityAlertResponse",(e,t)=>{this.update(r=>{r.addressSecurityAlertResponses[e.toLowerCase()]={...t,timestamp:Date.now()}})}),v(k,this,s),v(E,this,r||(()=>undefined)),v(T,this,null),this.waitingForUnlock=[],t.subscribe("KeyringController:unlock",S(A,this,P).bind(this)),t.subscribe("PreferencesController:stateChange",({preferences:e})=>{const t=this.state;"number"==typeof(null==e?void 0:e.autoLockTimeLimit)&&t.timeoutMinutes!==e.autoLockTimeLimit&&S(A,this,N).call(this,e.autoLockTimeLimit)});const{preferences:n}=t.call("PreferencesController:getState");"number"==typeof n.autoLockTimeLimit&&S(A,this,N).call(this,n.autoLockTimeLimit),this.messagingSystem.registerActionHandler("AppStateController:getUnlockPromise",this.getUnlockPromise.bind(this)),this.messagingSystem.registerActionHandler("AppStateController:requestQrCodeScan",S(A,this,B).bind(this)),v(C,this,null)}getUnlockPromise(e){return new Promise(t=>{const{isUnlocked:r}=this.messagingSystem.call("KeyringController:getState");r?t():S(A,this,_).call(this,t,e)})}setDefaultHomeActiveTabName(e){this.update(t=>{t.defaultHomeActiveTabName=e})}setConnectedStatusPopoverHasBeenShown(){this.update(e=>{e.connectedStatusPopoverHasBeenShown=!0})}setRecoveryPhraseReminderHasBeenShown(){this.update(e=>{e.recoveryPhraseReminderHasBeenShown=!0})}setSurveyLinkLastClickedOrClosed(e){this.update(t=>{t.surveyLinkLastClickedOrClosed=e})}setOnboardingDate(){this.update(e=>{e.onboardingDate=Date.now()})}setLastViewedUserSurvey(e){this.update(t=>{t.lastViewedUserSurvey=e})}setRampCardClosed(){this.update(e=>{e.isRampCardClosed=!0})}setNewPrivacyPolicyToastClickedOrClosed(){this.update(e=>{e.newPrivacyPolicyToastClickedOrClosed=!0})}setNewPrivacyPolicyToastShownDate(e){this.update(t=>{t.newPrivacyPolicyToastShownDate=e})}updateSlides(e){this.update(t=>{const r=t.slides||[],s=e.map(e=>{const t=r.find(t=>t.id===e.id);return t?{...t,...e}:e});t.slides=[...s]})}removeSlide(e){this.update(t=>{const r=t.slides||[];t.slides=r.map(t=>t.id===e?{...t,dismissed:!0}:t),e===h.DOWNLOAD_MOBILE_APP_SLIDE_ID&&(t.showDownloadMobileAppSlide=!1)})}setRecoveryPhraseReminderLastShown(e){this.update(t=>{t.recoveryPhraseReminderLastShown=e})}setTermsOfUseLastAgreed(e){this.update(t=>{t.termsOfUseLastAgreed=e})}setSnapsInstallPrivacyWarningShownStatus(e){this.update(t=>{t.snapsInstallPrivacyWarningShown=e})}setOutdatedBrowserWarningLastShown(e){this.update(t=>{t.outdatedBrowserWarningLastShown=e})}setLastActiveTime(){S(A,this,O).call(this)}setIsUpdateAvailable(e){this.update(t=>{t.isUpdateAvailable=e})}setUpdateModalLastDismissedAt(e){this.update(t=>{t.updateModalLastDismissedAt=e})}setLastUpdatedAt(e){this.update(t=>{t.lastUpdatedAt=e})}setBrowserEnvironment(e,t){this.update(r=>{r.browserEnvironment={os:e,browser:t}})}addPollingToken(e,t){t.toString()!==h.POLLING_TOKEN_ENVIRONMENT_TYPES[h.ENVIRONMENT_TYPE_BACKGROUND]&&S(A,this,R).call(this,t)&&S(A,this,j).call(this,e,t)}removePollingToken(e,t){if(t.toString()!==h.POLLING_TOKEN_ENVIRONMENT_TYPES[h.ENVIRONMENT_TYPE_BACKGROUND]){const r=this.state[t];S(A,this,R).call(this,t)&&this.update(s=>{s[t]=r.filter(t=>t!==e)})}}clearPollingTokens(){this.update(e=>{e.popupGasPollTokens=[],e.notificationGasPollTokens=[],e.fullScreenGasPollTokens=[]})}setShowTestnetMessageInDropdown(e){this.update(t=>{t.showTestnetMessageInDropdown=e})}setShowBetaHeader(e){this.update(t=>{t.showBetaHeader=e})}setShowPermissionsTour(e){this.update(t=>{t.showPermissionsTour=e})}setHasShownMultichainAccountsIntroModal(e){this.update(t=>{t.hasShownMultichainAccountsIntroModal=e})}setProductTour(e){this.update(t=>{t.productTour=e})}setShowNetworkBanner(e){this.update(t=>{t.showNetworkBanner=e})}updateNetworkConnectionBanner(e){this.update(t=>{t.networkConnectionBanner=e})}setShowAccountBanner(e){this.update(t=>{t.showAccountBanner=e})}setCurrentExtensionPopupId(e){this.update(t=>{t.currentExtensionPopupId=e})}setTrezorModel(e){this.update(t=>{t.trezorModel=e})}updateNftDropDownState(e){this.update(t=>{t.nftsDropdownState=e})}getSignatureSecurityAlertResponse(e){return this.state.signatureSecurityAlertResponses[e]}addSignatureSecurityAlertResponse(e){e.securityAlertId&&this.update(t=>{t.signatureSecurityAlertResponses[String(e.securityAlertId)]=e})}setCurrentPopupId(e){this.update(t=>{t.currentPopupId=e})}getLastInteractedConfirmationInfo(){return this.state.lastInteractedConfirmationInfo}setLastInteractedConfirmationInfo(e){this.update(t=>{t.lastInteractedConfirmationInfo=e})}getCurrentPopupId(){return this.state.currentPopupId}getThrottledOriginState(e){return this.state.throttledOrigins[e]}updateThrottledOriginState(e,t){this.update(r=>{r.throttledOrigins[e]=t})}completeQrCodeScan(e){if(!w(M,this))throw new Error("No QR code scan is in progress.");this.update(e=>{e.activeQrCodeScanRequest=null}),w(M,this).resolve(e),v(M,this,null)}cancelQrCodeScan(e){if(!w(M,this))throw new Error("No QR code scan is in progress.");this.update(e=>{e.activeQrCodeScanRequest=null}),w(M,this).reject(e||new Error("Scan cancelled")),v(M,this,null)}setEnableEnforcedSimulations(e){this.update(t=>{t.enableEnforcedSimulations=e})}setEnableEnforcedSimulationsForTransaction(e,t){this.update(r=>{r.enableEnforcedSimulationsForTransactions[e]=t})}setEnforcedSimulationsSlippage(e){this.update(t=>{t.enforcedSimulationsSlippage=e})}setEnforcedSimulationsSlippageForTransaction(e,t){this.update(r=>{r.enforcedSimulationsSlippageForTransactions[e]=t})}}function _(e,t){this.waitingForUnlock.push({resolve:e}),this.messagingSystem.publish("AppStateController:unlockChange"),t&&S(A,this,D).call(this)}function P(){if(this.waitingForUnlock.length>0){for(;this.waitingForUnlock.length>0;){var e;null===(e=this.waitingForUnlock.shift())||void 0===e||e.resolve()}this.messagingSystem.publish("AppStateController:unlockChange")}S(A,this,L).call(this)}function N(e){this.update(t=>{t.timeoutMinutes=e}),S(A,this,O).call(this)}function O(){const{timeoutMinutes:e}=this.state;if(w(T,this)?clearTimeout(w(T,this)):d.isManifestV3&&w(k,this).alarms.clear(u.AUTO_LOCK_TIMEOUT_ALARM),!e)return;const t=Number(e);d.isManifestV3?(w(k,this).alarms.create(u.AUTO_LOCK_TIMEOUT_ALARM,{delayInMinutes:t,periodInMinutes:t}),w(k,this).alarms.onAlarm.addListener(e=>{e.name===u.AUTO_LOCK_TIMEOUT_ALARM&&(w(E,this).call(this),w(k,this).alarms.clear(u.AUTO_LOCK_TIMEOUT_ALARM))})):v(T,this,setTimeout(()=>w(E,this).call(this),t*l.MINUTE))}function j(e,t){this.update(r=>{r[t].push(e)})}function R(e){return["popupGasPollTokens","notificationGasPollTokens","fullScreenGasPollTokens"].includes(e)}function D(){w(C,this)||(v(C,this,(0,n.v4)()),this.messagingSystem.call("ApprovalController:addRequest",{id:w(C,this),origin:h.ORIGIN_METAMASK,type:a.ApprovalType.Unlock},!0).catch(()=>{v(C,this,null)}))}function L(){if(w(C,this)){try{this.messagingSystem.call("ApprovalController:acceptRequest",w(C,this))}catch(e){i.default.error("Failed to unlock approval request",e)}v(C,this,null)}}function B(e){if(w(M,this))return w(M,this).promise;const t=(0,c.createDeferredPromise)();return v(M,this,t),this.update(t=>{t.activeQrCodeScanRequest=e}),t.promise}r.AppStateController=I}}},{package:"$root$",file:"app/scripts/controllers/app-state-controller.ts"}],[16,{"../../../../shared/constants/network":5433,"@metamask/keyring-api":1994,"@metamask/network-enablement-controller":2197,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.NetworkEnablementControllerInit=void 0;var s=e("@metamask/network-enablement-controller"),n=e("@metamask/keyring-api"),i=e("@metamask/utils"),a=e("../../../../shared/constants/network");const o=(e,t)=>{const r={[i.KnownCaipNamespace.Eip155]:{}};return Object.keys(e).forEach(e=>{r[i.KnownCaipNamespace.Eip155][e]=t.includes(e)}),r},c=(e,t=[])=>{const r={};return Object.keys(e).forEach(e=>{const s=t.includes(e),{namespace:n}=(0,i.parseCaipChainId)(e);(r[n]??(r[n]={}))[e]=s}),r},l=(e,t)=>{const{networkConfigurationsByChainId:r}=e,{multichainNetworkConfigurationsByChainId:s}=t;const i=[n.SolScope.Mainnet];return{enabledNetworkMap:{...o(r,a.FEATURED_NETWORK_CHAIN_IDS),...c(s,i)}}};r.NetworkEnablementControllerInit=({controllerMessenger:e,persistedState:t,getController:r})=>{const n=r("MultichainNetworkController").state,i=r("NetworkController").state;return{controller:new s.NetworkEnablementController({messenger:e,state:{...l(i,n),...t.NetworkEnablementController}})}}}}},{package:"$root$",file:"app/scripts/controller-init/assets/network-enablement-controller-init.ts"}],[160,{"../../../shared/constants/metametrics":5430,"../../../shared/modules/hexstring-utils":5535,"@metamask/base-controller":1222,"@metamask/controller-utils":1301,"@metamask/message-manager":2057,"@metamask/utils":2799,buffer:3760,loglevel:4542},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.managerName=r.isEIP1024EncryptedMessage=r.getDefaultState=r.default=void 0;var s,n=(s=e("loglevel"))&&s.__esModule?s:{default:s},i=e("@metamask/message-manager"),a=e("@metamask/base-controller"),o=e("@metamask/controller-utils"),c=e("@metamask/utils"),l=e("../../../shared/constants/metametrics"),u=e("../../../shared/modules/hexstring-utils");function d(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const p={unapprovedDecryptMsgs:{includeInStateLogs:!0,persist:!1,anonymous:!1,usedInUi:!0},unapprovedDecryptMsgCount:{includeInStateLogs:!0,persist:!1,anonymous:!1,usedInUi:!0}},h=r.managerName="DecryptMessageManager",m=e=>!!((0,c.isObject)(e.data)&&(0,c.hasProperty)(e.data,"version")&&(0,c.hasProperty)(e.data,"nonce")&&(0,c.hasProperty)(e.data,"ephemPublicKey")&&(0,c.hasProperty)(e.data,"ciphertext"));r.isEIP1024EncryptedMessage=m;const g=()=>({unapprovedDecryptMsgs:{},unapprovedDecryptMsgCount:0});r.getDefaultState=g;class f extends a.BaseController{constructor({getState:e,metricsEvent:t,messenger:r,managerMessenger:s}){super({metadata:p,messenger:r,name:"DecryptMessageController",state:{unapprovedDecryptMsgs:{},unapprovedDecryptMsgCount:0}}),d(this,"_getState",void 0),d(this,"_metricsEvent",void 0),d(this,"_decryptMessageManager",void 0),this._getState=e,this._metricsEvent=t,this._decryptMessageManager=new i.DecryptMessageManager({additionalFinishStatuses:["decrypted"],messenger:s}),r.subscribe(`${h}:unapprovedMessage`,this._requestApproval.bind(this)),this._subscribeToMessageState(r,(e,t,r)=>{e.unapprovedDecryptMsgs=t,e.unapprovedDecryptMsgCount=r})}get unapprovedDecryptMsgCount(){return this._decryptMessageManager.getUnapprovedMessagesCount()}resetState(){this.update(()=>({unapprovedDecryptMsgs:{},unapprovedDecryptMsgCount:0}))}clearUnapproved(){this._decryptMessageManager.clearUnapprovedMessages()}async newRequestDecryptMessage(e,t){return this._decryptMessageManager.addUnapprovedMessageAsync(e,t)}async decryptMessage(e){const t=e.metamaskId;try{const r=await this._decryptMessageManager.approveMessage(e);if(r.data=this._parseMessageData(r.data),!m(r))throw new Error("Invalid encrypted data.");const s=await this.messagingSystem.call("KeyringController:decryptMessage",r);this._decryptMessageManager.setMessageStatusAndResult(t,s,"decrypted"),this._acceptApproval(t)}catch(e){throw n.default.info("MetaMaskController - eth_decrypt failed.",e),this._cancelAbstractMessage(this._decryptMessageManager,t),e}return this._getState()}async decryptMessageInline(e){const t=e.metamaskId;if(e.data=this._parseMessageData(e.data),!m(e))throw new Error("Invalid encrypted data.");const r=await this.messagingSystem.call("KeyringController:decryptMessage",e);return this._decryptMessageManager.setResult(t,r),this._getState()}cancelDecryptMessage(e){return this._decryptMessageManager.rejectMessage(e),this._rejectApproval(e),this._getState()}rejectUnapproved(e){Object.keys(this._decryptMessageManager.getUnapprovedMessages()).forEach(t=>{this._cancelAbstractMessage(this._decryptMessageManager,t,e)})}_acceptApproval(e){this.messagingSystem.call("ApprovalController:acceptRequest",e)}_cancelAbstractMessage(e,t,r){return r&&this._metricsEvent({event:r,category:l.MetaMetricsEventCategory.Messages,properties:{action:"Decrypt Message Request"}}),e.rejectMessage(t),this._rejectApproval(t),this._getState()}_subscribeToMessageState(e,t){e.subscribe(`${h}:stateChange`,e=>{const r=this._migrateMessages(e.unapprovedMessages);this.update(s=>{t(s,r,e.unapprovedMessagesCount)})})}_migrateMessages(e){const t={};for(const r of Object.keys(e)){const s=e[r],n=this._migrateMessage(s);t[r]=n}return t}_migrateMessage(e){const{messageParams:t,...r}=e;return{...r,rawSig:e.rawSig,msgParams:t,origin:t.origin}}_requestApproval(e){const t=e.metamaskId,r=e.origin||o.ORIGIN_METAMASK;try{this.messagingSystem.call("ApprovalController:addRequest",{id:t,origin:r,type:o.ApprovalType.EthDecrypt},!0)}catch(e){n.default.info("Error adding request to approval controller",e)}}_parseMessageData(e){const r=(0,u.stripHexPrefix)(e),s=t.from(r,"hex");return JSON.parse(s.toString("utf8"))}_rejectApproval(e){try{this.messagingSystem.call("ApprovalController:rejectRequest",e,"Cancel")}catch(e){n.default.info("Error rejecting request to approval controller",e)}}}r.default=f}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"$root$",file:"app/scripts/controllers/decrypt-message.ts"}],[161,{"../../../shared/constants/app":5415,"../../../shared/constants/keyring":5426,"../../../shared/constants/metametrics":5430,"@metamask/base-controller":1222,"@metamask/message-manager":2057,loglevel:4542},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s,n=(s=e("loglevel"))&&s.__esModule?s:{default:s},i=e("@metamask/message-manager"),a=e("@metamask/base-controller"),o=e("../../../shared/constants/metametrics"),c=e("../../../shared/constants/keyring"),l=e("../../../shared/constants/app");function u(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const d="EncryptionPublicKeyManager",p={unapprovedEncryptionPublicKeyMsgs:{includeInStateLogs:!0,persist:!1,anonymous:!1,usedInUi:!0},unapprovedEncryptionPublicKeyMsgCount:{includeInStateLogs:!0,persist:!1,anonymous:!1,usedInUi:!0}};class h extends a.BaseController{constructor({messenger:e,managerMessenger:t,getEncryptionPublicKey:r,getAccountKeyringType:s,getState:n,metricsEvent:a}){super({name:"EncryptionPublicKeyController",metadata:p,messenger:e,state:{unapprovedEncryptionPublicKeyMsgs:{},unapprovedEncryptionPublicKeyMsgCount:0}}),u(this,"_getEncryptionPublicKey",void 0),u(this,"_getAccountKeyringType",void 0),u(this,"_getState",void 0),u(this,"_encryptionPublicKeyManager",void 0),u(this,"_metricsEvent",void 0),this._getEncryptionPublicKey=r,this._getAccountKeyringType=s,this._getState=n,this._metricsEvent=a,this._encryptionPublicKeyManager=new i.EncryptionPublicKeyManager({additionalFinishStatuses:["received"],messenger:t}),this.messagingSystem.subscribe(`${d}:unapprovedMessage`,this._requestApproval.bind(this)),this._subscribeToMessageState(e,(e,t,r)=>{e.unapprovedEncryptionPublicKeyMsgs=t,e.unapprovedEncryptionPublicKeyMsgCount=r})}get unapprovedMsgCount(){return this._encryptionPublicKeyManager.getUnapprovedMessagesCount()}resetState(){this.update(()=>({unapprovedEncryptionPublicKeyMsgs:{},unapprovedEncryptionPublicKeyMsgCount:0}))}async newRequestEncryptionPublicKey(e,t){switch(await this._getAccountKeyringType(e)){case c.KeyringType.ledger:return new Promise((e,t)=>{t(new Error("Ledger does not support eth_getEncryptionPublicKey."))});case c.KeyringType.trezor:return new Promise((e,t)=>{t(new Error("Trezor does not support eth_getEncryptionPublicKey."))});case c.KeyringType.lattice:return new Promise((e,t)=>{t(new Error("Lattice does not support eth_getEncryptionPublicKey."))});case c.KeyringType.qr:return Promise.reject(new Error("QR hardware does not support eth_getEncryptionPublicKey."));default:return this._encryptionPublicKeyManager.addUnapprovedMessageAsync({from:e},t)}}async encryptionPublicKey(e){n.default.info("MetaMaskController - encryptionPublicKey");const t=e.metamaskId;try{const r=await this._encryptionPublicKeyManager.approveMessage(e),s=await this._getEncryptionPublicKey(r.from);return this._encryptionPublicKeyManager.setMessageStatusAndResult(t,s,"received"),this._acceptApproval(t),this._getState()}catch(e){throw n.default.info("MetaMaskController - eth_getEncryptionPublicKey failed.",e),this._cancelAbstractMessage(this._encryptionPublicKeyManager,t),e}}cancelEncryptionPublicKey(e){return this._cancelAbstractMessage(this._encryptionPublicKeyManager,e)}rejectUnapproved(e){Object.keys(this._encryptionPublicKeyManager.getUnapprovedMessages()).forEach(t=>{this._cancelAbstractMessage(this._encryptionPublicKeyManager,t,e)})}clearUnapproved(){this._encryptionPublicKeyManager.clearUnapprovedMessages()}_cancelAbstractMessage(e,t,r){return r&&this._metricsEvent({event:r,category:o.MetaMetricsEventCategory.Messages,properties:{action:"Encryption public key Request"}}),e.rejectMessage(t),this._rejectApproval(t),this._getState()}_subscribeToMessageState(e,t){e.subscribe(`${d}:stateChange`,e=>{const r=this._migrateMessages(e.unapprovedMessages);this.update(s=>{t(s,r,e.unapprovedMessagesCount)})})}_migrateMessages(e){const t={};for(const r of Object.keys(e)){const s=e[r],n=this._migrateMessage(s);t[r]=n}return t}_migrateMessage(e){const{messageParams:t,...r}=e;return{...r,rawSig:e.rawSig,msgParams:t.from,origin:t.origin}}_requestApproval(e){const t=e.metamaskId,r=e.origin||l.ORIGIN_METAMASK;this.messagingSystem.call("ApprovalController:addRequest",{id:t,origin:r,type:"eth_getEncryptionPublicKey"},!0).catch(()=>{})}_acceptApproval(e){this.messagingSystem.call("ApprovalController:acceptRequest",e)}_rejectApproval(e){this.messagingSystem.call("ApprovalController:rejectRequest",e,"Cancel")}}r.default=h}}},{package:"$root$",file:"app/scripts/controllers/encryption-public-key.ts"}],[162,{"../../../../shared/lib/accounts/institutional-wallet-snap":5457,"@metamask/base-controller":1222,"@metamask/controller-utils":1301,"@metamask/snaps-utils":2677,"@metamask/transaction-controller":2754},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.InstitutionalSnapController=void 0;var s=e("@metamask/transaction-controller"),n=e("@metamask/snaps-utils"),i=e("@metamask/base-controller"),a=e("@metamask/controller-utils");function o(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function c(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const l=e("../../../../shared/lib/accounts/institutional-wallet-snap").INSTITUTIONAL_WALLET_SNAP_ID,u="InstitutionalSnapController",d={};var p=new WeakSet;class h extends i.BaseController{constructor({messenger:e}){super({messenger:e,name:u,state:{},metadata:d}),o(this,p),c(p,this,m).call(this)}async deferPublicationHook(e){if(await c(p,this,w).call(this,e)){const t=await c(p,this,f).call(this,e);return await c(p,this,y).call(this,e.id,t),!1}return!0}async beforeCheckPendingTransactionHook(e){return!await c(p,this,w).call(this,e)}}function m(){this.messagingSystem.registerActionHandler(`${u}:publishHook`,this.deferPublicationHook.bind(this)),this.messagingSystem.registerActionHandler(`${u}:beforeCheckPendingTransactionHook`,this.beforeCheckPendingTransactionHook.bind(this))}async function g(e){return await this.messagingSystem.call("SnapController:handleRequest",e)}async function f(e){const t={from:e.txParams.from,to:e.txParams.to,value:e.txParams.value,data:e.txParams.data,chainId:e.chainId},r={snapId:l,origin:a.ORIGIN_METAMASK,handler:n.HandlerType.OnRpcRequest,request:{method:"transactions.getMutableTransactionParameters",params:t}},i=await c(p,this,g).call(this,r);return{hash:i.transaction.transactionHash,nonce:i.transaction.nonce,gasLimit:i.transaction.gasLimit,maxFeePerGas:i.transaction.maxFeePerGas,maxPriorityFeePerGas:i.transaction.maxPriorityFeePerGas,type:i.transaction.type,status:s.TransactionStatus.submitted}}async function y(e,{status:t,hash:r,nonce:s,gasLimit:n,maxFeePerGas:i,maxPriorityFeePerGas:a,type:o}){return await this.messagingSystem.call("TransactionController:updateCustodialTransaction",{transactionId:e,status:t,hash:r,nonce:s,gasLimit:n,maxFeePerGas:i,maxPriorityFeePerGas:a,type:o})}async function w(e){var t;const r=await this.messagingSystem.call("AccountsController:getAccountByAddress",e.txParams.from);return null==r||null===(t=r.options.custodian)||void 0===t?void 0:t.deferPublication}r.InstitutionalSnapController=h}}},{package:"$root$",file:"app/scripts/controllers/institutional-snap/InstitutionalSnapController.ts"}],[163,{"../../../development/build/constants":519,"../../../shared/constants/alarms":5412,"../../../shared/constants/app":5415,"../../../shared/constants/keyring":5426,"../../../shared/constants/metametrics":5430,"../../../shared/constants/time":5449,"../../../shared/constants/transaction":5451,"../../../shared/lib/trace":5517,"../../../shared/modules/mv3.utils":5538,"../lib/util":290,"@metamask/base-controller":1222,"@metamask/name-controller":2156,"@metamask/utils":2799,buffer:3760,"ethereumjs-util":4019,lodash:4534,uuid:5366},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.overrideAnonymousEventNames=r.getDefaultMetaMetricsControllerState=r.default=void 0;var s=e("lodash"),n=e("ethereumjs-util"),i=e("uuid"),a=e("@metamask/name-controller"),o=e("@metamask/utils"),c=e("@metamask/base-controller"),l=e("../../../shared/constants/app"),u=e("../../../shared/constants/metametrics"),d=e("../../../shared/constants/time"),p=e("../../../shared/modules/mv3.utils"),h=e("../../../shared/constants/alarms"),m=e("../lib/util"),g=e("../../../shared/constants/transaction"),f=e("../../../shared/lib/trace"),y=e("../../../development/build/constants"),w=e("../../../shared/constants/keyring");function v(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function S(e,t,r){b(e,t),t.set(e,r)}function b(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function k(e,t){return e.get(T(e,t))}function E(e,t,r){return e.set(T(e,t),r),r}function T(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const C=r.overrideAnonymousEventNames={[g.TransactionMetaMetricsEvent.added]:g.AnonymousTransactionMetaMetricsEvent.added,[g.TransactionMetaMetricsEvent.approved]:g.AnonymousTransactionMetaMetricsEvent.approved,[g.TransactionMetaMetricsEvent.finalized]:g.AnonymousTransactionMetaMetricsEvent.finalized,[g.TransactionMetaMetricsEvent.rejected]:g.AnonymousTransactionMetaMetricsEvent.rejected,[g.TransactionMetaMetricsEvent.submitted]:g.AnonymousTransactionMetaMetricsEvent.submitted,[u.MetaMetricsEventName.SignatureRequested]:u.MetaMetricsEventName.SignatureRequestedAnon,[u.MetaMetricsEventName.SignatureApproved]:u.MetaMetricsEventName.SignatureApprovedAnon,[u.MetaMetricsEventName.SignatureRejected]:u.MetaMetricsEventName.SignatureRejectedAnon},M=e=>{setTimeout(()=>{throw e})},A=e=>{const t=[];return e.uniqueIdentifier&&t.push(e.uniqueIdentifier),e.actionId&&t.push(e.actionId),t.length&&e.isDuplicateAnonymizedEvent&&t.push("0x000"),t.length?t.join("-"):(0,m.generateRandomId)()},I={'You must pass either an "anonymousId" or a "userId".':!0},_={metaMetricsId:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},participateInMetaMetrics:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},latestNonAnonymousEventTimestamp:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},fragments:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!0},eventsBeforeMetricsOptIn:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!1},tracesBeforeMetricsOptIn:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!1},traits:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!1},dataCollectionForMarketing:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!0},marketingCampaignCookieId:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!1},segmentApiCalls:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!1}},P=()=>({participateInMetaMetrics:null,metaMetricsId:null,dataCollectionForMarketing:null,marketingCampaignCookieId:null,latestNonAnonymousEventTimestamp:0,eventsBeforeMetricsOptIn:[],tracesBeforeMetricsOptIn:[],traits:{},fragments:{},segmentApiCalls:{}});r.getDefaultMetaMetricsControllerState=P;var N=new WeakMap,O=new WeakMap,j=new WeakMap,R=new WeakMap,D=new WeakSet,L=new WeakMap;class B extends c.BaseController{constructor({state:e={},messenger:t,segment:r,version:n,environment:i,extension:a,captureException:c=M}){var l,u;super({name:"MetaMetricsController",metadata:_,state:{participateInMetaMetrics:null,metaMetricsId:null,dataCollectionForMarketing:null,marketingCampaignCookieId:null,latestNonAnonymousEventTimestamp:0,eventsBeforeMetricsOptIn:[],tracesBeforeMetricsOptIn:[],traits:{},fragments:{},segmentApiCalls:{},...e},messenger:t}),b(l=this,u=D),u.add(l),S(this,N,void 0),v(this,"chainId",void 0),v(this,"locale",void 0),v(this,"previousUserTraits",void 0),v(this,"version",void 0),S(this,O,void 0),S(this,j,void 0),S(this,R,void 0),S(this,L,(0,s.memoize)((e={})=>Object.values(e).reduce((e,t)=>e.concat(...Object.values(t)),[]))),E(N,this,e=>{const t=(0,o.getErrorMessage)(e);I[t]||c(e)}),this.chainId=T(D,this,x).call(this);const g=this.messagingSystem.call("PreferencesController:getState");this.locale=g.currentLocale.replace("_","-"),this.version="production"===i?n:`${n}-${i}`,E(O,this,a),E(j,this,i),this.messagingSystem.registerActionHandler("MetaMetricsController:trackEvent",this.trackEvent.bind(this)),this.messagingSystem.registerActionHandler("MetaMetricsController:getMetaMetricsId",this.getMetaMetricsId.bind(this)),this.messagingSystem.registerActionHandler("MetaMetricsController:createEventFragment",this.createEventFragment.bind(this)),this.messagingSystem.registerActionHandler("MetaMetricsController:getEventFragmentById",this.getEventFragmentById.bind(this)),this.messagingSystem.registerActionHandler("MetaMetricsController:updateEventFragment",this.updateEventFragment.bind(this)),this.messagingSystem.registerActionHandler("MetaMetricsController:deleteEventFragment",this.deleteEventFragment.bind(this)),this.messagingSystem.registerActionHandler("MetaMetricsController:finalizeEventFragment",this.finalizeEventFragment.bind(this));const f=(0,s.omitBy)(e.fragments,"persist");this.messagingSystem.subscribe("PreferencesController:stateChange",({currentLocale:e})=>{this.locale=null==e?void 0:e.replace("_","-")}),this.messagingSystem.subscribe("NetworkController:networkDidChange",({selectedNetworkClientId:e})=>{this.chainId=T(D,this,x).call(this,e)}),E(R,this,r),Object.values(f).forEach(e=>{this.processAbandonedFragment(e)}),p.isManifestV3&&Object.values(e.segmentApiCalls||{}).forEach(({eventType:e,payload:t})=>{try{T(D,this,X).call(this,e,t)}catch(e){k(N,this).call(this,e)}}),p.isManifestV3?(k(O,this).alarms.getAll().then(e=>{(0,m.checkAlarmExists)(e,h.METAMETRICS_FINALIZE_EVENT_FRAGMENT_ALARM)||k(O,this).alarms.create(h.METAMETRICS_FINALIZE_EVENT_FRAGMENT_ALARM,{delayInMinutes:1,periodInMinutes:1})}),k(O,this).alarms.onAlarm.addListener(e=>{e.name===h.METAMETRICS_FINALIZE_EVENT_FRAGMENT_ALARM&&this.finalizeAbandonedFragments()})):setInterval(()=>{this.finalizeAbandonedFragments()},30*d.SECOND)}finalizeAbandonedFragments(){Object.values(this.state.fragments).forEach(e=>{e.timeout&&e.lastUpdated&&Date.now()-e.lastUpdated/1e3>e.timeout&&this.processAbandonedFragment(e)})}generateMetaMetricsId(){return(0,n.bufferToHex)((0,n.keccak)(t.from(String(Date.now())+String(Math.round(Math.random()*Number.MAX_SAFE_INTEGER)))))}createEventFragment(e){if(!e.successEvent)throw new Error(`Must specify success event. Success event was: ${e.event}. Payload keys were: ${Object.keys(e)}. ${"object"==typeof e.properties?`Payload property keys were: ${Object.keys(e.properties)}`:""}`);const{fragments:t}=this.state,r=e.uniqueIdentifier??(0,i.v4)(),n={id:r,...e,lastUpdated:Date.now()},a=e.initialEvent===g.TransactionMetaMetricsEvent.submitted&&t[r]?{...t[r],canDeleteIfAbandoned:!1}:{};return this.update(e=>{e.fragments[r]=(0,s.merge)({},a,n)}),n.initialEvent&&this.trackEvent({event:n.initialEvent,category:n.category,properties:n.properties,sensitiveProperties:n.sensitiveProperties,page:n.page,referrer:n.referrer,revenue:n.revenue,value:n.value,currency:n.currency,environmentType:n.environmentType,actionId:e.actionId,uniqueIdentifier:e.uniqueIdentifier}),n}getEventFragmentById(e){return this.state.fragments[e]}processAbandonedFragment(e){e.canDeleteIfAbandoned?this.deleteEventFragment(e.id):this.finalizeEventFragment(e.id,{abandoned:!0})}updateEventFragment(e,t){const{fragments:r}=this.state,n=r[e];if(!n&&e.includes("transaction-submitted-"))this.update(r=>{r.fragments[e]={canDeleteIfAbandoned:!0,category:u.MetaMetricsEventCategory.Transactions,successEvent:g.TransactionMetaMetricsEvent.finalized,id:e,...t,lastUpdated:Date.now()}});else{if(!n)throw new Error(`Event fragment with id ${e} does not exist.`);this.update(r=>{r.fragments[e]=(0,s.merge)(r.fragments[e],{...t,lastUpdated:Date.now()})})}}deleteEventFragment(e){this.state.fragments[e]&&this.update(t=>{delete t.fragments[e]})}finalizeEventFragment(e,{abandoned:t=!1,page:r,referrer:s}={}){const n=this.state.fragments[e];if(!n)throw new Error(`Funnel with id ${e} does not exist.`);const i=t?n.failureEvent:n.successEvent;this.trackEvent({event:i??"",category:n.category,properties:n.properties,sensitiveProperties:n.sensitiveProperties,page:r??n.page,referrer:n.referrer??s,revenue:n.revenue,value:n.value,currency:n.currency,environmentType:n.environmentType,actionId:n.actionId,uniqueIdentifier:n.uniqueIdentifier?`${n.uniqueIdentifier}-${t?"failure":"success"}`:undefined}),this.update(t=>{delete t.fragments[e]})}identify(e){const{metaMetricsId:t,participateInMetaMetrics:r}=this.state;if(!r||!t||!e)return;if("object"!=typeof e)return void console.warn("MetaMetricsController#identify: userTraits parameter must be an object. Received type: "+typeof e);const s=T(D,this,G).call(this,e);T(D,this,V).call(this,s)}updateExtensionUninstallUrl(e,r){const s={av:this.version};e&&(s.mmi=t.from(r).toString("base64"),s.env=k(j,this));const n=new URLSearchParams(s);k(O,this)&&k(O,this).runtime&&k(O,this).runtime.setUninstallURL(`https://metamask.io/uninstalled?${n}`)}async setParticipateInMetaMetrics(e){const{metaMetricsId:t}=this.state,r=e&&!t?this.generateMetaMetricsId():t;return this.update(t=>{t.participateInMetaMetrics=e,t.metaMetricsId=r}),e?(this.trackEventsAfterMetricsOptIn(),this.clearEventsAfterMetricsOptIn(),this.trackTracesAfterMetricsOptIn(),this.clearTracesAfterMetricsOptIn()):this.state.marketingCampaignCookieId&&this.setMarketingCampaignCookieId(null),k(j,this)!==y.ENVIRONMENT.DEVELOPMENT&&null!==r&&this.updateExtensionUninstallUrl(e,r),r}setDataCollectionForMarketing(e){const{metaMetricsId:t}=this.state;return this.update(t=>{t.dataCollectionForMarketing=e}),!e&&this.state.marketingCampaignCookieId&&this.setMarketingCampaignCookieId(null),t}setMarketingCampaignCookieId(e){this.update(t=>{t.marketingCampaignCookieId=e})}trackPage(e,t){try{if(!1===this.state.participateInMetaMetrics)return;if(null===this.state.participateInMetaMetrics&&(null==t||!t.isOptInPath))return;const{name:r,params:s,environmentType:n,page:i,referrer:a,actionId:o}=e,{metaMetricsId:c}=this.state,l=c?"userId":"anonymousId",d=c??u.METAMETRICS_ANONYMOUS_ID;T(D,this,X).call(this,"page",{messageId:A({actionId:o}),[l]:d,name:r,properties:{params:s,locale:this.locale,chain_id:this.chainId,environment_type:n},context:T(D,this,$).call(this,a,i)})}catch(e){k(N,this).call(this,e)}}trackEvent(e,t){T(D,this,U).call(this,e),T(D,this,F).call(this,e,t).catch(e=>{k(N,this).call(this,e)})}handleMetaMaskStateUpdate(e){const t=this._buildUserTraitsObject(e);t&&this.identify(t)}trackEventsAfterMetricsOptIn(){const{eventsBeforeMetricsOptIn:e}=this.state;e.forEach(e=>{this.trackEvent(e)})}clearEventsAfterMetricsOptIn(){this.update(e=>{e.eventsBeforeMetricsOptIn=[]})}addEventBeforeMetricsOptIn(e){this.update(t=>{t.eventsBeforeMetricsOptIn.push(e)})}trackTracesAfterMetricsOptIn(){const{tracesBeforeMetricsOptIn:e}=this.state;e.forEach(e=>{"start"===e.type?(0,f.trace)(e.request):"end"===e.type&&(0,f.endTrace)(e.request)})}clearTracesAfterMetricsOptIn(){this.update(e=>{e.tracesBeforeMetricsOptIn=[]})}addTraceBeforeMetricsOptIn(e){this.update(t=>{t.tracesBeforeMetricsOptIn.push(e)})}bufferedTrace(e,t){if(this.state.participateInMetaMetrics)return t?(0,f.trace)(e,t):(0,f.trace)(e);let r;if(e.parentContext&&"object"==typeof e.parentContext){const t=e.parentContext;r=null==t?void 0:t._name}return this.addTraceBeforeMetricsOptIn({type:"start",request:{...e,parentContext:undefined,startTime:e.startTime??Date.now()},parentTraceName:r}),undefined}bufferedEndTrace(e){this.state.participateInMetaMetrics?(0,f.endTrace)(e):this.addTraceBeforeMetricsOptIn({type:"end",request:{...e,timestamp:e.timestamp??Date.now()}})}updateTraits(e){this.update(t=>{t.traits={...t.traits,...e}})}getMetaMetricsId(){let{metaMetricsId:e}=this.state;return e||(e=this.generateMetaMetricsId(),this.update(t=>{t.metaMetricsId=e})),e}_buildUserTraitsObject(e){var t,r,n;const{traits:i}=this.state,a={[u.MetaMetricsUserTrait.AddressBookEntries]:(0,s.sum)(Object.values(e.addressBook).map(s.size)),[u.MetaMetricsUserTrait.InstallDateExt]:i[u.MetaMetricsUserTrait.InstallDateExt]||"",[u.MetaMetricsUserTrait.LedgerConnectionType]:e.ledgerTransportType,[u.MetaMetricsUserTrait.NetworksAdded]:Object.values(e.networkConfigurationsByChainId).map(e=>e.chainId),[u.MetaMetricsUserTrait.NetworksWithoutTicker]:Object.values(e.networkConfigurationsByChainId).filter(({nativeCurrency:e})=>!e).map(({chainId:e})=>e),[u.MetaMetricsUserTrait.ChainIdList]:[...Object.keys(e.networkConfigurationsByChainId).map(e=>`eip155:${parseInt(e,16)}`),...Object.keys(e.multichainNetworkConfigurationsByChainId)],[u.MetaMetricsUserTrait.NftAutodetectionEnabled]:e.useNftDetection,[u.MetaMetricsUserTrait.NumberOfAccounts]:Object.values(e.internalAccounts.accounts).length,[u.MetaMetricsUserTrait.NumberOfNftCollections]:T(D,this,K).call(this,e.allNfts),[u.MetaMetricsUserTrait.NumberOfNfts]:k(L,this).call(this,e.allNfts).length,[u.MetaMetricsUserTrait.NumberOfTokens]:T(D,this,q).call(this,e.allTokens),[u.MetaMetricsUserTrait.NumberOfHDEntropies]:T(D,this,W).call(this,e)??(null===(t=this.previousUserTraits)||void 0===t?void 0:t.number_of_hd_entropies),[u.MetaMetricsUserTrait.OpenSeaApiEnabled]:e.openSeaEnabled,[u.MetaMetricsUserTrait.ThreeBoxEnabled]:!1,[u.MetaMetricsUserTrait.Theme]:e.theme||"default",[u.MetaMetricsUserTrait.TokenDetectionEnabled]:e.useTokenDetection,[u.MetaMetricsUserTrait.ShowNativeTokenAsMainBalance]:e.ShowNativeTokenAsMainBalance,[u.MetaMetricsUserTrait.CurrentCurrency]:e.currentCurrency,[u.MetaMetricsUserTrait.SecurityProviders]:e.securityAlertsEnabled?["blockaid"]:[],[u.MetaMetricsUserTrait.PetnameAddressCount]:T(D,this,Z).call(this,e),[u.MetaMetricsUserTrait.IsMetricsOptedIn]:e.participateInMetaMetrics,[u.MetaMetricsUserTrait.HasMarketingConsent]:e.dataCollectionForMarketing,[u.MetaMetricsUserTrait.TokenSortPreference]:(null===(r=e.tokenSortConfig)||void 0===r?void 0:r.key)||"",[u.MetaMetricsUserTrait.PrivacyModeEnabled]:e.preferences.privacyMode,[u.MetaMetricsUserTrait.NetworkFilterPreference]:Object.keys(e.preferences.tokenNetworkFilter||{}),[u.MetaMetricsUserTrait.ProfileId]:null===(n=Object.entries(e.srpSessionData||{}))||void 0===n||null===(n=n[0])||void 0===n||null===(n=n[1])||void 0===n||null===(n=n.profile)||void 0===n?void 0:n.profileId};if(!this.previousUserTraits&&e.participateInMetaMetrics)return this.previousUserTraits=a,a;if(this.previousUserTraits&&!(0,s.isEqual)(this.previousUserTraits,a)){const t=(0,s.pickBy)(a,(e,t)=>{const r=this.previousUserTraits[t];return!(0,s.isEqual)(r,e)});return e.participateInMetaMetrics&&(this.previousUserTraits=a),t}return null}}function x(e){const t=e||this.messagingSystem.call("NetworkController:getState").selectedNetworkClientId,{configuration:{chainId:r}}=this.messagingSystem.call("NetworkController:getNetworkClientById",t);return r}async function F(e,t){if(!(this.state.participateInMetaMetrics||null!=t&&t.isOptIn))return;const r=[];if(e.sensitiveProperties){if(!0===(null==t?void 0:t.excludeMetaMetricsId))throw new Error("sensitiveProperties was specified in an event payload that also set the excludeMetaMetricsId flag");const n=C[`${e.event}`],i={...e,event:n??e.event},a=(0,s.merge)({...i.sensitiveProperties},{...i.properties});r.push(T(D,this,J).call(this,T(D,this,H).call(this,{...i,properties:a,isDuplicateAnonymizedEvent:!0}),{...t,excludeMetaMetricsId:!0}))}r.push(T(D,this,J).call(this,T(D,this,H).call(this,e),t)),await Promise.all(r)}function U(e){if(!e.event)throw new Error(`Must specify event. Event was: ${e.event}. Payload keys were: ${Object.keys(e)}. ${"object"==typeof e.properties?`Payload property keys were: ${Object.keys(e.properties)}`:""}`)}function $(e,t=u.METAMETRICS_BACKGROUND_PAGE_OBJECT){return{app:{name:"MetaMask Extension",version:this.version},userAgent:window.navigator.userAgent,page:t,referrer:e,marketingCampaignCookieId:this.state.marketingCampaignCookieId}}function H(e){const{event:t,properties:r,revenue:n,value:i,currency:a,category:o,page:c,referrer:u,environmentType:d=l.ENVIRONMENT_TYPE_BACKGROUND}=e;let p;return p=r&&"chain_id_caip"in r&&"string"==typeof r.chain_id_caip?null:r&&"chain_id"in r&&"string"==typeof r.chain_id?r.chain_id:this.chainId,{event:t,messageId:A(e),properties:{...(0,s.omit)(r,["revenue","locale","currency","value"]),revenue:n,value:i,currency:a,category:o,locale:this.locale,chain_id:p,environment_type:d},context:T(D,this,$).call(this,u,c)}}function G(e){return Object.entries(e).reduce((e,[t,r])=>T(D,this,Q).call(this,r)?{...e,[t]:r.toISOString()}:T(D,this,z).call(this,r)?{...e,[t]:r}:(console.warn(`MetaMetricsController: "${t}" value is not a valid trait type`),e),{})}function K(e={}){const t=k(L,this).call(this,e).map(e=>e.address);return new Set(t).size}function q(e){return Object.values(e).reduce((e,t)=>e+(0,s.sum)(Object.values(t).map(s.size)),0)}function W(e){var t;return(null===(t=e.keyrings)||void 0===t?void 0:t.filter(e=>e.type===w.KeyringType.hdKeyTree).length)??0}function V(e){const{metaMetricsId:t}=this.state;if(e&&0!==Object.keys(e).length)try{T(D,this,X).call(this,"identify",{userId:t??undefined,traits:e})}catch(e){k(N,this).call(this,e)}else console.warn("MetaMetricsController#_identify: No userTraits found")}function z(e){const t=typeof e;return"string"===t||"boolean"===t||"number"===t||T(D,this,Y).call(this,e)||T(D,this,Q).call(this,e)}function Y(e){return Array.isArray(e)&&(e.every(e=>"string"==typeof e)||e.every(e=>"boolean"==typeof e)||e.every(e=>"number"==typeof e))}function Q(e){return"[object Date]"===Object.prototype.toString.call(e)}function J(e,t){const{isOptIn:r,metaMetricsId:s,matomoEvent:n,flushImmediately:i}=t||{};let a="userId",c=this.state.metaMetricsId,l=(null==t?void 0:t.excludeMetaMetricsId)??!1;const d=Boolean(e.event.match(/^send|^confirm/iu));return!1!==(null==t?void 0:t.excludeMetaMetricsId)&&d&&(l=!0),l||r&&!s?(a="anonymousId",c=u.METAMETRICS_ANONYMOUS_ID):r&&s&&(c=s),e[a]=c??undefined,!0===n&&(e.properties.legacy_event=!0),new Promise((t,r)=>{T(D,this,X).call(this,"track",e,e=>{if(e){const t=(0,o.isErrorWithMessage)(e)?e.message:"",s=(0,o.isErrorWithStack)(e)?e.stack:undefined,n=new Error(t);return s&&(n.stack=s),r(n)}return t()}),i&&k(R,this).flush()})}function X(e,t,r){const{metaMetricsId:s,latestNonAnonymousEventTimestamp:n,participateInMetaMetrics:i}=this.state;if(!i||!s)return;const a=t.messageId||(0,m.generateRandomId)();let o=new Date;if(t.timestamp){const e=new Date(t.timestamp);(0,m.isValidDate)(e)&&(o=e)}const c={...t,messageId:a,timestamp:o};this.update(t=>{t.latestNonAnonymousEventTimestamp=c.anonymousId===u.METAMETRICS_ANONYMOUS_ID?n:o.valueOf(),t.segmentApiCalls[a]={eventType:e,payload:{...c,timestamp:c.timestamp.toString()}}});k(R,this)[e](c,e=>(this.update(e=>{delete e.segmentApiCalls[a]}),null==r?void 0:r(e)))}function Z(e){var t;const r=(null===(t=e.names)||void 0===t?void 0:t[a.NameType.ETHEREUM_ADDRESS])??{};return Object.keys(r).reduce((e,t)=>{const s=r[t];return e+Object.keys(s).reduce((e,t)=>{var r;return e+(Boolean(null===(r=s[t].name)||void 0===r?void 0:r.length)?1:0)},0)},0)}r.default=B}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"$root$",file:"app/scripts/controllers/metametrics-controller.ts"}],[164,{"@metamask/base-controller":1222},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.MetaMetricsDataDeletionController=void 0;var s=e("@metamask/base-controller");function n(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function i(e,t){return e.get(a(e,t))}function a(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const o="MetaMetricsDataDeletionController",c={metaMetricsDataDeletionId:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},metaMetricsDataDeletionTimestamp:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},metaMetricsDataDeletionStatus:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0}};var l=new WeakMap,u=new WeakSet;class d extends s.BaseController{constructor({dataDeletionService:e,messenger:t,state:r}){var s,i;super({messenger:t,metadata:c,name:o,state:{metaMetricsDataDeletionId:null,metaMetricsDataDeletionTimestamp:0,...r}}),n(s=this,i=u),i.add(s),function(e,t,r){n(e,t),t.set(e,r)}(this,l,void 0),function(e,t,r){e.set(a(e,t),r)}(l,this,e),a(u,this,p).call(this)}async createMetaMetricsDataDeletionTask(){const{metaMetricsId:e}=this.messagingSystem.call("MetaMetricsController:getState");if(!e)throw new Error("MetaMetrics ID not found");const t=await i(l,this).createDataDeletionRegulationTask(e);this.update(e=>{e.metaMetricsDataDeletionId=t??null,e.metaMetricsDataDeletionTimestamp=Date.now()}),await this.updateDataDeletionTaskStatus()}async updateDataDeletionTaskStatus(){const e=this.state.metaMetricsDataDeletionId;if(!e)throw new Error("Delete Regulation id not found");const t=await i(l,this).fetchDeletionRegulationStatus(e);this.update(e=>{e.metaMetricsDataDeletionStatus=t??undefined})}}function p(){this.messagingSystem.registerActionHandler(`${o}:createMetaMetricsDataDeletionTask`,this.createMetaMetricsDataDeletionTask.bind(this)),this.messagingSystem.registerActionHandler(`${o}:updateDataDeletionTaskStatus`,this.updateDataDeletionTaskStatus.bind(this))}r.MetaMetricsDataDeletionController=d}}},{package:"$root$",file:"app/scripts/controllers/metametrics-data-deletion/metametrics-data-deletion.ts"}],[165,{"../../../shared/constants/network":5433,"@metamask/base-controller":1222,"@metamask/keyring-api":1994,"@metamask/multichain-network-controller":2095},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.NetworkOrderController=void 0;var s=e("@metamask/keyring-api"),n=e("@metamask/base-controller"),i=e("@metamask/multichain-network-controller"),a=e("../../../shared/constants/network");const o={orderedNetworkList:[]},c={orderedNetworkList:{includeInStateLogs:!1,persist:!0,anonymous:!0,usedInUi:!0}};class l extends n.BaseController{constructor({messenger:e,state:t}){super({messenger:e,metadata:c,name:"NetworkOrderController",state:{...o,...t}}),this.messagingSystem.subscribe("NetworkController:stateChange",e=>{this.onNetworkControllerStateChange(e)})}onNetworkControllerStateChange({networkConfigurationsByChainId:e}){this.update(t=>{const r=Object.keys(e).filter(e=>!a.TEST_CHAINS.includes(e)).map(i.toEvmCaipChainId),n=[s.BtcScope.Mainnet,s.SolScope.Mainnet],o=r.filter(e=>!t.orderedNetworkList.some(({networkId:t})=>t===e)).map(e=>({networkId:e}));t.orderedNetworkList=t.orderedNetworkList.filter(({networkId:e})=>r.includes(e)||n.includes(e)).concat(o)})}updateNetworksList(e){this.update(t=>{t.orderedNetworkList=e.map(e=>({networkId:e}))})}}r.NetworkOrderController=l}}},{package:"$root$",file:"app/scripts/controllers/network-order.ts"}],[166,{"../../../shared/constants/onboarding":5436,"../../../shared/modules/environment":5530,"@metamask/base-controller":1222,loglevel:4542},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getDefaultOnboardingControllerState=r.default=void 0;var s,n=e("@metamask/base-controller"),i=(s=e("loglevel"))&&s.__esModule?s:{default:s},a=e("../../../shared/constants/onboarding"),o=e("../../../shared/modules/environment");function c(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const l=()=>({seedPhraseBackedUp:null,firstTimeFlowType:null,completedOnboarding:!1});r.getDefaultOnboardingControllerState=l;const u={onboardingTabs:{}},d={seedPhraseBackedUp:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},firstTimeFlowType:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},completedOnboarding:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},onboardingTabs:{includeInStateLogs:!0,persist:!1,anonymous:!1,usedInUi:!0}};class p extends n.BaseController{constructor({messenger:e,state:t}){super({messenger:e,metadata:d,name:"OnboardingController",state:{seedPhraseBackedUp:null,firstTimeFlowType:null,completedOnboarding:!1,...t,...u}}),c(this,"registerOnboarding",async(e,t)=>{if(this.state.completedOnboarding)return void i.default.debug("Ignoring registerOnboarding; user already onboarded");const{onboardingTabs:r}={...this.state??{}};r&&(r[e]&&r[e]===t||(i.default.debug(`Registering onboarding tab at location '${e}' with tabId '${t}'`),this.update(s=>{s.onboardingTabs={...r,[e]:t}})))})}setSeedPhraseBackedUp(e){this.update(t=>{t.seedPhraseBackedUp=e})}completeOnboarding(){return this.update(e=>{e.completedOnboarding=!0}),!0}setFirstTimeFlowType(e){this.update(t=>{t.firstTimeFlowType=e})}getIsSocialLoginFlow(){if(!(0,o.getIsSeedlessOnboardingFeatureEnabled)())return!1;const{firstTimeFlowType:e}=this.state;return e===a.FirstTimeFlowType.socialCreate||e===a.FirstTimeFlowType.socialImport}}r.default=p}}},{package:"$root$",file:"app/scripts/controllers/onboarding.ts"}],[1685,{"@metamask/keyring-controller":2004},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.GetCallsStatusCode=r.EIP5792ErrorCode=r.MessageType=r.KEYRING_TYPES_SUPPORTING_7702=r.VERSION=void 0;const s=e("@metamask/keyring-controller");var n,i,a;r.VERSION="2.0.0",r.KEYRING_TYPES_SUPPORTING_7702=[s.KeyringTypes.hd,s.KeyringTypes.simple],function(e){e.SendTransaction="eth_sendTransaction"}(n||(r.MessageType=n={})),function(e){e[e.UnsupportedNonOptionalCapability=5700]="UnsupportedNonOptionalCapability",e[e.UnsupportedChainId=5710]="UnsupportedChainId",e[e.UnknownBundleId=5730]="UnknownBundleId",e[e.RejectedUpgrade=5750]="RejectedUpgrade"}(i||(r.EIP5792ErrorCode=i={})),function(e){e[e.PENDING=100]="PENDING",e[e.CONFIRMED=200]="CONFIRMED",e[e.FAILED_OFFCHAIN=400]="FAILED_OFFCHAIN",e[e.REVERTED=500]="REVERTED",e[e.REVERTED_PARTIAL=600]="REVERTED_PARTIAL"}(a||(r.GetCallsStatusCode=a={}))}}},{package:"@metamask/eip-5792-middleware",file:"node_modules/@metamask/eip-5792-middleware/dist/constants.cjs"}],[1686,{"../constants.cjs":1685,"@metamask/rpc-errors":2384,"@metamask/transaction-controller":2754},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getCallsStatus=void 0;const s=e("@metamask/rpc-errors"),n=e("@metamask/transaction-controller"),i=e("../constants.cjs");r.getCallsStatus=function(e,t){const r=e.call("TransactionController:getState").transactions.filter(e=>e.batchId===t);if(!r?.length)throw new s.JsonRpcError(i.EIP5792ErrorCode.UnknownBundleId,"No matching bundle found");const a=r[0],{chainId:o,txReceipt:c}=a,l=function(e){const{hash:t,status:r}=e;if(r===n.TransactionStatus.confirmed)return i.GetCallsStatusCode.CONFIRMED;if(r===n.TransactionStatus.failed)return t?i.GetCallsStatusCode.REVERTED:i.GetCallsStatusCode.FAILED_OFFCHAIN;if(r===n.TransactionStatus.dropped)return i.GetCallsStatusCode.REVERTED;return i.GetCallsStatusCode.PENDING}(a),u=c,d=u?.logs??[],p=u&&[{blockHash:u.blockHash,blockNumber:u.blockNumber,gasUsed:u.gasUsed,logs:d.map(e=>({address:e.address,data:e.data,topics:e.topics})),status:u.status,transactionHash:u.transactionHash}];return{version:i.VERSION,id:t,chainId:o,atomic:!0,status:l,receipts:p}}}}},{package:"@metamask/eip-5792-middleware",file:"node_modules/@metamask/eip-5792-middleware/dist/hooks/getCallsStatus.cjs"}],[1687,{"../constants.cjs":1685,"../utils.cjs":1694},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getCapabilities=void 0;const s=e("../constants.cjs"),n=e("../utils.cjs");r.getCapabilities=async function(e,t,r,i){const{getDismissSmartAccountSuggestionEnabled:a,getIsSmartTransaction:o,isAtomicBatchSupported:c,isRelaySupported:l,getSendBundleSupportedChains:u}=e;let d=i?.map(e=>e.toLowerCase());if(!d?.length){const e=t.call("NetworkController:getState").networkConfigurationsByChainId;d=Object.keys(e)}const p=await c({address:r,chainIds:d}),h=await async function(e,t,r,s,n,i){const a=i.call("PreferencesController:getState").useTransactionSimulations,o=await Promise.all(t.map(({chainId:e})=>e).map(e=>s(e))),c=await n(e),l=t.map((e,t)=>({...e,relaySupportedForChain:o[t]}));return e.reduce((e,t)=>{const s=l.find(({chainId:e})=>e===t)??{},{isSupported:n=!1,relaySupportedForChain:i}=s,o=r(t),u=c[t]??!1;return a&&(o&&u||n&&i)&&(e[t]={alternateGasFees:{supported:!0}}),e},{})}(d,p,o,l,u,t);return d.reduce((e,i)=>{const o=p.find(({chainId:e})=>e===i)??{},{delegationAddress:c,isSupported:l,upgradeContractAddress:u}=o,d=a();let h=!1;try{const e=(0,n.getAccountKeyringType)(r,t);h=s.KEYRING_TYPES_SUPPORTING_7702.includes(e)}catch{}if(!l&&!(!d&&u&&!c&&h))return e;const m=l?"supported":"ready";return e[i]===undefined&&(e[i]={}),e[i].atomic={status:m},e},h)}}}},{package:"@metamask/eip-5792-middleware",file:"node_modules/@metamask/eip-5792-middleware/dist/hooks/getCapabilities.cjs"}],[1688,{"../constants.cjs":1685,"../utils.cjs":1694,"@metamask/rpc-errors":2384,"@metamask/transaction-controller":2754,"@metamask/utils":2799,uuid:5366},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.processSendCalls=void 0;const s=e("@metamask/rpc-errors"),n=e("@metamask/transaction-controller"),i=e("@metamask/utils"),a=e("uuid"),o=e("../constants.cjs"),c=e("../utils.cjs");function l(e){const{version:t}=e;if(t!==o.VERSION)throw s.rpcErrors.invalidInput(`Version not supported: Got ${t}, expected ${o.VERSION}`)}function u(e,t){const{chainId:r}=e;if(r&&r.toLowerCase()!==t.toLowerCase())throw s.rpcErrors.invalidParams(`Chain ID must match the dApp selected network: Got ${r}, expected ${t}`)}function d(e){const{calls:t,capabilities:r}=e,n=[...Object.keys(r??{}).filter(e=>!0!==r?.[e].optional),...t.flatMap(e=>Object.keys(e.capabilities??{}).filter(t=>!0!==e.capabilities?.[t].optional))];if(n?.length)throw new s.JsonRpcError(o.EIP5792ErrorCode.UnsupportedNonOptionalCapability,`Unsupported non-optional capabilities: ${n.join(", ")}`)}r.processSendCalls=async function(e,t,r,p){const{addTransactionBatch:h,addTransaction:m,getDismissSmartAccountSuggestionEnabled:g,isAtomicBatchSupported:f,validateSecurity:y}=e,{calls:w,from:v}=r,{networkClientId:S,origin:b}=p,k=w.map(e=>({params:e})),{chainId:E}=t.call("NetworkController:getNetworkClientById",S).configuration,T=v??t.call("AccountsController:getSelectedAccount").address,C=(0,a.v4)(),M=y.bind(null,C);let A;return A=1===Object.keys(k).length?await async function({addTransaction:e,chainId:t,from:r,networkClientId:s,origin:c,securityAlertId:p,sendCalls:h,transactions:m,validateSecurity:g}){!function(e,t){l(e),d(e),u(e,t)}(h,t);const f={from:r,...m[0].params,type:n.TransactionEnvelopeType.feeMarket},y={method:o.MessageType.SendTransaction,params:[f],origin:c};g(y,t);const w=function(){const e=(0,a.v4)(),t=new Uint8Array((0,a.parse)(e));return(0,i.bytesToHex)(t)}();return await e(f,{networkClientId:s,origin:c,securityAlertResponse:{securityAlertId:p},batchId:w}),w}({addTransaction:m,chainId:E,from:T,networkClientId:S,origin:b,securityAlertId:C,sendCalls:r,transactions:k,validateSecurity:M}):await async function({addTransactionBatch:e,isAtomicBatchSupported:t,chainId:r,from:n,getDismissSmartAccountSuggestionEnabled:i,networkClientId:a,messenger:p,origin:h,sendCalls:m,securityAlertId:g,transactions:f,validateSecurity:y}){const w=await t({address:n,chainIds:[r]}),v=w?.[0],S=(0,c.getAccountKeyringType)(n,p),b=i();!function(e,t,r,n,i){l(e),function(e,t,r){if(u(e,t),!r)throw new s.JsonRpcError(o.EIP5792ErrorCode.UnsupportedChainId,`EIP-7702 not supported on chain: ${t}`)}(e,t,n),d(e),function(e,t,r){if(t?.delegationAddress)return;if(e)throw new s.JsonRpcError(o.EIP5792ErrorCode.RejectedUpgrade,"EIP-7702 upgrade disabled by the user");if(!o.KEYRING_TYPES_SUPPORTING_7702.includes(r))throw new s.JsonRpcError(o.EIP5792ErrorCode.RejectedUpgrade,"EIP-7702 upgrade not supported on account")}(r,n,i)}(m,r,b,v,S);const k=await e({from:n,networkClientId:a,origin:h,securityAlertId:g,transactions:f,validateSecurity:y});return k.batchId}({addTransactionBatch:h,isAtomicBatchSupported:f,chainId:E,from:T,getDismissSmartAccountSuggestionEnabled:g,messenger:t,networkClientId:S,origin:b,sendCalls:r,securityAlertId:C,transactions:k,validateSecurity:M}),{id:A}}}}},{package:"@metamask/eip-5792-middleware",file:"node_modules/@metamask/eip-5792-middleware/dist/hooks/processSendCalls.cjs"}],[1689,{"./hooks/getCallsStatus.cjs":1686,"./hooks/getCapabilities.cjs":1687,"./hooks/processSendCalls.cjs":1688,"./methods/wallet_getCallsStatus.cjs":1690,"./methods/wallet_getCapabilities.cjs":1691,"./methods/wallet_sendCalls.cjs":1692},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.walletGetCapabilities=r.walletGetCallsStatus=r.walletSendCalls=r.getCapabilities=r.getCallsStatus=r.processSendCalls=void 0;var s=e("./hooks/processSendCalls.cjs");Object.defineProperty(r,"processSendCalls",{enumerable:!0,get:function(){return s.processSendCalls}});var n=e("./hooks/getCallsStatus.cjs");Object.defineProperty(r,"getCallsStatus",{enumerable:!0,get:function(){return n.getCallsStatus}});var i=e("./hooks/getCapabilities.cjs");Object.defineProperty(r,"getCapabilities",{enumerable:!0,get:function(){return i.getCapabilities}});var a=e("./methods/wallet_sendCalls.cjs");Object.defineProperty(r,"walletSendCalls",{enumerable:!0,get:function(){return a.walletSendCalls}});var o=e("./methods/wallet_getCallsStatus.cjs");Object.defineProperty(r,"walletGetCallsStatus",{enumerable:!0,get:function(){return o.walletGetCallsStatus}});var c=e("./methods/wallet_getCapabilities.cjs");Object.defineProperty(r,"walletGetCapabilities",{enumerable:!0,get:function(){return c.walletGetCapabilities}})}}},{package:"@metamask/eip-5792-middleware",file:"node_modules/@metamask/eip-5792-middleware/dist/index.cjs"}],[1690,{"../types.cjs":1693,"../utils.cjs":1694,"@metamask/rpc-errors":2384},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.walletGetCallsStatus=void 0;const s=e("@metamask/rpc-errors"),n=e("../types.cjs"),i=e("../utils.cjs");r.walletGetCallsStatus=async function(e,t,{getCallsStatus:r}){if(!r)throw s.rpcErrors.methodNotSupported();(0,i.validateParams)(e.params,n.GetCallsStatusStruct);const a=e.params[0];t.result=await r(a,e)}}}},{package:"@metamask/eip-5792-middleware",file:"node_modules/@metamask/eip-5792-middleware/dist/methods/wallet_getCallsStatus.cjs"}],[1691,{"../types.cjs":1693,"../utils.cjs":1694,"@metamask/rpc-errors":2384},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.walletGetCapabilities=void 0;const s=e("@metamask/rpc-errors"),n=e("../types.cjs"),i=e("../utils.cjs");r.walletGetCapabilities=async function(e,t,{getAccounts:r,getCapabilities:a}){if(!a)throw s.rpcErrors.methodNotSupported();(0,i.validateParams)(e.params,n.GetCapabilitiesStruct);const o=e.params[0],c=e.params[1];await(0,i.validateAndNormalizeKeyholder)(o,e,{getAccounts:r});const l=await a(o,c,e);t.result=l}}}},{package:"@metamask/eip-5792-middleware",file:"node_modules/@metamask/eip-5792-middleware/dist/methods/wallet_getCapabilities.cjs"}],[1692,{"../types.cjs":1693,"../utils.cjs":1694,"@metamask/rpc-errors":2384},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.walletSendCalls=void 0;const s=e("@metamask/rpc-errors"),n=e("../types.cjs"),i=e("../utils.cjs");r.walletSendCalls=async function(e,t,{getAccounts:r,processSendCalls:a}){if(!a)throw s.rpcErrors.methodNotSupported();(0,i.validateParams)(e.params,n.SendCallsStruct);const o=e.params[0],c=o.from?await(0,i.validateAndNormalizeKeyholder)(o.from,e,{getAccounts:r}):undefined,l={...o,from:c};t.result=await a(l,e)}}}},{package:"@metamask/eip-5792-middleware",file:"node_modules/@metamask/eip-5792-middleware/dist/methods/wallet_sendCalls.cjs"}],[1693,{"@metamask/superstruct":2705,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.SendCallsStruct=r.CapabilitiesStruct=r.GetCapabilitiesStruct=r.GetCallsStatusStruct=void 0;const s=e("@metamask/superstruct"),n=e("@metamask/utils");r.GetCallsStatusStruct=(0,s.tuple)([n.StrictHexStruct]),r.GetCapabilitiesStruct=(0,s.tuple)([n.HexChecksumAddressStruct,(0,s.optional)((0,s.array)(n.StrictHexStruct))]),r.CapabilitiesStruct=(0,s.record)((0,s.string)(),(0,s.type)({optional:(0,s.optional)((0,s.boolean)())})),r.SendCallsStruct=(0,s.tuple)([(0,s.object)({version:(0,s.nonempty)((0,s.string)()),id:(0,s.optional)(n.StrictHexStruct),from:(0,s.optional)(n.HexChecksumAddressStruct),chainId:n.StrictHexStruct,atomicRequired:(0,s.boolean)(),calls:(0,s.array)((0,s.object)({to:(0,s.optional)(n.HexChecksumAddressStruct),data:(0,s.optional)(n.StrictHexStruct),value:(0,s.optional)(n.StrictHexStruct),capabilities:(0,s.optional)(r.CapabilitiesStruct)})),capabilities:(0,s.optional)(r.CapabilitiesStruct)})])}}},{package:"@metamask/eip-5792-middleware",file:"node_modules/@metamask/eip-5792-middleware/dist/types.cjs"}],[1694,{"./constants.cjs":1685,"@metamask/rpc-errors":2384,"@metamask/superstruct":2705},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.resemblesAddress=r.validateParams=r.validateAndNormalizeKeyholder=r.getAccountKeyringType=void 0;const s=e("@metamask/rpc-errors"),n=e("@metamask/superstruct"),i=e("./constants.cjs");function a(e){return 42===e.length}r.getAccountKeyringType=function(e,t){const{accounts:r}=t.call("AccountsController:getState").internalAccounts,n=Object.values(r).find(t=>t.address.toLowerCase()===e.toLowerCase()),a=n?.metadata?.keyring?.type;if(!a)throw new s.JsonRpcError(i.EIP5792ErrorCode.RejectedUpgrade,"EIP-7702 upgrade not supported as account type is unknown");return a},r.validateAndNormalizeKeyholder=async function(e,t,{getAccounts:r}){if("string"==typeof e&&e.length>0&&a(e)){const n=(await r(t)).map(e=>e.toLowerCase()),i=e.toLowerCase();if(n.includes(i))return i;throw s.providerErrors.unauthorized()}throw s.rpcErrors.invalidParams({message:"Invalid parameters: must provide an Ethereum address."})},r.validateParams=function(e,t){const[r]=(0,n.validate)(e,t);if(r)throw s.rpcErrors.invalidParams(function(e,t){return`${t}\n\n${e.failures().map(e=>`${e.path.join(" > ")}${e.path.length?" - ":""}${e.message}`).join("\n")}`}(r,"Invalid params"))},r.resemblesAddress=a}}},{package:"@metamask/eip-5792-middleware",file:"node_modules/@metamask/eip-5792-middleware/dist/utils.cjs"}],[1695,{"@ethersproject/providers":692,"@metamask/base-controller":1222,"@metamask/controller-utils":1301,"@metamask/utils":2799,"punycode/punycode.js":4838},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var s,n,i,a,o,c=this&&this.__classPrivateFieldGet||function(e,t,r,s){if("a"===r&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?s:"a"===r?s.call(e):s?s.value:t.get(e)},l=this&&this.__classPrivateFieldSet||function(e,t,r,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(e,r):n?n.value=r:t.set(e,r),r};Object.defineProperty(r,"__esModule",{value:!0}),r.EnsController=r.DEFAULT_ENS_NETWORK_MAP=void 0;const u=e("@ethersproject/providers"),d=e("@metamask/base-controller"),p=e("@metamask/controller-utils"),h=e("@metamask/utils"),m=e("punycode/punycode.js"),g=(0,h.createProjectLogger)("ens-controller");r.DEFAULT_ENS_NETWORK_MAP={1:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",3:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",4:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",5:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",17e3:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",11155111:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"};const f={ensEntries:{persist:!0,anonymous:!1},ensResolutionsByAddress:{persist:!0,anonymous:!1}},y={ensEntries:{},ensResolutionsByAddress:{}};class w extends d.BaseController{constructor({registriesByChainId:e=r.DEFAULT_ENS_NETWORK_MAP,messenger:t,state:o={},onNetworkDidChange:l}){super({name:"EnsController",metadata:f,messenger:t,state:{...y,ensEntries:Object.fromEntries(Object.entries(e).map(([e,t])=>[(0,p.toHex)(e),{".":{address:t,chainId:(0,p.toHex)(e),ensName:"."}}])),...o}}),s.add(this),n.set(this,null),c(this,s,"m",i).call(this,e),l&&l(({selectedNetworkClientId:t})=>{this.resetState(),c(this,s,"m",a).call(this,t,e)})}resetState(){this.update(e=>{e.ensResolutionsByAddress={}})}clear(){this.update(e=>{e.ensEntries={}})}delete(e,t){const r=(0,p.normalizeEnsName)(t);return!!((0,p.isSafeDynamicKey)(e)&&r&&this.state.ensEntries[e]&&this.state.ensEntries[e][r])&&(this.update(t=>{delete t.ensEntries[e][r],0===Object.keys(t.ensEntries[e]).length&&delete t.ensEntries[e]}),!0)}get(e,t){const r=(0,p.normalizeEnsName)(t);return r&&this.state.ensEntries[e]&&this.state.ensEntries[e][r]||null}set(e,t,r){if(!Number.isInteger(Number.parseInt(e,10))||!t||"string"!=typeof t||r&&!(0,p.isValidHexAddress)(r))throw new Error(`Invalid ENS entry: { chainId:${e}, ensName:${t}, address:${r}}`);const s=(0,p.normalizeEnsName)(t);if(!s)throw new Error(`Invalid ENS name: ${t}`);const n=r?(0,p.toChecksumHexAddress)(r):null,i=this.state.ensEntries[e];return(!i?.[s]||i[s].address!==n)&&(this.update(t=>{t.ensEntries={...this.state.ensEntries,[e]:{...this.state.ensEntries[e],[s]:{address:n,chainId:e,ensName:s}}}}),!0)}async reverseResolveAddress(e){if(!c(this,n,"f"))return undefined;const t=(0,p.toChecksumHexAddress)(e);if(this.state.ensResolutionsByAddress[t])return this.state.ensResolutionsByAddress[t];let r,s;try{r=await c(this,n,"f").lookupAddress(t)}catch(e){return g(e),undefined}if(!r)return undefined;try{s=await c(this,n,"f").resolveName(r)}catch(e){return g(e),undefined}return s?"0x0000000000000000000000000000000000000000"===s||"0x"===s||(0,p.toChecksumHexAddress)(s)!==t?undefined:(this.update(e=>{e.ensResolutionsByAddress[t]=(0,m.toASCII)(r)}),r):undefined}}r.EnsController=w,n=new WeakMap,s=new WeakSet,i=function(e){const{selectedNetworkClientId:t}=this.messagingSystem.call("NetworkController:getState");c(this,s,"m",a).call(this,t,e)},a=function(e,t){const{configuration:{chainId:r},provider:i}=this.messagingSystem.call("NetworkController:getNetworkClientById",e);t&&t[parseInt(r,16)]&&c(this,s,"m",o).call(this,r)?l(this,n,new u.Web3Provider(i,{chainId:(0,p.convertHexToDecimal)(r),name:p.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP[r],ensAddress:t[parseInt(r,16)]}),"f"):l(this,n,null,"f")},o=function(e){return Boolean(this.state.ensEntries[e])},r.default=w}}},{package:"@metamask/ens-controller",file:"node_modules/@metamask/ens-controller/dist/EnsController.cjs"}],[1696,{"./EnsController.cjs":1695},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var s=this&&this.__createBinding||(Object.create?function(e,t,r,s){s===undefined&&(s=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,s,n)}:function(e,t,r,s){s===undefined&&(s=r),e[s]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||s(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),n(e("./EnsController.cjs"),r)}}},{package:"@metamask/ens-controller",file:"node_modules/@metamask/ens-controller/dist/index.cjs"}],[1697,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var s,n,i=this&&this.__classPrivateFieldSet||function(e,t,r,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(e,r):n?n.value=r:t.set(e,r),r},a=this&&this.__classPrivateFieldGet||function(e,t,r,s){if("a"===r&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?s:"a"===r?s.call(e):s?s.value:t.get(e)};Object.defineProperty(r,"__esModule",{value:!0}),r.ErrorReportingService=void 0;r.ErrorReportingService=class{constructor({messenger:e,captureException:t}){s.set(this,void 0),n.set(this,void 0),i(this,n,e,"f"),i(this,s,t,"f"),a(this,n,"f").registerActionHandler("ErrorReportingService:captureException",a(this,s,"f").bind(this))}captureException(e){a(this,s,"f").call(this,e)}},s=new WeakMap,n=new WeakMap}}},{package:"@metamask/error-reporting-service",file:"node_modules/@metamask/error-reporting-service/dist/error-reporting-service.cjs"}],[1698,{"./error-reporting-service.cjs":1697},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.ErrorReportingService=void 0;var s=e("./error-reporting-service.cjs");Object.defineProperty(r,"ErrorReportingService",{enumerable:!0,get:function(){return s.ErrorReportingService}})}}},{package:"@metamask/error-reporting-service",file:"node_modules/@metamask/error-reporting-service/dist/index.cjs"}],[17,{"../../controllers/network-order":165},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.NetworkOrderControllerInit=void 0;var s=e("../../controllers/network-order");r.NetworkOrderControllerInit=({controllerMessenger:e,persistedState:t})=>({controller:new s.NetworkOrderController({messenger:e,state:{orderedNetworkList:[],...t.NetworkOrderController}})})}}},{package:"$root$",file:"app/scripts/controller-init/assets/network-order-controller-init.ts"}],[1705,{"./base-filter":1706},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const s=e("./base-filter");t.exports=class extends s{constructor(){super(),this.allResults=[]}async update(){throw new Error("BaseFilterWithHistory - no update method specified")}addResults(e){this.allResults=this.allResults.concat(e),super.addResults(e)}addInitialResults(e){this.allResults=this.allResults.concat(e),super.addInitialResults(e)}getAllResults(){return this.allResults}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/base-filter-history.js"}],[1706,{"@metamask/safe-event-emitter":2386},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const s=e("@metamask/safe-event-emitter").default;t.exports=class extends s{constructor(){super(),this.updates=[]}async initialize(){}async update(){throw new Error("BaseFilter - no update method specified")}addResults(e){this.updates=this.updates.concat(e),e.forEach(e=>this.emit("update",e))}addInitialResults(e){}getChangesAndClear(){const e=this.updates;return this.updates=[],e}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/base-filter.js"}],[1707,{"./base-filter":1706,"./getBlocksForRange":1708,"./hexUtils":1709},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const s=e("./base-filter"),n=e("./getBlocksForRange"),{incrementHexInt:i}=e("./hexUtils");t.exports=class extends s{constructor({provider:e,params:t}){super(),this.type="block",this.provider=e}async update({oldBlock:e,newBlock:t}){const r=t,s=i(e),a=(await n({provider:this.provider,fromBlock:s,toBlock:r})).map(e=>e.hash);this.addResults(a)}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/block-filter.js"}],[1708,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){function s(e){return e===undefined||null===e?e:Number.parseInt(e,16)}function n(e){if(e===undefined||null===e)return e;return"0x"+e.toString(16)}t.exports=async function({provider:e,fromBlock:t,toBlock:r}){t||(t=r);const i=s(t),a=s(r),o=Array(a-i+1).fill().map((e,t)=>i+t).map(n);let c=await Promise.all(o.map(t=>async function(e,t,r){for(let s=0;s<3;s++)try{return e.request({id:1,jsonrpc:"2.0",method:t,params:r})}catch(e){console.error(`provider.request failed: ${e.stack||e.message||e}`)}return null}(e,"eth_getBlockByNumber",[t,!1])));return c=c.filter(e=>null!==e),c}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/getBlocksForRange.js"}],[1709,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){function s(e){return e.sort((e,t)=>"latest"===e||"earliest"===t?1:"latest"===t||"earliest"===e?-1:n(e)-n(t))}function n(e){return e===undefined||null===e?e:Number.parseInt(e,16)}function i(e){if(e===undefined||null===e)return e;let t=e.toString(16);return t.length%2&&(t="0"+t),"0x"+t}function a(){return Math.floor(16*Math.random()).toString(16)}t.exports={minBlockRef:function(...e){return s(e)[0]},maxBlockRef:function(...e){const t=s(e);return t[t.length-1]},sortBlockRefs:s,bnToHex:function(e){return"0x"+e.toString(16)},blockRefIsNumber:function(e){return e&&!["earliest","latest","pending"].includes(e)},hexToInt:n,incrementHexInt:function(e){if(e===undefined||null===e)return e;return i(n(e)+1)},intToHex:i,unsafeRandomBytes:function(e){let t="0x";for(let r=0;r<e;r++)t+=a(),t+=a();return t}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/hexUtils.js"}],[1710,{"./block-filter.js":1707,"./hexUtils":1709,"./log-filter.js":1711,"./tx-filter.js":1713,"@metamask/json-rpc-engine":1943,"async-mutex":3582},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const s=e("async-mutex").Mutex,{createAsyncMiddleware:n,createScaffoldMiddleware:i}=e("@metamask/json-rpc-engine"),a=e("./log-filter.js"),o=e("./block-filter.js"),c=e("./tx-filter.js"),{intToHex:l,hexToInt:u}=e("./hexUtils");function d(e){return p(async(...t)=>{const r=await e(...t);return l(r.id)})}function p(e){return n(async(t,r)=>{const s=await e.apply(null,t.params);r.result=s})}function h(e,t){const r=[];for(let t in e)r.push(e[t]);return r}t.exports=function({blockTracker:e,provider:t}){let r=0,n={};const m=new s,g=function({mutex:e}){return t=>async(r,s,n,i)=>{(await e.acquire())(),t(r,s,n,i)}}({mutex:m}),f=i({eth_newFilter:g(d(w)),eth_newBlockFilter:g(d(v)),eth_newPendingTransactionFilter:g(d(S)),eth_uninstallFilter:g(p(E)),eth_getFilterChanges:g(p(b)),eth_getFilterLogs:g(p(k))}),y=async({oldBlock:e,newBlock:t})=>{if(0===n.length)return;const r=await m.acquire();try{await Promise.all(h(n).map(async r=>{try{await r.update({oldBlock:e,newBlock:t})}catch(e){console.error(e)}}))}catch(e){console.error(e)}r()};return f.newLogFilter=w,f.newBlockFilter=v,f.newPendingTransactionFilter=S,f.uninstallFilter=E,f.getFilterChanges=b,f.getFilterLogs=k,f.destroy=()=>{!async function(){const e=h(n).length;n={},C({prevFilterCount:e,newFilterCount:0})}()},f;async function w(e){const r=new a({provider:t,params:e});await T(r);return r}async function v(){const e=new o({provider:t});await T(e);return e}async function S(){const e=new c({provider:t});await T(e);return e}async function b(e){const t=u(e),r=n[t];if(!r)throw new Error(`No filter for index "${t}"`);return r.getChangesAndClear()}async function k(e){const t=u(e),r=n[t];if(!r)throw new Error(`No filter for index "${t}"`);let s=[];return"log"===r.type&&(s=r.getAllResults()),s}async function E(e){const t=u(e),r=n[t],s=Boolean(r);return s&&await async function(e){const t=h(n).length;delete n[e];const r=h(n).length;C({prevFilterCount:t,newFilterCount:r})}(t),s}async function T(t){const s=h(n).length,i=await e.getLatestBlock();await t.initialize({currentBlock:i}),r++,n[r]=t,t.id=r,t.idHex=l(r);return C({prevFilterCount:s,newFilterCount:h(n).length}),r}function C({prevFilterCount:t,newFilterCount:r}){0===t&&r>0?e.on("sync",y):t>0&&0===r&&e.removeListener("sync",y)}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/index.js"}],[1711,{"./base-filter-history":1705,"./hexUtils":1709,"@metamask/eth-query":1831,pify:4765},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const s=e("@metamask/eth-query"),n=e("pify"),i=e("./base-filter-history"),{bnToHex:a,hexToInt:o,incrementHexInt:c,minBlockRef:l,blockRefIsNumber:u}=e("./hexUtils");t.exports=class extends i{constructor({provider:e,params:t}){super(),this.type="log",this.ethQuery=new s(e),this.params=Object.assign({fromBlock:"latest",toBlock:"latest",address:undefined,topics:[]},t),this.params.address&&(Array.isArray(this.params.address)||(this.params.address=[this.params.address]),this.params.address=this.params.address.map(e=>e.toLowerCase()))}async initialize({currentBlock:e}){let t=this.params.fromBlock;["latest","pending"].includes(t)&&(t=e),"earliest"===t&&(t="0x0"),this.params.fromBlock=t;const r=l(this.params.toBlock,e),s=Object.assign({},this.params,{toBlock:r}),n=await this._fetchLogs(s);this.addInitialResults(n)}async update({oldBlock:e,newBlock:t}){const r=t;let s;s=e?c(e):t;const n=Object.assign({},this.params,{fromBlock:s,toBlock:r}),i=(await this._fetchLogs(n)).filter(e=>this.matchLog(e));this.addResults(i)}async _fetchLogs(e){return await n(t=>this.ethQuery.getLogs(e,t))()}matchLog(e){if(o(this.params.fromBlock)>=o(e.blockNumber))return!1;if(u(this.params.toBlock)&&o(this.params.toBlock)<=o(e.blockNumber))return!1;const t=e.address&&e.address.toLowerCase();if(this.params.address&&t&&!this.params.address.includes(t))return!1;return this.params.topics.every((t,r)=>{let s=e.topics[r];if(!s)return!1;s=s.toLowerCase();let n=Array.isArray(t)?t:[t];if(n.includes(null))return!0;n=n.map(e=>e.toLowerCase());return n.includes(s)})}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/log-filter.js"}],[1712,{"./getBlocksForRange.js":1708,"./hexUtils.js":1709,"./index.js":1710,"@metamask/json-rpc-engine":1943,"@metamask/safe-event-emitter":2386},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const s=e("@metamask/safe-event-emitter").default,{createAsyncMiddleware:n,createScaffoldMiddleware:i}=e("@metamask/json-rpc-engine"),a=e("./index.js"),{unsafeRandomBytes:o,incrementHexInt:c}=e("./hexUtils.js"),l=e("./getBlocksForRange.js");function u(e){return null===e||e===undefined?null:{hash:e.hash,parentHash:e.parentHash,sha3Uncles:e.sha3Uncles,miner:e.miner,stateRoot:e.stateRoot,transactionsRoot:e.transactionsRoot,receiptsRoot:e.receiptsRoot,logsBloom:e.logsBloom,difficulty:e.difficulty,number:e.number,gasLimit:e.gasLimit,gasUsed:e.gasUsed,nonce:e.nonce,mixHash:e.mixHash,timestamp:e.timestamp,extraData:e.extraData}}t.exports=function({blockTracker:e,provider:t}){const r={},d=a({blockTracker:e,provider:t});let p=!1;const h=new s,m=i({eth_subscribe:n(async function(s,n){if(p)throw new Error("SubscriptionManager - attempting to use after destroying");const i=s.params[0],a=o(16);let h;switch(i){case"newHeads":h=m({subId:a});break;case"logs":const e=s.params[1];h=f({subId:a,filter:await d.newLogFilter(e)});break;default:throw new Error(`SubscriptionManager - unsupported subscription type "${i}"`)}return r[a]=h,void(n.result=a);function m({subId:r}){const s={type:i,destroy:async()=>{e.removeListener("sync",s.update)},update:async({oldBlock:e,newBlock:s})=>{const n=s,i=c(e);(await l({provider:t,fromBlock:i,toBlock:n})).map(u).filter(e=>null!==e).forEach(e=>{g(r,e)})}};return e.on("sync",s.update),s}function f({subId:e,filter:t}){t.on("update",t=>g(e,t));return{type:i,destroy:async()=>await d.uninstallFilter(t.idHex)}}}),eth_unsubscribe:n(async function(e,t){if(p)throw new Error("SubscriptionManager - attempting to use after destroying");const s=e.params[0],n=r[s];if(!n)return void(t.result=!1);delete r[s],await n.destroy(),t.result=!0})});return m.destroy=function(){h.removeAllListeners();for(const e in r)r[e].destroy(),delete r[e];p=!0},{events:h,middleware:m};function g(e,t){h.emit("notification",{jsonrpc:"2.0",method:"eth_subscription",params:{subscription:e,result:t}})}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/subscriptionManager.js"}],[1713,{"./base-filter":1706,"./getBlocksForRange":1708,"./hexUtils":1709},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const s=e("./base-filter"),n=e("./getBlocksForRange"),{incrementHexInt:i}=e("./hexUtils");t.exports=class extends s{constructor({provider:e}){super(),this.type="tx",this.provider=e}async update({oldBlock:e}){const t=e,r=i(e),s=await n({provider:this.provider,fromBlock:r,toBlock:t}),a=[];for(const e of s)a.push(...e.transactions);this.addResults(a)}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/tx-filter.js"}],[1719,{"./logging-utils":1726,"./utils/cache":1731,"@metamask/json-rpc-engine":1943},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createBlockCacheMiddleware=void 0;const s=e("@metamask/json-rpc-engine"),n=e("./logging-utils"),i=e("./utils/cache"),a=(0,n.createModuleLogger)(n.projectLogger,"block-cache"),o=[undefined,null,"<nil>"];class c{constructor(){this.cache={}}getBlockCache(e){const t=Number.parseInt(e,16);let r=this.cache[t];if(!r){const e={};this.cache[t]=e,r=e}return r}async get(e,t){const r=this.getBlockCache(t),s=(0,i.cacheIdentifierForRequest)(e,!0);return s?r[s]:undefined}async set(e,t,r){if(!this.canCacheResult(e,r))return;const s=(0,i.cacheIdentifierForRequest)(e,!0);if(!s)return;this.getBlockCache(t)[s]=r}canCacheRequest(e){if(!(0,i.canCache)(e.method))return!1;return"pending"!==(0,i.blockTagForRequest)(e)}canCacheResult(e,t){return!o.includes(t)&&!(e.method&&["eth_getTransactionByHash","eth_getTransactionReceipt"].includes(e.method)&&(!t||!t.blockHash||"0x0000000000000000000000000000000000000000000000000000000000000000"===t.blockHash))}clearBefore(e){const t=Number.parseInt(e,16);Object.keys(this.cache).map(Number).filter(e=>e<t).forEach(e=>delete this.cache[e])}}r.createBlockCacheMiddleware=function({blockTracker:e}={}){if(!e)throw new Error("createBlockCacheMiddleware - No PollingBlockTracker specified");const t=new c,r={[i.CacheStrategy.Permanent]:t,[i.CacheStrategy.Block]:t,[i.CacheStrategy.Fork]:t,[i.CacheStrategy.Never]:undefined};return(0,s.createAsyncMiddleware)(async(s,n,o)=>{if(s.skipCache)return o();const c=(0,i.cacheTypeForMethod)(s.method),l=r[c];if(!l)return o();if(!l.canCacheRequest(s))return o();const u=(0,i.blockTagForRequest)(s),d=u&&"string"==typeof u?u:"latest";let p;if(a("blockTag = %o, req = %o",d,s),"earliest"===d)p="0x00";else if("latest"===d){a("Fetching latest block number to determine cache key");const r=await e.getLatestBlock();a("Clearing values stored under block numbers before %o",r),t.clearBefore(r),p=r}else p=d;const h=await l.get(s,p);return h===undefined?(a("No cache stored under block number %o, carrying request forward",p),await o(),a("Populating cache with",n),await l.set(s,p,n.result)):(a("Cache hit, reusing cache result stored under block number %o",p),n.result=h),undefined})}}}},{package:"@metamask/eth-json-rpc-middleware",file:"node_modules/@metamask/eth-json-rpc-middleware/dist/block-cache.js"}],[172,{"../../../../../shared/constants/keyring":5426,"../../../../../shared/constants/snaps/permissions":5444,"@metamask/keyring-controller":2004,"@metamask/snaps-rpc-methods":2507,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getSnapPermissionSpecifications=function(e,t){return{...(0,s.buildSnapEndowmentSpecifications)(Object.keys(a.ExcludedSnapEndowments)),...(0,s.buildSnapRestrictedMethodSpecifications)(Object.keys(a.ExcludedSnapPermissions),{getPreferences:()=>{const t=e.call("CurrencyRateController:getState").currentCurrency,{currentLocale:r,openSeaEnabled:s,preferences:{privacyMode:n,showTestNetworks:i},securityAlertsEnabled:a,useCurrencyRateCheck:o,useTransactionSimulations:c,useTokenDetection:l,useMultiAccountBalanceChecker:u,useNftDetection:d}=e.call("PreferencesController:getState");return{locale:r,currency:t,hideBalances:n,useSecurityAlerts:a,useExternalPricingData:o,simulateOnChainActions:c,useTokenDetection:l,batchCheckBalances:u,displayNftMedia:s,useNftDetection:d,showTestnets:i}},clearSnapState:e.call.bind(e,"SnapController:clearSnapState"),getMnemonic:async t=>{if(!t){const[t]=e.call("KeyringController:getKeyringsByType",o.KeyringType.hdKeyTree);if(!t.mnemonic)throw new Error("Primary keyring mnemonic unavailable.");return t.mnemonic}try{const{type:r,mnemonic:s}=await e.call("KeyringController:withKeyring",{id:t},async({keyring:e})=>({type:e.type,mnemonic:(0,i.hasProperty)(e,"mnemonic")?e.mnemonic:undefined}));if(r!==n.KeyringTypes.hd||!s)throw new Error(`Entropy source with ID "${t}" not found.`);return s}catch{throw new Error(`Entropy source with ID "${t}" not found.`)}},getMnemonicSeed:async t=>{if(!t){const[t]=e.call("KeyringController:getKeyringsByType",o.KeyringType.hdKeyTree);if(!t.seed)throw new Error("Primary keyring mnemonic unavailable.");return t.seed}try{const{type:r,seed:s}=await e.call("KeyringController:withKeyring",{id:t},async({keyring:e})=>({type:e.type,seed:(0,i.hasProperty)(e,"seed")?e.seed:undefined}));if(r!==n.KeyringTypes.hd||!s)throw new Error(`Entropy source with ID "${t}" not found.`);return s}catch{throw new Error(`Entropy source with ID "${t}" not found.`)}},getUnlockPromise:e.call.bind(e,"AppStateController:getUnlockPromise"),getSnap:e.call.bind(e,"SnapController:get"),handleSnapRpcRequest:e.call.bind(e,"SnapController:handleRequest"),getSnapState:e.call.bind(e,"SnapController:getSnapState"),requestUserApproval:t.addAndShowApprovalRequest,showNativeNotification:(t,r)=>e.call("RateLimitController:call",t,"showNativeNotification",t,r.message),showInAppNotification:(t,r)=>{const{content:s,message:n,title:i,footerLink:a}=r,o={interfaceId:s,message:n,title:i,footerLink:a};return e.call("RateLimitController:call",t,"showInAppNotification",t,o)},updateSnapState:e.call.bind(e,"SnapController:updateSnapState"),maybeUpdatePhishingList:()=>{const{usePhishDetect:t}=e.call("PreferencesController:getState");t&&e.call("PhishingController:maybeUpdateState")},isOnPhishingList:t=>{const{usePhishDetect:r}=e.call("PreferencesController:getState");return!!r&&e.call("PhishingController:testOrigin",t).result},createInterface:e.call.bind(e,"SnapInterfaceController:createInterface"),getInterface:e.call.bind(e,"SnapInterfaceController:getInterface"),getClientCryptography:()=>({}),getSnapKeyring:async()=>{const[r]=e.call("KeyringController:getKeyringsByType",o.KeyringType.snap);return r||(await t.addNewKeyring(o.KeyringType.snap),e.call("KeyringController:getKeyringsByType",o.KeyringType.snap)[0])}})}};var s=e("@metamask/snaps-rpc-methods"),n=e("@metamask/keyring-controller"),i=e("@metamask/utils"),a=e("../../../../../shared/constants/snaps/permissions"),o=e("../../../../../shared/constants/keyring")}}},{package:"$root$",file:"app/scripts/controllers/permissions/snaps/specifications.ts"}],[1720,{"./utils/cache":1731,"@metamask/json-rpc-engine":1943},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createBlockRefRewriteMiddleware=void 0;const s=e("@metamask/json-rpc-engine"),n=e("./utils/cache");r.createBlockRefRewriteMiddleware=function({blockTracker:e}={}){if(!e)throw Error('BlockRefRewriteMiddleware - mandatory "blockTracker" option is missing.');return(0,s.createAsyncMiddleware)(async(t,r,s)=>{const i=(0,n.blockTagParamIndex)(t.method);if(i===undefined)return s();if("latest"!==(Array.isArray(t.params)&&t.params[i]?t.params[i]:"latest"))return s();const a=await e.getLatestBlock();return Array.isArray(t.params)&&(t.params[i]=a),s()})}}}},{package:"@metamask/eth-json-rpc-middleware",file:"node_modules/@metamask/eth-json-rpc-middleware/dist/block-ref-rewrite.js"}],[1721,{"./logging-utils":1726,"./utils/cache":1731,"@metamask/json-rpc-engine":1943,"klona/full":4386},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createBlockRefMiddleware=void 0;const s=e("@metamask/json-rpc-engine"),n=e("klona/full"),i=e("./logging-utils"),a=e("./utils/cache"),o=(0,i.createModuleLogger)(i.projectLogger,"block-ref");r.createBlockRefMiddleware=function({provider:e,blockTracker:t}={}){if(!e)throw Error('BlockRefMiddleware - mandatory "provider" option is missing.');if(!t)throw Error('BlockRefMiddleware - mandatory "blockTracker" option is missing.');return(0,s.createAsyncMiddleware)(async(r,s,i)=>{var c;const l=(0,a.blockTagParamIndex)(r.method);if(l===undefined)return i();if("latest"!==(Array.isArray(r.params)&&null!==(c=r.params[l])&&void 0!==c?c:"latest"))return o('blockRef is not "latest", carrying request forward'),i();const u=await t.getLatestBlock();o(`blockRef is "latest", setting param ${l} to latest block ${u}`);const d=(0,n.klona)(r);return Array.isArray(d.params)&&(d.params[l]=u),o("Performing another request %o",d),s.result=await e.request(d),undefined})}}}},{package:"@metamask/eth-json-rpc-middleware",file:"node_modules/@metamask/eth-json-rpc-middleware/dist/block-ref.js"}],[1722,{"./logging-utils":1726,"@metamask/json-rpc-engine":1943},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createBlockTrackerInspectorMiddleware=void 0;const s=e("@metamask/json-rpc-engine"),n=e("./logging-utils"),i=(0,n.createModuleLogger)(n.projectLogger,"block-tracker-inspector"),a=["eth_getTransactionByHash","eth_getTransactionReceipt"];function o(e){const{result:t}=e;return t&&"object"==typeof t&&(r=t,s="blockNumber",Object.hasOwnProperty.call(r,s))&&"string"==typeof t.blockNumber?t.blockNumber:undefined;var r,s}r.createBlockTrackerInspectorMiddleware=function({blockTracker:e}){return(0,s.createAsyncMiddleware)(async(t,r,s)=>{if(!a.includes(t.method))return s();await s();const n=o(r);if(!n)return undefined;i("res.result.blockNumber exists, proceeding. res = %o",r);return Number.parseInt(n,16)>Number.parseInt(e.getCurrentBlock(),16)&&(i("blockNumber from response is greater than current block number, refreshing current block number"),await e.checkForLatestBlock()),undefined})}}}},{package:"@metamask/eth-json-rpc-middleware",file:"node_modules/@metamask/eth-json-rpc-middleware/dist/block-tracker-inspector.js"}],[1723,{"@metamask/json-rpc-engine":1943,"@metamask/rpc-errors":2384},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createFetchMiddleware=void 0;const s=e("@metamask/json-rpc-engine"),n=e("@metamask/rpc-errors");r.createFetchMiddleware=function({rpcService:e,options:t={}}){return(0,s.createAsyncMiddleware)(async(r,s)=>{const i="originHttpHeaderKey"in t&&t.originHttpHeaderKey!==undefined&&r.origin!==undefined?{[t.originHttpHeaderKey]:r.origin}:{},a=await e.request({id:r.id,jsonrpc:r.jsonrpc,method:r.method,params:r.params},{headers:i});if("error"in a)throw n.rpcErrors.internal({data:a.error});s.result=a.result})}}}},{package:"@metamask/eth-json-rpc-middleware",file:"node_modules/@metamask/eth-json-rpc-middleware/dist/fetch.js"}],[1724,{"./block-cache":1719,"./block-ref":1721,"./block-ref-rewrite":1720,"./block-tracker-inspector":1722,"./fetch":1723,"./inflight-cache":1725,"./providerAsMiddleware":1729,"./retryOnEmpty":1730,"./wallet":1737},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var s=this&&this.__createBinding||(Object.create?function(e,t,r,s){s===undefined&&(s=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,s,n)}:function(e,t,r,s){s===undefined&&(s=r),e[s]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||s(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.createFetchMiddleware=void 0,n(e("./block-cache"),r),n(e("./block-ref-rewrite"),r),n(e("./block-ref"),r),n(e("./block-tracker-inspector"),r);var i=e("./fetch");Object.defineProperty(r,"createFetchMiddleware",{enumerable:!0,get:function(){return i.createFetchMiddleware}}),n(e("./inflight-cache"),r),n(e("./providerAsMiddleware"),r),n(e("./retryOnEmpty"),r),n(e("./wallet"),r)}}},{package:"@metamask/eth-json-rpc-middleware",file:"node_modules/@metamask/eth-json-rpc-middleware/dist/index.js"}],[1725,{"./logging-utils":1726,"./utils/cache":1731,"@metamask/json-rpc-engine":1943,"klona/full":4386},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createInflightCacheMiddleware=void 0;const s=e("@metamask/json-rpc-engine"),n=e("klona/full"),i=e("./logging-utils"),a=e("./utils/cache"),o=(0,i.createModuleLogger)(i.projectLogger,"inflight-cache");r.createInflightCacheMiddleware=function(){const e={};return(0,s.createAsyncMiddleware)(async(t,r,s)=>{if(t.skipCache)return s();const i=(0,a.cacheIdentifierForRequest)(t);if(!i)return o("Request is not cacheable, proceeding. req = %o",t),s();let c=e[i];return c?(o("Running %i handler(s) for request %o",c.length,t),await async function(e,t){const{resolve:r,promise:s}=function(){let e;const t=new Promise(t=>{e=t});return{resolve:e,promise:t}}();return t.push(t=>{e.result=(0,n.klona)(t.result),e.error=(0,n.klona)(t.error),r()}),s}(r,c),undefined):(c=[],e[i]=c,o("Carrying original request forward %o",t),await s(),delete e[i],o("Running %i collected handler(s) for request %o",c.length,t),function(e,t){setTimeout(()=>{t.forEach(t=>{try{t(e)}catch(e){console.error(e)}})})}(r,c),undefined)})}}}},{package:"@metamask/eth-json-rpc-middleware",file:"node_modules/@metamask/eth-json-rpc-middleware/dist/inflight-cache.js"}],[1726,{"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createModuleLogger=r.projectLogger=void 0;const s=e("@metamask/utils");Object.defineProperty(r,"createModuleLogger",{enumerable:!0,get:function(){return s.createModuleLogger}}),r.projectLogger=(0,s.createProjectLogger)("eth-json-rpc-middleware")}}},{package:"@metamask/eth-json-rpc-middleware",file:"node_modules/@metamask/eth-json-rpc-middleware/dist/logging-utils.js"}],[1727,{"../utils/validation":1736,"@metamask/rpc-errors":2384,"@metamask/superstruct":2705,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.walletRequestExecutionPermissions=r.RequestExecutionPermissionsStruct=void 0;const s=e("@metamask/rpc-errors"),n=e("@metamask/superstruct"),i=e("@metamask/utils"),a=e("../utils/validation"),o=(0,n.object)({type:(0,n.string)(),isAdjustmentAllowed:(0,n.boolean)(),data:(0,n.record)((0,n.string)(),(0,n.unknown)())}),c=(0,n.object)({type:(0,n.string)(),isAdjustmentAllowed:(0,n.boolean)(),data:(0,n.record)((0,n.string)(),(0,n.unknown)())}),l=(0,n.object)({type:(0,n.literal)("account"),data:(0,n.object)({address:i.HexChecksumAddressStruct})}),u=(0,n.object)({chainId:i.StrictHexStruct,address:(0,n.optional)(i.HexChecksumAddressStruct),signer:l,permission:o,rules:(0,n.optional)((0,n.union)([(0,n.array)(c),(0,n.literal)(null)]))});r.RequestExecutionPermissionsStruct=(0,n.array)(u),r.walletRequestExecutionPermissions=async function(e,t,{processRequestExecutionPermissions:n}){if(!n)throw s.rpcErrors.methodNotSupported("wallet_requestExecutionPermissions - no middleware configured");const{params:i}=e;(0,a.validateParams)(i,r.RequestExecutionPermissionsStruct),t.result=await n(i,e)}}}},{package:"@metamask/eth-json-rpc-middleware",file:"node_modules/@metamask/eth-json-rpc-middleware/dist/methods/wallet-request-execution-permissions.js"}],[1728,{"../utils/validation":1736,"@metamask/rpc-errors":2384,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.walletRevokeExecutionPermission=r.RevokeExecutionPermissionRequestParamsStruct=r.RevokeExecutionPermissionResultStruct=void 0;const s=e("@metamask/rpc-errors"),n=e("@metamask/utils"),i=e("../utils/validation");r.RevokeExecutionPermissionResultStruct=(0,n.object)({}),r.RevokeExecutionPermissionRequestParamsStruct=(0,n.object)({permissionContext:n.StrictHexStruct}),r.walletRevokeExecutionPermission=async function(e,t,{processRevokeExecutionPermission:n}){if(!n)throw s.rpcErrors.methodNotSupported("wallet_revokeExecutionPermission - no middleware configured");const{params:a}=e;(0,i.validateParams)(a,r.RevokeExecutionPermissionRequestParamsStruct),t.result=await n(a,e)}}}},{package:"@metamask/eth-json-rpc-middleware",file:"node_modules/@metamask/eth-json-rpc-middleware/dist/methods/wallet-revoke-execution-permission.js"}],[1729,{"@metamask/json-rpc-engine":1943},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.ethersProviderAsMiddleware=r.providerAsMiddleware=void 0;const s=e("@metamask/json-rpc-engine");r.providerAsMiddleware=function(e){return(0,s.createAsyncMiddleware)(async(t,r)=>{r.result=await e.request(t)})},r.ethersProviderAsMiddleware=function(e){return(t,r,s,n)=>{e.send(t,(e,t)=>e?n(e):(Object.assign(r,t),n()))}}}}},{package:"@metamask/eth-json-rpc-middleware",file:"node_modules/@metamask/eth-json-rpc-middleware/dist/providerAsMiddleware.js"}],[1730,{"./logging-utils":1726,"./utils/cache":1731,"./utils/error":1733,"./utils/timeout":1735,"@metamask/json-rpc-engine":1943,"klona/full":4386},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createRetryOnEmptyMiddleware=void 0;const s=e("@metamask/json-rpc-engine"),n=e("klona/full"),i=e("./logging-utils"),a=e("./utils/cache"),o=e("./utils/error"),c=e("./utils/timeout"),l=(0,i.createModuleLogger)(i.projectLogger,"retry-on-empty"),u=[undefined,null,"<nil>"];r.createRetryOnEmptyMiddleware=function({provider:e,blockTracker:t}={}){if(!e)throw Error('RetryOnEmptyMiddleware - mandatory "provider" option is missing.');if(!t)throw Error('RetryOnEmptyMiddleware - mandatory "blockTracker" option is missing.');return(0,s.createAsyncMiddleware)(async(r,s,i)=>{const d=(0,a.blockTagParamIndex)(r.method);if(d===undefined)return i();let p=Array.isArray(r.params)&&r.params[d]?r.params[d]:undefined;if(p===undefined&&(p="latest"),["latest","pending"].includes(p))return i();const h=Number.parseInt(p.slice(2),16);if(Number.isNaN(h))return i();const m=await t.getLatestBlock(),g=Number.parseInt(m.slice(2),16);if(h>g)return l("Requested block number %o is higher than latest block number %o, falling through to original request",h,g),i();l("Requested block number %o is not higher than latest block number %o, trying request until non-empty response is received",h,g);const f=(0,n.klona)(r),y=await async function(e,t){for(let r=0;r<e;r++)try{return await t()}catch(e){if((0,o.isExecutionRevertedError)(e))throw e;l("(call %i) Request failed, waiting 1s to retry again...",r+1),await(0,c.timeout)(1e3)}throw l("Retries exhausted"),new Error("RetryOnEmptyMiddleware - retries exhausted")}(10,async()=>{l("Performing request %o",f);const t=await e.request(f);l("Result is %o",t);if(u.includes(t))throw new Error(`RetryOnEmptyMiddleware - empty result "${JSON.stringify(t)}" for request "${JSON.stringify(f)}"`);return t});return l("Copying result %o",y),s.result=y,undefined})}}}},{package:"@metamask/eth-json-rpc-middleware",file:"node_modules/@metamask/eth-json-rpc-middleware/dist/retryOnEmpty.js"}],[1731,{"safe-stable-stringify":5220},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.cacheTypeForMethod=r.blockTagParamIndex=r.blockTagForRequest=r.canCache=r.cacheIdentifierForRequest=r.CacheStrategy=void 0;const s=(0,e("safe-stable-stringify").configure)({bigint:!1,circularValue:Error});var n;function i(e){return o(e)!==n.Never}function a(e){switch(e){case"eth_getStorageAt":return 2;case"eth_getBalance":case"eth_getCode":case"eth_getTransactionCount":case"eth_call":return 1;case"eth_getBlockByNumber":return 0;default:return undefined}}function o(e){switch(e){case"web3_clientVersion":case"web3_sha3":case"eth_protocolVersion":case"eth_getBlockTransactionCountByHash":case"eth_getUncleCountByBlockHash":case"eth_getCode":case"eth_getBlockByHash":case"eth_getTransactionByHash":case"eth_getTransactionByBlockHashAndIndex":case"eth_getTransactionReceipt":case"eth_getUncleByBlockHashAndIndex":case"eth_getCompilers":case"eth_compileLLL":case"eth_compileSolidity":case"eth_compileSerpent":case"shh_version":case"test_permaCache":return n.Permanent;case"eth_getBlockByNumber":case"eth_getBlockTransactionCountByNumber":case"eth_getUncleCountByBlockNumber":case"eth_getTransactionByBlockNumberAndIndex":case"eth_getUncleByBlockNumberAndIndex":case"test_forkCache":return n.Fork;case"eth_gasPrice":case"eth_blockNumber":case"eth_getBalance":case"eth_getStorageAt":case"eth_getTransactionCount":case"eth_call":case"eth_estimateGas":case"eth_getFilterLogs":case"eth_getLogs":case"test_blockCache":return n.Block;default:return n.Never}}!function(e){e.Block="block",e.Fork="fork",e.Never="never",e.Permanent="perma"}(n=r.CacheStrategy||(r.CacheStrategy={})),r.cacheIdentifierForRequest=function(e,t){var r;const n=t?function(e){if(!e.params)return[];const t=a(e.method);if(t===undefined||!Array.isArray(e.params)||t>=e.params.length)return e.params;if("eth_getBlockByNumber"===e.method)return e.params.slice(1);return e.params.slice(0,t)}(e):null!==(r=e.params)&&void 0!==r?r:[];return i(e.method)?`${e.method}:${s(n)}`:null},r.canCache=i,r.blockTagForRequest=function(e){if(!e.params)return undefined;const t=a(e.method);return t===undefined||!Array.isArray(e.params)||t>=e.params.length?undefined:e.params[t]},r.blockTagParamIndex=a,r.cacheTypeForMethod=o}}},{package:"@metamask/eth-json-rpc-middleware",file:"node_modules/@metamask/eth-json-rpc-middleware/dist/utils/cache.js"}],[1732,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.stripArrayTypeIfPresent=void 0;r.stripArrayTypeIfPresent=e=>(null==e?void 0:e.match(/\S\[\d*\]$/u))?e.replace(/\[\d*\]$/gu,"").trim():e}}},{package:"@metamask/eth-json-rpc-middleware",file:"node_modules/@metamask/eth-json-rpc-middleware/dist/utils/common.js"}],[1733,{"@metamask/rpc-errors":2384,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.isExecutionRevertedError=void 0;const s=e("@metamask/rpc-errors"),n=e("@metamask/utils");r.isExecutionRevertedError=function(e){return(0,n.isJsonRpcError)(e)&&e.code===s.errorCodes.rpc.invalidInput&&"execution reverted"===e.message}}}},{package:"@metamask/eth-json-rpc-middleware",file:"node_modules/@metamask/eth-json-rpc-middleware/dist/utils/error.js"}],[1734,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){function s(e){return"string"!=typeof e?e:JSON.parse(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.parseTypedMessage=r.normalizeTypedMessage=void 0,r.normalizeTypedMessage=function(e){var t;let r;try{r=s(e)}catch(t){return e}const{verifyingContract:n}=null!==(t=r.domain)&&void 0!==t?t:{};return n?(r.domain.verifyingContract=function(e){if(e.startsWith("0X"))return`0x${e.slice(2)}`;return e}(n),JSON.stringify(r)):e},r.parseTypedMessage=s}}},{package:"@metamask/eth-json-rpc-middleware",file:"node_modules/@metamask/eth-json-rpc-middleware/dist/utils/normalize.js"}],[1735,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.timeout=void 0,r.timeout=async function(e){return new Promise(t=>setTimeout(t,e))}}}},{package:"@metamask/eth-json-rpc-middleware",file:"node_modules/@metamask/eth-json-rpc-middleware/dist/utils/timeout.js"}],[1736,{"@metamask/rpc-errors":2384,"@metamask/superstruct":2705},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.resemblesAddress=r.validateParams=r.validateAndNormalizeKeyholder=void 0;const s=e("@metamask/rpc-errors"),n=e("@metamask/superstruct");function i(e){return 42===e.length}r.validateAndNormalizeKeyholder=async function(e,t,{getAccounts:r}){if("string"==typeof e&&e.length>0&&i(e)){const n=(await r(t)).map(e=>e.toLowerCase()),i=e.toLowerCase();if(n.includes(i))return i;throw s.providerErrors.unauthorized()}throw s.rpcErrors.invalidParams({message:"Invalid parameters: must provide an Ethereum address."})},r.validateParams=function(e,t){const[r]=(0,n.validate)(e,t);if(r)throw s.rpcErrors.invalidParams(function(e,t){return`${t}\n\n${e.failures().map(e=>`${e.path.join(" > ")}${e.path.length?" - ":""}${e.message}`).join("\n")}`}(r,"Invalid params"))},r.resemblesAddress=i}}},{package:"@metamask/eth-json-rpc-middleware",file:"node_modules/@metamask/eth-json-rpc-middleware/dist/utils/validation.js"}],[1737,{"./methods/wallet-request-execution-permissions":1727,"./methods/wallet-revoke-execution-permission":1728,"./utils/common":1732,"./utils/normalize":1734,"./utils/validation":1736,"@metamask/eth-sig-util":1833,"@metamask/json-rpc-engine":1943,"@metamask/rpc-errors":2384,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var s=this&&this.__createBinding||(Object.create?function(e,t,r,s){s===undefined&&(s=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,s,n)}:function(e,t,r,s){s===undefined&&(s=r),e[s]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&s(t,e,r);return n(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.createWalletMiddleware=void 0;const a=i(e("@metamask/eth-sig-util")),o=e("@metamask/json-rpc-engine"),c=e("@metamask/rpc-errors"),l=e("@metamask/utils"),u=e("./methods/wallet-request-execution-permissions"),d=e("./methods/wallet-revoke-execution-permission"),p=e("./utils/common"),h=e("./utils/normalize"),m=e("./utils/validation");function g(e){const{primaryType:t,types:r}=(0,h.parseTypedMessage)(e);if(!r)throw c.rpcErrors.invalidInput();if(!r[(0,p.stripArrayTypeIfPresent)(t)])throw c.rpcErrors.invalidInput()}function f(e){const{domain:{verifyingContract:t}={}}=(0,h.parseTypedMessage)(e);if(t&&"cosmos"!==t&&!(0,l.isValidHexAddress)(t))throw c.rpcErrors.invalidInput()}r.createWalletMiddleware=function({getAccounts:e,processDecryptMessage:t,processEncryptionPublicKey:r,processPersonalMessage:s,processTransaction:n,processSignTransaction:i,processTypedMessage:l,processTypedMessageV3:p,processTypedMessageV4:y,processRequestExecutionPermissions:w,processRevokeExecutionPermission:v}){if(!e)throw new Error("opts.getAccounts is required");return(0,o.createScaffoldMiddleware)({eth_accounts:(0,o.createAsyncMiddleware)(async function(t,r){r.result=await e(t)}),eth_coinbase:(0,o.createAsyncMiddleware)(async function(t,r){const s=await e(t);r.result=s[0]||null}),eth_sendTransaction:(0,o.createAsyncMiddleware)(async function(e,t){if(!n)throw c.rpcErrors.methodNotSupported();if(!(e.params&&Array.isArray(e.params)&&e.params.length>=1))throw c.rpcErrors.invalidInput();const r=e.params[0],s=Object.assign(Object.assign({},r),{from:await S((null==r?void 0:r.from)||"",e)});t.result=await n(s,e)}),eth_signTransaction:(0,o.createAsyncMiddleware)(async function(e,t){if(!i)throw c.rpcErrors.methodNotSupported();if(!(e.params&&Array.isArray(e.params)&&e.params.length>=1))throw c.rpcErrors.invalidInput();const r=e.params[0],s=Object.assign(Object.assign({},r),{from:await S((null==r?void 0:r.from)||"",e)});t.result=await i(s,e)}),eth_signTypedData:(0,o.createAsyncMiddleware)(async function(e,t){if(!l)throw c.rpcErrors.methodNotSupported();if(!((null==e?void 0:e.params)&&Array.isArray(e.params)&&e.params.length>=2))throw c.rpcErrors.invalidInput();const r=e.params,s=r[0],n=await S(r[1],e),i=r[2]||{},a=Object.assign(Object.assign({},i),{from:n,data:s,signatureMethod:"eth_signTypedData",version:"V1"});t.result=await l(a,e,"V1")}),eth_signTypedData_v3:(0,o.createAsyncMiddleware)(async function(e,t){if(!p)throw c.rpcErrors.methodNotSupported();if(!((null==e?void 0:e.params)&&Array.isArray(e.params)&&e.params.length>=2))throw c.rpcErrors.invalidInput();const r=e.params,s=await S(r[0],e),n=(0,h.normalizeTypedMessage)(r[1]);g(n),f(n);const i={data:n,from:s,version:"V3",signatureMethod:"eth_signTypedData_v3"};t.result=await p(i,e,"V3")}),eth_signTypedData_v4:(0,o.createAsyncMiddleware)(async function(e,t){if(!y)throw c.rpcErrors.methodNotSupported();if(!((null==e?void 0:e.params)&&Array.isArray(e.params)&&e.params.length>=2))throw c.rpcErrors.invalidInput();const r=e.params,s=await S(r[0],e),n=(0,h.normalizeTypedMessage)(r[1]);g(n),f(n);const i={data:n,from:s,version:"V4",signatureMethod:"eth_signTypedData_v4"};t.result=await y(i,e,"V4")}),personal_sign:(0,o.createAsyncMiddleware)(async function(e,t){if(!s)throw c.rpcErrors.methodNotSupported();if(!((null==e?void 0:e.params)&&Array.isArray(e.params)&&e.params.length>=2))throw c.rpcErrors.invalidInput();const r=e.params,n=r[0],i=r[1],a=r[2]||{};let o,l;if((0,m.resemblesAddress)(n)&&!(0,m.resemblesAddress)(i)){let e="The eth_personalSign method requires params ordered ";e+="[message, address]. This was previously handled incorrectly, ",e+="and has been corrected automatically. ",e+="Please switch this param order for smooth behavior in the future.",t.warning=e,o=n,l=i}else l=n,o=i;o=await S(o,e);const u=Object.assign(Object.assign({},a),{from:o,data:l,signatureMethod:"personal_sign"});t.result=await s(u,e)}),eth_getEncryptionPublicKey:(0,o.createAsyncMiddleware)(async function(e,t){if(!r)throw c.rpcErrors.methodNotSupported();if(!((null==e?void 0:e.params)&&Array.isArray(e.params)&&e.params.length>=1))throw c.rpcErrors.invalidInput();const s=e.params,n=await S(s[0],e);t.result=await r(n,e)}),eth_decrypt:(0,o.createAsyncMiddleware)(async function(e,r){if(!t)throw c.rpcErrors.methodNotSupported();if(!((null==e?void 0:e.params)&&Array.isArray(e.params)&&e.params.length>=1))throw c.rpcErrors.invalidInput();const s=e.params,n=s[0],i=await S(s[1],e),a=s[2]||{},o=Object.assign(Object.assign({},a),{from:i,data:n});r.result=await t(o,e)}),personal_ecRecover:(0,o.createAsyncMiddleware)(async function(e,t){if(!((null==e?void 0:e.params)&&Array.isArray(e.params)&&e.params.length>=2))throw c.rpcErrors.invalidInput();const r=e.params,s=r[0],n=r[1],i=a.recoverPersonalSignature({data:s,signature:n});t.result=i}),wallet_requestExecutionPermissions:(0,o.createAsyncMiddleware)(async(e,t)=>(0,u.walletRequestExecutionPermissions)(e,t,{processRequestExecutionPermissions:w})),wallet_revokeExecutionPermission:(0,o.createAsyncMiddleware)(async(e,t)=>(0,d.walletRevokeExecutionPermission)(e,t,{processRevokeExecutionPermission:v}))});async function S(t,r){return(0,m.validateAndNormalizeKeyholder)(t,r,{getAccounts:e})}}}}},{package:"@metamask/eth-json-rpc-middleware",file:"node_modules/@metamask/eth-json-rpc-middleware/dist/wallet.js"}],[174,{"../../../shared/constants/hardware-wallets":5424,"../../../shared/constants/network":5433,"../../../shared/constants/preferences":5438,"@metamask/base-controller":1222,"@metamask/preferences-controller":2294},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getDefaultPreferencesControllerState=r.ReferralStatus=r.PreferencesController=void 0;var s=e("@metamask/base-controller"),n=e("@metamask/preferences-controller"),i=e("../../../shared/constants/network"),a=e("../../../shared/constants/hardware-wallets"),o=e("../../../shared/constants/preferences");function c(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}let l=r.ReferralStatus=function(e){return e.Approved="approved",e.Passed="passed",e.Declined="declined",e}({});const u=()=>({addSnapAccountEnabled:!1,advancedGasFee:{},currentLocale:"",dismissSeedBackUpReminder:!1,enableMV3TimestampSave:!0,featureFlags:{},forgottenPassword:!1,identities:{},ipfsGateway:i.IPFS_DEFAULT_GATEWAY_URL,isIpfsGatewayEnabled:!0,isMultiAccountBalancesEnabled:!0,knownMethodData:{},ledgerTransportType:window.navigator.hid?a.LedgerTransportTypes.webhid:a.LedgerTransportTypes.u2f,lostIdentities:{},manageInstitutionalWallets:!1,openSeaEnabled:!0,overrideContentSecurityPolicyHeader:!0,preferences:{autoLockTimeLimit:undefined,avatarType:"maskicon",dismissSmartAccountSuggestionEnabled:!1,featureNotificationsEnabled:!1,hideZeroBalanceTokens:!1,petnamesEnabled:!0,privacyMode:!1,showConfirmationAdvancedDetails:!1,showExtensionInFullSizeView:!1,showFiatInTestnets:!1,showMultiRpcModal:!1,showNativeTokenAsMainBalance:!1,showTestNetworks:!1,skipDeepLinkInterstitial:!1,smartAccountOptIn:!0,smartTransactionsOptInStatus:!0,smartTransactionsMigrationApplied:!1,tokenNetworkFilter:{},tokenSortConfig:{key:"tokenFiatAmount",order:"dsc",sortCallback:"stringNumeric"},useNativeCurrencyAsPrimaryCurrency:!0},securityAlertsEnabled:!0,selectedAddress:"",showIncomingTransactions:{[n.ETHERSCAN_SUPPORTED_CHAIN_IDS.MAINNET]:!0,[n.ETHERSCAN_SUPPORTED_CHAIN_IDS.GOERLI]:!0,[n.ETHERSCAN_SUPPORTED_CHAIN_IDS.BSC]:!0,[n.ETHERSCAN_SUPPORTED_CHAIN_IDS.BSC_TESTNET]:!0,[n.ETHERSCAN_SUPPORTED_CHAIN_IDS.OPTIMISM]:!0,[n.ETHERSCAN_SUPPORTED_CHAIN_IDS.OPTIMISM_SEPOLIA]:!0,[n.ETHERSCAN_SUPPORTED_CHAIN_IDS.POLYGON]:!0,[n.ETHERSCAN_SUPPORTED_CHAIN_IDS.POLYGON_TESTNET]:!0,[n.ETHERSCAN_SUPPORTED_CHAIN_IDS.AVALANCHE]:!0,[n.ETHERSCAN_SUPPORTED_CHAIN_IDS.AVALANCHE_TESTNET]:!0,[n.ETHERSCAN_SUPPORTED_CHAIN_IDS.FANTOM]:!0,[n.ETHERSCAN_SUPPORTED_CHAIN_IDS.FANTOM_TESTNET]:!0,[n.ETHERSCAN_SUPPORTED_CHAIN_IDS.SEPOLIA]:!0,[n.ETHERSCAN_SUPPORTED_CHAIN_IDS.LINEA_GOERLI]:!0,[n.ETHERSCAN_SUPPORTED_CHAIN_IDS.LINEA_SEPOLIA]:!0,[n.ETHERSCAN_SUPPORTED_CHAIN_IDS.LINEA_MAINNET]:!0,[n.ETHERSCAN_SUPPORTED_CHAIN_IDS.MOONBEAM]:!0,[n.ETHERSCAN_SUPPORTED_CHAIN_IDS.MOONBEAM_TESTNET]:!0,[n.ETHERSCAN_SUPPORTED_CHAIN_IDS.MOONRIVER]:!0,[n.ETHERSCAN_SUPPORTED_CHAIN_IDS.GNOSIS]:!0,[n.ETHERSCAN_SUPPORTED_CHAIN_IDS.SEI]:!0},snapRegistryList:{},snapsAddSnapAccountModalDismissed:!1,theme:o.ThemeType.os,use4ByteResolution:!0,useAddressBarEnsResolution:!0,useBlockie:!1,useCurrencyRateCheck:!0,useExternalNameSources:!0,useExternalServices:!0,useMultiAccountBalanceChecker:!0,useNftDetection:!0,usePhishDetect:!0,useSafeChainsListValidation:!0,useTokenDetection:!0,useTransactionSimulations:!0,watchEthereumAccountEnabled:!1,referrals:{hyperliquid:{}}});r.getDefaultPreferencesControllerState=u;const d={addSnapAccountEnabled:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!0},advancedGasFee:{persist:!0,includeInStateLogs:!0,anonymous:!0,usedInUi:!0},currentLocale:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},dismissSeedBackUpReminder:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},enableMV3TimestampSave:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},featureFlags:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},forgottenPassword:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},identities:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!0},ipfsGateway:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!0},isIpfsGatewayEnabled:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!0},isMultiAccountBalancesEnabled:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},knownMethodData:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!0},ledgerTransportType:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},lostIdentities:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!0},manageInstitutionalWallets:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!0},openSeaEnabled:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},overrideContentSecurityPolicyHeader:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},preferences:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},securityAlertsEnabled:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!0},selectedAddress:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!0},showIncomingTransactions:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},snapRegistryList:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!0},snapsAddSnapAccountModalDismissed:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!0},textDirection:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!0},theme:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},use4ByteResolution:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},useAddressBarEnsResolution:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},useBlockie:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},useCurrencyRateCheck:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},useExternalNameSources:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!0},useExternalServices:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!0},useMultiAccountBalanceChecker:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},useNftDetection:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},usePhishDetect:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},useSafeChainsListValidation:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!0},useTokenDetection:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},useTransactionSimulations:{includeInStateLogs:!0,persist:!0,anonymous:!0,usedInUi:!0},watchEthereumAccountEnabled:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!0},referrals:{includeInStateLogs:!0,persist:!0,anonymous:!1,usedInUi:!0}};var p=new WeakSet;class h extends s.BaseController{constructor({messenger:e,state:t}){const r=u(),s={...r,...t,preferences:{...r.preferences,...null==t?void 0:t.preferences}};super({messenger:e,metadata:d,name:"PreferencesController",state:s}),c(this,p),this.messagingSystem.subscribe("AccountsController:stateChange",function(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}(p,this,m).bind(this)),globalThis.setPreference=(e,t)=>this.setFeatureFlag(e,t)}setPasswordForgotten(e){this.update(t=>{t.forgottenPassword=e})}setUseBlockie(e){this.update(t=>{t.useBlockie=e})}setUsePhishDetect(e){this.update(t=>{t.usePhishDetect=e})}setUseMultiAccountBalanceChecker(e){this.update(t=>{t.useMultiAccountBalanceChecker=e})}setUseSafeChainsListValidation(e){this.update(t=>{t.useSafeChainsListValidation=e})}toggleExternalServices(e){this.update(t=>{t.useExternalServices=e}),this.setUseTokenDetection(e),this.setUseCurrencyRateCheck(e),this.setUsePhishDetect(e),this.setUseAddressBarEnsResolution(e),this.setOpenSeaEnabled(e),this.setUseNftDetection(e),this.setUseSafeChainsListValidation(e)}setUseTokenDetection(e){this.update(t=>{t.useTokenDetection=e})}setUseNftDetection(e){this.update(t=>{t.useNftDetection=e})}setUse4ByteResolution(e){this.update(t=>{t.use4ByteResolution=e})}setUseCurrencyRateCheck(e){this.update(t=>{t.useCurrencyRateCheck=e})}setOpenSeaEnabled(e){this.update(t=>{t.openSeaEnabled=e})}setSecurityAlertsEnabled(e){this.update(t=>{t.securityAlertsEnabled=e})}setAddSnapAccountEnabled(e){this.update(t=>{t.addSnapAccountEnabled=e})}setUseExternalNameSources(e){this.update(t=>{t.useExternalNameSources=e})}setUseTransactionSimulations(e){this.update(t=>{t.useTransactionSimulations=e})}setAdvancedGasFee({chainId:e,gasFeePreferences:t}){const{advancedGasFee:r}=this.state;this.update(s=>{s.advancedGasFee={...r,[e]:t}})}setTheme(e){this.update(t=>{t.theme=e})}addKnownMethodData(e,t){const{knownMethodData:r}=this.state,s={...r};s[e]=t,this.update(e=>{e.knownMethodData=s})}setCurrentLocale(e){const t=["ar","dv","fa","he","ku"].includes(e)?"rtl":"auto";return this.update(r=>{r.currentLocale=e,r.textDirection=t}),t}setSelectedAddress(e){const t=this.messagingSystem.call("AccountsController:getAccountByAddress",e);if(!t)throw new Error(`Identity for '${e} not found`);this.messagingSystem.call("AccountsController:setSelectedAccount",t.id)}getSelectedAddress(){return this.messagingSystem.call("AccountsController:getSelectedAccount").address}setAccountLabel(e,t){if(!e)throw new Error(`setAccountLabel requires a valid address, got ${String(e)}`);const r=this.messagingSystem.call("AccountsController:getAccountByAddress",e);return r?(this.messagingSystem.call("AccountsController:setAccountName",r.id,t),t):undefined}setFeatureFlag(e,t){const r={...this.state.featureFlags,[e]:t};return this.update(e=>{e.featureFlags=r}),r}setPreference(e,t){const r={...this.getPreferences(),[e]:t};return this.update(e=>{e.preferences=r}),r}getPreferences(){return this.state.preferences}getIpfsGateway(){return this.state.ipfsGateway}setIpfsGateway(e){return this.update(t=>{t.ipfsGateway=e}),e}setIsIpfsGatewayEnabled(e){this.update(t=>{t.isIpfsGatewayEnabled=e})}setUseAddressBarEnsResolution(e){this.update(t=>{t.useAddressBarEnsResolution=e})}setLedgerTransportPreference(e){return this.update(t=>{t.ledgerTransportType=e}),e}setDismissSeedBackUpReminder(e){this.update(t=>{t.dismissSeedBackUpReminder=e})}setOverrideContentSecurityPolicyHeader(e){this.update(t=>{t.overrideContentSecurityPolicyHeader=e})}setManageInstitutionalWallets(e){this.update(t=>{t.manageInstitutionalWallets=e})}setServiceWorkerKeepAlivePreference(e){this.update(t=>{t.enableMV3TimestampSave=e})}setSnapsAddSnapAccountModalDismissed(e){this.update(t=>{t.snapsAddSnapAccountModalDismissed=e})}addReferralApprovedAccount(e){this.update(t=>{t.referrals.hyperliquid[e]=l.Approved})}addReferralPassedAccount(e){this.update(t=>{t.referrals.hyperliquid[e]=l.Passed})}addReferralDeclinedAccount(e){this.update(t=>{t.referrals.hyperliquid[e]=l.Declined})}removeReferralDeclinedAccount(e){this.update(t=>{delete t.referrals.hyperliquid[e]})}setAccountsReferralApproved(e){this.update(t=>{e.forEach(e=>{t.referrals.hyperliquid[e]=l.Approved})})}}function m(e){const{accounts:t,selectedAccount:r}=e.internalAccounts,s=t[r],{identities:n,lostIdentities:i}=this.state,a=Object.values(t).map(e=>e.address.toLowerCase()),o=Object.keys(n).reduce((e,t)=>(a.includes(t.toLowerCase())&&(e[t]=n[t]),e),{...i??{}}),c=Object.values(t).reduce((e,t)=>(e[t.address]={address:t.address,name:t.metadata.name,lastSelected:t.metadata.lastSelected},e),{});this.update(e=>{e.identities=c,e.lostIdentities=o,e.selectedAddress=(null==s?void 0:s.address)||""})}r.PreferencesController=h}}},{package:"$root$",file:"app/scripts/controllers/preferences-controller.ts"}],[1742,{"./ledger-hw-app.cjs":1744,"./ledger-iframe-bridge.cjs":1745,"./ledger-keyring.cjs":1746,"./ledger-mobile-bridge.cjs":1747,"./ledger-transport-middleware.cjs":1748},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var s=this&&this.__createBinding||(Object.create?function(e,t,r,s){s===undefined&&(s=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,s,n)}:function(e,t,r,s){s===undefined&&(s=r),e[s]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||s(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),n(e("./ledger-keyring.cjs"),r),n(e("./ledger-iframe-bridge.cjs"),r),n(e("./ledger-mobile-bridge.cjs"),r),n(e("./ledger-transport-middleware.cjs"),r),n(e("./ledger-hw-app.cjs"),r)}}},{package:"@metamask/eth-ledger-bridge-keyring",file:"node_modules/@metamask/eth-ledger-bridge-keyring/dist/index.cjs"}],[1743,{"./type.cjs":1749,"@ledgerhq/hw-transport":879},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.handleLedgerTransportError=function(e,t){if(e instanceof s.TransportStatusError){const t=e;throw new n.LedgerStatusError(t.statusCode,function(e){switch(e.statusCode){case 27013:return"Ledger: User rejected the transaction";case 27264:return"Ledger: Blind signing must be enabled";case 21781:return"Ledger: Device is locked. Unlock it to continue";case 25871:return"Ledger: Ethereum app closed. Open it to unlock";default:return e.message}}(t))}throw e instanceof Error?e:new Error(t)};const s=e("@ledgerhq/hw-transport"),n=e("./type.cjs")}}},{package:"@metamask/eth-ledger-bridge-keyring",file:"node_modules/@metamask/eth-ledger-bridge-keyring/dist/ledger-error-handler.cjs"}],[1744,{"@ledgerhq/hw-app-eth":864,buffer:3760},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.MetaMaskLedgerHwAppEth=void 0;const n=s(e("@ledgerhq/hw-app-eth")),i=e("buffer");class a extends n.default{constructor(){super(...arguments),this.mainAppName="BOLOS",this.ethAppName="Ethereum",this.transportEncoding="ascii"}async openEthApp(){await this.transport.send(224,216,0,0,i.Buffer.from(this.ethAppName,this.transportEncoding))}async closeApps(){await this.transport.send(176,167,0,0)}async getAppNameAndVersion(){const e=await this.transport.send(176,1,0,0);if(1!==e[0])throw new Error("Incorrect format return from getAppNameAndVersion.");let t=1;const r=e[t]??0;t+=1;const s=e.slice(t,t+=r).toString(this.transportEncoding),n=e[t]??0;t+=1;return{appName:s,version:e.slice(t,t+=n).toString(this.transportEncoding)}}}r.MetaMaskLedgerHwAppEth=a}}},{package:"@metamask/eth-ledger-bridge-keyring",file:"node_modules/@metamask/eth-ledger-bridge-keyring/dist/ledger-hw-app.cjs"}],[1745,{"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var s,n,i,a,o,c,l,u,d,p=this&&this.__classPrivateFieldGet||function(e,t,r,s){if("a"===r&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?s:"a"===r?s.call(e):s?s.value:t.get(e)},h=this&&this.__classPrivateFieldSet||function(e,t,r,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(e,r):n?n.value=r:t.set(e,r),r};Object.defineProperty(r,"__esModule",{value:!0}),r.LedgerIframeBridge=r.IFrameMessageAction=void 0;const m=e("@metamask/utils");var g;!function(e){e.LedgerIsIframeReady="ledger-is-iframe-ready",e.LedgerConnectionChange="ledger-connection-change",e.LedgerUnlock="ledger-unlock",e.LedgerMakeApp="ledger-make-app",e.LedgerUpdateTransport="ledger-update-transport",e.LedgerSignTransaction="ledger-sign-transaction",e.LedgerSignPersonalMessage="ledger-sign-personal-message",e.LedgerSignTypedData="ledger-sign-typed-data"}(g||(r.IFrameMessageAction=g={}));r.LedgerIframeBridge=class{constructor(e={bridgeUrl:"https://metamask.github.io/eth-ledger-bridge-keyring"}){s.add(this),this.iframeLoaded=!1,n.set(this,void 0),this.isDeviceConnected=!1,this.currentMessageId=0,i.set(this,new Map),p(this,s,"m",d).call(this,e),h(this,n,{bridgeUrl:e?.bridgeUrl},"f")}async init(){await p(this,s,"m",o).call(this,p(this,n,"f").bridgeUrl),this.eventListener=p(this,s,"m",l).bind(this,p(this,n,"f").bridgeUrl),window.addEventListener("message",this.eventListener)}async destroy(){this.eventListener&&window.removeEventListener("message",this.eventListener)}async getOptions(){return p(this,n,"f")}async setOptions(e){p(this,s,"m",d).call(this,e),p(this,n,"f")?.bridgeUrl!==e.bridgeUrl&&(p(this,n,"f").bridgeUrl=e.bridgeUrl,await this.destroy(),await this.init())}async attemptMakeApp(){const e=await p(this,s,"m",u).call(this,{action:g.LedgerMakeApp},{timeout:8e3});if("success"in e&&e.success)return!0;throw"error"in e?e.error:new Error("Unknown error occurred")}async updateTransportMethod(e){if(!this.iframeLoaded)throw new Error("The iframe is not loaded yet");const t=await p(this,s,"m",u).call(this,{action:g.LedgerUpdateTransport,params:{transportType:e}},{timeout:8e3});if("success"in t&&t.success)return!0;throw new Error("Ledger transport could not be updated")}async getPublicKey(e){return p(this,s,"m",a).call(this,g.LedgerUnlock,e)}async deviceSignTransaction(e){return p(this,s,"m",a).call(this,g.LedgerSignTransaction,e)}async deviceSignMessage(e){return p(this,s,"m",a).call(this,g.LedgerSignPersonalMessage,e)}async deviceSignTypedData(e){return p(this,s,"m",a).call(this,g.LedgerSignTypedData,e)}},n=new WeakMap,i=new WeakMap,s=new WeakSet,a=async function(...[e,t]){const r=await p(this,s,"m",u).call(this,{action:e,params:t});if("payload"in r&&r.payload){if("success"in r&&r.success)return r.payload;if("error"in r.payload)throw r.payload.error}throw new Error("Unknown error occurred")},o=async function(e){return new Promise(t=>{this.iframe=document.createElement("iframe"),this.iframe.src=e,this.iframe.allow="hid 'src'",this.iframe.onload=async()=>{this.iframeLoaded=!0,t()},document.head.appendChild(this.iframe)})},c=function(e){const t=e.split("/");return t.splice(-1,1),t.join("/")},l=function(e,t){const{origin:r,data:n}=t;if(r===p(this,s,"m",c).call(this,e)&&n){const e=p(this,i,"f").get(n.messageId);e?(e.resolve(n),p(this,i,"f").delete(n.messageId)):n.action===g.LedgerConnectionChange&&(this.isDeviceConnected=n.payload.connected)}},u=async function(e,{timeout:t}={}){this.currentMessageId+=1;const r={...e,messageId:this.currentMessageId,target:"LEDGER-IFRAME"},s=(0,m.createDeferredPromise)();if(p(this,i,"f").set(this.currentMessageId,s),!this.iframeLoaded||!this.iframe?.contentWindow)throw new Error("The iframe is not loaded yet");return t&&setTimeout(()=>{p(this,i,"f").has(r.messageId)&&(p(this,i,"f").delete(r.messageId),s.reject(new Error("Ledger iframe message timeout")))},t),this.iframe.contentWindow.postMessage(r,"*"),s.promise},d=function(e){if("string"!=typeof e.bridgeUrl||0===e.bridgeUrl.length)throw new Error("bridgeURL is not a valid URL")}}}},{package:"@metamask/eth-ledger-bridge-keyring",file:"node_modules/@metamask/eth-ledger-bridge-keyring/dist/ledger-iframe-bridge.cjs"}],[1746,{"./ledger-error-handler.cjs":1743,"@ethereumjs/rlp":578,"@ethereumjs/tx":591,"@ethereumjs/util":605,"@metamask/eth-sig-util":1833,"@metamask/utils":2799,buffer:3760,hdkey:4307},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var s,n,i,a,o,c,l,u,d,p,h,m,g,f,y=this&&this.__classPrivateFieldGet||function(e,t,r,s){if("a"===r&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?s:"a"===r?s.call(e):s?s.value:t.get(e)},w=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.LedgerKeyring=void 0;const v=e("@ethereumjs/rlp"),S=e("@ethereumjs/tx"),b=e("@ethereumjs/util"),k=e("@metamask/eth-sig-util"),E=e("@metamask/utils"),T=e("buffer"),C=w(e("hdkey")),M=e("./ledger-error-handler.cjs"),A="m",I=`${A}/44'/60'/0'`,_="Ledger Hardware";var P;!function(e){e.Ropsten="https://api-ropsten.etherscan.io",e.Kovan="https://api-kovan.etherscan.io",e.Rinkeby="https://api-rinkeby.etherscan.io",e.Mainnet="https://api.etherscan.io"}(P||(P={}));class N{constructor({bridge:e}){if(s.add(this),this.deviceId="",this.type=_,this.page=0,this.perPage=5,this.unlockedAccount=0,this.accounts=[],this.accountDetails={},this.hdk=new C.default,this.hdPath=I,this.paths={},this.network=P.Mainnet,this.implementFullBIP44=!1,!e)throw new Error("Bridge is a required dependency for the keyring");this.bridge=e}async init(){return this.bridge.init()}async destroy(){return this.bridge.destroy()}async serialize(){return{hdPath:this.hdPath,accounts:this.accounts.slice(),deviceId:this.deviceId,accountDetails:this.accountDetails,implementFullBIP44:!1}}async deserialize(e){this.hdPath=e.hdPath??I,this.accounts=e.accounts??[],this.deviceId=e.deviceId??"",this.accountDetails=e.accountDetails??{},e.accountDetails||y(this,s,"m",n).call(this,e),this.implementFullBIP44=e.implementFullBIP44??!1;const t=new Set(Object.keys(this.accountDetails));return this.accounts=this.accounts.filter(e=>t.has(y(this,s,"m",f).call(this,e))),Promise.resolve()}setDeviceId(e){this.deviceId=e}getDeviceId(){return this.deviceId}isUnlocked(){return Boolean(this.hdk.publicKey)}isConnected(){return this.bridge.isDeviceConnected}setAccountToUnlock(e){this.unlockedAccount=e}setHdPath(e){this.hdPath!==e&&(this.hdk=new C.default),this.hdPath=e}async unlock(e,t=!0){if(this.isUnlocked()&&!e)return y(this,s,"m",f).call(this,(0,E.bytesToHex)((0,b.publicToAddress)(this.hdk.publicKey,!0)));const r=e?y(this,s,"m",h).call(this,e):this.hdPath;let n;try{n=await this.bridge.getPublicKey({hdPath:r})}catch(e){(0,M.handleLedgerTransportError)(e,"Ledger: Unknown error while unlocking account")}return t&&n.chainCode&&(this.hdk.publicKey=T.Buffer.from(n.publicKey,"hex"),this.hdk.chainCode=T.Buffer.from(n.chainCode,"hex")),(0,E.add0x)(n.address)}async addAccounts(e){return new Promise((t,r)=>{this.unlock().then(async r=>{const n=this.unlockedAccount,i=n+e,a=[];for(let e=n;e<i;e++){const t=y(this,s,"m",d).call(this,e);let r;r=y(this,s,"m",p).call(this)?await this.unlock(t):y(this,s,"m",l).call(this,A,e),this.accountDetails[y(this,s,"m",f).call(this,r)]={bip44:y(this,s,"m",p).call(this),hdPath:t},this.accounts.includes(r)||(this.accounts=[...this.accounts,r],a.push(r)),this.page=0}t(a)}).catch(r)})}getName(){return _}async getFirstPage(){return this.page=0,y(this,s,"m",a).call(this,1)}async getNextPage(){return y(this,s,"m",a).call(this,1)}async getPreviousPage(){return y(this,s,"m",a).call(this,-1)}async getAccounts(){return Promise.resolve(this.accounts.slice())}removeAccount(e){const t=this.accounts.filter(t=>t.toLowerCase()!==e.toLowerCase());if(t.length===this.accounts.length)throw new Error(`Address ${e} not found in this keyring`);this.accounts=t,delete this.accountDetails[y(this,s,"m",f).call(this,e)]}async attemptMakeApp(){return this.bridge.attemptMakeApp()}async updateTransportMethod(e){return this.bridge.updateTransportMethod(e)}async signTransaction(e,t){let r;if(function(e){return"getChainId"in e&&"function"==typeof e.getChainId}(t))return t.v=t.getChainId(),t.r="0x00",t.s="0x00",r=t.serialize().toString("hex"),y(this,s,"m",i).call(this,e,r,e=>(t.v=T.Buffer.from(e.v,"hex"),t.r=T.Buffer.from(e.r,"hex"),t.s=T.Buffer.from(e.s,"hex"),t));const n=t.getMessageToSign();return r=Array.isArray(n)?T.Buffer.from(v.RLP.encode(n)).toString("hex"):(0,E.bytesToHex)(n),y(this,s,"m",i).call(this,e,r,e=>{const r=t.toJSON();return r.type=t.type,r.v=(0,E.add0x)(e.v),r.r=(0,E.add0x)(e.r),r.s=(0,E.add0x)(e.s),S.TransactionFactory.fromTxData(r,{common:t.common,freeze:Object.isFrozen(t)})})}async signMessage(e,t){return this.signPersonalMessage(e,t)}async signPersonalMessage(e,t){const r=await this.unlockAccountByAddress(e);if(!r)throw new Error("Ledger: Unknown error while signing message");let n;try{n=await this.bridge.deviceSignMessage({hdPath:r,message:(0,E.remove0x)(t)})}catch(e){(0,M.handleLedgerTransportError)(e,"Ledger: Unknown error while signing message")}let i=parseInt(String(n.v),10).toString(16);i.length<2&&(i=`0${i}`);const a=`0x${n.r}${n.s}${i}`,o=(0,k.recoverPersonalSignature)({data:t,signature:a});if(y(this,s,"m",f).call(this,o)!==y(this,s,"m",f).call(this,e))throw new Error("Ledger: The signature doesnt match the right address");return a}async unlockAccountByAddress(e){const t=y(this,s,"m",f).call(this,e),r=this.accountDetails[t];if(!r)throw new Error(`Ledger: Account for address '${t}' not found`);const{hdPath:n}=r;if((await this.unlock(n,!1)).toLowerCase()!==e.toLowerCase())throw new Error(`Ledger: Account ${e} does not belong to the connected device`);return n}async signTypedData(e,t,r){const{version:n}=r??{};if(!("V4"===n))throw new Error("Ledger: Only version 4 of typed data signing is supported");const{domain:i,types:a,primaryType:o,message:c}=k.TypedDataUtils.sanitizeData(t),l=await this.unlockAccountByAddress(e);if(!l)throw new Error("Ledger: Unknown error while signing message");let u;try{u=await this.bridge.deviceSignTypedData({hdPath:l,message:{domain:{name:i.name,chainId:i.chainId,version:i.version,verifyingContract:i.verifyingContract,salt:i.salt instanceof ArrayBuffer?T.Buffer.from(i.salt).toString("hex"):i.salt},types:a,primaryType:o.toString(),message:c}})}catch(e){(0,M.handleLedgerTransportError)(e,"Ledger: Unknown error while signing message")}let d=parseInt(String(u.v),10).toString(16);d.length<2&&(d=`0${d}`);const p=`0x${u.r}${u.s}${d}`,h=(0,k.recoverTypedSignature)({data:t,signature:p,version:k.SignTypedDataVersion.V4});if(y(this,s,"m",f).call(this,h)!==y(this,s,"m",f).call(this,e))throw new Error("Ledger: The signature doesnt match the right address");return p}forgetDevice(){this.deviceId="",this.accounts=[],this.page=0,this.unlockedAccount=0,this.paths={},this.accountDetails={},this.hdk=new C.default}}r.LedgerKeyring=N,s=new WeakSet,n=function(e){if(y(this,s,"m",p).call(this)&&e.accountIndexes)for(const[t,r]of Object.entries(e.accountIndexes))this.accountDetails[t]={bip44:!0,hdPath:y(this,s,"m",d).call(this,r)};const t=new Set(Object.keys(this.accountDetails));y(this,s,"m",p).call(this)||this.accounts.forEach(e=>{const r=y(this,s,"m",f).call(this,e);t.has(r)||(this.accountDetails[r]={bip44:!1,hdPath:y(this,s,"m",u).call(this,e)})})},i=async function(e,t,r){const s=await this.unlockAccountByAddress(e);if(!s)throw new Error("Ledger: hdPath is empty while signing transaction");let n;try{n=await this.bridge.deviceSignTransaction({tx:(0,E.remove0x)(t),hdPath:s})}catch(e){(0,M.handleLedgerTransportError)(e,"Ledger: Unknown error while signing transaction")}const i=r(n);if(i.verifySignature())return i;throw new Error("Ledger: The transaction signature is not valid")},a=async function(e){this.page+=e,this.page<=0&&(this.page=1);const t=(this.page-1)*this.perPage,r=t+this.perPage;let n;return await this.unlock(),n=y(this,s,"m",p).call(this)?await y(this,s,"m",o).call(this,t,r):y(this,s,"m",c).call(this,t,r),n},o=async function(e,t){const r=[];for(let n=e;n<t;n++){const e=y(this,s,"m",d).call(this,n),t=await this.unlock(e),i=!this.implementFullBIP44||await y(this,s,"m",m).call(this,t);if(r.push({address:t,balance:null,index:n}),!i)break}return r},c=function(e,t){const r=[];for(let n=e;n<t;n++){const e=y(this,s,"m",l).call(this,A,n);r.push({address:e,balance:null,index:n}),this.paths[y(this,s,"m",f).call(this,e)]=n}return r},l=function(e,t){const r=this.hdk.derive(`${e}/${t}`),n=(0,E.bytesToHex)((0,b.publicToAddress)(r.publicKey,!0));return y(this,s,"m",f).call(this,n)},u=function(e){const t=y(this,s,"m",f).call(this,e);let r=this.paths[t];if(void 0===r)for(let e=0;e<1e3;e++)if(t===y(this,s,"m",l).call(this,A,e)){r=e;break}if(void 0===r)throw new Error("Unknown address");return y(this,s,"m",d).call(this,r)},d=function(e){return y(this,s,"m",p).call(this)?`m/44'/60'/${e}'/0/0`:`${this.hdPath}/${e}`},p=function(){return"m/44'/60'/0'/0/0"===this.hdPath},h=function(e){return e.toString().replace("m/","")},m=async function(e){const t=y(this,s,"m",g).call(this),r=await window.fetch(`${t}/api?module=account&action=txlist&address=${e}&tag=latest&page=1&offset=1`),n=await r.json();return"0"!==n.status&&n.result.length>0},g=function(){return this.network},f=function(e){return(0,E.getChecksumAddress)((0,E.add0x)(e))},N.type=_}}},{package:"@metamask/eth-ledger-bridge-keyring",file:"node_modules/@metamask/eth-ledger-bridge-keyring/dist/ledger-keyring.cjs"}],[1747,{"./ledger-hw-app.cjs":1744},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var s,n,i,a,o,c=this&&this.__classPrivateFieldSet||function(e,t,r,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(e,r):n?n.value=r:t.set(e,r),r},l=this&&this.__classPrivateFieldGet||function(e,t,r,s){if("a"===r&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?s:"a"===r?s.call(e):s?s.value:t.get(e)};Object.defineProperty(r,"__esModule",{value:!0}),r.LedgerMobileBridge=void 0;e("./ledger-hw-app.cjs");r.LedgerMobileBridge=class{constructor(e,t={}){s.add(this),n.set(this,void 0),i.set(this,void 0),this.isDeviceConnected=!1,c(this,i,t,"f"),c(this,n,e,"f")}async init(){return Promise.resolve()}async destroy(){try{await l(this,s,"m",a).call(this).dispose()}catch(e){console.error(e)}this.isDeviceConnected=!1}async deviceSignMessage({hdPath:e,message:t}){return l(this,s,"m",o).call(this).signPersonalMessage(e,t)}async deviceSignTypedData({hdPath:e,message:t}){return l(this,s,"m",o).call(this).signEIP712Message(e,t)}async deviceSignTransaction({tx:e,hdPath:t}){return l(this,s,"m",o).call(this).clearSignTransaction(t,e,{externalPlugins:!0,erc20:!0,nft:!0})}async getPublicKey({hdPath:e}){return await l(this,s,"m",o).call(this).getAddress(e,!1,!0)}async getOptions(){return l(this,i,"f")}async setOptions(e){c(this,i,e,"f")}async updateTransportMethod(e){if(!e.deviceModel)throw new Error("Property `deviceModel` is not defined in `transport`.");if(!e.deviceModel.id)throw new Error("Property `deviceModel.id` is not defined in `transport`.");return l(this,s,"m",a).call(this).setTransport(e),this.isDeviceConnected=!0,Promise.resolve(!0)}async attemptMakeApp(){throw new Error("Method not supported.")}async openEthApp(){await l(this,s,"m",o).call(this).openEthApp()}async closeApps(){await l(this,s,"m",o).call(this).closeApps()}async getAppNameAndVersion(){return l(this,s,"m",o).call(this).getAppNameAndVersion()}},n=new WeakMap,i=new WeakMap,s=new WeakSet,a=function(){if(l(this,n,"f"))return l(this,n,"f");throw new Error("Instance `transportMiddleware` is not initialized.")},o=function(){return l(this,s,"m",a).call(this).getEthApp()}}}},{package:"@metamask/eth-ledger-bridge-keyring",file:"node_modules/@metamask/eth-ledger-bridge-keyring/dist/ledger-mobile-bridge.cjs"}],[1748,{"./ledger-hw-app.cjs":1744},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var s,n=this&&this.__classPrivateFieldSet||function(e,t,r,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(e,r):n?n.value=r:t.set(e,r),r},i=this&&this.__classPrivateFieldGet||function(e,t,r,s){if("a"===r&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?s:"a"===r?s.call(e):s?s.value:t.get(e)};Object.defineProperty(r,"__esModule",{value:!0}),r.LedgerTransportMiddleware=void 0;const a=e("./ledger-hw-app.cjs");r.LedgerTransportMiddleware=class{constructor(){this.mainAppName="BOLOS",this.ethAppName="Ethereum",this.transportEncoding="ascii",s.set(this,void 0)}async dispose(){const e=this.getTransport();await e.close()}setTransport(e){n(this,s,e,"f")}getTransport(){if(!i(this,s,"f"))throw new Error("Instance `transport` is not initialized.");return i(this,s,"f")}getEthApp(){return new a.MetaMaskLedgerHwAppEth(this.getTransport())}},s=new WeakMap}}},{package:"@metamask/eth-ledger-bridge-keyring",file:"node_modules/@metamask/eth-ledger-bridge-keyring/dist/ledger-transport-middleware.cjs"}],[1749,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.LedgerStatusError=void 0;class s extends Error{constructor(e,t){super(t),this.statusCode=e}}r.LedgerStatusError=s}}},{package:"@metamask/eth-ledger-bridge-keyring",file:"node_modules/@metamask/eth-ledger-bridge-keyring/dist/type.cjs"}],[175,{"webextension-polyfill":5398},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getNotificationImage=async function(){return await n.default.runtime.getURL("../../images/icon-64.png")};var s,n=(s=e("webextension-polyfill"))&&s.__esModule?s:{default:s}}}},{package:"$root$",file:"app/scripts/controllers/push-notifications/get-notification-image.ts"}],[176,{"../../../../shared/lib/translate":5522,"@metamask/notification-services-controller":2240},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createNotificationMessage=function(e){return s.NotificationServicesPushController.Utils.createOnChainPushNotificationMessage(e,a)};var s=e("@metamask/notification-services-controller"),n=e("../../../../shared/lib/translate");const i=(...e)=>(0,n.t)(...e)??"",a={...{pushPlatformNotificationsFundsSentTitle:()=>i("pushPlatformNotificationsFundsSentTitle"),pushPlatformNotificationsFundsSentDescriptionDefault:()=>i("pushPlatformNotificationsFundsSentDescriptionDefault"),pushPlatformNotificationsFundsSentDescription:(e,t)=>i("pushPlatformNotificationsFundsSentDescription",e,t),pushPlatformNotificationsFundsReceivedTitle:()=>i("pushPlatformNotificationsFundsReceivedTitle"),pushPlatformNotificationsFundsReceivedDescriptionDefault:()=>i("pushPlatformNotificationsFundsReceivedDescriptionDefault"),pushPlatformNotificationsFundsReceivedDescription:(e,t)=>i("pushPlatformNotificationsFundsReceivedDescription",e,t),pushPlatformNotificationsSwapCompletedTitle:()=>i("pushPlatformNotificationsSwapCompletedTitle"),pushPlatformNotificationsSwapCompletedDescription:()=>i("pushPlatformNotificationsSwapCompletedDescription"),pushPlatformNotificationsNftSentTitle:()=>i("pushPlatformNotificationsNftSentTitle"),pushPlatformNotificationsNftSentDescription:()=>i("pushPlatformNotificationsNftSentDescription"),pushPlatformNotificationsNftReceivedTitle:()=>i("pushPlatformNotificationsNftReceivedTitle"),pushPlatformNotificationsNftReceivedDescription:()=>i("pushPlatformNotificationsNftReceivedDescription"),pushPlatformNotificationsStakingRocketpoolStakeCompletedTitle:()=>i("pushPlatformNotificationsStakingRocketpoolStakeCompletedTitle"),pushPlatformNotificationsStakingRocketpoolStakeCompletedDescription:()=>i("pushPlatformNotificationsStakingRocketpoolStakeCompletedDescription"),pushPlatformNotificationsStakingRocketpoolUnstakeCompletedTitle:()=>i("pushPlatformNotificationsStakingRocketpoolUnstakeCompletedTitle"),pushPlatformNotificationsStakingRocketpoolUnstakeCompletedDescription:()=>i("pushPlatformNotificationsStakingRocketpoolUnstakeCompletedDescription"),pushPlatformNotificationsStakingLidoStakeCompletedTitle:()=>i("pushPlatformNotificationsStakingLidoStakeCompletedTitle"),pushPlatformNotificationsStakingLidoStakeCompletedDescription:()=>i("pushPlatformNotificationsStakingLidoStakeCompletedDescription"),pushPlatformNotificationsStakingLidoStakeReadyToBeWithdrawnTitle:()=>i("pushPlatformNotificationsStakingLidoStakeReadyToBeWithdrawnTitle"),pushPlatformNotificationsStakingLidoStakeReadyToBeWithdrawnDescription:()=>i("pushPlatformNotificationsStakingLidoStakeReadyToBeWithdrawnDescription"),pushPlatformNotificationsStakingLidoWithdrawalRequestedTitle:()=>i("pushPlatformNotificationsStakingLidoWithdrawalRequestedTitle"),pushPlatformNotificationsStakingLidoWithdrawalRequestedDescription:()=>i("pushPlatformNotificationsStakingLidoWithdrawalRequestedDescription"),pushPlatformNotificationsStakingLidoWithdrawalCompletedTitle:()=>i("pushPlatformNotificationsStakingLidoWithdrawalCompletedTitle"),pushPlatformNotificationsStakingLidoWithdrawalCompletedDescription:()=>i("pushPlatformNotificationsStakingLidoWithdrawalCompletedDescription")},...{PositionLiquidatedTitle:()=>i("pushNotificationPositionLiquidatedTitle"),PositionLiquidatedDescriptionLong:e=>i("pushNotificationPositionLiquidatedDescriptionLong",e),PositionLiquidatedDescriptionShort:e=>i("pushNotificationPositionLiquidatedDescriptionShort",e),StopLossTriggeredTitle:()=>i("pushNotificationStopLossTriggeredTitle"),StopLossTriggeredDescriptionLong:e=>i("pushNotificationStopLossTriggeredDescriptionLong",e),StopLossTriggeredDescriptionShort:e=>i("pushNotificationStopLossTriggeredDescriptionShort",e),TakeProfitTriggeredTitle:()=>i("pushNotificationTakeProfitTriggeredTitle"),TakeProfitTriggeredDescriptionLong:e=>i("pushNotificationTakeProfitTriggeredDescriptionLong",e),TakeProfitTriggeredDescriptionShort:e=>i("pushNotificationTakeProfitTriggeredDescriptionShort",e),LimitOrderFilledTitle:()=>i("pushNotificationLimitOrderFilledTitle"),LimitOrderFilledDescriptionLong:e=>i("pushNotificationLimitOrderFilledDescriptionLong",e),LimitOrderFilledDescriptionShort:e=>i("pushNotificationLimitOrderFilledDescriptionShort",e)}}}}},{package:"$root$",file:"app/scripts/controllers/push-notifications/get-notification-message.ts"}],[177,{"../../platforms/extension":504,"./get-notification-image":175,"./get-notification-message":176},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.onPushNotificationClicked=async function(e,t){var r;e.notification.close();const s=t??(null==e||null===(r=e.notification)||void 0===r?void 0:r.data),n=`${c.getExtensionURL(null,null)}#notifications/${s.id}`;e.waitUntil(o.clients.openWindow(n))},r.onPushNotificationReceived=async function(e){const t=(0,a.createNotificationMessage)(e);if(!t)return;const r=null==o?void 0:o.registration;if(!r)return;const s=await(0,i.getNotificationImage)();await r.showNotification(t.title,{body:t.description,icon:s,tag:null==e?void 0:e.id,data:e})};var s,n=(s=e("../../platforms/extension"))&&s.__esModule?s:{default:s},i=e("./get-notification-image"),a=e("./get-notification-message");const o=self,c=new n.default}}},{package:"$root$",file:"app/scripts/controllers/push-notifications/index.ts"}],[178,{"../../../../shared/constants/common":5418,"../../../../shared/constants/gas":5423,"../../../../shared/constants/metametrics":5430,"../../../../shared/constants/network":5433,"../../../../shared/constants/smartTransactions":5443,"../../../../shared/constants/swaps":5447,"../../../../shared/constants/time":5449,"../../../../shared/lib/fetch-with-cache":5498,"../../../../shared/lib/sentry":5511,"../../../../shared/lib/swaps-utils":5514,"../../../../shared/lib/transactions-controller-utils":5519,"../../../../shared/modules/Numeric":5524,"../../../../shared/modules/conversion.utils":5529,"../../../../shared/modules/string-utils":5551,"../../../../shared/modules/swaps.utils":5552,"./swaps.constants":179,"./swaps.utils":180,"@ethersproject/contracts":654,"@ethersproject/providers":692,"@metamask/base-controller":1222,"bignumber.js":3648,"human-standard-token-abi":4318,lodash:4534},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=e("@ethersproject/contracts"),n=e("@ethersproject/providers"),i=e("@metamask/base-controller"),a=e("bignumber.js"),o=M(e("human-standard-token-abi")),c=e("lodash"),l=e("../../../../shared/lib/sentry"),u=e("../../../../shared/constants/common"),d=e("../../../../shared/constants/gas"),p=e("../../../../shared/constants/metametrics"),h=e("../../../../shared/constants/network"),m=e("../../../../shared/constants/smartTransactions"),g=e("../../../../shared/constants/swaps"),f=e("../../../../shared/constants/time"),y=M(e("../../../../shared/lib/fetch-with-cache")),w=e("../../../../shared/lib/swaps-utils"),v=e("../../../../shared/lib/transactions-controller-utils"),S=e("../../../../shared/modules/conversion.utils"),b=e("../../../../shared/modules/Numeric"),k=e("../../../../shared/modules/string-utils"),E=e("../../../../shared/modules/swaps.utils"),T=e("./swaps.constants"),C=e("./swaps.utils");function M(e){return e&&e.__esModule?e:{default:e}}function A(e,t,r){I(e,t),t.set(e,r)}function I(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function P(e,t){return e.get(O(e,t))}function N(e,t,r){return e.set(O(e,t),r),r}function O(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const j={swapsState:{includeInStateLogs:!0,persist:!1,anonymous:!1,usedInUi:!0}};var R=new WeakMap,D=new WeakMap,L=new WeakMap,B=new WeakMap,x=new WeakMap,F=new WeakMap,U=new WeakSet;class $ extends i.BaseController{constructor(e,t){var r,s,n;super({name:T.controllerName,metadata:j,messenger:e.messenger,state:{swapsState:{...(0,T.getDefaultSwapsControllerState)().swapsState,swapsFeatureFlags:(null==t||null===(r=t.swapsState)||void 0===r?void 0:r.swapsFeatureFlags)||{}}}}),I(s=this,n=U),n.add(s),_(this,"getBufferedGasLimit",void 0),_(this,"resetState",void 0),_(this,"trackMetaMetricsEvent",void 0),A(this,R,void 0),A(this,D,void 0),A(this,L,null),A(this,B,void 0),A(this,x,void 0),A(this,F,void 0),_(this,"_fetchTradesInfo",w.fetchTradesInfo),_(this,"__test__updateState",e=>{this.update(t=>({swapsState:{...t.swapsState,...e.swapsState}}))}),this.messagingSystem.registerActionHandler("SwapsController:fetchAndSetQuotes",this.fetchAndSetQuotes.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:setSelectedQuoteAggId",this.setSelectedQuoteAggId.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:resetSwapsState",this.resetSwapsState.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:setSwapsTokens",this.setSwapsTokens.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:clearSwapsQuotes",this.clearSwapsQuotes.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:setApproveTxId",this.setApproveTxId.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:setTradeTxId",this.setTradeTxId.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:setSwapsTxGasPrice",this.setSwapsTxGasPrice.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:setSwapsTxGasLimit",this.setSwapsTxGasLimit.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:setSwapsTxMaxFeePerGas",this.setSwapsTxMaxFeePerGas.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:setSwapsTxMaxFeePriorityPerGas",this.setSwapsTxMaxFeePriorityPerGas.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:safeRefetchQuotes",this.safeRefetchQuotes.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:stopPollingForQuotes",this.stopPollingForQuotes.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:setBackgroundSwapRouteState",this.setBackgroundSwapRouteState.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:resetPostFetchState",this.resetPostFetchState.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:setSwapsErrorKey",this.setSwapsErrorKey.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:setInitialGasEstimate",this.setInitialGasEstimate.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:setCustomApproveTxData",this.setCustomApproveTxData.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:setSwapsLiveness",this.setSwapsLiveness.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:setSwapsFeatureFlags",this.setSwapsFeatureFlags.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:setSwapsUserFeeLevel",this.setSwapsUserFeeLevel.bind(this)),this.messagingSystem.registerActionHandler("SwapsController:setSwapsQuotesPollingLimitEnabled",this.setSwapsQuotesPollingLimitEnabled.bind(this)),this.getBufferedGasLimit=e.getBufferedGasLimit,this.trackMetaMetricsEvent=e.trackMetaMetricsEvent,this.resetState=()=>{this.update(e=>{e.swapsState={...(0,T.getDefaultSwapsControllerState)().swapsState,swapsFeatureFlags:null==e?void 0:e.swapsState.swapsFeatureFlags}})},N(B,this,e.getEIP1559GasFeeEstimates),N(x,this,e.getLayer1GasFee),N(R,this,0),N(D,this,0),this._fetchTradesInfo=e.fetchTradesInfo||w.fetchTradesInfo}clearSwapsQuotes(){this.update(e=>{e.swapsState.quotes={},e.swapsState.selectedAggId=null,e.swapsState.topAggId=null})}async fetchAndSetQuotes(e,t,r=!1){var s;if(!e)return null;let n;n=(null===(s=P(F,this))||void 0===s?void 0:s.clientId)===t.networkClientId?P(F,this):O(U,this,H).call(this,t.networkClientId);const{quotesPollingLimitEnabled:i,saveFetchedQuotes:a}=this.state.swapsState;r||N(D,this,0),P(L,this)&&clearTimeout(P(L,this)),r||this.setSwapsErrorKey("");const o=P(R,this)+1;N(R,this,o),a||this._setSaveFetchedQuotes(!0);let[l]=await Promise.all([this._fetchTradesInfo(e,{chainId:n.chainId}),this._setSwapsNetworkConfig(n)]);const{saveFetchedQuotes:u}=this.state.swapsState;if(!u)return[{},null];l=(0,c.mapValues)(l,e=>({...e,sourceTokenInfo:null==t?void 0:t.sourceTokenInfo,destinationTokenInfo:null==t?void 0:t.destinationTokenInfo}));const d=n.chainId===h.CHAIN_IDS.OPTIMISM.toString(),p=n.chainId===h.CHAIN_IDS.BASE.toString();(d||p)&&Object.values(l).length>0&&await Promise.all(Object.values(l).map(async e=>{if(e.trade){const t=await P(x,this).call(this,{transactionParams:e.trade,networkClientId:n.clientId});e.multiLayerL1TradeFeeTotal=t}return e}));const m=Date.now();let f=!1;if(!(0,E.isSwapsDefaultTokenAddress)(e.sourceToken,n.chainId)&&Object.values(l).length){const t=await this._getERC20Allowance(e.sourceToken,e.fromAddress,n),[s]=Object.values(l);if(f=s.approvalNeeded&&(t.eq(0)||t.lt(s.sourceAmount))&&"wrappedNative"!==s.aggregator,f){if(!r&&s.approvalNeeded){const{gasLimit:e}=await this._timedoutGasReturn(s.approvalNeeded,s.aggregator);l=(0,c.mapValues)(l,t=>t.approvalNeeded?{...t,approvalNeeded:{...t.approvalNeeded,gas:e||g.DEFAULT_ERC20_APPROVE_GAS}}:t)}}else l=(0,c.mapValues)(l,e=>({...e,approvalNeeded:null}))}let y=null;if(f||null!=e&&e.balanceError||(l=await this._getAllQuotesWithGasEstimates(l)),0===Object.values(l).length)this.setSwapsErrorKey(g.QUOTES_NOT_AVAILABLE_ERROR);else{const e=await this.getTopQuoteWithCalculatedSavings({quotes:l});Array.isArray(e)&&(y=e[0],l=e[1])}if(P(R,this)!==o)throw new Error(g.SWAPS_FETCH_ORDER_CONFLICT);let{selectedAggId:w}=this.state.swapsState;return w&&l[w]||(w=null),this.update(r=>{r.swapsState.quotes=l,r.swapsState.fetchParams={...e,metaData:t},r.swapsState.quotesLastFetched=m,r.swapsState.selectedAggId=w,r.swapsState.topAggId=y}),i&&N(D,this,P(D,this)+1),!i||P(D,this)<T.POLL_COUNT_LIMIT+1?(this._pollForNewQuotes(),[l,y]):(this.resetPostFetchState(),this.setSwapsErrorKey(g.QUOTES_EXPIRED_ERROR),null)}async getTopQuoteWithCalculatedSavings({quotes:e,networkClientId:t}){var r;let s;if(t){const e=this.messagingSystem.call("NetworkController:getNetworkClientById",t);s=e.configuration.chainId}else{if(P(F,this)===undefined)throw new Error("There is no network set");s=P(F,this).chainId}const{marketData:n}=this._getTokenRatesState(),i=(null==n?void 0:n[s])??{},{customGasPrice:o,customMaxPriorityFeePerGas:l}=this.state.swapsState;if(0===Object.keys(e).length)return{};const p=(0,c.cloneDeep)(e),{gasFeeEstimates:h,gasEstimateType:m}=await P(B,this).call(this,{networkClientId:t});let g="0x0";if(m===d.GasEstimateTypes.feeMarket){const{high:{suggestedMaxPriorityFeePerGas:e},estimatedBaseFee:t}=h,r=(0,S.decGWEIToHexWEI)(Number(e)),s=new b.Numeric(t,10,u.EtherDenomination.GWEI).toDenomination(u.EtherDenomination.WEI);g=new b.Numeric(l||r,16).add(s).round(6).toString()}else m===d.GasEstimateTypes.legacy?g=o||(0,S.decGWEIToHexWEI)(Number(h.high)):m===d.GasEstimateTypes.ethGasPrice&&(g=o||(0,S.decGWEIToHexWEI)(Number(h.gasPrice)));let f,y="";Object.values(p).forEach(e=>{const{aggregator:t,approvalNeeded:r,averageGas:n,destinationAmount:o,destinationToken:c,destinationTokenInfo:l,gasEstimateWithRefund:d,sourceAmount:p,sourceToken:h,trade:m,fee:w,multiLayerL1TradeFeeTotal:C}=e;if(!m||!c)return;const M=(d?new a.BigNumber(d,16):new a.BigNumber(n||T.MAX_GAS_LIMIT,10)).plus((null==r?void 0:r.gas)||"0x0",16).toString(16);let A=(0,v.calcGasTotal)(M,g);null!==C&&(A=(0,S.sumHexes)(A||"0x0",C||"0x0"));const I=new b.Numeric(A,16,u.EtherDenomination.WEI).add(new b.Numeric(m.value,16,u.EtherDenomination.WEI)),_=I.toDenomination(u.EtherDenomination.ETH).round(6).value,P=(0,E.isSwapsDefaultTokenAddress)(h,s)?I.minus(new b.Numeric(p,10)).toDenomination(u.EtherDenomination.ETH).round(6).value:_,N=(0,v.calcTokenAmount)(o??"0",l.decimals),O=new a.BigNumber(100,10).minus(w,10).div(100),j=N.div(O).minus(N),R=Object.keys(i).find(e=>(0,k.isEqualCaseInsensitive)(e,c)),D=R?i[R]:null,L=(null==D?void 0:D.price)||1,B=N.times(L.toString(10),10),x=(0,E.isSwapsDefaultTokenAddress)(c,s)?1:null==D?void 0:D.price,F=x?B.minus(P,10):B;e.ethFee=P.toString(10),x&&(e.ethValueOfTokens=B.toString(10),e.overallValueOfQuote=F.toString(10),e.metaMaskFeeInEth=j.times(x.toString(10)).toString(10)),f&&!F.gt(f||0)||(y=t,f=F)});const w=Object.keys(i).find(e=>{var t;return(0,k.isEqualCaseInsensitive)(e,null===(t=p[y])||void 0===t?void 0:t.destinationToken)}),M=w?i[w]:null;if((0,E.isSwapsDefaultTokenAddress)(null===(r=p[y])||void 0===r?void 0:r.destinationToken,s)||Boolean(null==M?void 0:M.price)){const e=p[y],{ethFee:t,metaMaskFeeInEth:r,ethValueOfTokens:s}=(0,C.getMedianEthValueQuote)(Object.values(p)),n=new a.BigNumber(e.ethValueOfTokens,10).minus(s,10).toString(10),i=new a.BigNumber(t).minus(e.ethFee,10).toString(10),o=e.metaMaskFeeInEth,c={performance:n,fee:i,total:new a.BigNumber(n).plus(i).minus(o).toString(10),metaMaskFee:o,medianMetaMaskFee:r};p[y].isBestQuote=!0,p[y].savings=c}return[y,p]}resetPostFetchState(){this.update(e=>{e.swapsState={...(0,T.getDefaultSwapsControllerState)().swapsState,tokens:e.swapsState.tokens,fetchParams:e.swapsState.fetchParams,swapsFeatureIsLive:e.swapsState.swapsFeatureIsLive,swapsQuoteRefreshTime:e.swapsState.swapsQuoteRefreshTime,swapsQuotePrefetchingRefreshTime:e.swapsState.swapsQuotePrefetchingRefreshTime,swapsFeatureFlags:e.swapsState.swapsFeatureFlags}}),P(L,this)&&clearTimeout(P(L,this))}resetSwapsState(){this.update(e=>{e.swapsState={...(0,T.getDefaultSwapsControllerState)().swapsState,swapsQuoteRefreshTime:e.swapsState.swapsQuoteRefreshTime,swapsQuotePrefetchingRefreshTime:e.swapsState.swapsQuotePrefetchingRefreshTime,swapsFeatureFlags:e.swapsState.swapsFeatureFlags}}),P(L,this)&&clearTimeout(P(L,this))}safeRefetchQuotes(){!P(L,this)&&this.state.swapsState.fetchParams&&this.fetchAndSetQuotes(this.state.swapsState.fetchParams,{...this.state.swapsState.fetchParams.metaData})}setApproveTxId(e){this.update(t=>{t.swapsState.approveTxId=e})}setBackgroundSwapRouteState(e){this.update(t=>{t.swapsState.routeState=e})}setCustomApproveTxData(e){this.update(t=>{t.swapsState.customApproveTxData=e})}async setInitialGasEstimate(e){const t={...this.state.swapsState.quotes[e]},{gasLimit:r,simulationFails:s}=t.trade?await this._timedoutGasReturn(t.trade,t.aggregator):{gasLimit:null,simulationFails:!0};if(r&&!s){const e=(0,C.calculateGasEstimateWithRefund)(t.maxGas,t.estimatedRefund,r);t.gasEstimate=r,t.gasEstimateWithRefund=e}this.update(r=>{r.swapsState.quotes={...r.swapsState.quotes,[e]:t}})}setSelectedQuoteAggId(e){this.update(t=>{t.swapsState.selectedAggId=e})}setSwapsFeatureFlags(e){this.update(t=>{t.swapsState.swapsFeatureFlags=e})}setSwapsErrorKey(e){this.update(t=>{t.swapsState.errorKey=e})}setSwapsLiveness(e){const{swapsFeatureIsLive:t}=e;this.update(e=>{e.swapsState.swapsFeatureIsLive=t})}setSwapsQuotesPollingLimitEnabled(e){this.update(t=>{t.swapsState.quotesPollingLimitEnabled=e})}setSwapsTokens(e){this.update(t=>{t.swapsState.tokens=e})}setSwapsTxGasLimit(e){this.update(t=>{t.swapsState.customMaxGas=e})}setSwapsTxGasPrice(e){this.update(t=>{t.swapsState.customGasPrice=e})}setSwapsTxMaxFeePerGas(e){this.update(t=>{t.swapsState.customMaxFeePerGas=e})}setSwapsTxMaxFeePriorityPerGas(e){this.update(t=>{t.swapsState.customMaxPriorityFeePerGas=e})}setSwapsUserFeeLevel(e){this.update(t=>{t.swapsState.swapsUserFeeLevel=e})}setTradeTxId(e){this.update(t=>{t.swapsState.tradeTxId=e})}stopPollingForQuotes(){P(L,this)&&clearTimeout(P(L,this))}async _fetchSwapsNetworkConfig(e){const t=await(0,y.default)({url:(0,w.getBaseApi)("network",e.chainId),fetchOptions:{method:"GET"},cacheOptions:{cacheRefreshTime:6e5},functionName:"_fetchSwapsNetworkConfig"}),{refreshRates:r,parameters:s={}}=t||{};if(!r||"number"!=typeof r.quotes||"number"!=typeof r.quotesPrefetching)throw new Error(`MetaMask - invalid response for refreshRates: ${t}`);return{quotes:1e3*r.quotes,quotesPrefetching:1e3*r.quotesPrefetching,stxGetTransactions:1e3*r.stxGetTransactions,stxBatchStatus:1e3*r.stxBatchStatus,stxStatusDeadline:r.stxStatusDeadline,stxMaxFeeMultiplier:s.stxMaxFeeMultiplier}}async _getAllQuotesWithGasEstimates(e){const t=await Promise.all(Object.values(e).map(async e=>{if(!e.trade)return{gasLimit:null,simulationFails:!0,aggId:e.aggregator};const{gasLimit:t,simulationFails:r}=await this._timedoutGasReturn(e.trade,e.aggregator);return{gasLimit:t,simulationFails:r,aggId:e.aggregator}})),r={};return t.forEach(({gasLimit:t,simulationFails:s,aggId:n})=>{if(t&&!s){const s=(0,C.calculateGasEstimateWithRefund)(e[n].maxGas,e[n].estimatedRefund,t);r[n]={...e[n],gasEstimate:t,gasEstimateWithRefund:s}}else e[n].approvalNeeded&&(r[n]=e[n])}),r}async _getERC20Allowance(e,t,r){const n=new s.Contract(e,o.default,r.ethersProvider);return await n.allowance(t,g.SWAPS_CHAINID_CONTRACT_ADDRESS_MAP[r.chainId])}_getTokenRatesState(){const{marketData:e}=this.messagingSystem.call("TokenRatesController:getState");return{marketData:e}}_pollForNewQuotes(){const{swapsQuoteRefreshTime:e,swapsQuotePrefetchingRefreshTime:t,quotesPollingLimitEnabled:r}=this.state.swapsState;N(L,this,setTimeout(()=>{var e;this.fetchAndSetQuotes(this.state.swapsState.fetchParams,null===(e=this.state.swapsState.fetchParams)||void 0===e?void 0:e.metaData,!0)},r?e:t))}_setSaveFetchedQuotes(e){this.update(t=>{t.swapsState.saveFetchedQuotes=e})}async _setSwapsNetworkConfig(e){let t=null;try{t=await this._fetchSwapsNetworkConfig(e)}catch(e){console.error("Request for Swaps network config failed: ",e)}this.update(e=>{var r,s,n,i,a,o;e.swapsState.swapsQuoteRefreshTime=(null===(r=t)||void 0===r?void 0:r.quotes)||T.FALLBACK_QUOTE_REFRESH_TIME,e.swapsState.swapsQuotePrefetchingRefreshTime=(null===(s=t)||void 0===s?void 0:s.quotesPrefetching)||T.FALLBACK_QUOTE_REFRESH_TIME,e.swapsState.swapsStxGetTransactionsRefreshTime=(null===(n=t)||void 0===n?void 0:n.stxGetTransactions)||m.FALLBACK_SMART_TRANSACTIONS_REFRESH_TIME,e.swapsState.swapsStxBatchStatusRefreshTime=(null===(i=t)||void 0===i?void 0:i.stxBatchStatus)||m.FALLBACK_SMART_TRANSACTIONS_REFRESH_TIME,e.swapsState.swapsStxMaxFeeMultiplier=(null===(a=t)||void 0===a?void 0:a.stxMaxFeeMultiplier)||m.FALLBACK_SMART_TRANSACTIONS_MAX_FEE_MULTIPLIER,e.swapsState.swapsStxStatusDeadline=(null===(o=t)||void 0===o?void 0:o.stxStatusDeadline)||m.FALLBACK_SMART_TRANSACTIONS_DEADLINE})}_timedoutGasReturn(e,t=""){return new Promise(r=>{let s=!1;const n=setTimeout(()=>{s=!0,this.trackMetaMetricsEvent({event:p.MetaMetricsEventName.QuoteError,category:p.MetaMetricsEventCategory.Swaps,properties:{error_type:p.MetaMetricsEventErrorType.GasTimeout,aggregator:t}}),r({gasLimit:null,simulationFails:!0})},5*f.SECOND),i={data:e.data,from:e.from,to:e.to,value:e.value};this.getBufferedGasLimit({txParams:i},1).then(({gasLimit:e,simulationFails:t})=>{s||(clearTimeout(n),r({gasLimit:e,simulationFails:t}))}).catch(e=>{(0,l.captureException)(e,{extra:{aggregator:t}}),s||(clearTimeout(n),r({gasLimit:null,simulationFails:!0}))})})}}function H(e){const t=this.messagingSystem.call("NetworkController:getNetworkClientById",e),{chainId:r}=t.configuration,s={client:t,clientId:e,chainId:r,ethersProvider:new n.Web3Provider(t.provider)};return N(F,this,s),s}r.default=$}}},{package:"$root$",file:"app/scripts/controllers/swaps/index.ts"}],[179,{"../../../../shared/constants/smartTransactions":5443,"../../../../shared/constants/time":5449},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.controllerName=r.POLL_COUNT_LIMIT=r.MAX_GAS_LIMIT=r.FALLBACK_QUOTE_REFRESH_TIME=void 0,r.getDefaultSwapsControllerState=function(){return{swapsState:{quotes:{},quotesPollingLimitEnabled:!1,fetchParams:null,tokens:null,tradeTxId:null,approveTxId:null,quotesLastFetched:null,customMaxGas:"",customGasPrice:null,customMaxFeePerGas:null,customMaxPriorityFeePerGas:null,swapsUserFeeLevel:"",selectedAggId:null,customApproveTxData:"",errorKey:"",topAggId:null,routeState:"",swapsFeatureIsLive:!0,saveFetchedQuotes:!1,swapsQuoteRefreshTime:i,swapsQuotePrefetchingRefreshTime:i,swapsStxBatchStatusRefreshTime:s.FALLBACK_SMART_TRANSACTIONS_REFRESH_TIME,swapsStxStatusDeadline:s.FALLBACK_SMART_TRANSACTIONS_DEADLINE,swapsStxGetTransactionsRefreshTime:s.FALLBACK_SMART_TRANSACTIONS_REFRESH_TIME,swapsStxMaxFeeMultiplier:s.FALLBACK_SMART_TRANSACTIONS_MAX_FEE_MULTIPLIER,swapsFeatureFlags:{}}}};var s=e("../../../../shared/constants/smartTransactions"),n=e("../../../../shared/constants/time");r.controllerName="SwapsController",r.MAX_GAS_LIMIT=25e5,r.POLL_COUNT_LIMIT=3;const i=r.FALLBACK_QUOTE_REFRESH_TIME=n.MINUTE}}},{package:"$root$",file:"app/scripts/controllers/swaps/swaps.constants.ts"}],[18,{"../../../../shared/constants/metametrics":5430,"@metamask/assets-controllers":1157,"@metamask/bridge-controller":1229},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.NftControllerInit=void 0;var s=e("@metamask/assets-controllers"),n=e("@metamask/bridge-controller"),i=e("../../../../shared/constants/metametrics");r.NftControllerInit=({controllerMessenger:e,initMessenger:t,persistedState:r})=>({controller:new s.NftController({state:r.NftController,messenger:e,onNftAdded:({address:e,symbol:r,tokenId:s,standard:a,source:o})=>t.call("MetaMetricsController:trackEvent",{event:i.MetaMetricsEventName.NftAdded,category:i.MetaMetricsEventCategory.Wallet,sensitiveProperties:{token_contract_address:e,token_symbol:r??null,token_id:s,token_standard:a,asset_type:n.AssetType.NFT,source:o}})})})}}},{package:"$root$",file:"app/scripts/controller-init/assets/nft-controller-init.ts"}],[180,{"./swaps.constants":179,"bignumber.js":3648},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.calculateGasEstimateWithRefund=function(e=n.MAX_GAS_LIMIT,t="0",r="0"){const i=new s.BigNumber(e,10).minus(t,10),a=i.lt(0);return!a&&i.lt(r,16)?`0x${i.toString(16)}`:r},r.getMedianEthValueQuote=function(e){if(!Array.isArray(e)||0===e.length)throw new Error("Expected non-empty array param.");const t=[...e];if(t.sort((e,t)=>{const r=new s.BigNumber(e.overallValueOfQuote,10),n=new s.BigNumber(t.overallValueOfQuote,10);return r.equals(n)?0:r.lessThan(n)?-1:1}),t.length%2==1){const e=t[(t.length-1)/2].overallValueOfQuote;return i(t.filter(t=>e===t.overallValueOfQuote))}const r=t.length/2,n=r-1,a=t[r].overallValueOfQuote,o=t[n].overallValueOfQuote,c=t.filter(e=>a===e.overallValueOfQuote),l=t.filter(e=>o===e.overallValueOfQuote),u=i(c),d=i(l);return{ethFee:new s.BigNumber(u.ethFee,10).plus(d.ethFee,10).dividedBy(2).toString(10),metaMaskFeeInEth:new s.BigNumber(u.metaMaskFeeInEth,10).plus(d.metaMaskFeeInEth,10).dividedBy(2).toString(10),ethValueOfTokens:new s.BigNumber(u.ethValueOfTokens,10).plus(d.ethValueOfTokens,10).dividedBy(2).toString(10)}},r.meansOfQuotesFeesAndValue=i;var s=e("bignumber.js"),n=e("./swaps.constants");function i(e){const t=e.reduce((e,t)=>({ethFee:e.ethFee.plus(t.ethFee,10),metaMaskFeeInEth:e.metaMaskFeeInEth.plus(t.metaMaskFeeInEth,10),ethValueOfTokens:e.ethValueOfTokens.plus(t.ethValueOfTokens,10)}),{ethFee:new s.BigNumber(0,10),metaMaskFeeInEth:new s.BigNumber(0,10),ethValueOfTokens:new s.BigNumber(0,10)});return{ethFee:t.ethFee.div(e.length,10).toString(10),metaMaskFeeInEth:t.metaMaskFeeInEth.div(e.length,10).toString(10),ethValueOfTokens:t.ethValueOfTokens.div(e.length,10).toString(10)}}}}},{package:"$root$",file:"app/scripts/controllers/swaps/swaps.utils.ts"}],[181,{"../../shared/constants/app":5415,"./lib/util":290,"webextension-polyfill":5398},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.onMessageReceived=r.checkForMultipleVersionsRunning=void 0;var s,n=(s=e("webextension-polyfill"))&&s.__esModule?s:{default:s},i=e("../../shared/constants/app"),a=e("./lib/util");const o="isRunning";r.onMessageReceived=e=>{e===o&&console.warn("Warning! You have multiple instances of MetaMask running!")};r.checkForMultipleVersionsRunning=async()=>{if((0,a.getPlatform)()!==i.PLATFORM_CHROME&&(0,a.getPlatform)()!==i.PLATFORM_FIREFOX)return;const e=(0,a.getPlatform)()===i.PLATFORM_CHROME?i.CHROME_BUILD_IDS:i.FIREFOX_BUILD_IDS,t=n.default.runtime.id;for(const r of e)if(r!==t)try{await n.default.runtime.sendMessage(r,o)}catch(e){}}}}},{package:"$root$",file:"app/scripts/detect-multiple-instances.js"}],[182,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default={config:{}}}}},{package:"$root$",file:"app/scripts/first-time-state.js"}],[183,{"@metamask/name-controller":2156},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.ChangeType=r.AbstractPetnamesBridge=void 0;var s=e("@metamask/name-controller");function n(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t,r){a(e,t),t.set(e,r)}function a(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function o(e,t){return e.get(l(e,t))}function c(e,t,r){return e.set(l(e,t),r),r}function l(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}let u=r.ChangeType=function(e){return e.ADDED="ADDED",e.UPDATED="UPDATED",e.DELETED="DELETED",e}({});var d=function(e){return e.SOURCE_TO_PETNAMES="Source->Petnames",e.PETNAMES_TO_SOURCE="Petnames->Source",e}(d||{});function p({type:e,variation:t,value:r}){return`${e}/${t}/${e===s.NameType.ETHEREUM_ADDRESS?r.toLowerCase():r}`}var h=new WeakMap,m=new WeakMap,g=new WeakMap,f=new WeakSet;function y(e){if(o(g,this)===e)throw new Error(`Attempted to synchronize recursively in same direction: ${e}`);if(null!==o(g,this))return;c(g,this,e);const[t,r]="Source->Petnames"===e?[this.getSourceEntries(),l(f,this,w).call(this)]:[l(f,this,w).call(this),this.getSourceEntries()],s=l(f,this,S).call(this,r,t);l(f,this,b).call(this,s),c(g,this,null)}function w(){const{names:e}=o(m,this).state,t=[];for(const r of Object.values(s.NameType))for(const s of Object.keys(e[r]))for(const n of Object.keys(e[r][s])){const{name:i,sourceId:a,origin:o}=e[r][s][n];if(!i)continue;const c={value:s,type:r,name:i,variation:n,sourceId:a??undefined,origin:o??undefined};this.shouldSyncPetname(c)&&t.push(c)}return t}function v(e,t){e===u.DELETED?(delete t.sourceId,delete t.origin,o(m,this).setName({...t,name:null})):o(m,this).setName(t)}function S(e,t){const r=[],s=[],n=[],i=new Map(e.map(e=>[p(e),e])),a=new Map(t.map(e=>[p(e),e]));return a.forEach((e,t)=>{const n=i.get(t);n?e.name!==n.name&&s.push(e):r.push(e)}),i.forEach((e,t)=>{a.has(t)||n.push(e)}),{[u.ADDED]:r,[u.UPDATED]:s,[u.DELETED]:n}}function b(e){const t=o(g,this)===d.SOURCE_TO_PETNAMES?l(f,this,v).bind(this):this.updateSourceEntry.bind(this);for(const r of Object.values(u))for(const s of e[r])t(r,s)}r.AbstractPetnamesBridge=class{constructor({isTwoWay:e,nameController:t,messenger:r}){var s,o;a(s=this,o=f),o.add(s),i(this,h,void 0),i(this,m,void 0),i(this,g,null),n(this,"messenger",void 0),c(h,this,e),c(m,this,t),this.messenger=r}init(){o(h,this)&&this.messenger.subscribe("NameController:stateChange",()=>l(f,this,y).call(this,d.PETNAMES_TO_SOURCE)),this.onSourceChange(()=>l(f,this,y).call(this,d.SOURCE_TO_PETNAMES))}updateSourceEntry(e,t){throw new Error("updateSourceEntry must be overridden for two-way bridges")}shouldSyncPetname(e){return!0}}}}},{package:"$root$",file:"app/scripts/lib/AbstractPetnamesBridge.ts"}],[184,{"./AbstractPetnamesBridge":183,"@metamask/name-controller":2156},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.AccountIdentitiesPetnamesBridge=void 0;var s=e("@metamask/name-controller"),n=e("./AbstractPetnamesBridge");class i extends n.AbstractPetnamesBridge{constructor({nameController:e,messenger:t}){super({isTwoWay:!1,nameController:e,messenger:t})}getSourceEntries(){return this.messenger.call("AccountsController:listAccounts").map(e=>({value:e.address,type:s.NameType.ETHEREUM_ADDRESS,name:e.metadata.name,sourceId:undefined,variation:s.FALLBACK_VARIATION,origin:s.NameOrigin.ACCOUNT_IDENTITY}))}onSourceChange(e){this.messenger.subscribe("AccountsController:stateChange",e)}shouldSyncPetname(e){return e.origin===s.NameOrigin.ACCOUNT_IDENTITY}}r.AccountIdentitiesPetnamesBridge=i}}},{package:"$root$",file:"app/scripts/lib/AccountIdentitiesPetnamesBridge.ts"}],[185,{"./AbstractPetnamesBridge":183,"@metamask/name-controller":2156,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.AddressBookPetnamesBridge=void 0;var s=e("@metamask/name-controller"),n=e("@metamask/utils"),i=e("./AbstractPetnamesBridge");function a(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function o(e,t){return e.get(c(e,t))}function c(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var l=new WeakMap;class u extends i.AbstractPetnamesBridge{constructor({addressBookController:e,nameController:t,messenger:r}){var s,n,i;super({isTwoWay:!0,nameController:t,messenger:r}),a(this,l,void 0),n=this,i=e,(s=l).set(c(s,n),i)}getSourceEntries(){const e=[],{state:t}=o(l,this);for(const r of Object.keys(t.addressBook)){if(!(0,n.isStrictHexString)(r))continue;const i=t.addressBook[r];for(const n of Object.keys(i)){const i=t.addressBook[r][n],a=r.toLowerCase(),{name:o,isEns:c}=i;null!=o&&o.length&&null!=n&&n.length&&e.push({value:n,name:o,variation:a,type:s.NameType.ETHEREUM_ADDRESS,sourceId:c?"ens":undefined,origin:s.NameOrigin.ADDRESS_BOOK})}}return e}updateSourceEntry(e,t){e===i.ChangeType.DELETED?o(l,this).delete(t.variation,t.value):o(l,this).set(t.value,t.name,t.variation)}onSourceChange(e){this.messenger.subscribe("AddressBookController:stateChange",e)}}r.AddressBookPetnamesBridge=u}}},{package:"$root$",file:"app/scripts/lib/AddressBookPetnamesBridge.ts"}],[186,{"@metamask/base-controller":1222,"@metamask/obs-store":2253},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=e("@metamask/obs-store"),n=e("@metamask/base-controller");function i(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function a(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var c=new WeakSet;class l extends s.ObservableStore{constructor({config:e,controllerMessenger:t,state:r,persist:s}){super(r),i(this,c),a(this,"config",{}),this.persist=s,this.controllerMessenger=t,e&&this.updateStructure(e)}updateStructure(e){this.config=e,this.removeAllListeners();const t={};for(const s of Object.keys(e)){var r;if(!e[s])throw new Error(`Undefined '${s}'`);const i=e[s];i.subscribe?e[s].subscribe(e=>{o(c,this,u).call(this,s,e)}):this.persist?this.controllerMessenger.subscribe(`${i.name}:stateChange`,(t,r)=>{o(c,this,d).call(this,e[s].metadata,r)&&o(c,this,u).call(this,s,(0,n.getPersistentState)(t,e[s].metadata))}):this.controllerMessenger.subscribe(`${i.name}:stateChange`,e=>o(c,this,u).call(this,s,e));const a=i.state??(null===(r=i.getState)||void 0===r?void 0:r.call(i));t[s]=this.persist&&e[s].metadata?(0,n.getPersistentState)(a,e[s].metadata):a}this.updateState(t)}getFlatState(){if(!this.config)return{};let e={};for(const t of Object.keys(this.config)){const r=this.config[t],s=r.getState?r.getState():r.state;e={...e,...s}}return e}}function u(e,t){const r=this.getState()[e];this.updateState({[e]:t}),this.emit("stateChange",{oldState:r,newState:t,controllerKey:e})}function d(e,t){return t.some(t=>{if(0===t.path.length)return!0;const r=t.path[0];return!e[r]||e[r].persist})}r.default=l}}},{package:"$root$",file:"app/scripts/lib/ComposableObservableStore.js"}],[187,{"webextension-polyfill":5398},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.CronjobControllerStorageManager=r.CronjobControllerStorageKey=void 0;var s,n=(s=e("webextension-polyfill"))&&s.__esModule?s:{default:s};function i(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function a(e,t){return e.get(c(e,t))}function o(e,t,r){return e.set(c(e,t),r),r}function c(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const l=r.CronjobControllerStorageKey="temp-cronjob-storage";var u=new WeakMap,d=new WeakMap;r.CronjobControllerStorageManager=class{constructor(){i(this,u,null),i(this,d,!1)}async init(){o(u,this,(await n.default.storage.local.get(l))[l]),o(d,this,!0)}getInitialState(){if(!a(d,this))throw new Error("CronjobControllerStorageManager not yet initialized");return a(u,this)}set(e){if(!a(d,this))throw new Error("CronjobControllerStorageManager not yet initialized");n.default.storage.local.set({[l]:e}).catch(console.error)}}}}},{package:"$root$",file:"app/scripts/lib/CronjobControllerStorageManager.ts"}],[188,{"./state-utils":266,"@metamask/utils":2799,uuid:5366},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.PatchStore=void 0;var s=e("@metamask/utils"),n=e("uuid"),i=e("./state-utils");function a(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const o=(0,s.createProjectLogger)("patch-store");r.PatchStore=class{constructor(e){a(this,"id",void 0),a(this,"observableStore",void 0),a(this,"pendingPatches",new Map),a(this,"listener",void 0),this.id=(0,n.v4)(),this.observableStore=e,this.listener=this._onStateChange.bind(this),this.observableStore.on("stateChange",this.listener),o("Created",this.id)}flushPendingPatches(){const e=[...this.pendingPatches.values()];this.pendingPatches.clear();for(const t of e)o("Flushed",t.path.join("."),this.id,t);return e}destroy(){this.observableStore.removeListener("stateChange",this.listener),o("Destroyed",this.id)}_onStateChange({oldState:e,newState:t}){const r=(0,i.sanitizeUIState)(t),s=this._generatePatches(e,r),n=Boolean(t.vault);if(n&&s.push({op:"replace",path:["isInitialized"],value:n}),s.length)for(const e of s){const t=e.path.join(".");this.pendingPatches.set(t,e),o("Updated",t,this.id,e)}}_generatePatches(e,t){return Object.keys(t).map(r=>{const s=e[r],n=t[r];return s===n?null:{op:"replace",path:[r],value:n}}).filter(Boolean)}}}}},{package:"$root$",file:"app/scripts/lib/PatchStore.ts"}],[189,{"@metamask/name-controller":2156,"@metamask/snaps-rpc-methods":2507,"@metamask/snaps-utils":2677,loglevel:4542},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.SnapsNameProvider=void 0;var s,n=e("@metamask/name-controller"),i=e("@metamask/snaps-utils"),a=(s=e("loglevel"))&&s.__esModule?s:{default:s},o=e("@metamask/snaps-rpc-methods");function c(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function l(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u(e,t){return e.get(d(e,t))}function d(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var p=new WeakMap,h=new WeakSet;function m(e){const t=u(p,this).call("PermissionController:getState").subjects;return u(p,this).call("SnapController:getAll").filter(({id:r})=>{var s;const n=null===(s=t[r])||void 0===s?void 0:s.permissions["endowment:name-lookup"];if(!n)return!1;const i=(0,o.getChainIdsCaveat)(n);return!(e&&i&&!i.includes(e))})}async function g(e,t,r){const s=e,n={chainId:t,address:r};let o,c;try{const t=await u(p,this).call("SnapController:handleRequest",{snapId:e,origin:"metamask",handler:i.HandlerType.OnNameLookup,request:{jsonrpc:"2.0",method:" ",params:n}}),r=null==t?void 0:t.resolvedDomains;o=r?[...new Set(r.map(e=>e.resolvedDomain))]:[]}catch(t){a.default.error("Snap name provider request failed",{snapId:e,request:n,error:t}),c=t}return{sourceId:s,result:{proposedNames:o,error:c}}}r.SnapsNameProvider=class{constructor({messenger:e}){var t,r,s;!function(e,t){c(e,t),t.add(e)}(this,h),l(this,"name","SnapsNameProvider"),l(this,"state",null),function(e,t,r){c(e,t),t.set(e,r)}(this,p,void 0),r=this,s=e,(t=p).set(d(t,r),s)}getMetadata(){const e=d(h,this,m).call(this);return{sourceIds:{[n.NameType.ETHEREUM_ADDRESS]:e.map(e=>e.id)},sourceLabels:e.reduce((e,t)=>{const r=u(p,this).call("SnapController:get",t.id),s=null==r?void 0:r.manifest.proposedName;return{...e,[t.id]:s||t.id}},{})}}async getProposedNames(e){const{variation:t,value:r}=e,s=`eip155:${parseInt(t,16)}`,n=d(h,this,m).call(this,s);return{results:(await Promise.all(n.map(e=>d(h,this,g).call(this,e.id,s,r)))).reduce((e,t)=>{const{sourceId:r,result:s}=t;return{...e,[r]:s}},{})}}}}}},{package:"$root$",file:"app/scripts/lib/SnapsNameProvider.ts"}],[1896,{"./onekey-keyring.cjs":1897,"./trezor-connect-bridge.cjs":1898,"./trezor-keyring.cjs":1899},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var s=this&&this.__createBinding||(Object.create?function(e,t,r,s){s===undefined&&(s=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,s,n)}:function(e,t,r,s){s===undefined&&(s=r),e[s]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||s(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),n(e("./trezor-keyring.cjs"),r),n(e("./onekey-keyring.cjs"),r),n(e("./trezor-connect-bridge.cjs"),r)}}},{package:"@metamask/eth-trezor-keyring",file:"node_modules/@metamask/eth-trezor-keyring/dist/index.cjs"}],[1897,{"./trezor-keyring.cjs":1899},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.OneKeyKeyring=void 0;const s=e("./trezor-keyring.cjs"),n="OneKey Hardware";class i extends s.TrezorKeyring{constructor(){super(...arguments),this.type=n}}r.OneKeyKeyring=i,i.type=n}}},{package:"@metamask/eth-trezor-keyring",file:"node_modules/@metamask/eth-trezor-keyring/dist/onekey-keyring.cjs"}],[1898,{"@trezor/connect-web":2918},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var s=this&&this.__createBinding||(Object.create?function(e,t,r,s){s===undefined&&(s=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,s,n)}:function(e,t,r,s){s===undefined&&(s=r),e[s]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&s(t,e,r);return n(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.TrezorConnectBridge=void 0;const a=i(e("@trezor/connect-web"));r.TrezorConnectBridge=class{constructor(){this.trezorConnectInitiated=!1}async init(e){a.default.on(a.DEVICE_EVENT,e=>{var t;e.type===a.DEVICE.CONNECT&&(this.model=null===(t=e.payload.features)||void 0===t?void 0:t.model)}),this.trezorConnectInitiated||(await a.default.init(e),this.trezorConnectInitiated=!0)}async dispose(){return a.default.dispose(),Promise.resolve()}getPublicKey(e){return a.default.getPublicKey(e)}ethereumSignTransaction(e){return a.default.ethereumSignTransaction(e)}ethereumSignMessage(e){return a.default.ethereumSignMessage(e)}ethereumSignTypedData(e){return a.default.ethereumSignTypedData(e)}}}}},{package:"@metamask/eth-trezor-keyring",file:"node_modules/@metamask/eth-trezor-keyring/dist/trezor-connect-bridge.cjs"}],[1899,{"@ethereumjs/tx":591,"@ethereumjs/util":605,"@metamask/eth-sig-util":1833,"@metamask/utils":2799,"@trezor/connect-plugin-ethereum":2909,buffer:3760,hdkey:4307},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){var s,n,i,a,o,c,l=this&&this.__classPrivateFieldGet||function(e,t,r,s){if("a"===r&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?s:"a"===r?s.call(e):s?s.value:t.get(e)},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.TrezorKeyring=r.TREZOR_CONNECT_MANIFEST=void 0;const d=e("@ethereumjs/tx"),p=e("@ethereumjs/util"),h=e("@metamask/eth-sig-util"),m=e("@metamask/utils"),g=e("@trezor/connect-plugin-ethereum"),f=u(e("hdkey")),y="m/44'/60'/0'/0",w="m/44'/1'/0'/0",v="m/44'/60'/0'",S={[y]:!0,[v]:!0,[w]:!0},b="Trezor Hardware",k=1e3;async function E(e){return new Promise(t=>setTimeout(t,e))}function T(e){return"function"==typeof e.getChainId}r.TREZOR_CONNECT_MANIFEST={appName:"MetaMask",email:"support@metamask.io",appUrl:"https://metamask.io"};class C{constructor({bridge:e}){if(s.add(this),this.type=b,this.accounts=[],this.hdk=new f.default,this.hdPath=y,this.page=0,this.perPage=5,this.unlockedAccount=0,this.paths={},!e)throw new Error("Bridge is a required dependency for the keyring");this.bridge=e}getModel(){return this.bridge.model}async init(){return this.bridge.init({manifest:r.TREZOR_CONNECT_MANIFEST,lazyLoad:!0})}async destroy(){return this.bridge.dispose()}async serialize(){return Promise.resolve({hdPath:this.hdPath,accounts:this.accounts.slice(),page:this.page,paths:this.paths,perPage:this.perPage,unlockedAccount:this.unlockedAccount})}async deserialize(e){var t,r,s,n;return this.hdPath=null!==(t=e.hdPath)&&void 0!==t?t:y,this.accounts=null!==(r=e.accounts)&&void 0!==r?r:[],this.page=null!==(s=e.page)&&void 0!==s?s:0,this.perPage=null!==(n=e.perPage)&&void 0!==n?n:5,Promise.resolve()}isUnlocked(){var e;return Boolean(null===(e=this.hdk)||void 0===e?void 0:e.publicKey)}async unlock(){return this.isUnlocked()?Promise.resolve("already unlocked"):new Promise((e,r)=>{this.bridge.getPublicKey({path:this.hdPath,coin:"ETH"}).then(s=>{var n;s.success?(this.hdk.publicKey=t.from(s.payload.publicKey,"hex"),this.hdk.chainCode=t.from(s.payload.chainCode,"hex"),e("just unlocked")):r(new Error((null===(n=s.payload)||void 0===n?void 0:n.error)||"Unknown error"))}).catch(e=>{r(new Error((null==e?void 0:e.toString())||"Unknown error"))})})}setAccountToUnlock(e){this.unlockedAccount=parseInt(String(e),10)}async addAccounts(e){return new Promise((t,r)=>{this.unlock().then(r=>{const n=this.unlockedAccount,i=n+e,a=[];for(let e=n;e<i;e++){const t=l(this,s,"m",o).call(this,"m",e);this.accounts.includes(t)||(this.accounts=[...this.accounts,t],a.push(t)),this.page=0}t(a)}).catch(e=>{r(e)})})}async getFirstPage(){return this.page=0,l(this,s,"m",n).call(this,1)}async getNextPage(){return l(this,s,"m",n).call(this,1)}async getPreviousPage(){return l(this,s,"m",n).call(this,-1)}async getAccounts(){return Promise.resolve(this.accounts.slice())}removeAccount(e){if(!this.accounts.map(e=>e.toLowerCase()).includes(e.toLowerCase()))throw new Error(`Address ${e} not found in this keyring`);this.accounts=this.accounts.filter(t=>t.toLowerCase()!==e.toLowerCase())}async signTransaction(e,r){return T(r)?l(this,s,"m",i).call(this,e,r.getChainId(),r,e=>(r.v=t.from(e.v,"hex"),r.r=t.from(e.r,"hex"),r.s=t.from(e.s,"hex"),r)):l(this,s,"m",i).call(this,e,Number(r.common.chainId()),r,e=>{const t=r.toJSON();return t.type=r.type,t.v=(0,m.add0x)(e.v),t.r=(0,m.add0x)(e.r),t.s=(0,m.add0x)(e.s),d.TransactionFactory.fromTxData(t,{common:r.common,freeze:Object.isFrozen(r)})})}async signMessage(e,t){return this.signPersonalMessage(e,t)}async signPersonalMessage(e,t){return new Promise((r,n)=>{this.unlock().then(i=>{setTimeout(()=>{this.bridge.ethereumSignMessage({path:l(this,s,"m",c).call(this,e),message:(0,m.remove0x)(t),hex:!0}).then(t=>{var s;if(t.success){t.payload.address!==(0,m.getChecksumAddress)(e)&&n(new Error("signature doesnt match the right address"));const s=`0x${t.payload.signature}`;r(s)}else n(new Error((null===(s=t.payload)||void 0===s?void 0:s.error)||"Unknown error"))}).catch(e=>{n(new Error((null==e?void 0:e.toString())||"Unknown error"))})},"just unlocked"===i?k:0)}).catch(e=>{n(new Error((null==e?void 0:e.toString())||"Unknown error"))})})}async signTypedData(e,t,r){var n,i;const{version:a}=null!=r?r:{version:h.SignTypedDataVersion.V4},o=(0,g.transformTypedData)(t,a===h.SignTypedDataVersion.V4),{types:u,message:d={},domain:p={},primaryType:f,domain_separator_hash:y,message_hash:w}=o,v=await this.unlock();await E("just unlocked"===v?k:0);const S=await this.bridge.ethereumSignTypedData({path:l(this,s,"m",c).call(this,e),data:{types:Object.assign(Object.assign({},u),{EIP712Domain:null!==(n=u.EIP712Domain)&&void 0!==n?n:[]}),message:d,domain:p,primaryType:f},metamask_v4_compat:!0,domain_separator_hash:y,message_hash:null!=w?w:""});if(S.success){if((0,m.getChecksumAddress)(e)!==S.payload.address)throw new Error("signature doesnt match the right address");return S.payload.signature}throw new Error((null===(i=S.payload)||void 0===i?void 0:i.error)||"Unknown error")}forgetDevice(){this.accounts=[],this.hdk=new f.default,this.page=0,this.unlockedAccount=0,this.paths={}}setHdPath(e){if(!S[e])throw new Error(`The setHdPath method does not support setting HD Path to ${e}`);this.hdPath!==e&&(this.hdk=new f.default,this.accounts=[],this.page=0,this.perPage=5,this.unlockedAccount=0,this.paths={}),this.hdPath=e}}r.TrezorKeyring=C,s=new WeakSet,n=async function(e){return this.page+=e,this.page<=0&&(this.page=1),new Promise((e,t)=>{this.unlock().then(t=>{const r=(this.page-1)*this.perPage,n=r+this.perPage,i=[];for(let e=r;e<n;e++){const t=l(this,s,"m",o).call(this,"m",e);i.push({address:t,balance:null,index:e}),this.paths[(0,m.getChecksumAddress)(t)]=e}e(i)}).catch(e=>{t(e)})})},i=async function(e,r,n,i){var o,u,d,p;let h;h=T(n)?{to:l(this,s,"m",a).call(this,n.to),value:l(this,s,"m",a).call(this,n.value),data:l(this,s,"m",a).call(this,n.data),chainId:r,nonce:l(this,s,"m",a).call(this,n.nonce),gasLimit:l(this,s,"m",a).call(this,n.gasLimit),gasPrice:l(this,s,"m",a).call(this,n.gasPrice)}:Object.assign(Object.assign({},n.toJSON()),{chainId:r,to:l(this,s,"m",a).call(this,t.from(null!==(u=null===(o=n.to)||void 0===o?void 0:o.bytes)&&void 0!==u?u:[]))});try{const t=await this.unlock();await E("just unlocked"===t?k:0);const r=await this.bridge.ethereumSignTransaction({path:l(this,s,"m",c).call(this,e),transaction:h});if(r.success){const t=i(r.payload),s=(0,m.getChecksumAddress)((0,m.add0x)(t.getSenderAddress().toString("hex")));if(s!==(0,m.getChecksumAddress)(e))throw new Error("signature doesn't match the right address");return t}throw new Error((null===(d=r.payload)||void 0===d?void 0:d.error)||"Unknown error")}catch(e){throw new Error(null!==(p=null==e?void 0:e.toString())&&void 0!==p?p:"Unknown error")}},a=function(e){return(0,m.bytesToHex)(e)},o=function(e,t){const r=this.hdk.derive(`${e}/${t}`),s=(0,m.bytesToHex)((0,p.publicToAddress)(r.publicKey,!0));return(0,p.toChecksumAddress)(s)},c=function(e){const t=(0,m.getChecksumAddress)(e);let r=this.paths[t];if(void 0===r)for(let e=0;e<1e3;e++)if(t===l(this,s,"m",o).call(this,"m",e)){r=e;break}if(void 0===r)throw new Error("Unknown address");return`${this.hdPath}/${r}`},C.type=b}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/eth-trezor-keyring",file:"node_modules/@metamask/eth-trezor-keyring/dist/trezor-keyring.cjs"}],[19,{"@metamask/assets-controllers":1157},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.NftDetectionControllerInit=void 0;var s=e("@metamask/assets-controllers");r.NftDetectionControllerInit=e=>{const{controllerMessenger:t,getController:r}=e,n=()=>r("NftController");return{controller:new s.NftDetectionController({messenger:t,addNft:(...e)=>n().addNft(...e),getNftState:()=>n().state,disabled:!r("PreferencesController").state.useNftDetection})}}}}},{package:"$root$",file:"app/scripts/controller-init/assets/nft-detection-controller-init.ts"}],[190,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){function s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(r,"__esModule",{value:!0}),r.WeakRefObjectMap=void 0;class n{constructor(){s(this,"map",void 0),this.map=new Map}set(e,t){const r={};for(const e in t){if(!Object.prototype.hasOwnProperty.call(t,e))continue;const s=t[e];if("object"!=typeof s||null===s)throw new Error(`Property ${String(e)} is not an object and cannot be weakly referenced.`);r[e]=new WeakRef(s)}return this.map.set(e,r),this}get(e){const t=this.map.get(e);if(!t)return undefined;const r={};for(const s in t){if(!Object.prototype.hasOwnProperty.call(t,s))continue;const n=t[s].deref();if(n===undefined)return this.map.delete(e),undefined;r[s]=n}return r}has(e){return this.get(e)!==undefined}delete(e){return this.get(e)!==undefined&&this.map.delete(e)}clear(){this.map.clear()}get size(){return this.map.size}entries(){const e=[];return this.map.forEach((t,r)=>{const s=this.get(r);s!==undefined&&e.push([r,s])}),e.values()}keys(){return this.map.keys()}values(){const e=[];return this.map.forEach((t,r)=>{const s=this.get(r);s!==undefined&&e.push(s)}),e.values()}[Symbol.iterator](){return this.entries()}get[Symbol.toStringTag](){return"WeakRefObjectMap"}forEach(e,t){this.map.forEach((r,s)=>{const n=this.get(s);n!==undefined&&(t?e.call(t,n,s,this):e(n,s,this))})}}r.WeakRefObjectMap=n}}},{package:"$root$",file:"app/scripts/lib/WeakRefObjectMap.ts"}],[191,{"../../../../shared/constants/app":5415,"@metamask/controller-utils":1301,"@metamask/rpc-errors":2384,"@metamask/snaps-rpc-methods":2507,"@metamask/utils":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.rejectAllApprovals=function({approvalController:e,deleteInterface:t}){const r=e.state.pendingApprovals,s=Object.values(r);for(const r of s)l({approvalController:e,approvalRequest:r,deleteInterface:t})},r.rejectOriginApprovals=function({approvalController:e,deleteInterface:t,origin:r}){const s=e.state.pendingApprovals,n=Object.values(s).filter(e=>e.origin===r);for(const r of n)l({approvalController:e,approvalRequest:r,deleteInterface:t})};var s=e("@metamask/controller-utils"),n=e("@metamask/snaps-rpc-methods"),i=e("@metamask/rpc-errors"),a=e("@metamask/utils"),o=e("../../../../shared/constants/app");const c=(0,a.createProjectLogger)("approval-utils");function l({approvalController:e,approvalRequest:t,deleteInterface:r}){var a;const{id:l,type:u,origin:d}=t,p=null===(a=t.requestData)||void 0===a?void 0:a.id;switch(u){case s.ApprovalType.SnapDialogAlert:case s.ApprovalType.SnapDialogPrompt:case n.DIALOG_APPROVAL_TYPES.default:c("Rejecting snap dialog",{id:l,interfaceId:p,origin:d,type:u}),e.accept(l,null),null==r||r(p);break;case s.ApprovalType.SnapDialogConfirmation:c("Rejecting snap confirmation",{id:l,interfaceId:p,origin:d,type:u}),e.accept(l,!1),null==r||r(p);break;case o.SNAP_MANAGE_ACCOUNTS_CONFIRMATION_TYPES.confirmAccountCreation:case o.SNAP_MANAGE_ACCOUNTS_CONFIRMATION_TYPES.confirmAccountRemoval:case o.SNAP_MANAGE_ACCOUNTS_CONFIRMATION_TYPES.showSnapAccountRedirect:c("Rejecting snap account confirmation",{id:l,origin:d,type:u}),e.accept(l,!1);break;default:c("Rejecting pending approval",{id:l,origin:d,type:u}),e.reject(l,i.providerErrors.userRejectedRequest({data:{cause:"rejectAllApprovals"}}))}}}}},{package:"$root$",file:"app/scripts/lib/approval/utils.ts"}],[192,{"../../../shared/modules/string-utils":5551},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=e("../../../shared/modules/string-utils");r.default=class{constructor(e={}){const{preferencesController:t,addressBookController:r,accountsController:s,networkController:n,trackMetaMetricsEvent:i}=e;this.preferencesController=t,this.accountsController=s,this.addressBookController=r,this.networkController=n,this._trackMetaMetricsEvent=i}async restoreUserData(e){const t=this.preferencesController.state,{preferences:r,addressBook:s,network:n,internalAccounts:i}=JSON.parse(e);r&&(r.identities=t.identities,r.lostIdentities=t.lostIdentities,r.selectedAddress=t.selectedAddress,this.preferencesController.update(r)),s&&this.addressBookController.update(s,!0),n&&this.networkController.loadBackup(n),i&&this.accountsController.loadBackup(i),(r||s||n||i)&&this._trackMetaMetricsEvent({event:"User Data Imported",category:"Backup"})}async backupUserData(){const e={preferences:{...this.preferencesController.state},internalAccounts:{internalAccounts:this.accountsController.state.internalAccounts},addressBook:{...this.addressBookController.state},network:{networkConfigurationsByChainId:this.networkController.state.networkConfigurationsByChainId}};delete e.preferences.identities,delete e.preferences.lostIdentities,delete e.preferences.selectedAddress;const t=JSON.stringify(e),r=new Date,n=e=>(0,s.prependZero)(e,2);return{fileName:`MetaMaskUserData.${r.getFullYear()}_${n(r.getMonth()+1)}_${n(r.getDay())}_${n(r.getHours())}_${n(r.getMinutes())}_${n(r.getDay())}.json`,data:t}}}}}},{package:"$root$",file:"app/scripts/lib/backup.js"}],[193,{"@metamask/utils":2799,lodash:4534},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.fetchAccountBalancesInBatches=async function(e){const{addresses:t,supportedChainIds:r,accountApiBaseUrl:n,batchSize:a=50,logger:o}=e,c=r.join(",");return i({items:t,batchSize:a,processBatch:async e=>{const t=r[0],i=e.map(e=>(0,s.toCaipAccountId)("eip155",t,e)).join(","),a=`${n}/v4/multiaccount/balances?networks=${c}&accountAddresses=${i}`,l=await fetch(a,{method:"GET",headers:{Accept:"application/json"}});if(!l.ok)return null==o||o.warn(`Account API batch request failed with status ${l.status}: ${l.statusText}`),null;return await l.json()},mergeResults:e=>{const t={balances:{}};return e.forEach(e=>{Object.assign(t.balances,e.balances)}),t},logger:o})},r.processInBatches=i;var s=e("@metamask/utils"),n=e("lodash");async function i(e){const{items:t,batchSize:r,processBatch:s,mergeResults:i,logger:a}=e;if(0===t.length)return null;const o=(0,n.chunk)(t,r);null==a||a.debug(`Processing ${t.length} items in ${o.length} batches of max ${r} each`);try{const e=await Promise.all(o.map(async(e,t)=>{try{const r=await s(e);return null===r&&(null==a||a.warn(`Batch ${t+1} failed and returned null`)),r}catch(e){return null==a||a.warn(`Batch ${t+1} failed with error: ${String(e)}`),null}})),t=[];for(const r of e)null!==r&&t.push(r);if(t.length<=0)return null==a||a.warn("All batches failed"),null;if(null==a||a.debug(`Successfully processed ${t.length}/${o.length} batches`),i)return i(t);return t[0]||null}catch(e){return null==a||a.warn(`Batch processing failed: ${String(e)}`),null}}}}},{package:"$root$",file:"app/scripts/lib/batch-utils.ts"}],[194,{"../../../shared/constants/time":5449,loglevel:4542,"readable-stream":4977},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.THREE_MINUTES=void 0,r.default=function(){const e=c();return new n.Transform({transform(t,r,s){const n=t.id===undefined,a=e.add(t.id);n||a?s(null,t):(i.default.debug(`RPC request with id "${t.id}" already seen.`),s())},objectMode:!0})};var s,n=e("readable-stream"),i=(s=e("loglevel"))&&s.__esModule?s:{default:s},a=e("../../../shared/constants/time");const o=r.THREE_MINUTES=3*a.MINUTE,c=()=>{const e=new Map;return setInterval(()=>{const t=Date.now()-o;for(const[r,s]of e.entries()){if(!(s<=t))break;e.delete(r)}},o),{add:t=>!e.has(t)&&(e.set(t,Date.now()),!0)}}}}},{package:"$root$",file:"app/scripts/lib/createDupeReqFilterStream.ts"}],[195,{"../../../shared/constants/permissions":5437,"../controllers/permissions":170,"@metamask/keyring-api":1994},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function({messenger:e}){return function(t,r,n,i){const o=e.call("AccountsController:getSelectedAccount");if((0,s.isEvmAccountType)(o.type))return n();if(a.includes(t.method))return i(new Error(`Non-EVM account cannot request this method: ${t.method}`));if("wallet_requestPermissions"===t.method&&null!=t&&t.params&&Array.isArray(t.params)&&t.params.length>0&&t.params[0]){const e=Object.keys(t.params[0]);if(a.some(t=>e.includes(t)))return i(new Error(`Non-EVM account cannot request this method: ${e.toString()}`))}return n()}};var s=e("@metamask/keyring-api"),n=e("../../../shared/constants/permissions"),i=e("../controllers/permissions");const a=[...Object.values(n.RestrictedEthMethods),...i.unrestrictedEthSigningMethods]}}},{package:"$root$",file:"app/scripts/lib/createEvmMethodsToNonEvmAccountReqFilterMiddleware.ts"}],[196,{"../../../shared/constants/referrals":5440,"@metamask/json-rpc-engine":1943,loglevel:4542},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.HyperliquidPermissionTriggerType=void 0,r.createHyperliquidReferralMiddleware=function(e){return(0,n.createAsyncMiddleware)(async(t,r,s)=>{if(await s(),!function(e){return Boolean(e.origin)&&Boolean(e.tabId)}(t))return;const n="wallet_requestPermissions"===t.method&&t.origin===a.HYPERLIQUID_ORIGIN,c=Array.isArray(r.result)&&r.result.some(e=>"eth_accounts"===(null==e?void 0:e.parentCapability));n&&c&&e(t.tabId,o.NewConnection).catch(e=>{i.default.error("Failed to handle Hyperliquid referral after wallet_requestPermissions grant: ",e)})})};var s,n=e("@metamask/json-rpc-engine"),i=(s=e("loglevel"))&&s.__esModule?s:{default:s},a=e("../../../shared/constants/referrals");let o=r.HyperliquidPermissionTriggerType=function(e){return e.NewConnection="new_connection",e.OnNavigateConnectedTab="on_navigate_connected_tab",e}({})}}},{package:"$root$",file:"app/scripts/lib/createHyperliquidReferralMiddleware.ts"}],[197,{loglevel:4542},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){return function(t,r,s){s(s=>{r.error&&n.default.debug("Error in RPC response:\n",r),t.isMetamaskInternal||(n.default.info(`RPC (${e.origin}): ${t.method} -> ${r.error?"error":"success"}`),s())})}};var s,n=(s=e("loglevel"))&&s.__esModule?s:{default:s}}}},{package:"$root$",file:"app/scripts/lib/createLoggerMiddleware.js"}],[198,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function({mainFrameOrigin:e}){return function(t,r,s){t.mainFrameOrigin=e,s()}}}}},{package:"$root$",file:"app/scripts/lib/createMainFrameOriginMiddleware.ts"}],[199,{"./stream-utils":271,"@metamask/rpc-errors":2384},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=e("@metamask/rpc-errors"),n=e("./stream-utils");r.default=(e,t)=>async r=>{if(!(0,n.isStreamWritable)(t))return;if(!e[r.method])return void t.write({jsonrpc:"2.0",error:s.rpcErrors.methodNotFound({message:`${r.method} not found`}),id:r.id});let i,a;try{i=await e[r.method](...r.params)}catch(e){a=e}(0,n.isStreamWritable)(t)?a?t.write({jsonrpc:"2.0",error:(0,s.serializeError)(a,{shouldIncludeStack:!0}),id:r.id}):t.write({jsonrpc:"2.0",result:i,id:r.id}):a&&console.error(a)}}}},{package:"$root$",file:"app/scripts/lib/createMetaRPCHandler.js"}],[20,{"../../lib/util":290,"@metamask/assets-controllers":1157},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.TokenRatesControllerInit=void 0;var s=e("@metamask/assets-controllers"),n=e("../../lib/util");r.TokenRatesControllerInit=e=>{const{controllerMessenger:t,initMessenger:r,persistedState:i}=e,a=r.call("PreferencesController:getState"),o=new s.TokenRatesController({messenger:t,state:i.TokenRatesController,tokenPricesService:new s.CodefiTokenPricesServiceV2,disabled:!a.useCurrencyRateCheck});return r.subscribe("PreferencesController:stateChange",(0,n.previousValueComparator)((e,t)=>{const{useCurrencyRateCheck:r}=e,{useCurrencyRateCheck:s}=t;return s&&!r?o.enable():!s&&r&&o.disable(),!0},a)),{controller:o}}}}},{package:"$root$",file:"app/scripts/controller-init/assets/token-rates-controller-init.ts"}],[200,{"./middleware/pending":218,"@metamask/eth-json-rpc-middleware":1724,"@metamask/json-rpc-engine":1943},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function({version:e,getAccounts:t,processTransaction:r,processTypedMessage:a,processTypedMessageV3:o,processTypedMessageV4:c,processPersonalMessage:l,processDecryptMessage:u,processEncryptionPublicKey:d,getPendingNonce:p,getPendingTransactionByHash:h,processRequestExecutionPermissions:m}){return(0,s.mergeMiddleware)([(0,s.createScaffoldMiddleware)({eth_syncing:!1,web3_clientVersion:`MetaMask/v${e}`}),(0,n.createWalletMiddleware)({getAccounts:t,processTransaction:r,processTypedMessage:a,processTypedMessageV3:o,processTypedMessageV4:c,processPersonalMessage:l,processDecryptMessage:u,processEncryptionPublicKey:d,processRequestExecutionPermissions:m}),(0,i.createPendingNonceMiddleware)({getPendingNonce:p}),(0,i.createPendingTxMiddleware)({getPendingTransactionByHash:h})])};var s=e("@metamask/json-rpc-engine"),n=e("@metamask/eth-json-rpc-middleware"),i=e("./middleware/pending")}}},{package:"$root$",file:"app/scripts/lib/createMetamaskMiddleware.js"}],[201,{loglevel:4542,"webextension-polyfill":5398},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function({location:e,registerOnboarding:t}){return async function(r,i,a,o){try{if("wallet_registerOnboarding"!==r.method)return void a();r.tabId&&r.tabId!==n.default.tabs.TAB_ID_NONE?await t(e,r.tabId):s.default.debug(`'wallet_registerOnboarding' message from ${e} ignored due to missing tabId`),i.result=!0,o()}catch(e){o(e)}}};var s=i(e("loglevel")),n=i(e("webextension-polyfill"));function i(e){return e&&e.__esModule?e:{default:e}}}}},{package:"$root$",file:"app/scripts/lib/createOnboardingMiddleware.js"}],[202,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){return function(t,r,s){t.origin=e.origin,s()}}}}},{package:"$root$",file:"app/scripts/lib/createOriginMiddleware.js"}],[203,{"../../../shared/constants/app":5415,"@metamask/rpc-errors":2384},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.SPAM_FILTER_ACTIVATED_ERROR=r.REJECTION_THRESHOLD_IN_MS=r.NUMBER_OF_REJECTIONS_THRESHOLD=r.BLOCKING_THRESHOLD_IN_MS=r.BLOCKABLE_METHODS=void 0,r.default=function({getThrottledOriginState:e,updateThrottledOriginState:t}){return function(r,s,n,p){const{method:h,origin:m}=r;if(!c.has(h)||l.includes(m))return void n();!function(e){if(!e)return!1;const t=Date.now(),{rejections:r,lastRejection:s}=e,n=t-s<=o;return r>=i&&n}(e(m))?n(r=>{if("error"in s&&s.error&&d(s.error)){var n;const i=null===(n=s.error)||void 0===n?void 0:n.data;if("rejectAllApprovals"===(null==i?void 0:i.cause))return void r();const o=e(m)||{rejections:0,lastRejection:0},c=Date.now(),l=c-o.lastRejection<a?o.rejections+1:1;t(m,{rejections:l,lastRejection:c})}else{const r=e(m);Boolean(r)&&t(m,{rejections:0,lastRejection:0})}r()}):p(u)}};var s=e("@metamask/rpc-errors"),n=e("../../../shared/constants/app");const i=r.NUMBER_OF_REJECTIONS_THRESHOLD=3,a=r.REJECTION_THRESHOLD_IN_MS=3e4,o=r.BLOCKING_THRESHOLD_IN_MS=6e4,c=r.BLOCKABLE_METHODS=new Set([n.MESSAGE_TYPE.ADD_ETHEREUM_CHAIN,n.MESSAGE_TYPE.ETH_SEND_TRANSACTION,n.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA,n.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V1,n.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V3,n.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V4,n.MESSAGE_TYPE.PERSONAL_SIGN,n.MESSAGE_TYPE.SWITCH_ETHEREUM_CHAIN,n.MESSAGE_TYPE.WALLET_SEND_CALLS,n.MESSAGE_TYPE.WATCH_ASSET]),l=["http://127.0.0.1:8080","http://127.0.0.1:8081","http://127.0.0.1:8082","http://localhost:8080","http://localhost:8081","http://localhost:8082"],u=r.SPAM_FILTER_ACTIVATED_ERROR=s.providerErrors.unauthorized("Request blocked due to spam filter."),d=e=>e.code===s.errorCodes.provider.userRejectedRequest}}},{package:"$root$",file:"app/scripts/lib/createOriginThrottlingMiddleware.ts"}],[204,{"../../../shared/constants/app":5415,"../../../shared/constants/metametrics":5430,"../../../shared/constants/security-provider":5441,"../../../shared/constants/signatures":5442,"../../../shared/constants/transaction":5451,"../../../shared/lib/confirmation.utils":5463,"../../../shared/lib/snaps/snaps":5512,"../../../shared/modules/error":5531,"../../../shared/modules/transaction.utils":5553,"../../../ui/helpers/utils/metrics":6683,"./snap-keyring/metrics":259,"@metamask/controller-utils":1301,"@metamask/rpc-errors":2384,"ethereumjs-util":4019},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function({rateLimitTimeout:e=3e5,rateLimitSamplePercent:t=.001,globalRateLimitTimeout:r=3e5,globalRateLimitMaxAmount:M=10,getAccountType:A,getDeviceModel:I,getHardwareTypeForMetric:_,snapAndHardwareMessenger:P,appStateController:N,metaMetricsController:O,getHDEntropyIndex:j}){return async function(R,D,L){const{origin:B,method:x,params:F}=R,U=function(e){return[a.MESSAGE_TYPE.WALLET_CREATE_SESSION,a.MESSAGE_TYPE.WALLET_INVOKE_METHOD].includes(e)}(x),$=U?o.MetaMetricsRequestedThrough.MultichainApi:o.MetaMetricsRequestedThrough.EthereumProvider,H=U?o.MetaMetricsEventCategory.MultichainApi:o.MetaMetricsEventCategory.InpageProvider;let G,K=x;var q;x===a.MESSAGE_TYPE.WALLET_INVOKE_METHOD&&(K=null==F||null===(q=F.request)||void 0===q?void 0:q.method,G=null==F?void 0:F.scope);const W=v[K];let V;switch(W){case y.TIMEOUT:V=void 0!==T[K];break;case y.NON_RATE_LIMITED:V=!1;break;case y.BLOCKED:V=!0;break;default:case y.RANDOM_SAMPLE:V=Math.random()>=t}const z=M>0&&C>=M,Y=!0===O.state.participateInMetaMetrics,Q=b[K],J={api_source:$};let X;G&&(J.chain_id_caip=G);const Z=(0,g.isSnapPreinstalled)(B),ee=B!==a.ORIGIN_METAMASK&&!Z&&!V&&!z&&!0===Y;if(ee){var te;const t=Q?Q.REQUESTED:o.MetaMetricsEventName.ProviderMethodCalled;if(t===o.MetaMetricsEventName.SignatureRequested){var re,se,ne,ie,ae;let e;var oe,ce;if(J.signature_type=K,J.hd_entropy_index=j(),(0,i.isValidAddress)(null==R||null===(re=R.params)||void 0===re?void 0:re[1]))e=null==R||null===(oe=R.params)||void 0===oe?void 0:oe[0];else e=null==R||null===(ce=R.params)||void 0===ce?void 0:ce[1];null!==(se=R.securityAlertResponse)&&void 0!==se&&se.providerRequestsCount&&Object.keys(R.securityAlertResponse.providerRequestsCount).forEach(e=>{J[`ppom_${e}_count`]=R.securityAlertResponse.providerRequestsCount[e]}),J.security_alert_response=(null===(ne=R.securityAlertResponse)||void 0===ne?void 0:ne.result_type)??l.BlockaidResultType.NotApplicable,J.security_alert_reason=(null===(ie=R.securityAlertResponse)||void 0===ie?void 0:ie.reason)??l.BlockaidReason.notApplicable,null!==(ae=R.securityAlertResponse)&&void 0!==ae&&ae.description&&(J.security_alert_description=R.securityAlertResponse.description),(0,m.shouldUseRedesignForSignatures)({approvalType:S[K]})&&(J.ui_customizations=[...J.ui_customizations||[],o.MetaMetricsEventUiCustomization.RedesignedConfirmation]);const t=await(0,f.getSnapAndHardwareInfoForMetrics)(A,I,_,P);Object.assign(J,t);try{if(K===a.MESSAGE_TYPE.PERSONAL_SIGN){const{isSIWEMessage:t}=(0,s.detectSIWE)({data:e});t&&(J.ui_customizations=[...J.ui_customizations||[],o.MetaMetricsEventUiCustomization.Siwe])}else if(K===a.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V4){const t=(0,c.parseTypedDataMessage)(e);X={},J.eip712_primary_type=t.primaryType,X.eip712_verifyingContract=t.domain.verifyingContract,X.eip712_domain_version=t.domain.version,X.eip712_domain_name=t.domain.name,u.PRIMARY_TYPES_PERMIT.includes(t.primaryType)?J.ui_customizations=[...J.ui_customizations||[],o.MetaMetricsEventUiCustomization.Permit]:u.PRIMARY_TYPES_ORDER.includes(t.primaryType)&&(J.ui_customizations=[...J.ui_customizations||[],o.MetaMetricsEventUiCustomization.Order])}}catch(e){console.warn(`createRPCMethodTrackingMiddleware: Errored - ${e}`)}}else J.method=K;const n=k[K];if(n&&(J.params=n(F)),null===(te=E[K])||void 0===te||te.call(E,R,undefined,w.REQUESTED,J),t===o.MetaMetricsEventName.SignatureRequested){!function(e,t,r,s){e.createEventFragment({category:s,initialEvent:o.MetaMetricsEventName.SignatureRequested,successEvent:o.MetaMetricsEventName.SignatureApproved,failureEvent:o.MetaMetricsEventName.SignatureRejected,uniqueIdentifier:(0,h.generateSignatureUniqueId)(t.id),persist:!0,referrer:{url:t.origin},...r})}(O,R,{properties:J,sensitiveProperties:X},H)}else O.trackEvent({event:t,category:H,referrer:{url:B},properties:J});W===y.TIMEOUT&&(T[K]=setTimeout(()=>{delete T[K]},e)),C+=1,setTimeout(()=>{C-=1},r)}L(async e=>{var t,r,s,i;if(!1===ee||void 0===Q)return e();const a=null===(t=D.error)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.location;let c,l;const u=(0,p.getErrorMessage)(D.error);if((null===(r=D.error)||void 0===r?void 0:r.code)===n.errorCodes.provider.userRejectedRequest?(c=Q.REJECTED,l=w.REJECTED):(null===(s=D.error)||void 0===s?void 0:s.code)===n.errorCodes.rpc.internal&&[u,D.error.message].includes("Request rejected by user or snap.")?(c=Q.REJECTED,l=w.REJECTED,J.status=u):(c=Q.APPROVED,l=w.APPROVED),!c)return e();null===(i=E[K])||void 0===i||i.call(E,R,D,l,J);let m={};if(d.SIGNING_METHODS.includes(K)){var g;const e=N.getSignatureSecurityAlertResponse(null===(g=R.securityAlertResponse)||void 0===g?void 0:g.securityAlertId);m=(0,h.getBlockaidMetricsProps)({securityAlertResponse:e})}const f={...J,...m,location:a};if(c===o.MetaMetricsEventName.SignatureRejected||c===o.MetaMetricsEventName.SignatureApproved){const e={abandoned:c===Q.REJECTED},t={properties:{...f,hd_entropy_index:j()},sensitiveProperties:X};!function(e,t,r,s){const n=(0,h.generateSignatureUniqueId)(t.id);e.updateEventFragment(n,s),e.finalizeEventFragment(n,r)}(O,R,e,t)}else O.trackEvent({event:c,category:H,referrer:{url:B},properties:f});return e()})}};var s=e("@metamask/controller-utils"),n=e("@metamask/rpc-errors"),i=e("ethereumjs-util"),a=e("../../../shared/constants/app"),o=e("../../../shared/constants/metametrics"),c=e("../../../shared/modules/transaction.utils"),l=e("../../../shared/constants/security-provider"),u=e("../../../shared/constants/signatures"),d=e("../../../shared/constants/transaction"),p=e("../../../shared/modules/error"),h=e("../../../ui/helpers/utils/metrics"),m=e("../../../shared/lib/confirmation.utils"),g=e("../../../shared/lib/snaps/snaps"),f=e("./snap-keyring/metrics");const y={TIMEOUT:"timeout",BLOCKED:"blocked",NON_RATE_LIMITED:"non_rate_limited",RANDOM_SAMPLE:"random_sample"},w={REQUESTED:"REQUESTED",APPROVED:"APPROVED",REJECTED:"REJECTED"},v={[a.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA]:y.NON_RATE_LIMITED,[a.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V3]:y.NON_RATE_LIMITED,[a.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V4]:y.NON_RATE_LIMITED,[a.MESSAGE_TYPE.PERSONAL_SIGN]:y.NON_RATE_LIMITED,[a.MESSAGE_TYPE.ETH_DECRYPT]:y.NON_RATE_LIMITED,[a.MESSAGE_TYPE.ETH_GET_ENCRYPTION_PUBLIC_KEY]:y.NON_RATE_LIMITED,[a.MESSAGE_TYPE.ADD_ETHEREUM_CHAIN]:y.NON_RATE_LIMITED,[a.MESSAGE_TYPE.SWITCH_ETHEREUM_CHAIN]:y.NON_RATE_LIMITED,[a.MESSAGE_TYPE.ETH_REQUEST_ACCOUNTS]:y.TIMEOUT,[a.MESSAGE_TYPE.WALLET_REQUEST_PERMISSIONS]:y.TIMEOUT,[a.MESSAGE_TYPE.WALLET_CREATE_SESSION]:y.NON_RATE_LIMITED,[a.MESSAGE_TYPE.SEND_METADATA]:y.BLOCKED,[a.MESSAGE_TYPE.ETH_CHAIN_ID]:y.BLOCKED,[a.MESSAGE_TYPE.ETH_ACCOUNTS]:y.BLOCKED,[a.MESSAGE_TYPE.LOG_WEB3_SHIM_USAGE]:y.BLOCKED,[a.MESSAGE_TYPE.GET_PROVIDER_STATE]:y.BLOCKED,[a.MESSAGE_TYPE.WALLET_GET_CALLS_STATUS]:y.NON_RATE_LIMITED,[a.MESSAGE_TYPE.WALLET_GET_CAPABILITIES]:y.NON_RATE_LIMITED,[a.MESSAGE_TYPE.WALLET_SEND_CALLS]:y.NON_RATE_LIMITED},S={[a.MESSAGE_TYPE.PERSONAL_SIGN]:s.ApprovalType.PersonalSign,[a.MESSAGE_TYPE.SIGN]:s.ApprovalType.SignTransaction,[a.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA]:s.ApprovalType.EthSignTypedData,[a.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V1]:s.ApprovalType.EthSignTypedData,[a.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V3]:s.ApprovalType.EthSignTypedData,[a.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V4]:s.ApprovalType.EthSignTypedData},b={[a.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA]:{APPROVED:o.MetaMetricsEventName.SignatureApproved,REJECTED:o.MetaMetricsEventName.SignatureRejected,REQUESTED:o.MetaMetricsEventName.SignatureRequested},[a.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V3]:{APPROVED:o.MetaMetricsEventName.SignatureApproved,REJECTED:o.MetaMetricsEventName.SignatureRejected,REQUESTED:o.MetaMetricsEventName.SignatureRequested},[a.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V4]:{APPROVED:o.MetaMetricsEventName.SignatureApproved,REJECTED:o.MetaMetricsEventName.SignatureRejected,REQUESTED:o.MetaMetricsEventName.SignatureRequested},[a.MESSAGE_TYPE.PERSONAL_SIGN]:{APPROVED:o.MetaMetricsEventName.SignatureApproved,REJECTED:o.MetaMetricsEventName.SignatureRejected,REQUESTED:o.MetaMetricsEventName.SignatureRequested},[a.MESSAGE_TYPE.ETH_DECRYPT]:{APPROVED:o.MetaMetricsEventName.DecryptionApproved,REJECTED:o.MetaMetricsEventName.DecryptionRejected,REQUESTED:o.MetaMetricsEventName.DecryptionRequested},[a.MESSAGE_TYPE.ETH_GET_ENCRYPTION_PUBLIC_KEY]:{APPROVED:o.MetaMetricsEventName.EncryptionPublicKeyApproved,REJECTED:o.MetaMetricsEventName.EncryptionPublicKeyRejected,REQUESTED:o.MetaMetricsEventName.EncryptionPublicKeyRequested},[a.MESSAGE_TYPE.ETH_REQUEST_ACCOUNTS]:{APPROVED:o.MetaMetricsEventName.PermissionsApproved,REJECTED:o.MetaMetricsEventName.PermissionsRejected,REQUESTED:o.MetaMetricsEventName.PermissionsRequested},[a.MESSAGE_TYPE.WALLET_REQUEST_PERMISSIONS]:{APPROVED:o.MetaMetricsEventName.PermissionsApproved,REJECTED:o.MetaMetricsEventName.PermissionsRejected,REQUESTED:o.MetaMetricsEventName.PermissionsRequested},[a.MESSAGE_TYPE.WALLET_CREATE_SESSION]:{APPROVED:o.MetaMetricsEventName.PermissionsApproved,REJECTED:o.MetaMetricsEventName.PermissionsRejected,REQUESTED:o.MetaMetricsEventName.PermissionsRequested},[a.MESSAGE_TYPE.WALLET_GET_CALLS_STATUS]:{REQUESTED:o.MetaMetricsEventName.Wallet5792Called},[a.MESSAGE_TYPE.WALLET_GET_CAPABILITIES]:{REQUESTED:o.MetaMetricsEventName.Wallet5792Called},[a.MESSAGE_TYPE.WALLET_SEND_CALLS]:{REQUESTED:o.MetaMetricsEventName.Wallet5792Called}},k={[a.MESSAGE_TYPE.WATCH_ASSET]:({type:e})=>({type:e}),[a.MESSAGE_TYPE.ADD_ETHEREUM_CHAIN]:([{chainId:e}])=>({chainId:e}),[a.MESSAGE_TYPE.SWITCH_ETHEREUM_CHAIN]:([{chainId:e}])=>({chainId:e})},E={[a.MESSAGE_TYPE.WALLET_SEND_CALLS]:function(e,t,r,s){var n;if(r!==w.REQUESTED)return;const{params:i}=e,a=null==i||null===(n=i[0])||void 0===n||null===(n=n.calls)||void 0===n?void 0:n.length;a&&(s.batch_transaction_count=a)},[a.MESSAGE_TYPE.WALLET_CREATE_SESSION]:function(e,t,r,s){if(r===w.REQUESTED){const{params:t}=e,r=(null==t?void 0:t.requiredScopes)||{},n=(null==t?void 0:t.optionalScopes)||{},i=new Set;for(const e of Object.keys(r))i.add(e);for(const e of Object.keys(n))i.add(e);s.chain_id_list=Array.from(i)}else if(r===w.APPROVED){const{result:e}=t,r=Object.keys((null==e?void 0:e.sessionScopes)||{});s.chain_id_list=r}}},T={};let C=0}}},{package:"$root$",file:"app/scripts/lib/createRPCMethodTrackingMiddleware.js"}],[205,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){return function(t,r,s){t.tabId=e.tabId,s()}}}}},{package:"$root$",file:"app/scripts/lib/createTabIdMiddleware.js"}],[2054,{"@metamask/base-controller":1222,events:4072,uuid:5366},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.AbstractMessageManager=void 0;const s=e("@metamask/base-controller"),n=e("events"),i=e("uuid"),a={unapprovedMessages:{includeInStateLogs:!0,persist:!1,anonymous:!1,usedInUi:!0},unapprovedMessagesCount:{includeInStateLogs:!0,persist:!1,anonymous:!1,usedInUi:!0}};class o extends s.BaseController{constructor({additionalFinishStatuses:e,messenger:t,name:r,securityProviderRequest:s,state:i={}}){super({messenger:t,metadata:a,name:r,state:{unapprovedMessages:{},unapprovedMessagesCount:0,...i}}),this.internalEvents=new n.EventEmitter,this.messages=[],this.securityProviderRequest=s,this.additionalFinishStatuses=e??[]}addRequestToMessageParams(e,t){const r={...e};return t&&(r.requestId=t.id,r.origin=t.origin),r}createUnapprovedMessage(e,t,r){return{id:(0,i.v1)(),messageParams:e,securityAlertResponse:r?.securityAlertResponse,status:"unapproved",time:Date.now(),type:t}}saveMessageList(e=!0){this.update(e=>{e.unapprovedMessages=this.getUnapprovedMessages(),e.unapprovedMessagesCount=this.getUnapprovedMessagesCount()}),e&&this.messagingSystem.publish(`${this.name}:updateBadge`)}setMessageStatus(e,t){const r=this.getMessage(e);if(!r)throw new Error(`${this.name}: Message not found for id: ${e}.`);const s={...r,status:t};this.updateMessage(s),this.internalEvents.emit(`${e}:${t}`,s),("rejected"===t||"signed"===t||"errored"===t||this.additionalFinishStatuses.includes(t))&&this.internalEvents.emit(`${e}:finished`,s)}updateMessage(e,t=!0){const r=this.messages.findIndex(t=>e.id===t.id);-1!==r&&(this.messages[r]=e),this.saveMessageList(t)}async securityCheck(e){if(this.securityProviderRequest){const t=await this.securityProviderRequest(e,e.type);return{...e,securityProviderResponse:t}}return e}clearUnapprovedMessages(){this.update(e=>{e.unapprovedMessages={},e.unapprovedMessagesCount=0})}getUnapprovedMessagesCount(){return Object.keys(this.getUnapprovedMessages()).length}getUnapprovedMessages(){return this.messages.filter(e=>"unapproved"===e.status).reduce((e,t)=>(e[t.id]=t,e),{})}async addMessage(e){const t=await this.securityCheck(e);this.messages.push(t),this.saveMessageList()}getMessage(e){return this.messages.find(t=>t.id===e)}getAllMessages(){return this.messages}approveMessage(e){return this.setMessageStatusApproved(e.metamaskId),this.prepMessageForSigning(e)}setMessageStatusApproved(e){this.setMessageStatus(e,"approved")}setMessageStatusInProgress(e){this.setMessageStatus(e,"inProgress")}setMessageStatusSigned(e,t){this.setMessageStatusAndResult(e,t,"signed")}setMessageStatusAndResult(e,t,r){this.setResult(e,t),this.setMessageStatus(e,r)}setResult(e,t){const r=this.getMessage(e);r&&this.updateMessage({...r,rawSig:t},!1)}setMetadata(e,t){const r=this.getMessage(e);if(!r)throw new Error(`${this.name}: Message not found for id: ${e}.`);this.updateMessage({...r,metadata:t},!1)}rejectMessage(e){this.setMessageStatus(e,"rejected")}async waitForFinishStatus(e,t){const{metamaskId:r,...s}=e;return new Promise((e,n)=>{this.internalEvents.once(`${r}:finished`,r=>{switch(r.status){case"signed":return e(r.rawSig);case"rejected":return n(new Error(`MetaMask ${t} Signature: User denied message signature.`));case"errored":return n(new Error(`MetaMask ${t} Signature: ${r.error}`));default:return n(new Error(`MetaMask ${t} Signature: Unknown problem: ${JSON.stringify(s)}`))}})})}}r.AbstractMessageManager=o,r.default=o}}},{package:"@metamask/message-manager",file:"node_modules/@metamask/message-manager/dist/AbstractMessageManager.cjs"}],[2055,{"./AbstractMessageManager.cjs":2054,"./utils.cjs":2059,"@metamask/controller-utils":1301},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.DecryptMessageManager=void 0;const s=e("@metamask/controller-utils"),n=e("./AbstractMessageManager.cjs"),i=e("./utils.cjs"),a="DecryptMessageManager";class o extends n.AbstractMessageManager{constructor({additionalFinishStatuses:e,messenger:t,securityProviderRequest:r,state:s}){super({additionalFinishStatuses:e,messenger:t,name:a,securityProviderRequest:r,state:s})}async addUnapprovedMessageAsync(e,t){(0,i.validateDecryptedMessageData)(e);const r=await this.addUnapprovedMessage(e,t);return new Promise((t,s)=>{this.internalEvents.once(`${r}:finished`,r=>{switch(r.status){case"decrypted":return t(r.rawSig);case"rejected":return s(new Error("MetaMask DecryptMessage: User denied message decryption."));case"errored":return s(new Error("MetaMask DecryptMessage: This message cannot be decrypted."));default:return s(new Error(`MetaMask DecryptMessage: Unknown problem: ${JSON.stringify(e)}`))}})})}async addUnapprovedMessage(e,t){const r=this.addRequestToMessageParams(e,t);e.data=(0,i.normalizeMessageData)(e.data);const n=this.createUnapprovedMessage(r,s.ApprovalType.EthDecrypt,t),o=n.id;return await this.addMessage(n),this.messagingSystem.publish(`${a}:unapprovedMessage`,{...r,metamaskId:o}),o}prepMessageForSigning(e){return delete e.metamaskId,Promise.resolve(e)}}r.DecryptMessageManager=o}}},{package:"@metamask/message-manager",file:"node_modules/@metamask/message-manager/dist/DecryptMessageManager.cjs"}],[2056,{"./AbstractMessageManager.cjs":2054,"./utils.cjs":2059,"@metamask/controller-utils":1301},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.EncryptionPublicKeyManager=void 0;const s=e("@metamask/controller-utils"),n=e("./AbstractMessageManager.cjs"),i=e("./utils.cjs");class a extends n.AbstractMessageManager{constructor({additionalFinishStatuses:e,messenger:t,securityProviderRequest:r,state:s}){super({additionalFinishStatuses:e,messenger:t,name:"EncryptionPublicKeyManager",securityProviderRequest:r,state:s})}async addUnapprovedMessageAsync(e,t){(0,i.validateEncryptionPublicKeyMessageData)(e);const r=await this.addUnapprovedMessage(e,t);return new Promise((t,s)=>{this.internalEvents.once(`${r}:finished`,r=>{switch(r.status){case"received":return t(r.rawSig);case"rejected":return s(new Error("MetaMask EncryptionPublicKey: User denied message EncryptionPublicKey."));default:return s(new Error(`MetaMask EncryptionPublicKey: Unknown problem: ${JSON.stringify(e)}`))}})})}async addUnapprovedMessage(e,t){const r=this.addRequestToMessageParams(e,t),n=this.createUnapprovedMessage(r,s.ApprovalType.EthGetEncryptionPublicKey,t),i=n.id;return await this.addMessage(n),this.messagingSystem.publish(`${this.name}:unapprovedMessage`,{...r,metamaskId:i}),i}prepMessageForSigning(e){return delete e.metamaskId,Promise.resolve({from:e.data})}}r.EncryptionPublicKeyManager=a,r.default=a}}},{package:"@metamask/message-manager",file:"node_modules/@metamask/message-manager/dist/EncryptionPublicKeyManager.cjs"}],[2057,{"./AbstractMessageManager.cjs":2054,"./DecryptMessageManager.cjs":2055,"./EncryptionPublicKeyManager.cjs":2056,"./types.cjs":2058},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var s=this&&this.__createBinding||(Object.create?function(e,t,r,s){s===undefined&&(s=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,s,n)}:function(e,t,r,s){s===undefined&&(s=r),e[s]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||s(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),n(e("./AbstractMessageManager.cjs"),r),n(e("./EncryptionPublicKeyManager.cjs"),r),n(e("./DecryptMessageManager.cjs"),r),n(e("./types.cjs"),r)}}},{package:"@metamask/message-manager",file:"node_modules/@metamask/message-manager/dist/index.cjs"}],[2058,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0})}}},{package:"@metamask/message-manager",file:"node_modules/@metamask/message-manager/dist/types.cjs"}],[2059,{"@metamask/controller-utils":1301,"@metamask/utils":2799,buffer:3760},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.validateDecryptedMessageData=r.validateEncryptionPublicKeyMessageData=r.normalizeMessageData=void 0;const s=e("@metamask/controller-utils"),n=e("@metamask/utils"),i=/^[0-9A-Fa-f]+$/gu;function a(e,t){if(!e||"string"!=typeof e||!(0,s.isValidHexAddress)(e))throw new Error(`Invalid "${t}" address: ${e} must be a valid string.`)}r.normalizeMessageData=function(e){try{const t=(0,n.remove0x)(e);if(t.match(i))return(0,n.add0x)(t)}catch(e){}return(0,n.bytesToHex)(t.from(e,"utf8"))},r.validateEncryptionPublicKeyMessageData=function(e){const{from:t}=e;a(t,"from")},r.validateDecryptedMessageData=function(e){const{from:t}=e;a(t,"from")}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/message-manager",file:"node_modules/@metamask/message-manager/dist/utils.cjs"}],[206,{"../../../shared/constants/app":5415,"../../../shared/lib/trace":5517},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return async function(e,t,r){const{id:s,method:o}=e,c=i[o];c&&(e.traceContext=await(0,n.trace)({name:c,id:s,tags:a[o]}),await(0,n.trace)({name:n.TraceName.Middleware,id:s,parentContext:e.traceContext})),r()}};var s=e("../../../shared/constants/app"),n=e("../../../shared/lib/trace");const i={[s.MESSAGE_TYPE.ETH_SEND_TRANSACTION]:n.TraceName.Transaction,[s.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA]:n.TraceName.Signature,[s.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V1]:n.TraceName.Signature,[s.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V3]:n.TraceName.Signature,[s.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V4]:n.TraceName.Signature,[s.MESSAGE_TYPE.PERSONAL_SIGN]:n.TraceName.Signature},a={[s.MESSAGE_TYPE.ETH_SEND_TRANSACTION]:{source:"dapp"}}}}},{package:"$root$",file:"app/scripts/lib/createTracingMiddleware.ts"}],[2065,{"./logger.cjs":2069,"@metamask/account-api":1083},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var s,n,i,a,o,c,l,u,d,p=this&&this.__classPrivateFieldSet||function(e,t,r,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(e,r):n?n.value=r:t.set(e,r),r},h=this&&this.__classPrivateFieldGet||function(e,t,r,s){if("a"===r&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?s:"a"===r?s.call(e):s?s.value:t.get(e)};Object.defineProperty(r,"__esModule",{value:!0}),r.MultichainAccountGroup=void 0;const m=e("@metamask/account-api"),g=e("@metamask/account-api"),f=e("./logger.cjs");r.MultichainAccountGroup=class{constructor({groupIndex:e,wallet:t,providers:r,messenger:m}){s.set(this,void 0),n.set(this,void 0),i.set(this,void 0),a.set(this,void 0),o.set(this,void 0),c.set(this,void 0),l.set(this,void 0),u.set(this,void 0),d.set(this,!1),p(this,s,(0,g.toMultichainAccountGroupId)(t.id,e),"f"),p(this,i,e,"f"),p(this,n,t,"f"),p(this,a,r,"f"),p(this,l,m,"f"),p(this,o,new Map,"f"),p(this,c,new Map,"f"),p(this,u,(0,f.createModuleLogger)(f.projectLogger,`[${h(this,s,"f")}]`),"f"),this.sync(),p(this,d,!0,"f")}sync(){h(this,u,"f").call(this,"Synchronizing with account providers..."),h(this,c,"f").clear();for(const e of h(this,a,"f")){const t=[];for(const r of e.getAccounts())r.options.entropy.id===this.wallet.entropySource&&r.options.entropy.groupIndex===this.groupIndex&&t.push(r.id);h(this,o,"f").set(e,t);for(const r of t)h(this,c,"f").set(r,e)}h(this,d,"f")&&h(this,l,"f").publish("MultichainAccountService:multichainAccountGroupUpdated",this),h(this,u,"f").call(this,"Synchronized")}get id(){return h(this,s,"f")}get type(){return m.AccountGroupType.MultichainAccount}get wallet(){return h(this,n,"f")}get groupIndex(){return h(this,i,"f")}hasAccounts(){return h(this,c,"f").size>0}getAccounts(){const e=[];for(const[t,r]of h(this,o,"f").entries())for(const s of r){const r=t.getAccount(s);r&&e.push(r)}return e}getAccount(e){const t=h(this,c,"f").get(e);return t?t.getAccount(e):undefined}get(e){return(0,m.selectOne)(this.getAccounts(),e)}select(e){return(0,m.select)(this.getAccounts(),e)}async alignAccounts(){h(this,u,"f").call(this,"Aligning accounts...");if((await Promise.allSettled(h(this,a,"f").map(async e=>{const t=h(this,o,"f").get(e);if(!t||0===t.length){h(this,u,"f").call(this,`Found missing accounts for account provider "${e.getName()}", creating them now...`);const t=await e.createAccounts({entropySource:this.wallet.entropySource,groupIndex:this.groupIndex});return h(this,u,"f").call(this,`Created ${t.length} accounts`),t}return Promise.resolve()}))).some(e=>"rejected"===e.status)){const e=`Failed to fully align multichain account group for entropy ID: ${this.wallet.entropySource} and group index: ${this.groupIndex}, some accounts might be missing`;h(this,u,"f").call(this,`${f.WARNING_PREFIX} ${e}`),console.warn(e)}h(this,u,"f").call(this,"Aligned")}},s=new WeakMap,n=new WeakMap,i=new WeakMap,a=new WeakMap,o=new WeakMap,c=new WeakMap,l=new WeakMap,u=new WeakMap,d=new WeakMap}}},{package:"@metamask/multichain-account-service",file:"node_modules/@metamask/multichain-account-service/dist/MultichainAccountGroup.cjs"}]],[],{});